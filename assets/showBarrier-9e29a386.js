import{_ as e}from"./ActWrapper-693a4c4c.js";import{_ as r}from"./DragJob-c32c0722.js";import{t as a,av as t,r as s,c as i,f as o,w as n,D as u,x as l,E as p,A as c,F as m,v as d,L as v,a9 as f,u as b,K as g,O as j,S as x,M as h}from"./vue-vendor-3ae2ccec.js";import{j as y}from"./util-c5e2dd68.js";import{N as _}from"./netregexes-ed180b06.js";import{a as w}from"./overlay_plugin_api-974cdd44.js";import{u as P}from"./index-c6b82793.js";import{_ as A}from"./_plugin-vue_export-helper-6a8c15be.js";import"./index-59b8e199.js";import"./element-plus-1c4f27f5.js";/* empty css                */import"./useDevMode-8c677e90.js";import"./regexes-da03e94d.js";const E=A(a({__name:"showBarrier",setup(a){t(e=>({"24eb8850":b(C),"375f7776":b(D)}));const A={statusEffectExplicit:_.statusEffectExplicit()};let E=0;const I=s([]),L=s(""),S=s(window.location.href),N=i(()=>new URLSearchParams(S.value.split("?")[1])),$=i(()=>"1"===N.value.get("showSettings")),C=i(()=>40*Number(N.value.get("lineHeight")||1)+"px"),D=i(()=>`${Number(N.value.get("fontSize")||26)}px`),U=i(()=>N.value.get("type")||"1");const H=P("cactbotRuntime-sortArr",y);function M(e){H.value=e}function O(){I.value.sort((e,r)=>e.id===L.value?-1:r.id===L.value?1:e.job===r.job?r.id.localeCompare(e.id):H.value.indexOf(e.job)-H.value.indexOf(r.job))}function R(e){return"1"===U.value?`${e.barrierPercent}`:"2"===U.value?`${e.barrierAmount}`:`${e.barrierPercent}%(${e.barrierAmount})`}return o(()=>{w("LogLine",e=>{!function(e){const r=A.statusEffectExplicit.exec(e);if(r?.groups?.targetId.startsWith("1")){const e=I.value.find(e=>e.id===r.groups?.targetId);e&&(e.barrierPercent=Number(r.groups?.currentShield),e.barrierAmount=Math.round(Number(r.groups?.maxHp)*e.barrierPercent/100))}}(e.rawLine)}),w("PartyChanged",e=>{I.value=e.party.filter(e=>e.inParty).map(e=>({...e,barrierPercent:0,barrierAmount:0}))}),w("ChangePrimaryPlayer",e=>{L.value=Number(e.charID).toString(16).toUpperCase()}),n([I,L,H],()=>{clearInterval(E),L.value?O():E=setInterval(()=>{L.value&&(O(),clearInterval(E))},100)},{immediate:!0}),window.addEventListener("hashchange",e=>S.value=e.newURL)}),(a,t)=>{const s=r,i=e;return l(),u(i,null,{default:p(()=>[c("div",null,[c("ul",null,[(l(!0),d(v,null,f(b(I),e=>(l(),d("li",{key:e.id},[m(c("span",{"m-r-2":""},g(e.name),513),[[j,b($)]]),c("span",{style:x(0===e.barrierPercent?{opacity:.25,color:"white"}:{opacity:1,color:"#f5da3c"})},g(R(e)),5)]))),128))]),m(h(s,{style:{"z-index":"10000"},party:b(I),"m-b-1":"","p-1":"",onUpdateSortArr:M},null,8,["party"]),[[j,b($)]])])]),_:1})}}}),[["__scopeId","data-v-c82cfd61"]]);export{E as default};
