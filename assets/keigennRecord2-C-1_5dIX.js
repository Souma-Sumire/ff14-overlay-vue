import{E as e}from"./index-BJ2GTDu3.js";import{J as t,g as r,bP as a,P as n,bQ as o,Q as l,aB as s,d as i,s as c,r as d,f as u,u as m,V as p,i as h,ai as f,A as y,b9 as g,aI as w,aq as v,X as b,y as x,b8 as S,ax as R,L as k,aj as C,x as I,au as T,b as E,aJ as H,h as F,Y as D,m as j,ay as M,aS as L,F as A,bE as N,M as O,bR as $,U as W,I as K,G as z,E as P,bH as B,bS as G,bT as V,a9 as _,a0 as q,bc as U,c as Y,o as Z,a as X,ag as J,j as Q,w as ee,z as te,t as re,e as ae,q as ne,l as oe,bb as le,p as se,ah as ie,bU as ce,k as de,v as ue,aa as me,aN as pe,aM as he,aC as fe,bV as ye}from"./index-l1E8K3Or.js";import{_ as ge}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{E as we}from"./el-empty-DNFt7U5A.js";import{B as ve,c as be}from"./el-scrollbar-CP1_Wryf.js";import{d as xe,o as Se,u as Re,e as ke,a as Ce}from"./index-e4OGYOCy.js";import{s as Ie,c as Te,a as Ee}from"./status-Cjdq15lm.js";import{c as He}from"./clipboard-BKuKuDeo.js";import{U as Fe}from"./util-BOtaAWHW.js";import"./el-popper-EM4JLVtD.js";/* empty css                   */import{E as De}from"./el-divider-CZAZhoNM.js";import{E as je}from"./index-qEGIXFk5.js";import{h as Me,g as Le}from"./xivapi-a6oZXlzI.js";import{d as Ae}from"./debounce-DxDkv_kZ.js";import{V as Ne,F as Oe,B as $e,R as We,a as Ke,b as ze,c as Pe,S as Be,H as Ge,d as Ve,I as _e,e as qe,A as Ue,D as Ye,C as Ze,E as Xe,f as Je,g as Qe}from"./defaults-htyzS7rC.js";import{c as et,r as tt}from"./raf-GzfqKIqn.js";import{a as rt}from"./scroll-vl4bHyTU.js";import{E as at,a as nt}from"./el-select-7QTQxWQM.js";/* empty css                  *//* empty css               */import{u as ot}from"./useDev-Bj7FhB__.js";import{g as lt}from"./actionChinese-CezHnvf8.js";import{l as st}from"./regexes-BKeG-dSP.js";import{N as it}from"./netregexes-RPvCCaeG.js";import{a as ct}from"./overlay_plugin_api-DHbPkDtN.js";import{E as dt}from"./index-BZ-rnhTy.js";import"./use-form-common-props-Co115vSc.js";import"./index-VgkDmEOj.js";import"./index-vnUxd9Py.js";import"./index-D-ziUHTG.js";import"./focus-trap-hrvQOWf8.js";import"./index-BAr7Vexf.js";import"./index-C0cJZiFV.js";import"./vnode-DSqGmbXa.js";import"./index-5AzRbaSm.js";var ut=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function mt(e,t){return e===t||!(!ut(e)||!ut(t))}function pt(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!mt(e[r],t[r]))return!1;return!0}const ht=()=>{const e=t().proxy.$props;return r(()=>{const t=(e,t,r)=>({});return e.perfMode?a(t):function(e,t){void 0===t&&(t=pt);var r=null;function a(){for(var a=[],n=0;n<arguments.length;n++)a[n]=arguments[n];if(r&&r.lastThis===this&&t(a,r.lastArgs))return r.lastResult;var o=e.apply(this,a);return r={lastResult:o,lastArgs:a,lastThis:this},o}return a.clear=function(){r=null},a}(t)})},ft=o({type:l([Number,Function]),required:!0}),yt=o({type:Number}),gt=o({type:Number,default:2}),wt=o({type:String,values:["ltr","rtl"],default:"ltr"}),vt=o({type:Number,default:0}),bt=o({type:Number,required:!0}),xt=o({type:String,values:["horizontal","vertical"],default:Ne}),St=n({className:{type:String,default:""},containerElement:{type:l([String,Object]),default:"div"},data:{type:l(Array),default:()=>s([])},direction:wt,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},innerProps:{type:l(Object),default:()=>({})},style:{type:l([Object,String,Array])},useIsScrolling:Boolean,width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:Boolean}),Rt=n({cache:gt,estimatedItemSize:yt,layout:xt,initScrollOffset:vt,total:bt,itemSize:ft,...St}),kt={type:Number,default:6},Ct={type:Number,default:0},It={type:Number,default:2},Tt=n({columnCache:gt,columnWidth:ft,estimatedColumnWidth:yt,estimatedRowHeight:yt,initScrollLeft:vt,initScrollTop:vt,itemKey:{type:l(Function),default:({columnIndex:e,rowIndex:t})=>`${t}:${e}`},rowCache:gt,rowHeight:ft,totalColumn:bt,totalRow:bt,hScrollbarSize:kt,vScrollbarSize:kt,scrollbarStartGap:Ct,scrollbarEndGap:It,role:String,...St}),Et=n({alwaysOn:Boolean,class:String,layout:xt,total:bt,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:kt,startGap:Ct,endGap:It,visible:Boolean}),Ht=(e,t)=>e<t?Oe:$e,Ft=e=>e===We;let Dt=null;function jt(e=!1){if(null===Dt||e){const e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",t.direction="rtl";const r=document.createElement("div"),a=r.style;return a.width="100px",a.height="100px",e.appendChild(r),document.body.appendChild(e),e.scrollLeft>0?Dt=Ke:(e.scrollLeft=1,Dt=0===e.scrollLeft?ze:Pe),document.body.removeChild(e),Dt}return Dt}const Mt=i({name:"ElVirtualScrollBar",props:Et,emits:["scroll","start-move","stop-move"],setup(e,{emit:t}){const a=r(()=>e.startGap+e.endGap),n=c("virtual-scrollbar"),o=c("scrollbar"),l=d(),s=d();let i=null,g=null;const w=u({isDragging:!1,traveled:0}),v=r(()=>ve[e.layout]),b=r(()=>e.clientSize-m(a)),x=r(()=>({position:"absolute",width:`${Ge===e.layout?b.value:e.scrollbarSize}px`,height:`${Ge===e.layout?e.scrollbarSize:b.value}px`,[Be[e.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"})),S=r(()=>{const t=e.ratio;if(t>=100)return Number.POSITIVE_INFINITY;if(t>=50)return t*b.value/100;const r=b.value/3;return Math.floor(Math.min(Math.max(t*b.value/100,Ve),r))}),R=r(()=>{if(!Number.isFinite(S.value))return{display:"none"};const t=`${S.value}px`,r=function({move:e,size:t,bar:r},a){const n={},o=`translate${r.axis}(${e}px)`;return n[r.size]=t,n.transform=o,"horizontal"===a?n.height="100%":n.width="100%",n}({bar:v.value,size:t,move:w.traveled},e.layout);return r}),k=r(()=>Math.ceil(e.clientSize-S.value-m(a))),C=()=>{window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",T),document.onselectstart=g,g=null;const e=m(s);e&&(e.removeEventListener("touchmove",E),e.removeEventListener("touchend",T))},I=e=>{e.stopImmediatePropagation(),e.ctrlKey||[1,2].includes(e.button)||(w.isDragging=!0,w[v.value.axis]=e.currentTarget[v.value.offset]-(e[v.value.client]-e.currentTarget.getBoundingClientRect()[v.value.direction]),t("start-move"),(()=>{window.addEventListener("mousemove",E),window.addEventListener("mouseup",T);const e=m(s);e&&(g=document.onselectstart,document.onselectstart=()=>!1,e.addEventListener("touchmove",E,{passive:!0}),e.addEventListener("touchend",T))})())},T=()=>{w.isDragging=!1,w[v.value.axis]=0,t("stop-move"),C()},E=e=>{const{isDragging:r}=w;if(!r)return;if(!s.value||!l.value)return;const a=w[v.value.axis];if(!a)return;et(i);const n=-1*(l.value.getBoundingClientRect()[v.value.direction]-e[v.value.client])-(s.value[v.value.offset]-a);i=tt(()=>{w.traveled=Math.max(0,Math.min(n,k.value)),t("scroll",n,k.value)})},H=e=>{const r=Math.abs(e.target.getBoundingClientRect()[v.value.direction]-e[v.value.client])-s.value[v.value.offset]/2;w.traveled=Math.max(0,Math.min(r,k.value)),t("scroll",r,k.value)};return p(()=>e.scrollFrom,e=>{w.isDragging||(w.traveled=Math.ceil(e*k.value))}),h(()=>{C()}),()=>f("div",{role:"presentation",ref:l,class:[n.b(),e.class,(e.alwaysOn||w.isDragging)&&"always-on"],style:x.value,onMousedown:y(H,["stop","prevent"]),onTouchstartPrevent:I},f("div",{ref:s,class:o.e("thumb"),style:R.value,onMousedown:I},[]))}});var Lt=(e=>(e.ASC="asc",e.DESC="desc",e))(Lt||{}),At=(e=>(e.LEFT="left",e.CENTER="center",e.RIGHT="right",e))(At||{}),Nt=(e=>(e.LEFT="left",e.RIGHT="right",e))(Nt||{});const Ot={asc:"desc",desc:"asc"},$t=Symbol("placeholder");const Wt=(e,{mainTableRef:a,leftTableRef:n,rightTableRef:o,tableInstance:l,ns:s,isScrolling:i})=>{const c=t(),{emit:u}=c,p=w(!1),h=d(e.defaultExpandedRowKeys||[]),f=d(-1),y=w(null),g=d({}),x=d({}),S=w({}),R=w({}),k=w({}),C=r(()=>v(e.estimatedRowHeight));function I({hovered:e,rowKey:t}){if(i.value)return;l.vnode.el.querySelectorAll(`[rowkey="${String(t)}"]`).forEach(t=>{e?t.classList.add(s.is("hovered")):t.classList.remove(s.is("hovered"))})}const T=Ae(()=>{var e,t,r,l;p.value=!0,g.value={...m(g),...m(x)},E(m(y),!1),x.value={},y.value=null,null==(e=a.value)||e.forceUpdate(),null==(t=n.value)||t.forceUpdate(),null==(r=o.value)||r.forceUpdate(),null==(l=c.proxy)||l.$forceUpdate(),p.value=!1},0);function E(e,t=!1){m(C)&&[a,n,o].forEach(r=>{const a=m(r);a&&a.resetAfterRowIndex(e,t)})}return{expandedRowKeys:h,lastRenderedRowIndex:f,isDynamic:C,isResetting:p,rowHeights:g,resetAfterIndex:E,onRowExpanded:function({expanded:t,rowData:r,rowIndex:a,rowKey:n}){var o,i;const c=[...m(h)],d=c.indexOf(n);t?-1===d&&c.push(n):d>-1&&c.splice(d,1),h.value=c,u("update:expandedRowKeys",c),null==(o=e.onRowExpand)||o.call(e,{expanded:t,rowData:r,rowIndex:a,rowKey:n}),null==(i=e.onExpandedRowsChange)||i.call(e,c),l.vnode.el.querySelector(`.${s.is("hovered")}[rowkey="${String(n)}"]`)&&b(()=>I({hovered:!0,rowKey:n}))},onRowHovered:I,onRowsRendered:function(t){var r;null==(r=e.onRowsRendered)||r.call(e,t),t.rowCacheEnd>m(f)&&(f.value=t.rowCacheEnd)},onRowHeightChange:function({rowKey:e,height:t,rowIndex:r},a){a?a===Nt.RIGHT?k.value[e]=t:S.value[e]=t:R.value[e]=t;const n=Math.max(...[S,k,R].map(t=>t.value[e]||0));m(g)[e]!==n&&(!function(e,t,r){const a=m(y);(null===a||a>r)&&(y.value=r),x.value[e]=t}(e,n,r),T())}}},Kt=(e,t)=>e+t,zt=e=>x(e)?e.reduce(Kt,0):e,Pt=(e,t,r={})=>k(e)?e(t):null!=e?e:r,Bt=e=>(["width","maxWidth","minWidth","height"].forEach(t=>{e[t]=S(e[t])}),e),Gt=e=>R(e)?t=>f(e,t):e;function Vt(e){const a=d(),n=d(),o=d(),{columns:l,columnsStyles:s,columnsTotalWidth:i,fixedColumnsOnLeft:u,fixedColumnsOnRight:h,hasFixedColumns:f,mainColumns:y,onColumnSorted:b}=function(e,t,a){const n=r(()=>m(t).map((e,t)=>{var r,a;return{...e,key:null!=(a=null!=(r=e.key)?r:e.dataKey)?a:t}})),o=r(()=>m(n).filter(e=>!e.hidden)),l=r(()=>m(o).filter(e=>"left"===e.fixed||!0===e.fixed)),s=r(()=>m(o).filter(e=>"right"===e.fixed)),i=r(()=>m(o).filter(e=>!e.fixed)),c=r(()=>{const e=[];return m(l).forEach(t=>{e.push({...t,placeholderSign:$t})}),m(i).forEach(t=>{e.push(t)}),m(s).forEach(t=>{e.push({...t,placeholderSign:$t})}),e}),d=r(()=>m(l).length||m(s).length),u=r(()=>m(n).reduce((t,r)=>(t[r.key]=((e,t,r)=>{var a;const n={flexGrow:0,flexShrink:0,...r?{}:{flexGrow:e.flexGrow||0,flexShrink:e.flexShrink||1}};r||(n.flexShrink=1);const o={...null!=(a=e.style)?a:{},...n,flexBasis:"auto",width:e.width};return t||(e.maxWidth&&(o.maxWidth=e.maxWidth),e.minWidth&&(o.minWidth=e.minWidth)),o})(r,m(a),e.fixed),t),{})),p=r(()=>m(o).reduce((e,t)=>e+t.width,0)),h=e=>m(n).find(t=>t.key===e);return{columns:n,columnsStyles:u,columnsTotalWidth:p,fixedColumnsOnLeft:l,fixedColumnsOnRight:s,hasFixedColumns:d,mainColumns:c,normalColumns:i,visibleColumns:o,getColumn:h,getColumnStyle:e=>m(u)[e],updateColumnWidth:(e,t)=>{e.width=t},onColumnSorted:function(t){var r;const{key:a}=t.currentTarget.dataset;if(!a)return;const{sortState:n,sortBy:o}=e;let l=Lt.ASC;l=g(n)?Ot[n[a]]:Ot[o.order],null==(r=e.onColumnSort)||r.call(e,{column:h(a),key:a,order:l})}}}(e,C(e,"columns"),C(e,"fixed")),{scrollTo:R,scrollToLeft:k,scrollToTop:I,scrollToRow:T,onScroll:E,onVerticalScroll:H,scrollPos:F}=((e,{mainTableRef:t,leftTableRef:r,rightTableRef:a,onMaybeEndReached:n})=>{const o=d({scrollLeft:0,scrollTop:0});function l(e){var n,o,l;const{scrollTop:s}=e;null==(n=t.value)||n.scrollTo(e),null==(o=r.value)||o.scrollToTop(s),null==(l=a.value)||l.scrollToTop(s)}function s(e){o.value=e,l(e)}function i(e){o.value.scrollTop=e,l(m(o))}return p(()=>m(o).scrollTop,(e,t)=>{e>t&&n()}),{scrollPos:o,scrollTo:s,scrollToLeft:function(e){var r,a;o.value.scrollLeft=e,null==(a=null==(r=t.value)?void 0:r.scrollTo)||a.call(r,m(o))},scrollToTop:i,scrollToRow:function(e,r="auto"){var a;null==(a=t.value)||a.scrollToRow(e,r)},onScroll:function(t){var r;s(t),null==(r=e.onScroll)||r.call(e,t)},onVerticalScroll:function({scrollTop:e}){const{scrollTop:t}=m(o);e!==t&&i(e)}}})(e,{mainTableRef:a,leftTableRef:n,rightTableRef:o,onMaybeEndReached:function(){const{onEndReached:t}=e;if(!t)return;const{scrollTop:r}=m(F),a=m(_),n=m(J),o=a-(r+n)+e.hScrollbarSize;!oe.value&&m(A)>=0&&a<=r+m(Y)-m(re)?(oe.value=!0,t(o)):oe.value=!1}}),D=c("table-v2"),j=t(),M=w(!1),{expandedRowKeys:L,lastRenderedRowIndex:A,isDynamic:N,isResetting:O,rowHeights:$,resetAfterIndex:W,onRowExpanded:K,onRowHeightChange:z,onRowHovered:P,onRowsRendered:B}=Wt(e,{mainTableRef:a,leftTableRef:n,rightTableRef:o,tableInstance:j,ns:D,isScrolling:M}),{data:G,depthMap:V}=((e,{expandedRowKeys:t,lastRenderedRowIndex:a,resetAfterIndex:n})=>{const o=d({}),l=r(()=>{const r={},{data:a,rowKey:n}=e,l=m(t);if(!l||!l.length)return a;const s=[],i=new Set;l.forEach(e=>i.add(e));let c=a.slice();for(c.forEach(e=>r[e[n]]=0);c.length>0;){const e=c.shift();s.push(e),i.has(e[n])&&x(e.children)&&e.children.length>0&&(c=[...e.children,...c],e.children.forEach(t=>r[t[n]]=r[e[n]]+1))}return o.value=r,s}),s=r(()=>{const{data:t,expandColumnKey:r}=e;return r?m(l):t});return p(s,(e,t)=>{e!==t&&(a.value=-1,n(0,!0))}),{data:s,depthMap:o}})(e,{expandedRowKeys:L,lastRenderedRowIndex:A,resetAfterIndex:W}),_=r(()=>{const{estimatedRowHeight:t,rowHeight:r}=e,a=m(G);return v(t)?Object.values(m($)).reduce((e,t)=>e+t,0):a.length*r}),{bodyWidth:q,fixedTableHeight:U,mainTableHeight:Y,leftTableWidth:Z,rightTableWidth:X,windowHeight:J,footerHeight:Q,emptyStyle:ee,rootStyle:te,headerHeight:re}=((e,{columnsTotalWidth:t,rowsHeight:a,fixedColumnsOnLeft:n,fixedColumnsOnRight:o})=>{const l=r(()=>{const{fixed:r,width:a,vScrollbarSize:n}=e,o=a-n;return r?Math.max(Math.round(m(t)),o):o}),s=r(()=>{const{height:t=0,maxHeight:r=0,footerHeight:n,hScrollbarSize:o}=e;if(r>0){const e=m(h),t=m(a),l=m(p)+e+t+o;return Math.min(l,r-n)}return t-n}),i=r(()=>{const{maxHeight:t}=e,r=m(s);if(v(t)&&t>0)return r;const n=m(a)+m(p)+m(h);return Math.min(r,n)}),c=e=>e.width,d=r(()=>zt(m(n).map(c))),u=r(()=>zt(m(o).map(c))),p=r(()=>zt(e.headerHeight)),h=r(()=>{var t;return((null==(t=e.fixedData)?void 0:t.length)||0)*e.rowHeight}),f=r(()=>m(s)-m(p)-m(h)),y=r(()=>{const{style:t={},height:r,width:a}=e;return Bt({...t,height:r,width:a})}),g=r(()=>Bt({height:e.footerHeight})),w=r(()=>({top:S(m(p)),bottom:S(e.footerHeight),width:S(e.width)}));return{bodyWidth:l,fixedTableHeight:i,mainTableHeight:s,leftTableWidth:d,rightTableWidth:u,windowHeight:f,footerHeight:g,emptyStyle:w,rootStyle:y,headerHeight:p}})(e,{columnsTotalWidth:i,fixedColumnsOnLeft:u,fixedColumnsOnRight:h,rowsHeight:_}),ae=d(),ne=r(()=>{const t=0===m(G).length;return x(e.fixedData)?0===e.fixedData.length&&t:t});const oe=d(!1);return p(()=>m(_),()=>oe.value=!1),p(()=>e.expandedRowKeys,e=>L.value=e,{deep:!0}),{columns:l,containerRef:ae,mainTableRef:a,leftTableRef:n,rightTableRef:o,isDynamic:N,isResetting:O,isScrolling:M,hasFixedColumns:f,columnsStyles:s,columnsTotalWidth:i,data:G,expandedRowKeys:L,depthMap:V,fixedColumnsOnLeft:u,fixedColumnsOnRight:h,mainColumns:y,bodyWidth:q,emptyStyle:ee,rootStyle:te,footerHeight:Q,mainTableHeight:Y,fixedTableHeight:U,leftTableWidth:Z,rightTableWidth:X,showEmpty:ne,getRowHeight:function(t){const{estimatedRowHeight:r,rowHeight:a,rowKey:n}=e;return r?m($)[m(G)[t][n]]||r:a},onColumnSorted:b,onRowHovered:P,onRowExpanded:K,onRowsRendered:B,onRowHeightChange:z,scrollTo:R,scrollToLeft:k,scrollToTop:I,scrollToRow:T,onScroll:E,onVerticalScroll:H}}const _t=Symbol("tableV2"),qt="tableV2GridScrollLeft",Ut=String,Yt={type:l(Array),required:!0},Zt={type:l(Array)},Xt={...Zt,required:!0},Jt=String,Qt={type:l(Array),default:()=>s([])},er={type:Number,required:!0},tr={type:l([String,Number,Symbol]),default:"id"},rr={type:l(Object)},ar=n({class:String,columns:Yt,columnsStyles:{type:l(Object),required:!0},depth:Number,expandColumnKey:Jt,estimatedRowHeight:{...Tt.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:l(Function)},onRowHover:{type:l(Function)},onRowHeightChange:{type:l(Function)},rowData:{type:l(Object),required:!0},rowEventHandlers:{type:l(Object)},rowIndex:{type:Number,required:!0},rowKey:tr,style:{type:l(Object)}}),nr={type:Number,required:!0},or=n({class:String,columns:Yt,fixedHeaderData:{type:l(Array)},headerData:{type:l(Array),required:!0},headerHeight:{type:l([Number,Array]),default:50},rowWidth:nr,rowHeight:{type:Number,default:50},height:nr,width:nr}),lr=n({columns:Yt,data:Xt,fixedData:Zt,estimatedRowHeight:ar.estimatedRowHeight,width:er,height:er,headerWidth:er,headerHeight:or.headerHeight,bodyWidth:er,rowHeight:er,cache:Rt.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:Tt.scrollbarAlwaysOn,scrollbarStartGap:Tt.scrollbarStartGap,scrollbarEndGap:Tt.scrollbarEndGap,class:Ut,style:rr,containerStyle:rr,getRowHeight:{type:l(Function),required:!0},rowKey:ar.rowKey,onRowsRendered:{type:l(Function)},onScroll:{type:l(Function)}}),sr=n({cache:lr.cache,estimatedRowHeight:ar.estimatedRowHeight,rowKey:tr,headerClass:{type:l([String,Function])},headerProps:{type:l([Object,Function])},headerCellProps:{type:l([Object,Function])},headerHeight:or.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:l([String,Function])},rowProps:{type:l([Object,Function])},rowHeight:{type:Number,default:50},cellProps:{type:l([Object,Function])},columns:Yt,data:Xt,dataGetter:{type:l(Function)},fixedData:Zt,expandColumnKey:ar.expandColumnKey,expandedRowKeys:Qt,defaultExpandedRowKeys:Qt,class:Ut,fixed:Boolean,style:{type:l(Object)},width:er,height:er,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:Tt.hScrollbarSize,vScrollbarSize:Tt.vScrollbarSize,scrollbarAlwaysOn:Et.alwaysOn,sortBy:{type:l(Object),default:()=>({})},sortState:{type:l(Object),default:void 0},onColumnSort:{type:l(Function)},onExpandedRowsChange:{type:l(Function)},onEndReached:{type:l(Function)},onRowExpand:ar.onRowExpand,onScroll:lr.onScroll,onRowsRendered:lr.onRowsRendered,rowEventHandlers:ar.rowEventHandlers});var ir=i({name:"ElTableV2Header",props:or,setup(e,{slots:t,expose:a}){const n=c("table-v2"),o=I(qt),l=d(),s=r(()=>Bt({width:e.width,height:e.height})),i=r(()=>Bt({width:e.rowWidth,height:e.height})),u=r(()=>be(m(e.headerHeight))),p=e=>{const t=m(l);b(()=>{(null==t?void 0:t.scroll)&&t.scroll({left:e})})},h=()=>{const r=n.e("fixed-header-row"),{columns:a,fixedHeaderData:o,rowHeight:l}=e;return null==o?void 0:o.map((e,n)=>{var o;const s=Bt({height:l,width:"100%"});return null==(o=t.fixed)?void 0:o.call(t,{class:r,columns:a,rowData:e,rowIndex:-(n+1),style:s})})},f=()=>{const r=n.e("dynamic-header-row"),{columns:a}=e;return m(u).map((e,n)=>{var o;const l=Bt({width:"100%",height:e});return null==(o=t.dynamic)?void 0:o.call(t,{class:r,columns:a,headerIndex:n,style:l})})};return T(()=>{(null==o?void 0:o.value)&&p(o.value)}),a({scrollToLeft:p}),()=>{if(!(e.height<=0))return E("div",{ref:l,class:e.class,style:m(s),role:"rowgroup"},[E("div",{style:m(i),class:n.e("header")},[f(),h()])])}}});const cr=({name:e,clearCache:a,getColumnPosition:n,getColumnStartIndexForOffset:o,getColumnStopIndexForStartIndex:l,getEstimatedTotalHeight:s,getEstimatedTotalWidth:u,getColumnOffset:p,getRowOffset:h,getRowPosition:y,getRowStartIndexForOffset:g,getRowStopIndexForStartIndex:w,initCache:x,injectToInstance:S,validateProps:R})=>i({name:null!=e?e:"ElVirtualList",props:Tt,emits:[_e,qe],setup(e,{emit:i,expose:k,slots:C}){const I=c("vl");R(e);const T=t(),E=d(x(e,T));null==S||S(T,E);const O=d(),$=d(),W=d(),K=d(null),z=d({isScrolling:!1,scrollLeft:v(e.initScrollLeft)?e.initScrollLeft:0,scrollTop:v(e.initScrollTop)?e.initScrollTop:0,updateRequested:!1,xAxisScrollDir:Oe,yAxisScrollDir:Oe}),P=ht(),B=r(()=>Number.parseInt(`${e.height}`,10)),G=r(()=>Number.parseInt(`${e.width}`,10)),V=r(()=>{const{totalColumn:t,totalRow:r,columnCache:a}=e,{isScrolling:n,xAxisScrollDir:s,scrollLeft:i}=m(z);if(0===t||0===r)return[0,0,0,0];const c=o(e,i,m(E)),d=l(e,c,i,m(E)),u=n&&s!==$e?1:Math.max(1,a),p=n&&s!==Oe?1:Math.max(1,a);return[Math.max(0,c-u),Math.max(0,Math.min(t-1,d+p)),c,d]}),_=r(()=>{const{totalColumn:t,totalRow:r,rowCache:a}=e,{isScrolling:n,yAxisScrollDir:o,scrollTop:l}=m(z);if(0===t||0===r)return[0,0,0,0];const s=g(e,l,m(E)),i=w(e,s,l,m(E)),c=n&&o!==$e?1:Math.max(1,a),d=n&&o!==Oe?1:Math.max(1,a);return[Math.max(0,s-c),Math.max(0,Math.min(r-1,i+d)),s,i]}),q=r(()=>s(e,m(E))),U=r(()=>u(e,m(E))),Y=r(()=>{var t;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:e.direction,height:v(e.height)?`${e.height}px`:e.height,width:v(e.width)?`${e.width}px`:e.width},null!=(t=e.style)?t:{}]}),Z=r(()=>{const e=`${m(U)}px`;return{height:`${m(q)}px`,pointerEvents:m(z).isScrolling?"none":void 0,width:e}}),X=()=>{const{totalColumn:t,totalRow:r}=e;if(t>0&&r>0){const[e,t,r,a]=m(V),[n,o,l,s]=m(_);i(_e,{columnCacheStart:e,columnCacheEnd:t,rowCacheStart:n,rowCacheEnd:o,columnVisibleStart:r,columnVisibleEnd:a,rowVisibleStart:l,rowVisibleEnd:s})}const{scrollLeft:a,scrollTop:n,updateRequested:o,xAxisScrollDir:l,yAxisScrollDir:s}=m(z);i(qe,{xAxisScrollDir:l,scrollLeft:a,yAxisScrollDir:s,scrollTop:n,updateRequested:o})},J=t=>{const{clientHeight:r,clientWidth:a,scrollHeight:n,scrollLeft:o,scrollTop:l,scrollWidth:s}=t.currentTarget,i=m(z);if(i.scrollTop===l&&i.scrollLeft===o)return;let c=o;if(Ft(e.direction))switch(jt()){case ze:c=-o;break;case Ke:c=s-a-o}z.value={...i,isScrolling:!0,scrollLeft:c,scrollTop:Math.max(0,Math.min(l,n-r)),updateRequested:!0,xAxisScrollDir:Ht(i.scrollLeft,c),yAxisScrollDir:Ht(i.scrollTop,l)},b(()=>ne()),oe(),X()},Q=(e,t)=>{const r=m(B),a=(q.value-r)/t*e;re({scrollTop:Math.min(q.value-r,a)})},ee=(e,t)=>{const r=m(G),a=(U.value-r)/t*e;re({scrollLeft:Math.min(U.value-r,a)})},{onWheel:te}=(({atXEndEdge:e,atXStartEdge:t,atYEndEdge:r,atYStartEdge:a},n)=>{let o=null,l=0,s=0;const i=(n,o)=>{const l=n<=0&&t.value||n>=0&&e.value,s=o<=0&&a.value||o>=0&&r.value;return l&&s};return{hasReachedEdge:i,onWheel:e=>{et(o);let t=e.deltaX,r=e.deltaY;Math.abs(t)>Math.abs(r)?r=0:t=0,e.shiftKey&&0!==r&&(t=r,r=0),i(l,s)&&i(l+t,s+r)||(l+=t,s+=r,e.preventDefault(),o=tt(()=>{n(l,s),l=0,s=0}))}}})({atXStartEdge:r(()=>z.value.scrollLeft<=0),atXEndEdge:r(()=>z.value.scrollLeft>=U.value-m(G)),atYStartEdge:r(()=>z.value.scrollTop<=0),atYEndEdge:r(()=>z.value.scrollTop>=q.value-m(B))},(e,t)=>{var r,a,n,o;null==(a=null==(r=$.value)?void 0:r.onMouseUp)||a.call(r),null==(o=null==(n=W.value)?void 0:n.onMouseUp)||o.call(n);const l=m(G),s=m(B);re({scrollLeft:Math.min(z.value.scrollLeft+e,U.value-l),scrollTop:Math.min(z.value.scrollTop+t,q.value-s)})});H(O,"wheel",te,{passive:!1});const re=({scrollLeft:e=z.value.scrollLeft,scrollTop:t=z.value.scrollTop})=>{e=Math.max(e,0),t=Math.max(t,0);const r=m(z);t===r.scrollTop&&e===r.scrollLeft||(z.value={...r,xAxisScrollDir:Ht(r.scrollLeft,e),yAxisScrollDir:Ht(r.scrollTop,t),scrollLeft:e,scrollTop:t,updateRequested:!0},b(()=>ne()),oe(),X())},ae=(t,r)=>{const{columnWidth:o,direction:l,rowHeight:s}=e,i=P.value(a&&o,a&&s,a&&l),c=`${t},${r}`;if(N(i,c))return i[c];{const[,a]=n(e,r,m(E)),o=m(E),s=Ft(l),[d,u]=y(e,t,o),[p]=n(e,r,o);return i[c]={position:"absolute",left:s?void 0:`${a}px`,right:s?`${a}px`:void 0,top:`${u}px`,height:`${d}px`,width:`${p}px`},i[c]}},ne=()=>{z.value.isScrolling=!1,b(()=>{P.value(-1,null,null)})};F(()=>{if(!D)return;const{initScrollLeft:t,initScrollTop:r}=e,a=m(O);a&&(v(t)&&(a.scrollLeft=t),v(r)&&(a.scrollTop=r)),X()});const oe=()=>{const{direction:t}=e,{scrollLeft:r,scrollTop:a,updateRequested:n}=m(z),o=m(O);if(n&&o){if(t===We)switch(jt()){case ze:o.scrollLeft=-r;break;case Pe:o.scrollLeft=r;break;default:{const{clientWidth:e,scrollWidth:t}=o;o.scrollLeft=t-e-r;break}}else o.scrollLeft=Math.max(0,r);o.scrollTop=Math.max(0,a)}},{resetAfterColumnIndex:le,resetAfterRowIndex:se,resetAfter:ie}=T.proxy;k({windowRef:O,innerRef:K,getItemStyleCache:P,scrollTo:re,scrollToItem:(t=0,r=0,a=Ue)=>{const n=m(z);r=Math.max(0,Math.min(r,e.totalColumn-1)),t=Math.max(0,Math.min(t,e.totalRow-1));const o=rt(I.namespace.value),l=m(E),i=s(e,l),c=u(e,l);re({scrollLeft:p(e,r,a,n.scrollLeft,l,c>e.width?o:0),scrollTop:h(e,t,a,n.scrollTop,l,i>e.height?o:0)})},states:z,resetAfterColumnIndex:le,resetAfterRowIndex:se,resetAfter:ie});const ce=()=>{const t=j(e.innerElement),r=(()=>{var t;const[r,a]=m(V),[n,o]=m(_),{data:l,totalColumn:s,totalRow:i,useIsScrolling:c,itemKey:d}=e,u=[];if(i>0&&s>0)for(let e=n;e<=o;e++)for(let n=r;n<=a;n++){const r=d({columnIndex:n,data:l,rowIndex:e});u.push(f(A,{key:r},null==(t=C.default)?void 0:t.call(C,{columnIndex:n,data:l,isScrolling:c?m(z).isScrolling:void 0,style:ae(e,n),rowIndex:e})))}return u})();return[f(t,L(e.innerProps,{style:m(Z),ref:K}),M(t)?r:{default:()=>r})]};return()=>{const t=j(e.containerElement),{horizontalScrollbar:r,verticalScrollbar:a}=(()=>{const{scrollbarAlwaysOn:t,scrollbarStartGap:r,scrollbarEndGap:a,totalColumn:n,totalRow:o}=e,l=m(G),s=m(B),i=m(U),c=m(q),{scrollLeft:d,scrollTop:u}=m(z);return{horizontalScrollbar:f(Mt,{ref:$,alwaysOn:t,startGap:r,endGap:a,class:I.e("horizontal"),clientSize:l,layout:"horizontal",onScroll:ee,ratio:100*l/i,scrollFrom:d/(i-l),total:o,visible:!0}),verticalScrollbar:f(Mt,{ref:W,alwaysOn:t,startGap:r,endGap:a,class:I.e("vertical"),clientSize:s,layout:"vertical",onScroll:Q,ratio:100*s/c,scrollFrom:u/(c-s),total:n,visible:!0})}})(),n=ce();return f("div",{key:0,class:I.e("wrapper"),role:e.role},[f(t,{class:e.className,style:m(Y),onScroll:J,ref:O},M(t)?n:{default:()=>n}),r,a])}}}),{max:dr,min:ur,floor:mr}=Math,pr={column:"columnWidth",row:"rowHeight"},hr={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},fr=(e,t,r,a)=>{const[n,o,l]=[r[a],e[pr[a]],r[hr[a]]];if(t>l){let e=0;if(l>=0){const t=n[l];e=t.offset+t.size}for(let r=l+1;r<=t;r++){const t=o(r);n[r]={offset:e,size:t},e+=t}r[hr[a]]=t}return n[t]},yr=(e,t,r,a,n,o)=>{for(;r<=a;){const l=r+mr((a-r)/2),s=fr(e,l,t,o).offset;if(s===n)return l;s<n?r=l+1:a=l-1}return dr(0,r-1)},gr=(e,t,r,a)=>{const[n,o]=[t[a],t[hr[a]]];return(o>0?n[o].offset:0)>=r?yr(e,t,0,o,r,a):((e,t,r,a,n)=>{const o="column"===n?e.totalColumn:e.totalRow;let l=1;for(;r<o&&fr(e,r,t,n).offset<a;)r+=l,l*=2;return yr(e,t,mr(r/2),ur(r,o-1),a,n)})(e,t,dr(0,o),r,a)},wr=({totalRow:e},{estimatedRowHeight:t,lastVisitedRowIndex:r,row:a})=>{let n=0;if(r>=e&&(r=e-1),r>=0){const e=a[r];n=e.offset+e.size}return n+(e-r-1)*t},vr=({totalColumn:e},{column:t,estimatedColumnWidth:r,lastVisitedColumnIndex:a})=>{let n=0;if(a>e&&(a=e-1),a>=0){const e=t[a];n=e.offset+e.size}return n+(e-a-1)*r},br={column:vr,row:wr},xr=(e,t,r,a,n,o,l)=>{const[s,i]=["row"===o?e.height:e.width,br[o]],c=fr(e,t,n,o),d=i(e,n),u=dr(0,ur(d-s,c.offset)),m=dr(0,c.offset-s+l+c.size);switch(r===Qe&&(r=a>=m-s&&a<=u+s?Ue:Ze),r){case Je:return u;case Xe:return m;case Ze:return Math.round(m+(u-m)/2);default:return a>=m&&a<=u?a:m>u||a<m?m:u}},Sr=cr({name:"ElDynamicSizeGrid",getColumnPosition:(e,t,r)=>{const a=fr(e,t,r,"column");return[a.size,a.offset]},getRowPosition:(e,t,r)=>{const a=fr(e,t,r,"row");return[a.size,a.offset]},getColumnOffset:(e,t,r,a,n,o)=>xr(e,t,r,a,n,"column",o),getRowOffset:(e,t,r,a,n,o)=>xr(e,t,r,a,n,"row",o),getColumnStartIndexForOffset:(e,t,r)=>gr(e,r,t,"column"),getColumnStopIndexForStartIndex:(e,t,r,a)=>{const n=fr(e,t,a,"column"),o=r+e.width;let l=n.offset+n.size,s=t;for(;s<e.totalColumn-1&&l<o;)s++,l+=fr(e,t,a,"column").size;return s},getEstimatedTotalHeight:wr,getEstimatedTotalWidth:vr,getRowStartIndexForOffset:(e,t,r)=>gr(e,r,t,"row"),getRowStopIndexForStartIndex:(e,t,r,a)=>{const{totalRow:n,height:o}=e,l=fr(e,t,a,"row"),s=r+o;let i=l.size+l.offset,c=t;for(;c<n-1&&i<s;)c++,i+=fr(e,c,a,"row").size;return c},injectToInstance:(e,t)=>{const r=({columnIndex:r,rowIndex:a},n)=>{var o,l;n=!!O(n)||n,v(r)&&(t.value.lastVisitedColumnIndex=Math.min(t.value.lastVisitedColumnIndex,r-1)),v(a)&&(t.value.lastVisitedRowIndex=Math.min(t.value.lastVisitedRowIndex,a-1)),null==(o=e.exposed)||o.getItemStyleCache.value(-1,null,null),n&&(null==(l=e.proxy)||l.$forceUpdate())};Object.assign(e.proxy,{resetAfterColumnIndex:(e,t)=>{r({columnIndex:e},t)},resetAfterRowIndex:(e,t)=>{r({rowIndex:e},t)},resetAfter:r})},initCache:({estimatedColumnWidth:e=Ye,estimatedRowHeight:t=Ye})=>({column:{},estimatedColumnWidth:e,estimatedRowHeight:t,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:e,rowHeight:t})=>{}}),Rr=cr({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:e},t)=>[e,t*e],getRowPosition:({rowHeight:e},t)=>[e,t*e],getEstimatedTotalHeight:({totalRow:e,rowHeight:t})=>t*e,getEstimatedTotalWidth:({totalColumn:e,columnWidth:t})=>t*e,getColumnOffset:({totalColumn:e,columnWidth:t,width:r},a,n,o,l,s)=>{r=Number(r);const i=Math.max(0,e*t-r),c=Math.min(i,a*t),d=Math.max(0,a*t-r+s+t);switch("smart"===n&&(n=o>=d-r&&o<=c+r?Ue:Ze),n){case Je:return c;case Xe:return d;case Ze:{const e=Math.round(d+(c-d)/2);return e<Math.ceil(r/2)?0:e>i+Math.floor(r/2)?i:e}default:return o>=d&&o<=c?o:d>c||o<d?d:c}},getRowOffset:({rowHeight:e,height:t,totalRow:r},a,n,o,l,s)=>{t=Number(t);const i=Math.max(0,r*e-t),c=Math.min(i,a*e),d=Math.max(0,a*e-t+s+e);switch(n===Qe&&(n=o>=d-t&&o<=c+t?Ue:Ze),n){case Je:return c;case Xe:return d;case Ze:{const e=Math.round(d+(c-d)/2);return e<Math.ceil(t/2)?0:e>i+Math.floor(t/2)?i:e}default:return o>=d&&o<=c?o:d>c||o<d?d:c}},getColumnStartIndexForOffset:({columnWidth:e,totalColumn:t},r)=>Math.max(0,Math.min(t-1,Math.floor(r/e))),getColumnStopIndexForStartIndex:({columnWidth:e,totalColumn:t,width:r},a,n)=>{const o=a*e,l=Math.ceil((r+n-o)/e);return Math.max(0,Math.min(t-1,a+l-1))},getRowStartIndexForOffset:({rowHeight:e,totalRow:t},r)=>Math.max(0,Math.min(t-1,Math.floor(r/e))),getRowStopIndexForStartIndex:({rowHeight:e,totalRow:t,height:r},a,n)=>{const o=a*e,l=Math.ceil((r+n-o)/e);return Math.max(0,Math.min(t-1,a+l-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:e,rowHeight:t})=>{}});var kr=i({name:"ElTableV2Grid",props:lr,setup(e,{slots:t,expose:a}){const{ns:n}=I(_t),{bodyRef:o,fixedRowHeight:l,gridHeight:s,hasHeader:i,headerRef:c,headerHeight:u,totalHeight:h,forceUpdate:f,itemKey:y,onItemRendered:w,resetAfterRowIndex:x,scrollTo:S,scrollToTop:R,scrollToRow:k,scrollLeft:C}=(e=>{const t=d(),a=d(),n=d(0),o=r(()=>{const{data:t,rowHeight:r,estimatedRowHeight:a}=e;if(!a)return t.length*r}),l=r(()=>{const{fixedData:t,rowHeight:r}=e;return((null==t?void 0:t.length)||0)*r}),s=r(()=>zt(e.headerHeight)),i=r(()=>{const{height:t}=e;return Math.max(0,t-m(s)-m(l))}),c=r(()=>m(s)+m(l)>0);return p(()=>e.bodyWidth,()=>{var t;v(e.estimatedRowHeight)&&(null==(t=a.value)||t.resetAfter({columnIndex:0},!1))}),{bodyRef:a,forceUpdate:function(){var e,r;null==(e=m(a))||e.$forceUpdate(),null==(r=m(t))||r.$forceUpdate()},fixedRowHeight:l,gridHeight:i,hasHeader:c,headerHeight:s,headerRef:t,totalHeight:o,itemKey:({data:t,rowIndex:r})=>t[r][e.rowKey],onItemRendered:function({rowCacheStart:t,rowCacheEnd:r,rowVisibleStart:a,rowVisibleEnd:n}){var o;null==(o=e.onRowsRendered)||o.call(e,{rowCacheStart:t,rowCacheEnd:r,rowVisibleStart:a,rowVisibleEnd:n})},resetAfterRowIndex:function(e,t){var r;null==(r=a.value)||r.resetAfterRowIndex(e,t)},scrollTo:function(e,r){const o=m(t),l=m(a);g(e)?(null==o||o.scrollToLeft(e.scrollLeft),n.value=e.scrollLeft,null==l||l.scrollTo(e)):(null==o||o.scrollToLeft(e),n.value=e,null==l||l.scrollTo({scrollLeft:e,scrollTop:r}))},scrollToTop:function(e){var t;null==(t=m(a))||t.scrollTo({scrollTop:e})},scrollToRow:function(e,t){var r;null==(r=m(a))||r.scrollToItem(e,1,t)},scrollLeft:n}})(e);W(qt,C),$(async()=>{var e;await b();const t=null==(e=o.value)?void 0:e.states.scrollTop;t&&R(Math.round(t)+1)}),a({forceUpdate:f,totalHeight:h,scrollTo:S,scrollToTop:R,scrollToRow:k,resetAfterRowIndex:x});const T=()=>e.bodyWidth;return()=>{const{cache:r,columns:a,data:d,fixedData:p,useIsScrolling:h,scrollbarAlwaysOn:f,scrollbarEndGap:g,scrollbarStartGap:b,style:x,rowHeight:S,bodyWidth:R,estimatedRowHeight:k,headerWidth:C,height:I,width:H,getRowHeight:F,onScroll:D}=e,j=v(k),M=j?Sr:Rr,L=m(u);return E("div",{role:"table",class:[n.e("table"),e.class],style:x},[E(M,{ref:o,data:d,useIsScrolling:h,itemKey:y,columnCache:0,columnWidth:j?T:R,totalColumn:1,totalRow:d.length,rowCache:r,rowHeight:j?F:S,width:H,height:m(s),class:n.e("body"),role:"rowgroup",scrollbarStartGap:b,scrollbarEndGap:g,scrollbarAlwaysOn:f,onScroll:D,onItemRendered:w,perfMode:!1},{default:e=>{var r;const n=d[e.rowIndex];return null==(r=t.row)?void 0:r.call(t,{...e,columns:a,rowData:n})}}),m(i)&&E(ir,{ref:c,class:n.e("header-wrapper"),columns:a,headerData:d,headerHeight:e.headerHeight,fixedHeaderData:p,rowWidth:C,rowHeight:S,width:H,height:Math.min(L+m(l),I)},{dynamic:t.header,fixed:t.row})])}}});var Cr=(e,{slots:t})=>{const{mainTableRef:r,...a}=e;return E(kr,L({ref:r},a),"function"==typeof(n=t)||"[object Object]"===Object.prototype.toString.call(n)&&!R(n)?t:{default:()=>[t]});var n};var Ir=(e,{slots:t})=>{if(!e.columns.length)return;const{leftTableRef:r,...a}=e;return E(kr,L({ref:r},a),"function"==typeof(n=t)||"[object Object]"===Object.prototype.toString.call(n)&&!R(n)?t:{default:()=>[t]});var n};var Tr=(e,{slots:t})=>{if(!e.columns.length)return;const{rightTableRef:r,...a}=e;return E(kr,L({ref:r},a),"function"==typeof(n=t)||"[object Object]"===Object.prototype.toString.call(n)&&!R(n)?t:{default:()=>[t]});var n};const Er=e=>{const{isScrolling:t}=I(_t),a=d(!1),n=d(),o=r(()=>v(e.estimatedRowHeight)&&e.rowIndex>=0),l=r(()=>{const{rowData:t,rowIndex:r,rowKey:a,onRowHover:n}=e,o=e.rowEventHandlers||{},l={};return Object.entries(o).forEach(([e,n])=>{k(n)&&(l[e]=e=>{n({event:e,rowData:t,rowIndex:r,rowKey:a})})}),n&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach(({name:e,hovered:o})=>{const s=l[e];l[e]=e=>{n({event:e,hovered:o,rowData:t,rowIndex:r,rowKey:a}),null==s||s(e)}}),l});return F(()=>{m(o)&&((t=!1)=>{const r=m(n);if(!r)return;const{columns:o,onRowHeightChange:l,rowKey:s,rowIndex:i,style:c}=e,{height:d}=r.getBoundingClientRect();a.value=!0,b(()=>{if(t||d!==Number.parseInt(c.height)){const e=o[0],t=(null==e?void 0:e.placeholderSign)===$t;null==l||l({rowKey:s,height:d,rowIndex:i},e&&!t&&e.fixed)}})})(!0)}),{isScrolling:t,measurable:o,measured:a,rowRef:n,eventHandlers:l,onExpand:t=>{const{onRowExpand:r,rowData:a,rowIndex:n,rowKey:o}=e;null==r||r({expanded:t,rowData:a,rowIndex:n,rowKey:o})}}};var Hr=i({name:"ElTableV2TableRow",props:ar,setup(e,{expose:t,slots:r,attrs:a}){const{eventHandlers:n,isScrolling:o,measurable:l,measured:s,rowRef:i,onExpand:c}=Er(e);return t({onExpand:c}),()=>{const{columns:t,columnsStyles:d,expandColumnKey:u,depth:p,rowData:h,rowIndex:f,style:y}=e;let g=t.map((e,a)=>{const n=x(h.children)&&h.children.length>0&&e.key===u;return r.cell({column:e,columns:t,columnIndex:a,depth:p,style:d[e.key],rowData:h,rowIndex:f,isScrolling:m(o),expandIconProps:n?{rowData:h,rowIndex:f,onExpand:c}:void 0})});if(r.row&&(g=r.row({cells:g.map(e=>x(e)&&1===e.length?e[0]:e),style:y,columns:t,depth:p,rowData:h,rowIndex:f,isScrolling:m(o)})),m(l)){const{height:t,...r}=y||{},o=m(s);return E("div",L({ref:i,class:e.class,style:o?y:r,role:"row"},a,m(n)),[g])}return E("div",L(a,{ref:i,class:e.class,style:y,role:"row"},m(n)),[g])}}});var Fr=(e,{slots:t})=>{const{columns:r,columnsStyles:a,depthMap:n,expandColumnKey:o,expandedRowKeys:l,estimatedRowHeight:s,hasFixedColumns:i,rowData:c,rowIndex:d,style:u,isScrolling:m,rowProps:p,rowClass:h,rowKey:f,rowEventHandlers:y,ns:g,onRowHovered:w,onRowExpanded:v}=e,b=Pt(h,{columns:r,rowData:c,rowIndex:d},""),x=Pt(p,{columns:r,rowData:c,rowIndex:d}),S=c[f],k=n[S]||0,C=Boolean(o),I=d<0,T=[g.e("row"),b,{[g.e(`row-depth-${k}`)]:C&&d>=0,[g.is("expanded")]:C&&l.includes(S),[g.is("fixed")]:!k&&I,[g.is("customized")]:Boolean(t.row)}],H=i?w:void 0,F={...x,columns:r,columnsStyles:a,class:T,depth:k,expandColumnKey:o,estimatedRowHeight:I?void 0:s,isScrolling:m,rowIndex:d,rowData:c,rowKey:S,rowEventHandlers:y,style:u};return E(Hr,L(F,{onRowExpand:v,onMouseenter:e=>{null==H||H({hovered:!0,rowKey:S,event:e,rowData:c,rowIndex:d})},onMouseleave:e=>{null==H||H({hovered:!1,rowKey:S,event:e,rowData:c,rowIndex:d})},rowkey:S}),"function"==typeof(D=t)||"[object Object]"===Object.prototype.toString.call(D)&&!R(D)?t:{default:()=>[t]});var D};const Dr=(e,{slots:t})=>{var r;const{cellData:a,style:n}=e,o=(null==(r=null==a?void 0:a.toString)?void 0:r.call(a))||"",l=K(t,"default",e,()=>[o]);return E("div",{class:e.class,title:o,style:n},[l])};Dr.displayName="ElTableV2Cell",Dr.inheritAttrs=!1;var jr=Dr;var Mr=e=>{const{expanded:t,expandable:r,onExpand:a,style:n,size:o}=e,l={onClick:r?()=>a(!t):void 0,class:e.class};return E(P,L(l,{size:o,style:n}),{default:()=>[E(z,null,null)]})};const Lr=({columns:e,column:t,columnIndex:r,depth:a,expandIconProps:n,isScrolling:o,rowData:l,rowIndex:s,style:i,expandedRowKeys:c,ns:d,cellProps:u,expandColumnKey:m,indentSize:p,iconSize:h,rowKey:f},{slots:y})=>{const w=Bt(i);if(t.placeholderSign===$t)return E("div",{class:d.em("row-cell","placeholder"),style:w},null);const{cellRenderer:v,dataKey:b,dataGetter:x}=t,S=k(x)?x({columns:e,column:t,columnIndex:r,rowData:l,rowIndex:s}):B(l,null!=b?b:""),R=Pt(u,{cellData:S,columns:e,column:t,columnIndex:r,rowIndex:s,rowData:l}),C={class:d.e("cell-text"),columns:e,column:t,columnIndex:r,cellData:S,isScrolling:o,rowData:l,rowIndex:s},I=Gt(v),T=I?I(C):K(y,"default",C,()=>[E(jr,C,null)]),H=[d.e("row-cell"),t.class,t.align===At.CENTER&&d.is("align-center"),t.align===At.RIGHT&&d.is("align-right")],F=s>=0&&m&&t.key===m,D=s>=0&&c.includes(l[f]);let j;const M=`margin-inline-start: ${a*p}px;`;return F&&(j=g(n)?E(Mr,L(n,{class:[d.e("expand-icon"),d.is("expanded",D)],size:h,expanded:D,style:M,expandable:!0}),null):E("div",{style:[M,`width: ${h}px; height: ${h}px;`].join(" ")},null)),E("div",L({class:H,style:w},R,{role:"cell"}),[j,T])};Lr.inheritAttrs=!1;var Ar=Lr;const Nr=n({class:String,columns:Yt,columnsStyles:{type:l(Object),required:!0},headerIndex:Number,style:{type:l(Object)}});var Or=i({name:"ElTableV2HeaderRow",props:Nr,setup:(e,{slots:t})=>()=>{const{columns:r,columnsStyles:a,headerIndex:n,style:o}=e;let l=r.map((e,o)=>t.cell({columns:r,column:e,columnIndex:o,headerIndex:n,style:a[e.key]}));return t.header&&(l=t.header({cells:l.map(e=>x(e)&&1===e.length?e[0]:e),columns:r,headerIndex:n})),E("div",{class:e.class,style:o,role:"row"},[l])}});var $r=({columns:e,columnsStyles:t,headerIndex:r,style:a,headerClass:n,headerProps:o,ns:l},{slots:s})=>{const i={columns:e,headerIndex:r},c=[l.e("header-row"),Pt(n,i,""),{[l.is("customized")]:Boolean(s.header)}],d={...Pt(o,i),columnsStyles:t,class:c,columns:e,headerIndex:r,style:a};return E(Or,d,"function"==typeof(u=s)||"[object Object]"===Object.prototype.toString.call(u)&&!R(u)?s:{default:()=>[s]});var u};const Wr=(e,{slots:t})=>K(t,"default",e,()=>{var t,r;return[E("div",{class:e.class,title:null==(t=e.column)?void 0:t.title},[null==(r=e.column)?void 0:r.title])]});Wr.displayName="ElTableV2HeaderCell",Wr.inheritAttrs=!1;var Kr=Wr;var zr=e=>{const{sortOrder:t}=e;return E(P,{size:14,class:e.class},{default:()=>[t===Lt.ASC?E(G,null,null):E(V,null,null)]})};var Pr=(e,{slots:t})=>{const{column:r,ns:a,style:n,onColumnSorted:o}=e,l=Bt(n);if(r.placeholderSign===$t)return E("div",{class:a.em("header-row-cell","placeholder"),style:l},null);const{headerCellRenderer:s,headerClass:i,sortable:c}=r,d={...e,class:a.e("header-cell-text")},u=Gt(s),m=u?u(d):K(t,"default",d,()=>[E(Kr,d,null)]),{sortBy:p,sortState:h,headerCellProps:f}=e;let y,g;if(h){const e=h[r.key];y=Boolean(Ot[e]),g=y?e:Lt.ASC}else y=r.key===p.key,g=y?p.order:Lt.ASC;const w=[a.e("header-cell"),Pt(i,e,""),r.align===At.CENTER&&a.is("align-center"),r.align===At.RIGHT&&a.is("align-right"),c&&a.is("sortable")],v={...Pt(f,e),onClick:r.sortable?o:void 0,class:w,style:l,"data-key":r.key};return E("div",L(v,{role:"columnheader"}),[m,c&&E(zr,{class:[a.e("sort-icon"),y&&a.is("sorting")],sortOrder:g},null)])};const Br=(e,{slots:t})=>{var r;return E("div",{class:e.class,style:e.style},[null==(r=t.default)?void 0:r.call(t)])};Br.displayName="ElTableV2Footer";var Gr=Br;const Vr=(e,{slots:t})=>{const r=K(t,"default",{},()=>[E(we,null,null)]);return E("div",{class:e.class,style:e.style},[r])};Vr.displayName="ElTableV2Empty";var _r=Vr;const qr=(e,{slots:t})=>{var r;return E("div",{class:e.class,style:e.style},[null==(r=t.default)?void 0:r.call(t)])};qr.displayName="ElTableV2Overlay";var Ur=qr;function Yr(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!R(e)}var Zr=i({name:"ElTableV2",props:sr,setup(e,{slots:t,expose:r}){const a=c("table-v2"),{columnsStyles:n,fixedColumnsOnLeft:o,fixedColumnsOnRight:l,mainColumns:s,mainTableHeight:i,fixedTableHeight:d,leftTableWidth:u,rightTableWidth:p,data:h,depthMap:f,expandedRowKeys:y,hasFixedColumns:g,mainTableRef:w,leftTableRef:v,rightTableRef:b,isDynamic:x,isResetting:S,isScrolling:R,bodyWidth:k,emptyStyle:C,rootStyle:I,footerHeight:T,showEmpty:H,scrollTo:F,scrollToLeft:D,scrollToTop:j,scrollToRow:M,getRowHeight:A,onColumnSorted:N,onRowHeightChange:O,onRowHovered:$,onRowExpanded:K,onRowsRendered:z,onScroll:P,onVerticalScroll:B}=Vt(e);return r({scrollTo:F,scrollToLeft:D,scrollToTop:j,scrollToRow:M}),W(_t,{ns:a,isResetting:S,isScrolling:R}),()=>{const{cache:r,cellProps:c,estimatedRowHeight:S,expandColumnKey:R,fixedData:F,headerHeight:D,headerClass:j,headerProps:M,headerCellProps:W,sortBy:G,sortState:V,rowHeight:_,rowClass:q,rowEventHandlers:U,rowKey:Y,rowProps:Z,scrollbarAlwaysOn:X,indentSize:J,iconSize:Q,useIsScrolling:ee,vScrollbarSize:te,width:re}=e,ae=m(h),ne={cache:r,class:a.e("main"),columns:m(s),data:ae,fixedData:F,estimatedRowHeight:S,bodyWidth:m(k),headerHeight:D,headerWidth:m(k),height:m(i),mainTableRef:w,rowKey:Y,rowHeight:_,scrollbarAlwaysOn:X,scrollbarStartGap:2,scrollbarEndGap:te,useIsScrolling:ee,width:re,getRowHeight:A,onRowsRendered:z,onScroll:P},oe=m(u),le=m(d),se={cache:r,class:a.e("left"),columns:m(o),data:ae,fixedData:F,estimatedRowHeight:S,leftTableRef:v,rowHeight:_,bodyWidth:oe,headerWidth:oe,headerHeight:D,height:le,rowKey:Y,scrollbarAlwaysOn:X,scrollbarStartGap:2,scrollbarEndGap:te,useIsScrolling:ee,width:oe,getRowHeight:A,onScroll:B},ie=m(p),ce={cache:r,class:a.e("right"),columns:m(l),data:ae,fixedData:F,estimatedRowHeight:S,rightTableRef:b,rowHeight:_,bodyWidth:ie,headerWidth:ie,headerHeight:D,height:le,rowKey:Y,scrollbarAlwaysOn:X,scrollbarStartGap:2,scrollbarEndGap:te,width:ie,style:`${a.cssVarName("table-scrollbar-size")}: ${te}px`,useIsScrolling:ee,getRowHeight:A,onScroll:B},de=m(n),ue={ns:a,depthMap:m(f),columnsStyles:de,expandColumnKey:R,expandedRowKeys:m(y),estimatedRowHeight:S,hasFixedColumns:m(g),rowProps:Z,rowClass:q,rowKey:Y,rowEventHandlers:U,onRowHovered:$,onRowExpanded:K,onRowHeightChange:O},me={cellProps:c,expandColumnKey:R,indentSize:J,iconSize:Q,rowKey:Y,expandedRowKeys:m(y),ns:a},pe={ns:a,headerClass:j,headerProps:M,columnsStyles:de},he={ns:a,sortBy:G,sortState:V,headerCellProps:W,onColumnSorted:N},fe={row:e=>E(Fr,L(e,ue),{row:t.row,cell:e=>{let r;return t.cell?E(Ar,L(e,me,{style:de[e.column.key]}),Yr(r=t.cell(e))?r:{default:()=>[r]}):E(Ar,L(e,me,{style:de[e.column.key]}),null)}}),header:e=>E($r,L(e,pe),{header:t.header,cell:e=>{let r;return t["header-cell"]?E(Pr,L(e,he,{style:de[e.column.key]}),Yr(r=t["header-cell"](e))?r:{default:()=>[r]}):E(Pr,L(e,he,{style:de[e.column.key]}),null)}})},ye=[e.class,a.b(),a.e("root"),{[a.is("dynamic")]:m(x)}],ge={class:a.e("footer"),style:m(T)};return E("div",{class:ye,style:m(I)},[E(Cr,ne,Yr(fe)?fe:{default:()=>[fe]}),E(Ir,se,Yr(fe)?fe:{default:()=>[fe]}),E(Tr,ce,Yr(fe)?fe:{default:()=>[fe]}),t.footer&&E(Gr,ge,{default:t.footer}),m(H)&&E(_r,{class:a.e("empty"),style:m(C)},{default:t.empty}),t.overlay&&E(Ur,{class:a.e("overlay")},{default:t.overlay})])}}});const Xr=n({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:l(Function)}});var Jr=i({name:"ElAutoResizer",props:Xr,setup(e,{slots:t}){const r=c("auto-resizer"),{height:a,width:n,sizer:o}=(e=>{const t=d(),r=d(0),a=d(0);let n;return F(()=>{n=_(t,([e])=>{const{width:t,height:n}=e.contentRect,{paddingLeft:o,paddingRight:l,paddingTop:s,paddingBottom:i}=getComputedStyle(e.target),c=Number.parseInt(o)||0,d=Number.parseInt(l)||0,u=Number.parseInt(s)||0,m=Number.parseInt(i)||0;r.value=t-c-d,a.value=n-u-m}).stop}),h(()=>{null==n||n()}),p([r,a],([t,r])=>{var a;null==(a=e.onResize)||a.call(e,{width:t,height:r})}),{sizer:t,width:r,height:a}})(e),l={width:"100%",height:"100%"};return()=>{var e;return E("div",{ref:o,class:r.b(),style:l},[null==(e=t.default)?void 0:e.call(t,{height:a.value,width:n.value})])}}});const Qr=q(Zr),ea=q(Jr),ta={class:"upload select"},ra=ge(i({__name:"TestLog",emits:["handleLine","beforeHandle","afterHandle"],setup(t,{emit:r}){const a=r,n=d(null),o=d(null);async function l(t){o.value?.classList.remove("drag");const r=t.target.files;if(!r||0===r.length)return;a("beforeHandle");const n=e.service({fullscreen:!0,text:"正在解析……请稍候",lock:!0,spinner:'<div style="width:0;height:0"></div>'});for(let e=0;e<r.length;e++){const t=r[e],n=await t.text();for(const e of n.split("\n"))a("handleLine",e)}n.close(),a("afterHandle"),o.value?.classList.remove("drag")}function s(e){e.preventDefault(),o.value?.classList.add("drag")}function i(e){e.preventDefault(),o.value?.classList.remove("drag")}return F(()=>{n.value?.addEventListener("change",l),o.value?.addEventListener("dragover",s),o.value?.addEventListener("dragleave",i)}),U(()=>{n.value?.removeEventListener("change",l),o.value?.removeEventListener("dragover",s),o.value?.removeEventListener("dragleave",i)}),(e,t)=>(Z(),Y("div",ta,[X("div",{ref_key:"select",ref:o,class:"upload-select"},[t[0]||(t[0]=X("div",{class:"upload text"},[X("span",null,"+"),X("p",null,"上传或拖入ACT日志")],-1)),X("input",{ref_key:"input",ref:n,type:"file"},null,512)],512)]))}}),[["__scopeId","data-v-6722092f"]]),aa=[{name:"铁壁",id:1191,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"盾阵",id:1856,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"干预",id:1174,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"预警",id:74,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"武装",id:1176,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"神圣领域",id:82,type:"multiplier",performance:{physics:0,magic:0,darkness:0},isFriendly:!0},{name:"圣光幕帘",id:1362,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"圣盾阵",id:2674,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"骑士的坚守",id:2675,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"壁垒",id:77,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"极致防御",id:3829,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"极致护盾",id:3830,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"原初的直觉",id:735,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的勇猛",id:1857,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的武猛",id:1858,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"战栗",id:87,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"复仇",id:89,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"摆脱",id:1457,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"死斗",id:409,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"原初的血气",id:2678,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的血潮",id:2679,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的血烟",id:2680,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"戮罪",id:3832,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"至黑之夜",id:1178,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"弃明投暗",id:746,type:"multiplier",performance:{physics:.9,magic:.8,darkness:1},isFriendly:!0},{name:"暗影墙",id:747,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"暗黑布道",id:1894,type:"multiplier",performance:{physics:.95,magic:.9,darkness:1},isFriendly:!0},{name:"暗影卫",id:3835,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"行尸走肉",id:810,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"死而不僵",id:811,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"出死入生",id:3255,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"献奉",id:2682,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"石之心",id:1840,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"残暴弹",id:1898,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"伪装",id:1832,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"星云",id:1834,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"光之心",id:1839,type:"multiplier",performance:{physics:.95,magic:.85,darkness:1},isFriendly:!0},{name:"超火流星",id:1836,type:"multiplier",performance:{physics:0,magic:0,darkness:0},isFriendly:!0},{name:"刚玉之心",id:2683,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"刚玉之清",id:2684,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"神祝祷",id:1218,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"节制",id:1873,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"水流幕",id:2708,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"鼓舞",id:297,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"激励",id:1918,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"炽天的幕帘",id:1917,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"野战治疗阵",id:299,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"异想的幻光",id:317,type:"multiplier",performance:{physics:1,magic:.95,darkness:1},isFriendly:!0},{name:"炽天的幻光",id:1875,type:"multiplier",performance:{physics:1,magic:.95,darkness:1},isFriendly:!0},{name:"生命回生法",id:2710,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"怒涛之计",id:2711,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"命运之轮",id:849,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"天星交错",id:1889,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"擢升",id:2717,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"中间学派",id:1921,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"均衡诊断",id:2607,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"齐衡诊断",id:2608,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"均衡预后",id:2609,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"坚角清汁",id:2618,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"白牛清汁",id:2619,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"整体论",id:3003,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"整体盾",id:3365,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"输血",id:2612,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"泛输血",id:2613,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"心眼",id:1232,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"金刚极意",id:1179,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"行吟",id:1934,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"策动",id:1951,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"防守之桑巴",id:1826,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"即兴表演结束",id:2697,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"残影",id:488,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"魔罩",id:168,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"守护之光",id:2702,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"守护纹",id:2597,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"抗死",id:2707,type:"multiplier",performance:{physics:1,magic:.9,darkness:1},isFriendly:!0},{name:"雪仇",id:1193,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!1},{name:"牵制",id:1195,type:"multiplier",performance:{physics:.9,magic:.95,darkness:1},isFriendly:!1},{name:"昏乱",id:1203,type:"multiplier",performance:{physics:.95,magic:.9,darkness:1},isFriendly:!1},{name:"武装解除",id:860,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!1},{name:"减速",id:9,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!1},{name:"体力增加",id:2120,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"腐臭",id:1715,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!1},{name:"智力精神降低",id:2115,type:"multiplier",performance:{physics:1,magic:.9,darkness:1},isFriendly:!1},{name:"龙之力",id:2500,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"超硬化",id:1722,type:"multiplier",performance:{physics:.1,magic:.1,darkness:1},isFriendly:!0},{name:"玄结界",id:2496,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"仙人盾",id:2119,type:"multiplier",performance:{physics:.95,magic:.95,darkness:1},isFriendly:!0},{name:"强力守护",id:1719,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"哥布防御",id:2114,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"铜墙铁盾",id:194,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"坚守要塞",id:195,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"终极堡垒",id:196,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"原初大地",id:863,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"暗黑之力",id:864,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"灵魂之青",id:1931,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"坦培拉涂层",id:3686,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"油性坦培拉涂层",id:3687,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"世界树之干",id:3890,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"建筑神之塔",id:3892,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"太阳星座",id:3896,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"神爱抚",id:3903,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0}],na=[...aa],oa=new Map;let la="Chinese";function sa(e){if(la!==e||0===oa.size){oa.clear();for(const t of"Chinese"===e?aa:na){const e=Ie[t.id][1];t.fullIcon=Te(e),oa.set(t.id.toString(16).toUpperCase().padStart(2,"0"),t)}la=e}}function ia(e){return oa.get(e)}function ca(e,t){if("absorbed"===e.type)return"useful";if("dot"===t||"darkness"===t)return"unuseful";if(0===e.performance.darkness&&0===e.performance.magic&&0===e.performance.physics||1===e.performance.darkness&&1===e.performance.magic&&1===e.performance.physics)return"useful";const r="physics"===t?"magic":"physics";return 2*(100-100*e.performance[t])===100-100*e.performance[r]?"half-useful":1===e.performance[t]?"unuseful":"useful"}sa("Chinese");function da(e,t){return Object.entries(Ie).reduce((r,[a,[n,o]])=>(e.test(n)&&r.set(a,{name:n,icon:o,isFriendly:t}),r),new Map)}const ua=da(/(?:耐性|防御力)(?:大幅)?(?:降低|提升|低下|下降)|受伤(?:加重|减轻)|体力(?:增加|衰减|减少)|伤害屏障/,!0),ma=da(/(?:精神|力量|灵巧|智力){1,2}(?:大幅)?降低/,!1),pa=xe("hash"),ha=J("keigennRecord2.1",{state:()=>({userOptions:{scale:r(()=>fa(pa.scale,1)),opacity:r(()=>fa(pa.opacity,.9)),targetType:r(()=>fa(pa.targetType,"icon")),iconType:r(()=>fa(pa.iconType,3)),parseAA:r(()=>fa(pa.parseAA,!0)),parseDoT:r(()=>fa(pa.parseDoT,!1)),minimize:r(()=>fa(pa.minimize,!1)),actionCN:r(()=>fa(pa.actionCN,!0)),statusCN:r(()=>fa(pa.statusCN,!0))},isBrowser:!1}),getters:{icon4k:e=>e.userOptions.scale>=2||window.devicePixelRatio>=2?"_hr1":""},actions:{checkIsBrowser(){this.isBrowser=!window.OverlayPluginApi&&!pa.OVERLAY_WS&&!pa.HOST_PORT,this.isBrowser&&setTimeout(()=>this.checkIsBrowser(),1e3)},formatterName:e=>e,initEnvironment(e){/^[A-Z]\S+ [A-Z]\S+$/.test(e)?sa("Global"):sa("Chinese")}}});function fa(e,t){return"boolean"==typeof t?"0"!==e&&"false"!==e?.toLocaleLowerCase()&&("1"===e||"true"===e?.toLocaleLowerCase()||t):"number"==typeof t?Number.isNaN(+e)?t:+e:"string"==typeof t?e:t}function ya(e){return{dodge:"闪避","damage done":"击中","blocked damage":"格挡","parried damage":"招架","instant death":"即死",heal:"治疗","crit heal":"暴击治疗"}[e]}function ga(e){const t=function(e){switch(!0){case e.endsWith("33"):return"instant death";case/2\w{4}4$/.test(e):return"crit heal";case e.endsWith("1"):return"dodge";case e.endsWith("3"):return"damage done";case e.endsWith("4"):return"heal";case e.endsWith("5"):return"blocked damage";case e.endsWith("6"):return"parried damage";default:throw new Error(`Unknown effect flag ${e}`)}}(e),r=function(e){switch(!0){case/2\w{3}$/.test(e):return"crit damage";case/4\w{3}$/.test(e):return"direct hit damage";case/6\w{3}$/.test(e):return"crit direct hit damage";default:return"damage"}}(e),a=function(e){switch(!0){case/7?[1-4]\w{3}[35]$/.test(e):case/[16]$/.test(e):return"physics";case/^E$/.test(e):case/5\w{4}$/.test(e):return"magic";case/^(?:\d0)?3$/.test(e):case/6\w{4}$/.test(e):return"darkness";default:return"physics"}}(e);return{effect:t,properties:r,type:a}}const wa=["3E","113","213","313"],va=["A10","E"],ba=["04"],xa=["01","03","05","06","36"];function Sa(e){let t=0,r=e[8]??"",a=e[9]??"";wa.includes(r)&&(t+=2,r=e[8+t]??r,a=e[8+t+1]??a),va.includes(r)&&(t+=2,r=e[8+t]??r,a=e[8+t+1]??a);const n=function(e){if(void 0===e)return 0;const t=e.length;if(t<=4)return 0;let r=Number.parseInt(e.slice(0,t-4),16);if("4"===e[t-4]){const a=Number.parseInt(e.slice(t-2,t),16);r=r-a+(a<<16)}return r}(a),o=`00${r}`.slice(-2);return{amount:n,lowByte:o,flags:r,isHeal:ba.includes(o),isAttack:xa.includes(o)}}const Ra=[Number(409).toString(16).toUpperCase(),Number(810).toString(16).toUpperCase(),Number(811).toString(16).toUpperCase(),Number(1836).toString(16).toUpperCase()];const ka={class:"amount"},Ca={class:"row-info"},Ia=ge(i({__name:"Amount",props:{row:{}},setup(e){const t=e,{amount:a,maxHp:n,currentHp:o,shield:l,source:s,type:i}=t.row,c=Math.round(n*+l/100),d=Math.round(o/n*100),u=t.row.reduction,p=(a&&Math.round((a+c)/(1-u))||0).toLocaleString(),h=r(()=>a.toLocaleString()),f=i,y=(g=t.row).currentHp-g.amount<0&&!g.keigenns.find(e=>Ra.includes(e.effectId));var g;return(e,t)=>{const r=De,a=je;return Z(),Q(a,{"append-to":".wrapper",trigger:"hover",enterable:!1,"hide-after":0,width:180},{reference:ee(()=>[X("span",ka,[X("span",{class:ne(m(f))},[X("span",{class:ne({lethal:m(y)})},re(m(h)),3)],2)])]),default:ee(()=>[X("ul",Ca,[X("li",null,"伤害来源: "+re(m(s)),1),X("li",null,"玩家护盾: "+re(m(l))+"%",1),X("li",null,"玩家血量: "+re(m(d))+"%",1),m(u)<1&&"dot"!==m(i)?(Z(),Y(A,{key:0},[E(r),X("li",null,"减伤率: "+re((100*m(u)).toFixed(3))+"%",1),X("li",null,[t[0]||(t[0]=ae(" 倒推裸吃伤害: ",-1)),X("span",{class:ne(m(f))},re(m(p)),3)])],64)):te("",!0)])]),_:1})}}}),[["__scopeId","data-v-a148380a"]]),Ta={key:0},Ea={key:1,class:"status-container"},Ha=["title","data-duration","data-sourcePov"],Fa=["src","alt"],Da={class:"flags"},ja=ge(i({__name:"StatusShow",props:{row:{type:Object,required:!0}},setup(e){const t=e,r=ha(),a=r.userOptions,n=r.icon4k;return(e,r)=>"dot"===t.row.type?(Z(),Y("div",Ta," （不支持） ")):(Z(),Y("div",Ea,[(Z(!0),Y(A,null,oe(t.row.keigenns,(e,o)=>(Z(),Y("span",{key:o},[X("span",{class:"status",title:`${m(a).statusCN?e.name:e.effect}(${e.source})`,"data-duration":e.remainingDuration,"data-sourcePov":e.isPov},[X("img",{class:ne(`statusIcon ${m(ca)(e,t.row.type)}`),src:m(Le)(`/i/${e.fullIcon}${m(n)}.png`),alt:e.effect,loading:"lazy",onError:r[0]||(r[0]=(...e)=>m(Me)&&m(Me)(...e))},null,42,Fa)],8,Ha)]))),128)),X("span",Da,re("damage done"===t.row.effect?"":m(ya)(t.row.effect)),1)]))}}),[["__scopeId","data-v-9b1eaeae"]]),Ma={class:"target"},La=["src","alt"],Aa={key:1,class:"alt-text"},Na=ge(i({__name:"Target",props:{row:{type:Object,required:!0}},setup(e){const t=e,a=ha(),n=d(!1);function o(e){n.value=!0;e.target.style.display="none"}const l=r(()=>!n.value&&"icon"===(a.userOptions.targetType??"icon"));return(e,r)=>{return Z(),Y("div",Ma,[m(l)?(Z(),Y("img",{key:0,class:ne(`jobIcon cj${m(a).userOptions.iconType}`),src:(n=t.row.jobIcon,s=m(a).userOptions.iconType,`https://souma.diemoe.net/resources/img/cj${s}/${n.replace(/([A-Z])/g," $1").trim()}.png`),alt:t.row.jobIcon,onError:o},null,42,La)):(Z(),Y("span",Aa,re(t.row.job),1))]);var n,s}}}),[["__scopeId","data-v-0c7a0405"]]),Oa="[取消筛选]",$a=ge(i({__name:"Table",props:{rows:{},actionKey:{}},setup(e){const t=e,a=ha().userOptions,n=le("contextMenu"),o=d(""),l=d("");p(()=>t.rows,e=>{0===e.length&&(o.value="",l.value="")},{immediate:!0});const s=d(!1),i=d(0),c=d(0),u=d(null);Se(n,()=>{s.value=!1});const h=r(()=>[{label:"[取消筛选]",value:""},...Array.from(new Set(t.rows.map(e=>e[t.actionKey]))).map(e=>({label:e,value:e}))]),y=r(()=>[{label:"[取消筛选]",value:"",job:-1},...Array.from(new Map(t.rows.map(e=>[e.target,e])).values()).map(e=>({label:`${e.job}(${e.target})`,value:e.target,job:e.jobEnum}))].sort((e,t)=>Fe.enumSortMethod(e.job,t.job)));function g(){if(u.value){const e=u.value[t.actionKey];o.value===e?o.value="":o.value=e,s.value=!1}}function w(){if(u.value){const e=u.value.target;l.value===e?l.value="":l.value=e,s.value=!1}}const v=r(()=>t.rows.filter(e=>{const r=!o.value||o.value===Oa||e[t.actionKey]===o.value,a=!l.value||l.value===Oa||e.target===l.value;return r&&a}));function b(e){const t=[88,88,88],r=[50,250,200],a=Math.min(1,e/.5),n=Math.min(9,Math.floor(10*a))/9,o=Math.pow(n,.8),l=t[0]+(r[0]-t[0])*o,s=t[1]+(r[1]-t[1])*o,i=t[2]+(r[2]-t[2])*o;return`rgba(${Math.round(l)}, ${Math.round(s)}, ${Math.round(i)}, 1)`}const x=r(()=>[{key:"time",title:"时间",dataKey:"time",width:40,align:"center",class:"col-time"},{key:"action",title:"技能",dataKey:t.actionKey,width:64,align:"center",class:"col-action",headerCellRenderer:()=>f("div",{class:"header-filter"},[f(at,{size:"small",modelValue:o.value,placeholder:"技能",clearable:!1,style:"width:4.5em",teleported:!1,onChange:e=>o.value=e===Oa?"":e},()=>h.value.map(e=>f(nt,{key:e.value,label:e.label,value:e.value})))]),cellRenderer:({rowData:e})=>f("span",e[t.actionKey]??"")},{key:"target",title:"职业",dataKey:"target",width:32,align:"center",class:"col-target",headerCellRenderer:()=>f("div",{class:"header-filter"},[f(at,{size:"small",modelValue:l.value,placeholder:"职业",clearable:!1,style:"width:4.7em;text-overflow:clip;white-space:nowrap",class:"col-target-select",teleported:!1,onChange:e=>{l.value=e===Oa?"":e}},()=>y.value.map(e=>f(nt,{key:e.value,label:e.label,value:e.value})))]),cellRenderer:({rowData:e})=>f(Na,{row:e})},{key:"amount",title:"伤害",dataKey:"amount",width:45,align:"right",class:"col-amount",cellRenderer:({rowData:e})=>f(Ia,{row:e})},{key:"reduction",title:"减伤",dataKey:"reduction",width:35,align:"right",class:"col-amount",headerCellRenderer:()=>f("div",{class:"header-reduction"},"减伤"),cellRenderer:({rowData:e})=>f("span",{class:"col-reduction",style:{color:b(e.reduction)}},`${(100*e.reduction).toFixed(0)}`)},{key:"keigenns",title:"状态",dataKey:"keigenns",width:100,align:"left",flexGrow:1,class:"col-keigenns",cellRenderer:({rowData:e})=>f(ja,{row:e})}]);let S=null;const R=r(()=>({onClick:({rowData:e})=>{const{actionCN:t,amount:r,job:n,keigenns:o,time:l,type:s,effect:i,currentHp:c,maxHp:d,shield:u,reduction:m}=e,p="damage done"===i?"":`,${ya(i)}`,h=`${l} ${n} ${t} ${r.toLocaleString()}(${f=s,{physics:"物理",magic:"魔法",darkness:"暗黑",dot:"持续伤害"}[f]}) 减伤(${(100*m).toFixed(0)}%):${0===o.length&&""===p?"无":o.map(e=>a.statusCN?e.name:e.effect).join(",")+p} HP:${c}/${d}(${Math.round(c/d*100)}%)+盾:${Math.round(d*+u/100)}(${u}%)`;var f;He(h).then(()=>{S?.close(),S=ie.success({message:"复制成功",duration:800})}).catch(()=>ie.error("复制失败"))},onContextmenu:({rowData:e,event:t})=>{const r=t;u.value=e,i.value=r.clientX,c.value=r.clientY,s.value=!0}}));return(t,r)=>{const a=Qr,d=ea;return Z(),Q(d,{style:{height:"100%",width:"100%"}},{default:ee(({height:t,width:r})=>[E(a,{"header-class":"keigenn-table-header",class:"keigenn-table",columns:x.value,data:v.value,width:r,height:t,"row-height":28,"header-height":24,"row-key":"key","scrollbar-always-on":"","row-event-handlers":R.value},null,8,["columns","data","width","height","row-event-handlers"]),m(s)?(Z(),Y("div",{key:0,ref_key:"contextMenu",ref:n,class:"context-menu",style:se({top:`${m(c)}px`,left:`${m(i)}px`})},[X("ul",null,[X("li",{onClick:g},re(m(o)===(m(u)?.[e.actionKey]??"")?`取消筛选 [${m(u)?.[e.actionKey]??"此技能"}]`:`只看 [${m(u)?.[e.actionKey]??"此技能"}]`),1),X("li",{onClick:w},re(m(l)===m(u)?.target?`取消筛选 [${m(u)?.job??"此职业"}]`:`只看 [${m(u)?.job??"此职业"}]`),1)])],4)):te("",!0)]),_:1})}}}),[["__scopeId","data-v-b0bd732f"]]),Wa=(e,t)=>t.some(t=>e instanceof t);let Ka,za;const Pa=new WeakMap,Ba=new WeakMap,Ga=new WeakMap;let Va={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return Pa.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ya(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function _a(e){Va=e(Va)}function qa(e){return(za||(za=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Za(this),t),Ya(this.request)}:function(...t){return Ya(e.apply(Za(this),t))}}function Ua(e){return"function"==typeof e?qa(e):(e instanceof IDBTransaction&&function(e){if(Pa.has(e))return;const t=new Promise((t,r)=>{const a=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",o),e.removeEventListener("abort",o)},n=()=>{t(),a()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",n),e.addEventListener("error",o),e.addEventListener("abort",o)});Pa.set(e,t)}(e),Wa(e,Ka||(Ka=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Va):e)}function Ya(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,r)=>{const a=()=>{e.removeEventListener("success",n),e.removeEventListener("error",o)},n=()=>{t(Ya(e.result)),a()},o=()=>{r(e.error),a()};e.addEventListener("success",n),e.addEventListener("error",o)});return Ga.set(t,e),t}(e);if(Ba.has(e))return Ba.get(e);const t=Ua(e);return t!==e&&(Ba.set(e,t),Ga.set(t,e)),t}const Za=e=>Ga.get(e);const Xa=["get","getKey","getAll","getAllKeys","count"],Ja=["put","add","delete","clear"],Qa=new Map;function en(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Qa.get(t))return Qa.get(t);const r=t.replace(/FromIndex$/,""),a=t!==r,n=Ja.includes(r);if(!(r in(a?IDBIndex:IDBObjectStore).prototype)||!n&&!Xa.includes(r))return;const o=async function(e,...t){const o=this.transaction(e,n?"readwrite":"readonly");let l=o.store;return a&&(l=l.index(t.shift())),(await Promise.all([l[r](...t),n&&o.done]))[0]};return Qa.set(t,o),o}_a(e=>({...e,get:(t,r,a)=>en(t,r)||e.get(t,r,a),has:(t,r)=>!!en(t,r)||e.has(t,r)}));const tn=["continue","continuePrimaryKey","advance"],rn={},an=new WeakMap,nn=new WeakMap,on={get(e,t){if(!tn.includes(t))return e[t];let r=rn[t];return r||(r=rn[t]=function(...e){an.set(this,nn.get(this)[t](...e))}),r}};async function*ln(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const r=new Proxy(t,on);for(nn.set(r,t),Ga.set(r,Za(t));t;)yield r,t=await(an.get(r)||t.continue()),an.delete(r)}function sn(e,t){return t===Symbol.asyncIterator&&Wa(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&Wa(e,[IDBIndex,IDBObjectStore])}_a(e=>({...e,get:(t,r,a)=>sn(t,r)?ln:e.get(t,r,a),has:(t,r)=>sn(t,r)||e.has(t,r)}));let cn=null;async function dn(e){return cn||(cn=function(e,t,{blocked:r,upgrade:a,blocking:n,terminated:o}={}){const l=indexedDB.open(e,t),s=Ya(l);return a&&l.addEventListener("upgradeneeded",e=>{a(Ya(l.result),e.oldVersion,e.newVersion,Ya(l.transaction),e)}),r&&l.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),s.then(e=>{o&&e.addEventListener("close",()=>o()),n&&e.addEventListener("versionchange",e=>n(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}("souma",1,{upgrade(t){t.objectStoreNames.contains(e)||t.createObjectStore(e,{keyPath:"key"})}})),cn}const un="function"==typeof structuredClone?structuredClone:e=>{if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e.source,e.flags);if(Array.isArray(e))return e.map(e=>un(e));if(Object.getPrototypeOf(e)===Object.prototype){const t={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=un(e[r]));return t}return e},mn={class:"header-select"},pn={style:{height:"100%"}},hn={key:0,class:"testLog"},fn=ge(i({__name:"keigennRecord2",setup(e){const t=ot(),a=ha(),n=a.userOptions;a.checkIsBrowser();const o=d(n.minimize),l=r(()=>n.actionCN?"actionCN":"action"),s=d(!1),i=Re("keigenn-record-2-pov-name",""),c=Re("keigenn-record-2-pov-id",""),u=Re("keigenn-record-2-party-list",[]),p=Re("keigenn-record-2-job-map",{}),h=Re("keigenn-record-2-party-event-party",[]),f=d(0),g=d([{zoneName:"",duration:"00:00",table:ce([]),key:"init",timestamp:-1}]),w={rsv:/^262\|(?<timestamp>[^|]*)\|[^|]*\|[^|]*\|_rsv_(?<id>\d+)_[^|]+\|(?<real>[^|]*)\|/i,ability:it.ability(),statusEffectExplicit:it.statusEffectExplicit(),gainsEffect:it.gainsEffect(),losesEffect:it.losesEffect(),inCombat:/^260\|(?<timestamp>[^|]*)\|(?<inACTCombat>[^|]*)\|(?<inGameCombat>[^|]*)\|/,changeZone:it.changeZone(),partyList:/^11\|(?<timestamp>[^|]*)\|(?<partyCount>\d*)\|(?<list>(?:\w{8}\|)*)\w{16}/,primaryPlayer:/^02\|(?<timestamp>[^|]*)\|(?<id>[^|]*)\|(?<name>[^|]*)/,addCombatant:it.addedCombatant(),removingCombatant:it.removingCombatant(),networkDoT:it.networkDoT()},v=d(0),b=Re("souma-keigenn-record-2-zone-name",""),x=Re("souma-keigenn-record-2-rsv-data",{}),S={},R={friendly:{},enemy:{}},k=function(e){const t=async t=>t(await dn(e));return{getAll:()=>t(t=>t.getAll(e)),get:r=>t(t=>t.get(e,r)),set:r=>t(t=>t.put(e,r)),bulkSet:r=>t(async t=>{const a=t.transaction(e,"readwrite");for(const e of r)a.store.put(e);await a.done}),remove:r=>t(t=>t.delete(e,r)),clear:()=>t(t=>t.clear(e))}}("keigenn-record-2");function C(){s.value=!0,v.value=0,f.value=0,g.value.length=0,g.value.push({zoneName:"",duration:"00:00",table:ce([]),key:"init",timestamp:-1})}function I(){s.value=!1,M()}function T(e){for(const t in w){const r=w[t].exec(e);if(r){const o=e.split("|");switch(t){case"statusEffectExplicit":r.groups?.targetId.startsWith("1")&&(S[r.groups.targetId]=r.groups.currentShield);break;case"gainsEffect":{const e=o[st.GainsEffect.fields.effectId],t=o[st.GainsEffect.fields.effect],r=o[st.GainsEffect.fields.target],a=o[st.GainsEffect.fields.targetId],n=Number.parseInt(o[st.GainsEffect.fields.count],16);let l=ia(e);if(!l){const t=a.startsWith("1")&&ua.get(Number.parseInt(e,16).toString())||a.startsWith("4")&&ma.get(Number.parseInt(e,16).toString());if(!t)return;const r=Te(t.icon),o=n>1?Ee(r,n):r;l={type:"multiplier",performance:{physics:1,magic:1,darkness:1},id:Number.parseInt(e,16),fullIcon:o,name:t.name,isFriendly:t.isFriendly}}const s=o[st.GainsEffect.fields.duration],i=o[st.GainsEffect.fields.source],d=o[st.GainsEffect.fields.sourceId],u=new Date(o[st.GainsEffect.fields.timestamp]).getTime()+1e3*Number.parseFloat(s),m={name:l.name,type:l.type,count:n,effect:t,effectId:e,source:i,sourceId:d,target:r,targetId:a,expirationTimestamp:u,performance:l.performance,fullIcon:l.fullIcon,isPov:c.value===d};a.startsWith("1")&&l.isFriendly?(void 0===R.friendly[a]&&(R.friendly[a]={}),R.friendly[a][e]=m):a.startsWith("4")&&!l.isFriendly&&(void 0===R.enemy[r]&&(R.enemy[r]={}),R.enemy[r][e]=m)}break;case"losesEffect":{const e=o[st.LosesEffect.fields.target],t=o[st.LosesEffect.fields.targetId],r=o[st.LosesEffect.fields.effectId];t.startsWith("1")?R.friendly[t]&&Reflect.deleteProperty(R.friendly[t],r):R.enemy[e]&&Reflect.deleteProperty(R.enemy[e],r)}break;case"addCombatant":if("00"!==o[st.AddedCombatant.fields.job]){const e=o[st.AddedCombatant.fields.job],t=new Date(o[st.AddedCombatant.fields.timestamp]).getTime();p.value[o[st.AddedCombatant.fields.id]]={job:Number.parseInt(e,16),timestamp:t}}break;case"removingCombatant":Reflect.deleteProperty(p.value,o[st.RemovedCombatant.fields.id]);break;case"primaryPlayer":{c.value=o[st.ChangedPlayer.fields.id];const e=o[st.ChangedPlayer.fields.name];if(i.value===e)return;i.value=e,a.initEnvironment(o[st.ChangedPlayer.fields.name])}break;case"partyList":u.value=r.groups?.list?.split("|")??[];break;case"changeZone":b.value=o[st.ChangeZone.fields.name],j(new Date(o[st.ChangeZone.fields.timestamp]).getTime());break;case"inCombat":{const e="1"===o[st.InCombat.fields.inACTCombat],t="1"===o[st.InCombat.fields.inGameCombat],r=new Date(o[st.InCombat.fields.timestamp]).getTime();if(e||t){if(v.value>0)return;return"placeholder"===g.value[0].key&&g.value.splice(0,1),0!==g.value[0].table.length&&g.value.unshift({zoneName:"",duration:"00:00",table:ce([]),key:o[st.InCombat.fields.timestamp],timestamp:r}),v.value=r,g.value[0].zoneName=b.value,void(f.value=0)}if(!e&&!t)return void j(r)}break;case"rsv":{const e=Number(r.groups?.id),t=o[st.RSVData.fields.value];e&&t&&(x.value[Number(e)]=t)}break;case"networkDoT":if(!n.parseDoT)return;{const e=o[st.NetworkDoT.fields.which],t=o[st.NetworkDoT.fields.id];if("DoT"!==e||t.startsWith("4")||t!==c.value&&!u.value.includes(t)&&!h.value.find(e=>e.id===t))return;const r=o[st.NetworkDoT.fields.name],a=o[st.NetworkDoT.fields.damage],n=Number.parseInt(a,16),l=new Date(o[st.Ability.fields.timestamp]??"???").getTime(),s=Number(o[st.NetworkDoT.fields.currentHp]),i=Number(o[st.NetworkDoT.fields.maxHp]),d=L(0===v.value?0:l-v.value),m=H(t),p=Fe.jobToFullName(Fe.jobEnumToJob(m)).simple2,f=m,y=Fe.jobEnumToIcon(f);D({key:g.value[0].table.length.toString(),time:d,id:void 0,action:e,actionCN:e,source:"",target:r,targetId:t,job:p,jobIcon:y,jobEnum:f,amount:n,keigenns:[],currentHp:s,maxHp:i,effect:"damage done",type:"dot",shield:S[t]??"0",povId:c.value,reduction:0})}break;case"ability":if(0===v.value)return;{const e=Sa(o);if(e.isAttack&&e.amount>=0){const t=o[st.Ability.fields.sourceId]??"???",a=o[st.Ability.fields.targetId]??"???";if(!t.startsWith("4")||!a.startsWith("1"))return;if(a!==c.value&&!u.value.includes(a)&&!h.value.find(e=>e.id===a))return;const l=new Date(o[st.Ability.fields.timestamp]??"???").getTime(),s=o[st.Ability.fields.ability],i=s.match(/^_rsv_(?<id>\d+)_/),d=o[st.Ability.fields.id]??"???";let m=s;if(i){const e=Number(i.groups?.id);m=x.value[e]??s.match(/^_(?<id>rsv_\d+)_/)?.groups?.id}else if(m=m.replace(/unknown_.*/,"攻击"),!1===n.parseAA&&/^攻击|攻撃|[Aa]ttack$/.test(m))return;const p=lt(Number.parseInt(d,16)),f=p&&""!==p?p:m,y=Number(o[st.Ability.fields.targetCurrentHp]),w=Number(o[st.Ability.fields.targetMaxHp]),b=o[st.Ability.fields.source]??"???",k=o[st.Ability.fields.target]??"???",{effect:C,type:I}=ga(e.flags),T=L(0===v.value?0:l-v.value),E=H(a),F=Fe.jobToFullName(Fe.jobEnumToJob(E)).simple2,j=E,M=Fe.jobEnumToIcon(j),A=un(Object.values(R.friendly[a]??[]).concat(Object.values(R.enemy[b]??[])).filter(e=>{const t=Math.max(0,(e.expirationTimestamp-l)/1e3);return e.remainingDuration=t>=999?"":t.toFixed(t>.05&&t<.95?1:0),Number(e.remainingDuration)>-3})),N=S[r.groups.targetId]??"0",O=e.amount;let $=0;if("instant death"!==C&&"dodge"!==C){let e=1;"blocked damage"===C?e=.8:"parried damage"===C&&(e=.85);let t=1;for(const r of A)"absorbed"!==r.type&&(t*=r.performance[I]??1);$=1-t*e}D({key:g.value[0].table.length.toString(),time:T,id:d,action:m,actionCN:f,source:b,target:k,targetId:a,job:F,jobIcon:M,jobEnum:j,amount:O,keigenns:A,currentHp:y,maxHp:w,effect:C,type:I,shield:N,povId:c.value,reduction:$}),g.value[0].duration=L(new Date(o[st.Ability.fields.timestamp]).getTime()-v.value)}}}}}}function H(e){return[p.value[e],h.value.find(t=>t.id===e)??{job:0,timestamp:0}].sort((e,t)=>t.timestamp-e.timestamp)[0].job}function D(e){g.value[0].table.unshift(e)}function j(e){0!==v.value&&(g.value[0].duration=L(e-v.value),g.value[0]=fe(g.value[0]),v.value=0,R.friendly={},R.enemy={},M())}async function M(){if(s.value)return;const e=g.value.filter(e=>"placeholder"!==e.key&&e.timestamp>0).map(e=>{const t=Array.isArray(e.table)?ye(e.table):[];return{...ye(e),table:t}});await k.clear(),await k.bulkSet(e)}function L(e){const t=Math.max(Math.floor(e/6e4),0),r=Math.max(Math.floor((e-6e4*t)/1e3),0);return`${t<10?"0":""}${t}:${r<10?"0":""}${r}`}function N(){o.value=!o.value}function O(){g.value.unshift({zoneName:"",duration:"00:00",table:ce([]),key:"test",timestamp:Date.now()}),f.value=0}return a.isBrowser&&(i.value="测试用户"),""!==i.value&&a.initEnvironment(i.value),F(()=>{const e=ke({storageKey:"keigenn-record-2-theme"}),t=Ce(e);!1===e.value&&t();for(const r in p.value){const e=p.value[r];Date.now()-e.timestamp>864e5&&Reflect.deleteProperty(p.value,r)}!async function(){try{const e=await k.getAll();e.length&&(g.value.length=0,g.value.push(...e.reverse()))}catch(e){throw g.value.length=0,e}}(),ct("LogLine",e=>{T(e.rawLine)}),ct("PartyChanged",e=>{h.value=e.party.map(e=>({...e,timestamp:Date.now()}))}),ct("ChangePrimaryPlayer",e=>{i.value=e.charName,c.value=Number(e.charID).toString(16).toUpperCase()})}),(e,r)=>{const s=nt,i=at,c=dt,d=$a,u=ra;return Z(),Y(A,null,[X("div",{class:"wrapper",style:se({"--scale":m(n).scale,"--opacity":m(n).opacity}),onContextmenu:r[1]||(r[1]=y(()=>{},["prevent"]))},[X("header",null,[X("div",mn,[de(E(i,{modelValue:m(f),"onUpdate:modelValue":r[0]||(r[0]=e=>me(f)?f.value=e:null),size:"small",class:ne(["combat-select",m(a).isBrowser?"browser":"act"]),"popup-class-name":"combat-select-popup",offset:0,"show-arrow":!1},{default:ee(()=>[(Z(!0),Y(A,null,oe(m(g).length,e=>(Z(),Q(s,{key:`${m(g)[e-1].key}-${m(g)[e-1].duration}-${m(g)[e-1].zoneName}`,value:e-1,label:`${m(g)[e-1].duration} ${m(g)[e-1].zoneName}`},null,8,["value","label"]))),128))]),_:1},8,["modelValue","class"]),[[ue,!m(o)]])]),m(a).isBrowser?te("",!0):(Z(),Q(c,{key:0,class:ne(["minimize",m(o)?"in-minimize":"not-minimize"]),icon:m(o)?m(pe):m(he),circle:"",style:se({opacity:m(o)?.5:1}),onClick:N},null,8,["class","icon","style"]))]),de(X("main",pn,[E(d,{rows:m(g)[m(f)].table,"action-key":m(l)},null,8,["rows","action-key"])],512),[[ue,!m(o)]])],36),m(a).isBrowser||m(t)?(Z(),Y("div",hn,[m(t)?(Z(),Q(c,{key:0,onClick:O},{default:ee(()=>[...r[2]||(r[2]=[ae(" 测试 ",-1)])]),_:1})):te("",!0),E(u,{"m-1":"",onBeforeHandle:C,onAfterHandle:I,onHandleLine:T})])):te("",!0)],64)}}}),[["__scopeId","data-v-77a7fd11"]]);export{fn as default};
