import{d as oe,t as te,x as ne,y as le,A as u,v as z,o as U,c as se,w as r,D as b,F as E,u as e,a as l,g as s,f as a,b as ae,H as ie,G as me,I as C,R as V,K as ue,M as re,L as de,a4 as fe,i as pe,N as ce,h as ge,ak as Ce,ag as we,aA as Ve,l as _e,e as ve,af as he}from"./vendor-8ebccccd.js";import{g as Ae}from"./actionChinese-2f368d47.js";import{p as xe}from"./queryParams-77a1fad5.js";import{_ as ye}from"./_plugin-vue_export-helper-c27b6911.js";const Ie={style:{width:"10rem"}},De={class:"noCSS"},Se={class:"noCSS"},ze={class:"actionID"},Ue=oe({__name:"castingToChinese",setup(be){var v,h,A;te(i=>({"2648fc46":e(k),d0ad069e:e(O),d0ad069c:e(P),"6e887101":e(F),dc3140fa:e(N),bfabce6a:e(B),bfabce68:e(K),"477c80a5":e(L),"12b126fd":e(M),"12b126fe":e(H),"04c721df":e(Y)}));class T{constructor(t){this.name=Ae(parseInt(t[4],16))??t[4],this.startTime=Date.now(),this.castTime=Number(t[8])*1e3,this.overTime=this.startTime+this.castTime,this.actionId=parseInt(t[4],16)}}const d=ne({targetCast:void 0}),X=[{value:"Target",label:"当前目标"},{value:"Focus",label:"焦点目标"}],o=le("castingToChinese",{width:283,showCountdown:!0,showProgress:!0,showActionChinese:!0,showActionID:!1,offsetCountdownX:2,offsetCountdownY:2,offsetActionChineseX:0,offsetActionChineseY:-2,offsetActionIDX:0,offsetActionIDY:35,ping:80,keep:100,fontSizeCountDown:17,fontSizeActionName:20,fontFamily:"SmartisanHei",targetKey:"Target"},localStorage,{mergeDefaults:!0}),Y=u(()=>o.value.width+"px"),k=u(()=>o.value.showCountdown?1:0),F=u(()=>o.value.showProgress?1:0),N=u(()=>o.value.showActionChinese?1:0),L=u(()=>o.value.showActionID?1:0),O=u(()=>o.value.offsetCountdownX+"px"),P=u(()=>o.value.offsetCountdownY+"px"),B=u(()=>o.value.offsetActionChineseX+"px"),K=u(()=>o.value.offsetActionChineseY+"px"),M=u(()=>o.value.offsetActionIDX+"px"),H=u(()=>o.value.offsetActionIDY+"px"),p=new Map,c=z(0),w=o.value.ping,_=z(/^(?:1|true|on)$/i.test((v=xe)==null?void 0:v.showSettings)||((A=(h=document.getElementById("unlocked"))==null?void 0:h.style)==null?void 0:A.display)==="flex");addOverlayListener("EnmityTargetData",i=>{var t;d.targetCast=p.get((t=i[o.value.targetKey])==null?void 0:t.ID)}),addOverlayListener("LogLine",i=>{i.line[0]==="20"?p.set(parseInt(i.line[2],16),new T(i.line)):i.line[0]==="23"&&p.delete(parseInt(i.line[2],16))}),addOverlayListener("ChangeZone",()=>p.clear()),startOverlayEvents(),requestAnimationFrame(function i(){c.value=Date.now(),requestAnimationFrame(i)}),document.addEventListener("onOverlayStateUpdate",i=>{var t;_.value=((t=i==null?void 0:i.detail)==null?void 0:t.isLocked)===!1});function q(){localStorage.removeItem("castingToChinese"),location.reload()}return(i,t)=>{const m=ue,g=re,R=de,$=he,j=fe,G=pe,W=ce,Z=ge,x=Ce,y=we,J=Ve,Q=_e,ee=ve;return U(),se(ee,null,{default:r(()=>[b(l(Z,{class:"settings"},{default:r(()=>[s("form",null,[a("宽度: "),l(m,{modelValue:e(o).width,"onUpdate:modelValue":t[0]||(t[0]=n=>e(o).width=n),min:20,max:1e3,size:"small","controls-position":"right"},null,8,["modelValue"])]),s("form",null,[a("显示倒计时: "),l(g,{modelValue:e(o).showCountdown,"onUpdate:modelValue":t[1]||(t[1]=n=>e(o).showCountdown=n)},null,8,["modelValue"])]),s("form",null,[a("显示进度条: "),l(g,{modelValue:e(o).showProgress,"onUpdate:modelValue":t[2]||(t[2]=n=>e(o).showProgress=n)},null,8,["modelValue"])]),s("form",null,[a("显示中文: "),l(g,{modelValue:e(o).showActionChinese,"onUpdate:modelValue":t[3]||(t[3]=n=>e(o).showActionChinese=n)},null,8,["modelValue"])]),s("form",null,[a("显示ID: "),l(g,{modelValue:e(o).showActionID,"onUpdate:modelValue":t[4]||(t[4]=n=>e(o).showActionID=n)},null,8,["modelValue"])]),s("form",null,[a("延迟(ms): "),l(m,{modelValue:e(o).ping,"onUpdate:modelValue":t[5]||(t[5]=n=>e(o).ping=n),min:0,max:1e4,size:"small","controls-position":"right"},null,8,["modelValue"])]),s("form",null,[a("保留(ms): "),l(m,{modelValue:e(o).keep,"onUpdate:modelValue":t[6]||(t[6]=n=>e(o).keep=n),min:0,max:1e5,size:"small","controls-position":"right"},null,8,["modelValue"])]),s("form",null,[a("倒计时偏移X: "),l(m,{modelValue:e(o).offsetCountdownX,"onUpdate:modelValue":t[7]||(t[7]=n=>e(o).offsetCountdownX=n),min:-1e3,max:1e3,size:"small"},null,8,["modelValue"])]),s("form",null,[a("倒计时偏移Y: "),l(m,{modelValue:e(o).offsetCountdownY,"onUpdate:modelValue":t[8]||(t[8]=n=>e(o).offsetCountdownY=n),min:-1e3,max:1e3,size:"small","controls-position":"right"},null,8,["modelValue"])]),s("form",null,[a("中文偏移X: "),l(m,{modelValue:e(o).offsetActionChineseX,"onUpdate:modelValue":t[9]||(t[9]=n=>e(o).offsetActionChineseX=n),min:-1e3,max:1e3,size:"small"},null,8,["modelValue"])]),s("form",null,[a("中文偏移Y: "),l(m,{modelValue:e(o).offsetActionChineseY,"onUpdate:modelValue":t[10]||(t[10]=n=>e(o).offsetActionChineseY=n),min:-1e3,max:1e3,size:"small","controls-position":"right"},null,8,["modelValue"])]),s("form",null,[a("ID偏移X: "),l(m,{modelValue:e(o).offsetActionIDX,"onUpdate:modelValue":t[11]||(t[11]=n=>e(o).offsetActionIDX=n),min:-1e3,max:1e3,size:"small"},null,8,["modelValue"])]),s("form",null,[a("ID偏移Y: "),l(m,{modelValue:e(o).offsetActionIDY,"onUpdate:modelValue":t[12]||(t[12]=n=>e(o).offsetActionIDY=n),min:-1e3,max:1e3,size:"small","controls-position":"right"},null,8,["modelValue"])]),s("form",null,[a("倒计时字号(px): "),l(m,{modelValue:e(o).fontSizeCountDown,"onUpdate:modelValue":t[13]||(t[13]=n=>e(o).fontSizeCountDown=n),min:1,max:100,size:"small","controls-position":"right"},null,8,["modelValue"])]),s("form",null,[a("中文字号(px): "),l(m,{modelValue:e(o).fontSizeActionName,"onUpdate:modelValue":t[14]||(t[14]=n=>e(o).fontSizeActionName=n),min:1,max:100,size:"small","controls-position":"right"},null,8,["modelValue"])]),s("form",Ie,[a("字体: "),l(R,{modelValue:e(o).fontFamily,"onUpdate:modelValue":t[15]||(t[15]=n=>e(o).fontFamily=n),size:"small",clearable:"",onClear:t[16]||(t[16]=n=>e(o).fontFamily="SmartisanHei")},null,8,["modelValue"])]),s("form",De,[l(j,{modelValue:e(o).targetKey,"onUpdate:modelValue":t[17]||(t[17]=n=>e(o).targetKey=n),placeholder:"Select",size:"small",teleported:!1},{default:r(()=>[(U(),ae(me,null,ie(X,n=>l($,{key:n.value,label:n.label,value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),s("form",Se,[l(W,{onConfirm:q,teleported:!1,title:"确定要重置？"},{reference:r(()=>[l(G,null,{default:r(()=>[a("重置全部用户设置")]),_:1})]),_:1})])]),_:1},512),[[E,e(_)]]),b(l(Q,{style:V({fontFamily:e(o).fontFamily})},{default:r(()=>{var n,I;return[l(y,null,{default:r(()=>[l(x,{span:24,flex:"","justify-end":""},{default:r(()=>{var f;return[s("div",{style:V({fontSize:e(o).fontSizeCountDown+"px"}),class:"countdown"},C(Math.max(((((f=e(d).targetCast)==null?void 0:f.overTime)??1)-e(c)-e(w))/1e3,0).toFixed(2)),5)]}),_:1})]),_:1}),l(J,{percentage:Math.min((e(c)-(((n=e(d).targetCast)==null?void 0:n.startTime)??1)+e(w))/(((I=e(d).targetCast)==null?void 0:I.castTime)??1)*100,100),"stroke-width":8,indeterminate:!1,"show-text":!1,color:"#fbfff9",class:"progress"},null,8,["percentage"]),l(y,null,{default:r(()=>[l(x,{span:24,class:"action"},{default:r(()=>{var f,D,S;return[s("div",ze,C((f=e(d).targetCast)==null?void 0:f.actionId)+"("+C((D=e(d).targetCast)==null?void 0:D.actionId.toString(16).toUpperCase())+")",1),s("div",{style:V({fontSize:e(o).fontSizeActionName+"px"}),class:"actionChinese"},C((S=e(d).targetCast)==null?void 0:S.name),5)]}),_:1})]),_:1})]}),_:1},8,["style"]),[[E,e(d).targetCast&&e(c)-e(d).targetCast.overTime+e(w)<e(o).keep]])]),_:1})}}});const ke=ye(Ue,[["__scopeId","data-v-9ece0ded"]]);export{ke as default};
