import{d as $,J as z,p as d,q as i,s as D,b as O,X as U,o as m,e as f,x as _,F as k,M as H,u as s,t as P,v as E,a as M,A as L,R as V}from"./vendor-8aa0aaaa.js";import{_ as F}from"./DragJob-110ec90b.js";import{a as v}from"./overlay_plugin_api-409cb9ea.js";import{N as J}from"./netregexes-60f54b26.js";import{j as q}from"./util-831b56e7.js";import{_ as W}from"./_plugin-vue_export-helper-c27b6911.js";const X=$({__name:"showBarrier",setup(G){z(e=>({"92d710ac":s(A),"2e41421f":s(I)}));const N={statusEffectExplicit:J.statusEffectExplicit()},n=d([]),o=d(""),g=d(window.location.href),u=i(()=>new URLSearchParams(g.value.split("?")[1])),h=i(()=>u.value.get("showSettings")==="1"),A=i(()=>`${Number(u.value.get("lineHeight")||1)*40}px`),I=i(()=>`${Number(u.value.get("fontSize")||26)}px`),b=i(()=>u.value.get("type")||"1");function B(e){var a,x,w;const t=N.statusEffectExplicit.exec(e);if((a=t==null?void 0:t.groups)!=null&&a.targetId.startsWith("1")){const c=n.value.find(R=>{var S;return R.id===((S=t.groups)==null?void 0:S.targetId)});c&&(c.barrierPercent=Number((x=t.groups)==null?void 0:x.currentShield),c.barrierAmount=Math.round(Number((w=t.groups)==null?void 0:w.maxHp)*c.barrierPercent/100))}}const l=D("cactbotRuntime-sortArr",q);function C(e){l.value=e}function y(){n.value.sort((e,r)=>e.id===o.value?-1:r.id===o.value?1:e.job===r.job?r.id.localeCompare(e.id):l.value.indexOf(e.job)-l.value.indexOf(r.job))}function j(e){return b.value==="1"?`${e.barrierPercent}`:b.value==="2"?`${e.barrierAmount}`:`${e.barrierPercent}%(${e.barrierAmount})`}let p=0;return O(()=>{v("LogLine",e=>{B(e.rawLine)}),v("PartyChanged",e=>{n.value=e.party.filter(r=>r.inParty).map(r=>({...r,barrierPercent:0,barrierAmount:0}))}),v("ChangePrimaryPlayer",e=>{o.value=Number(e.charID).toString(16).toUpperCase()}),U([n,o,l],()=>{clearInterval(p),o.value?y():p=setInterval(()=>{o.value&&(y(),clearInterval(p))},100)},{immediate:!0}),window.addEventListener("hashchange",e=>g.value=e.newURL)}),(e,r)=>{const t=F;return m(),f("div",null,[_("ul",null,[(m(!0),f(k,null,H(s(n),a=>(m(),f("li",{key:a.id},[P(_("span",{"m-r-2":""},L(a.name),513),[[E,s(h)]]),_("span",{style:V(a.barrierPercent===0?{opacity:.25,color:"white"}:{opacity:1,color:"#f5da3c"})},L(j(a)),5)]))),128))]),P(M(t,{style:{"z-index":"10000"},party:s(n),"m-b-1":"","p-1":"",onUpdateSortArr:C},null,8,["party"]),[[E,s(h)]])])}}});const re=W(X,[["__scopeId","data-v-54eea9bd"]]);export{re as default};
