import{c as e,_ as l}from"./shared-common-CYjYp2IA.js";import{ab as a,F as s,b as i,q as t,h as n,ae as r}from"./shared-core-1WzSK5h7.js";import{a as o,r as c}from"./cactbot-CmNinDrW.js";import{n as k}from"./vendor-element-plus-DIlhOlLn.js";import{o as d,B as u,a5 as m,v as y,J as f,t as p,u as S,H as v,K as w,R as g,am as h,L as b,M as j,Z as C,X as _,I as T,Y as $,c as x}from"./vendor-vue-GqahCgpc.js";const I={class:"demo-text"},K={key:0,class:"key-skills-timer-container"},P={class:"skills-grid"},L=["onClick"],D={class:"buff-filter"},F=["src"],z={key:1,class:"test"},E=l(d({__name:"keySkillTimer",setup(l){const d=a(),{zoneType:E}=s(),N=x(()=>"Pvp"===E.value),R=n(),q=i(),A=e=>{d.party=e.party.filter(e=>e.inParty)},B=e=>{if(!N.value)if("21"===e.line[0]||"22"===e.line[0]&&"0"===e.line[45]){const l=Number.parseInt(e.line[4],16),a=r(l),s=e.line[2];d.triggerSkill([l,a],s,!0)}else"33"===e.line[0]&&["40000010","4000000F"].includes(e.line[3])&&d.wipe()};function H(e){d.speed=e,d.usedSkills.forEach(e=>{d.triggerSkill([e.id],e.owner.id,!1)})}function J(){window.open("/ff14-overlay-vue/#/keySkillTimerSettings","_blank","width=1550,height=1024")}return u(()=>{t(),o("PartyChanged",A),o("LogLine",B)}),m(()=>{c("PartyChanged",A),c("LogLine",B),Object.values(d.skillStates).forEach(e=>{e.rafId&&cancelAnimationFrame(e.rafId)})}),(l,a)=>{const s=k,i=e;return p(),y(i,null,{readme:f(()=>[w("span",I,[$(C(l.$t("keySkillTimer.demo-text1")),1),a[3]||(a[3]=w("br",null,null,-1)),$(" "+C(l.$t("keySkillTimer.demo-text2")),1)])]),default:f(()=>[S(N)?_("",!0):(p(),v("div",K,[w("div",P,[(p(!0),v(g,null,h(S(d).usedSkills,e=>(p(),v("div",{key:e.instanceKey,class:j(["buff-container",`line${e.line}`]),style:b({zIndex:S(q)||S(R)?99:void 0}),onClick:()=>S(q)||S(R)?function(e,l){(R||q)&&d.triggerSkill([e.id],e.owner.id,l)}(e,!0):null},[w("div",D,[w("span",{class:j(["duration",[S(d).skillStates[e.instanceKey]?.isRecast?"cooldown":"active"]])},C(S(d).skillStates[e.instanceKey]?.text||""),3),w("img",{src:e.src},null,8,F),S(d).skillStates[e.instanceKey]?.active?(p(),v("div",{key:S(d).skillStates[e.instanceKey]?.startTime||0,class:"cooldown-layer",style:b({clipPath:`inset(${S(d).skillStates[e.instanceKey]?.clipPercent??0}% 0 0 0)`})},null,4)):_("",!0)]),e.owner.hasDuplicate.skill||e.owner.hasDuplicate.job?(p(),v("span",{key:0,class:j(`job has-duplicate ${e.owner.hasDuplicate.job?"duplicate-show-name":"duplicate-show-job-name"} ${e.owner.jobIcon.toLowerCase()}`)},C(e.owner.hasDuplicate.job?e.owner.name:e.owner.jobName),3)):_("",!0)],14,L))),128))])])),S(R)||S(q)?(p(),v("div",z,[T(s,{onClick:S(d).demoFullParty},{default:f(()=>[$(C(l.$t("keySkillTimer.test-all-jobs")),1)]),_:1},8,["onClick"]),T(s,{onClick:a[0]||(a[0]=()=>S(d).shuffle())},{default:f(()=>[$(C(l.$t("keySkillTimer.test-8-party")),1)]),_:1}),S(R)?(p(),y(s,{key:0,onClick:a[1]||(a[1]=()=>H(1))},{default:f(()=>[$(C(l.$t("keySkillTimer.test-trigger-1x")),1)]),_:1})):_("",!0),S(R)?(p(),y(s,{key:1,onClick:a[2]||(a[2]=()=>H(5))},{default:f(()=>[$(C(l.$t("keySkillTimer.test-trigger-5x")),1)]),_:1})):_("",!0),T(s,{onClick:S(d).wipe},{default:f(()=>[$(C(l.$t("keySkillTimer.test-wipe")),1)]),_:1},8,["onClick"]),T(s,{type:"primary",onClick:J},{default:f(()=>[$(C(l.$t("keySkillTimer.settings")),1)]),_:1})])):_("",!0)]),_:1})}}}),[["__scopeId","data-v-f11cf5a5"]]);export{E as default};
