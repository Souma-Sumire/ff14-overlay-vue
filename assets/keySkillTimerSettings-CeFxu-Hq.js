import{a8 as e,a9 as l,u as a,U as t,aa as i,ab as s,ac as n,q as o,ad as r,v as d,y as c}from"./shared-core-BcyVo5ua.js";import{d as u,x as m,w as k,c as p,a as S,G as f,h as y,g,b,e as h,F as v,r as T,f as _,t as V,o as w,I as x,p as $,y as j,du as z}from"./vendor-vue-MSvGQJWD.js";import{_ as U,a as C,b as B}from"./shared-common-BkdhSTGj.js";import{E as D,a as F,n as J,b as N,aC as I,J as E,F as M,G as L,aD as O,aE as G,l as q,D as A,aB as P,j as X,k as H,h as K,aF as Q,an as R,X as W,aj as Y,au as Z,ac as ee,ax as le,N as ae,M as te,f as ie,g as se}from"./vendor-element-plus-CsMNiL2J.js";import"./cactbot-DtpbXwrG.js";const ne={class:"action-icon-wrapper"},oe=["src"],re={key:1,class:"action-icon-placeholder"},de=U(u({__name:"ActionIcon",props:{id:{}},setup(a){const t=a,i=m("");return k([()=>t.id,l],([l])=>{i.value=e(l)},{immediate:!0}),(e,l)=>(S(),p("div",ne,[i.value?(S(),p("img",{key:0,src:i.value,class:"action-icon",alt:""},null,8,oe)):(S(),p("div",re))]))}}),[["__scopeId","data-v-d9029fb5"]]),ce={class:"btn-text"},ue={class:"job-selector-content"},me=U(u({__name:"JobSelector",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:l}){const s=e,n=l,{t:o,locale:r}=a(),d=Object.freeze(t.getBattleJobs()),c=f(()=>{const e=i(r.value);return d.map(l=>{const a=t.jobToFullName(l);return{value:t.jobToJobEnum(l),label:a[e]??a.en}})}),u=f(()=>s.modelValue&&0!==s.modelValue.length?s.modelValue.length===d.length?o("keySkillTimerSettings.col.allJobs"):o("keySkillTimerSettings.col.jobsCount",{count:s.modelValue.length}):o("keySkillTimerSettings.col.allJobs")),m=e=>{n("update:modelValue",e)};return(l,a)=>{const t=N,i=J,s=F,n=D,o=E;return S(),y(o,{placement:"bottom",width:280,trigger:"click","popper-class":"job-selector-popper"},{reference:g(()=>[h(i,{size:"small",class:"job-popover-btn"},{default:g(()=>[h(t,null,{default:g(()=>[h(_(I))]),_:1}),b("span",ce,V(u.value),1)]),_:1})]),default:g(()=>[b("div",ue,[h(n,{"model-value":e.modelValue,"onUpdate:modelValue":m,multiple:"",filterable:"",placeholder:"Select Jobs",size:"default",class:"full-width","collapse-tags":"","collapse-tags-tooltip":""},{default:g(()=>[(S(!0),p(v,null,T(c.value,e=>(S(),y(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["model-value"])])]),_:1})}}}),[["__scopeId","data-v-8c5a0b7b"]]),ke={class:"settings-table-wrapper"},pe={class:"action-buttons"},Se={style:{display:"flex","align-items":"center",gap:"8px"}},fe={style:{color:"var(--el-text-color-secondary)","font-size":"12px"}},ye={class:"tts-header"},ge=U(u({__name:"SettingsTable",emits:["delete","move"],setup(e,{emit:l}){const a=l,t=s(),i=f(()=>t.keySkillsData.chinese),o=(e,l)=>{if(e){l(n(e,50).map(e=>({value:e.id.toString(),label:e.name,id:e.id})))}else l([])};return(e,l)=>{const s=N,n=J,r=q,d=L,c=P,u=H,m=X,k=K,f=M;return S(),p("div",ke,[h(f,{data:i.value,border:"",size:"small","row-key":e=>e.key,height:"100%",class:"custom-table","header-row-class-name":"table-header"},{default:g(()=>[h(d,{label:e.$t("keySkillTimerSettings.col.action"),width:"90",fixed:"left",align:"center"},{default:g(({row:l,$index:t})=>[b("div",pe,[h(n,{link:"",size:"small",disabled:0===t,onClick:e=>a("move",t,t-1)},{default:g(()=>[h(s,null,{default:g(()=>[h(_(O))]),_:1})]),_:1},8,["disabled","onClick"]),h(n,{link:"",size:"small",disabled:t===i.value.length-1,onClick:e=>a("move",t,t+1)},{default:g(()=>[h(s,null,{default:g(()=>[h(_(G))]),_:1})]),_:1},8,["disabled","onClick"]),h(r,{title:e.$t("keySkillTimerSettings.deleteConfirmTitle"),onConfirm:e=>a("delete",l.key)},{reference:g(()=>[h(n,{link:"",size:"small",type:"danger"},{default:g(()=>[h(s,null,{default:g(()=>[h(_(A))]),_:1})]),_:1})]),_:1},8,["title","onConfirm"])])]),_:1},8,["label"]),h(d,{label:e.$t("keySkillTimerSettings.col.preview"),width:"50",align:"center"},{default:g(({row:e})=>[(S(),y(de,{id:e.id,key:e.id},null,8,["id"]))]),_:1},8,["label"]),h(d,{label:e.$t("keySkillTimerSettings.col.id"),"min-width":"200"},{default:g(({row:e})=>[h(c,{modelValue:e.id,"onUpdate:modelValue":l=>e.id=l,"fetch-suggestions":o,placeholder:"...",size:"small",style:{width:"100%"},clearable:"","trigger-on-focus":!1},{default:g(({item:e})=>[b("div",Se,[(S(),y(de,{id:e.id,size:20,key:e.id},null,8,["id"])),b("span",null,V(e.label),1),b("span",fe,"("+V(e.value)+")",1)])]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),h(d,{width:"130"},{header:g(()=>[b("div",ye,[l[1]||(l[1]=b("span",null,"TTS",-1)),h(u,{modelValue:_(t).enableTts.chinese,"onUpdate:modelValue":l[0]||(l[0]=e=>_(t).enableTts.chinese=e),size:"small"},null,8,["modelValue"])])]),default:g(({row:e})=>[h(m,{modelValue:e.tts,"onUpdate:modelValue":l=>e.tts=l,size:"small",disabled:!_(t).enableTts.chinese},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),h(d,{label:e.$t("keySkillTimerSettings.col.duration"),"min-width":"180",align:"left"},{default:g(({row:e})=>[h(m,{modelValue:e.duration,"onUpdate:modelValue":l=>e.duration=l,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),h(d,{label:e.$t("keySkillTimerSettings.col.recast"),"min-width":"220",align:"left"},{default:g(({row:e})=>[h(m,{modelValue:e.recast1000ms,"onUpdate:modelValue":l=>e.recast1000ms=l,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),h(d,{label:e.$t("keySkillTimerSettings.col.job"),width:"100",align:"center"},{default:g(({row:e})=>[h(me,{modelValue:e.job,"onUpdate:modelValue":l=>e.job=l},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),h(d,{label:e.$t("keySkillTimerSettings.col.minLevel"),width:"110",align:"center"},{default:g(({row:e})=>[h(k,{modelValue:e.minLevel,"onUpdate:modelValue":l=>e.minLevel=l,min:1,max:100,size:"small",controls:!1,class:"level-input"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),h(d,{label:e.$t("keySkillTimerSettings.col.line"),width:"110",align:"center"},{default:g(({row:e})=>[h(k,{modelValue:e.line,"onUpdate:modelValue":l=>e.line=l,min:1,max:10,size:"small",controls:!1,class:"line-input"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"])]),_:1},8,["data","row-key"])])}}}),[["__scopeId","data-v-ffa5cfe5"]]),be={class:"page-container"},he={class:"header-toolbar"},ve={class:"left-tools"},Te={class:"preset-list",style:{height:"400px","overflow-y":"auto"}},_e={class:"preset-info"},Ve={class:"name"},we={class:"search-drawer-content",style:{height:"450px",padding:"12px"}},xe={class:"center-tools"},$e={class:"right-tools"},je={class:"page-content"},ze=U(u({__name:"keySkillTimerSettings",setup(e){const{t:l}=a(),t=s(),i=m(!1);function u(){ie.confirm(l("keySkillTimerSettings.resetConfirmMsg"),l("keySkillTimerSettings.confirmTitle"),{confirmButtonText:l("keySkillTimerSettings.confirmBtn"),cancelButtonText:l("keySkillTimerSettings.cancelBtn"),type:"warning"}).then(()=>{t.keySkillsData.chinese=[...r],se.success(l("keySkillTimerSettings.resetSuccessMsg"))}).catch(()=>{})}function f(e,a){t.keySkillsData.chinese.unshift({key:crypto.randomUUID(),id:e,tts:a||"",duration:0,recast1000ms:0,job:[],line:1,minLevel:1}),se.success(`${l("keySkillTimerSettings.addSkill")}: ${a||e}`)}function y(){const e=JSON.stringify(t.keySkillsData),a=z.compressToBase64(e);c(a).then(()=>se.success(l("keySkillTimerSettings.copySuccess"))).catch(()=>se.error(l("keySkillTimerSettings.copyFailed")))}function U(){ie.prompt(l("keySkillTimerSettings.importPromptMsg"),l("keySkillTimerSettings.importTitle"),{confirmButtonText:l("keySkillTimerSettings.confirmBtn"),cancelButtonText:l("keySkillTimerSettings.cancelBtn"),inputType:"textarea",inputValidator:e=>{try{const a=z.decompressFromBase64(e),t=JSON.parse(a);return"object"==typeof t&&null!==t||l("keySkillTimerSettings.dataFormatError")}catch(a){const e=a instanceof Error?a.message:String(a);return`${l("keySkillTimerSettings.dataFormatError")}: ${e}`}}}).then(({value:e})=>{if(e){const a=z.decompressFromBase64(e),i=JSON.parse(a);"object"==typeof i&&null!==i?(t.keySkillsData.chinese=i.chinese,se.success(l("keySkillTimerSettings.importSuccess"))):se.error(l("keySkillTimerSettings.importFormatError"))}}).catch(()=>{})}w(async()=>{try{await o()}catch(e){}finally{i.value=!0}});const D=m(""),F=x([]);let I;return k(D,e=>{I&&clearTimeout(I),I=window.setTimeout(()=>{F.value=n(e)},300)}),(e,l)=>{const a=J,s=N,n=Z,o=X,c=L,m=M,k=Y,w=E,x=W,z=C,I=B,O=ge,G=Q;return $((S(),p("div",be,[b("div",he,[b("div",ve,[h(w,{placement:"bottom-start",width:550,trigger:"click","popper-class":"skill-library-popover"},{reference:g(()=>[h(a,{type:"primary",icon:_(le),loading:!i.value},{default:g(()=>[j(V(e.$t("keySkillTimerSettings.searchSkill")),1)]),_:1},8,["icon","loading"])]),default:g(()=>[h(k,{type:"border-card",class:"search-tabs"},{default:g(()=>[h(n,{label:e.$t("keySkillTimerSettings.presets")},{default:g(()=>[b("div",Te,[(S(!0),p(v,null,T(_(r),l=>(S(),p("div",{key:l.key,class:"preset-item"},[b("div",_e,[h(de,{id:l.id,size:24},null,8,["id"]),b("span",Ve,V(_(d)(Number(l.id))||l.tts||e.$t("keySkillTimerSettings.unknownSkill")),1)]),h(a,{link:"",type:"primary",onClick:e=>f(Number(l.id),_(d)(Number(l.id))||l.tts)},{default:g(()=>[h(s,null,{default:g(()=>[h(_(ee))]),_:1})]),_:1},8,["onClick"])]))),128))])]),_:1},8,["label"]),h(n,{label:e.$t("keySkillTimerSettings.searchTab")},{default:g(()=>[b("div",we,[h(o,{modelValue:D.value,"onUpdate:modelValue":l[0]||(l[0]=e=>D.value=e),clearable:"",placeholder:e.$t("keySkillTimerSettings.skillName"),"prefix-icon":_(le),style:{"margin-bottom":"12px"},size:"default"},null,8,["modelValue","placeholder","prefix-icon"]),h(m,{data:F.value,style:{width:"100%"},height:"390px",size:"default"},{default:g(()=>[h(c,{width:"40",align:"center"},{default:g(({row:e})=>[h(de,{id:e.id,size:20},null,8,["id"])]),_:1}),h(c,{prop:"id",label:e.$t("keySkillTimerSettings.col.shortId"),width:"80"},null,8,["label"]),h(c,{prop:"name",label:e.$t("keySkillTimerSettings.skillName")},null,8,["label"]),h(c,{width:"50",align:"center"},{default:g(({row:e})=>[h(a,{link:"",type:"primary",onClick:l=>f(e.id,e.name)},{default:g(()=>[h(s,null,{default:g(()=>[h(_(ee))]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1},8,["label"])]),_:1})]),_:1})]),b("div",xe,[h(x,null,{default:g(()=>[h(a,{icon:_(ae),onClick:y},{default:g(()=>[j(V(e.$t("keySkillTimerSettings.export")),1)]),_:1},8,["icon"]),h(a,{icon:_(te),onClick:U},{default:g(()=>[j(V(e.$t("keySkillTimerSettings.import")),1)]),_:1},8,["icon"])]),_:1}),h(a,{type:"danger",icon:_(R),onClick:u},{default:g(()=>[j(V(e.$t("keySkillTimerSettings.restoreDefault")),1)]),_:1},8,["icon"])]),b("div",$e,[h(z,{"storage-key":"key-skill-timer-2"}),h(I,{teleported:!1})])]),b("main",je,[h(O,{onDelete:l[1]||(l[1]=e=>function(e){const l=t.keySkillsData.chinese,a=l.findIndex(l=>l.key===e);-1!==a&&l.splice(a,1)}(e)),onMove:l[2]||(l[2]=(e,l)=>function(e,l){const a=t.keySkillsData.chinese;if(l<0||l>=a.length||e===l)return;const i=a[e];i&&(a.splice(e,1),a.splice(l,0,i))}(e,l))})])])),[[G,!i.value,void 0,{fullscreen:!0,lock:!0}]])}}}),[["__scopeId","data-v-1b193fd7"]]);export{ze as default};
