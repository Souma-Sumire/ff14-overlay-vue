import{_ as e}from"./ActWrapper-bQD4m6T_.js";import{d as s,g as a,h as i,aX as l,j as t,w as n,o,c as r,B as c,u as p,a as m,F as u,l as d,p as f,q as k,t as y,b as j,e as _}from"./index-DWFkQZ8S.js";/* empty css                  */import{u as g}from"./useDemo-C4l28ANx.js";import{u as h}from"./useDev-3Lr8vsh6.js";import{u as v}from"./useZone-g_dzuUWb.js";import{u as w,c as b}from"./keySkills-CXraVZ07.js";import{a as C,r as S}from"./overlay_plugin_api-DHbPkDtN.js";import{E as P}from"./index-C22cpTD6.js";import{_ as x}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./el-card-CGHYHoo8.js";import"./index-Bm7i_3gN.js";import"./zoneInfo-zWYximu4.js";import"./zone_info-C7ipylWh.js";import"./content_type-lMHx3DqW.js";import"./demoParty-VUGfUoT5.js";import"./util-BOtaAWHW.js";import"./actionChinese-Ci6nVS5q.js";import"./chineseToIcon-xFdmTerz.js";import"./status-BoSfddpn.js";import"./tts-BkZGqxam.js";import"./index-DSq7NuXz.js";import"./use-form-common-props-BeDizkWW.js";const I={key:0,class:"key-skills-timer-container"},K={class:"skills-grid"},D=["onClick"],z={class:"buff-filter"},F=["src"],L={key:1,class:"test"},T=x(s({__name:"keySkillTimer",setup(s){const x=w(),{zoneType:T}=v(),E=a(()=>"Pvp"===T.value),X=h(),$=g(),N=e=>{x.party=e.party.filter(e=>e.inParty)},A=e=>{if(!E.value)if("21"===e.line[0]||"22"===e.line[0]&&"0"===e.line[45]){const s=Number.parseInt(e.line[4],16),a=b(s),i=e.line[2];x.triggerSkill(a,i,!0)}else"33"===e.line[0]&&["40000010","4000000F"].includes(e.line[3])&&x.wipe()},B=e=>{x.language=e.charName.includes(" ")?"global":"chinese"};function Z(e){x.speed=e,x.usedSkills.forEach(e=>{x.triggerSkill(e.id,e.owner.id,!1)})}function q(){window.open("/ff14-overlay-vue/#/keySkillTimerSettings","_blank")}return i(()=>{C("PartyChanged",N),C("LogLine",A),C("ChangePrimaryPlayer",B)}),l(()=>{S("PartyChanged",N),S("LogLine",A),S("ChangePrimaryPlayer",B),Object.values(x.skillStates).forEach(e=>{e.rafId&&cancelAnimationFrame(e.rafId)})}),(s,a)=>{const i=P,l=e;return o(),t(l,null,{readme:n(()=>a[3]||(a[3]=[m("span",{class:"demo-text"},[_(" 当前为演示数据，锁定后将显示真实数据。"),m("br"),_(" 请尽量拉宽窗口，点击技能可模拟触发。 ")],-1)])),default:n(()=>[p(E)?c("",!0):(o(),r("div",I,[m("div",K,[(o(!0),r(u,null,d(p(x).usedSkills,e=>(o(),r("div",{key:e.instanceKey,class:k(["buff-container",`line${e.line}`]),style:f({zIndex:p($)||p(X)?99:void 0}),onClick:()=>p($)||p(X)?function(e,s){(X||$)&&x.triggerSkill(e.id,e.owner.id,s)}(e,!0):null},[m("div",z,[m("span",{class:k(["duration",[p(x).skillStates[e.instanceKey]?.isRecast?"cooldown":"active"]])},y(p(x).skillStates[e.instanceKey]?.text||""),3),m("img",{src:e.src},null,8,F),p(x).skillStates[e.instanceKey]?.active?(o(),r("div",{key:p(x).skillStates[e.instanceKey]?.startTime||0,class:"cooldown-layer",style:f({clipPath:`inset(${p(x).skillStates[e.instanceKey]?.clipPercent??0}% 0 0 0)`})},null,4)):c("",!0)]),e.owner.hasDuplicate.skill||e.owner.hasDuplicate.job?(o(),r("span",{key:0,class:k(`job has-duplicate ${e.owner.hasDuplicate.job?"duplicate-show-name":"duplicate-show-job-name"} ${e.owner.jobIcon.toLowerCase()}`)},y(e.owner.hasDuplicate.job?e.owner.name:e.owner.jobName),3)):c("",!0)],14,D))),128))])])),p(X)||p($)?(o(),r("div",L,[j(i,{onClick:p(x).demoFullParty},{default:n(()=>a[4]||(a[4]=[_(" 模拟全部职业 ",-1)])),_:1,__:[4]},8,["onClick"]),j(i,{onClick:a[0]||(a[0]=()=>p(x).shuffle())},{default:n(()=>a[5]||(a[5]=[_(" 模拟8人小队 ",-1)])),_:1,__:[5]}),p(X)?(o(),t(i,{key:0,onClick:a[1]||(a[1]=()=>Z(1))},{default:n(()=>a[6]||(a[6]=[_(" 测试触发(1X) ",-1)])),_:1,__:[6]})):c("",!0),p(X)?(o(),t(i,{key:1,onClick:a[2]||(a[2]=()=>Z(5))},{default:n(()=>a[7]||(a[7]=[_(" 测试触发(5X) ",-1)])),_:1,__:[7]})):c("",!0),j(i,{onClick:p(x).wipe},{default:n(()=>a[8]||(a[8]=[_(" 模拟团灭 ",-1)])),_:1,__:[8]},8,["onClick"]),j(i,{type:"primary",onClick:q},{default:n(()=>a[9]||(a[9]=[_(" 设置 ",-1)])),_:1,__:[9]})])):c("",!0)]),_:1})}}}),[["__scopeId","data-v-d191f6d7"]]);export{T as default};
