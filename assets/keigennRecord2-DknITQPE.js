import{E as e}from"./index-Be_XGqkv.js";import{O as t,g as a,bv as r,K as l,bw as n,a8 as o,ac as s,d as i,M as c,r as d,f as u,u as m,y as p,i as h,x as f,am as y,aT as g,aj as v,L as w,av as b,a4 as x,aS as S,a5 as R,aM as k,z as C,S as T,Z as I,b as E,ak as H,h as F,ab as j,m as N,a7 as M,F as D,bi as O,Y as A,bx as L,P as z,ax as $,N as W,ao as K,T as P,bl as G,by as _,bz as V,b4 as B,W as q,aX as U,c as Y,o as Z,a as X,s as J,j as Q,w as ee,B as te,t as ae,e as re,q as le,l as ne,aW as oe,p as se,E as ie,bA as ce,k as de,v as ue,a0 as me,aq as pe,ap as he,ad as fe}from"./index-Du6R0ICZ.js";import{_ as ye}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{E as ge}from"./el-empty-TuacJYrG.js";import{B as ve,c as we}from"./el-scrollbar-ltHxvqh5.js";import{d as be,o as xe,u as Se,e as Re,a as ke}from"./index-CgfOPWb6.js";import{s as Ce,c as Te,a as Ie}from"./status-BoSfddpn.js";import{c as Ee}from"./clipboard-BKuKuDeo.js";import{U as He}from"./util-BOtaAWHW.js";import"./el-popper-CDSlBejH.js";/* empty css                   */import{E as Fe}from"./el-divider-DKWXhBOj.js";import{E as je}from"./index-VSn-3OVB.js";import{h as Ne,g as Me}from"./xivapi-CVfNURcy.js";import{d as De}from"./debounce-CF2qz_4Q.js";import{c as Oe,r as Ae}from"./raf-DMddzAl3.js";import{a as Le}from"./scroll-B2DM0nYU.js";import{E as ze,b as $e}from"./el-select-poBYh4cu.js";/* empty css                  *//* empty css               */import{u as We}from"./useDev-PGFMKJtA.js";import{g as Ke}from"./actionChinese-CjZRUybd.js";import{l as Pe}from"./regexes-BKeG-dSP.js";import{N as Ge}from"./netregexes-RPvCCaeG.js";import{a as _e}from"./overlay_plugin_api-DHbPkDtN.js";import{E as Ve}from"./index-ChL8X5sa.js";import"./use-form-common-props-QgtwL8Z9.js";import"./isEqual-D2Abr81x.js";import"./index-DGiCJTw6.js";import"./index-DyYCBO_O.js";import"./index-B4QhJAVy.js";import"./focus-trap-BNYb3zoO.js";import"./index-5E8m3BtR.js";import"./index-C-cnux7D.js";import"./vnode-BOa3N3YA.js";import"./lz-string-Bhlr6y1U.js";import"./_commonjsHelpers-CLPN-Npl.js";import"./index-BVvu14Ks.js";var Be=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function qe(e,t){return e===t||!(!Be(e)||!Be(t))}function Ue(e,t){if(e.length!==t.length)return!1;for(var a=0;a<e.length;a++)if(!qe(e[a],t[a]))return!1;return!0}const Ye=()=>{const e=t().proxy.$props;return a(()=>{const t=(e,t,a)=>({});return e.perfMode?r(t):function(e,t){void 0===t&&(t=Ue);var a=null;function r(){for(var r=[],l=0;l<arguments.length;l++)r[l]=arguments[l];if(a&&a.lastThis===this&&t(r,a.lastArgs))return a.lastResult;var n=e.apply(this,r);return a={lastResult:n,lastArgs:r,lastThis:this},n}return r.clear=function(){a=null},r}(t)})},Ze="itemRendered",Xe="scroll",Je="forward",Qe="backward",et="auto",tt="smart",at="start",rt="center",lt="end",nt="horizontal",ot="vertical",st="negative",it="positive-ascending",ct="positive-descending",dt={[nt]:"left",[ot]:"top"},ut=n({type:o([Number,Function]),required:!0}),mt=n({type:Number}),pt=n({type:Number,default:2}),ht=n({type:String,values:["ltr","rtl"],default:"ltr"}),ft=n({type:Number,default:0}),yt=n({type:Number,required:!0}),gt=n({type:String,values:["horizontal","vertical"],default:ot}),vt=l({className:{type:String,default:""},containerElement:{type:o([String,Object]),default:"div"},data:{type:o(Array),default:()=>s([])},direction:ht,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},style:{type:o([Object,String,Array])},useIsScrolling:Boolean,width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:Boolean}),wt=l({cache:pt,estimatedItemSize:mt,layout:gt,initScrollOffset:ft,total:yt,itemSize:ut,...vt}),bt={type:Number,default:6},xt={type:Number,default:0},St={type:Number,default:2},Rt=l({columnCache:pt,columnWidth:ut,estimatedColumnWidth:mt,estimatedRowHeight:mt,initScrollLeft:ft,initScrollTop:ft,itemKey:{type:o(Function),default:({columnIndex:e,rowIndex:t})=>`${t}:${e}`},rowCache:pt,rowHeight:ut,totalColumn:yt,totalRow:yt,hScrollbarSize:bt,vScrollbarSize:bt,scrollbarStartGap:xt,scrollbarEndGap:St,role:String,...vt}),kt=l({alwaysOn:Boolean,class:String,layout:gt,total:yt,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:bt,startGap:xt,endGap:St,visible:Boolean}),Ct=(e,t)=>e<t?Je:Qe,Tt=e=>"rtl"===e;let It=null;function Et(e=!1){if(null===It||e){const e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",t.direction="rtl";const a=document.createElement("div"),r=a.style;return r.width="100px",r.height="100px",e.appendChild(a),document.body.appendChild(e),e.scrollLeft>0?It=ct:(e.scrollLeft=1,It=0===e.scrollLeft?st:it),document.body.removeChild(e),It}return It}const Ht=i({name:"ElVirtualScrollBar",props:kt,emits:["scroll","start-move","stop-move"],setup(e,{emit:t}){const r=a(()=>e.startGap+e.endGap),l=c("virtual-scrollbar"),n=c("scrollbar"),o=d(),s=d();let i=null,g=null;const v=u({isDragging:!1,traveled:0}),w=a(()=>ve[e.layout]),b=a(()=>e.clientSize-m(r)),x=a(()=>({position:"absolute",width:`${nt===e.layout?b.value:e.scrollbarSize}px`,height:`${nt===e.layout?e.scrollbarSize:b.value}px`,[dt[e.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"})),S=a(()=>{const t=e.ratio;if(t>=100)return Number.POSITIVE_INFINITY;if(t>=50)return t*b.value/100;const a=b.value/3;return Math.floor(Math.min(Math.max(t*b.value,20),a))}),R=a(()=>{if(!Number.isFinite(S.value))return{display:"none"};const t=`${S.value}px`,a=function({move:e,size:t,bar:a},r){const l={},n=`translate${a.axis}(${e}px)`;return l[a.size]=t,l.transform=n,"horizontal"===r?l.height="100%":l.width="100%",l}({bar:w.value,size:t,move:v.traveled},e.layout);return a}),k=a(()=>Math.ceil(e.clientSize-S.value-m(r))),C=()=>{window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",I),document.onselectstart=g,g=null;const e=m(s);e&&(e.removeEventListener("touchmove",E),e.removeEventListener("touchend",I))},T=e=>{e.stopImmediatePropagation(),e.ctrlKey||[1,2].includes(e.button)||(v.isDragging=!0,v[w.value.axis]=e.currentTarget[w.value.offset]-(e[w.value.client]-e.currentTarget.getBoundingClientRect()[w.value.direction]),t("start-move"),(()=>{window.addEventListener("mousemove",E),window.addEventListener("mouseup",I);const e=m(s);e&&(g=document.onselectstart,document.onselectstart=()=>!1,e.addEventListener("touchmove",E,{passive:!0}),e.addEventListener("touchend",I))})())},I=()=>{v.isDragging=!1,v[w.value.axis]=0,t("stop-move"),C()},E=e=>{const{isDragging:a}=v;if(!a)return;if(!s.value||!o.value)return;const r=v[w.value.axis];if(!r)return;Oe(i);const l=-1*(o.value.getBoundingClientRect()[w.value.direction]-e[w.value.client])-(s.value[w.value.offset]-r);i=Ae(()=>{v.traveled=Math.max(0,Math.min(l,k.value)),t("scroll",l,k.value)})},H=e=>{const a=Math.abs(e.target.getBoundingClientRect()[w.value.direction]-e[w.value.client])-s.value[w.value.offset]/2;v.traveled=Math.max(0,Math.min(a,k.value)),t("scroll",a,k.value)};return p(()=>e.scrollFrom,e=>{v.isDragging||(v.traveled=Math.ceil(e*k.value))}),h(()=>{C()}),()=>f("div",{role:"presentation",ref:o,class:[l.b(),e.class,(e.alwaysOn||v.isDragging)&&"always-on"],style:x.value,onMousedown:y(H,["stop","prevent"]),onTouchstartPrevent:T},f("div",{ref:s,class:n.e("thumb"),style:R.value,onMousedown:T},[]))}});var Ft=(e=>(e.ASC="asc",e.DESC="desc",e))(Ft||{}),jt=(e=>(e.CENTER="center",e.RIGHT="right",e))(jt||{}),Nt=(e=>(e.LEFT="left",e.RIGHT="right",e))(Nt||{});const Mt={asc:"desc",desc:"asc"},Dt=Symbol("placeholder");const Ot=(e,{mainTableRef:r,leftTableRef:l,rightTableRef:n,tableInstance:o,ns:s,isScrolling:i})=>{const c=t(),{emit:u}=c,p=v(!1),h=d(e.defaultExpandedRowKeys||[]),f=d(-1),y=v(null),g=d({}),x=d({}),S=v({}),R=v({}),k=v({}),C=a(()=>w(e.estimatedRowHeight));function T({hovered:e,rowKey:t}){if(i.value)return;o.vnode.el.querySelectorAll(`[rowkey="${String(t)}"]`).forEach(t=>{e?t.classList.add(s.is("hovered")):t.classList.remove(s.is("hovered"))})}const I=De(()=>{var e,t,a,o;p.value=!0,g.value={...m(g),...m(x)},E(m(y),!1),x.value={},y.value=null,null==(e=r.value)||e.forceUpdate(),null==(t=l.value)||t.forceUpdate(),null==(a=n.value)||a.forceUpdate(),null==(o=c.proxy)||o.$forceUpdate(),p.value=!1},0);function E(e,t=!1){m(C)&&[r,l,n].forEach(a=>{const r=m(a);r&&r.resetAfterRowIndex(e,t)})}return{expandedRowKeys:h,lastRenderedRowIndex:f,isDynamic:C,isResetting:p,rowHeights:g,resetAfterIndex:E,onRowExpanded:function({expanded:t,rowData:a,rowIndex:r,rowKey:l}){var n,i;const c=[...m(h)],d=c.indexOf(l);t?-1===d&&c.push(l):d>-1&&c.splice(d,1),h.value=c,u("update:expandedRowKeys",c),null==(n=e.onRowExpand)||n.call(e,{expanded:t,rowData:a,rowIndex:r,rowKey:l}),null==(i=e.onExpandedRowsChange)||i.call(e,c),o.vnode.el.querySelector(`.${s.is("hovered")}[rowkey="${String(l)}"]`)&&b(()=>T({hovered:!0,rowKey:l}))},onRowHovered:T,onRowsRendered:function(t){var a;null==(a=e.onRowsRendered)||a.call(e,t),t.rowCacheEnd>m(f)&&(f.value=t.rowCacheEnd)},onRowHeightChange:function({rowKey:e,height:t,rowIndex:a},r){r?r===Nt.RIGHT?k.value[e]=t:S.value[e]=t:R.value[e]=t;const l=Math.max(...[S,k,R].map(t=>t.value[e]||0));m(g)[e]!==l&&(!function(e,t,a){const r=m(y);(null===r||r>a)&&(y.value=a),x.value[e]=t}(e,l,a),I())}}},At=(e,t)=>e+t,Lt=e=>x(e)?e.reduce(At,0):e,zt=(e,t,a={})=>k(e)?e(t):null!=e?e:a,$t=e=>(["width","maxWidth","minWidth","height"].forEach(t=>{e[t]=S(e[t])}),e),Wt=e=>R(e)?t=>f(e,t):e;function Kt(e){const r=d(),l=d(),n=d(),{columns:o,columnsStyles:s,columnsTotalWidth:i,fixedColumnsOnLeft:u,fixedColumnsOnRight:h,hasFixedColumns:f,mainColumns:y,onColumnSorted:b}=function(e,t,r){const l=a(()=>m(t).map((e,t)=>{var a,r;return{...e,key:null!=(r=null!=(a=e.key)?a:e.dataKey)?r:t}})),n=a(()=>m(l).filter(e=>!e.hidden)),o=a(()=>m(n).filter(e=>"left"===e.fixed||!0===e.fixed)),s=a(()=>m(n).filter(e=>"right"===e.fixed)),i=a(()=>m(n).filter(e=>!e.fixed)),c=a(()=>{const e=[];return m(o).forEach(t=>{e.push({...t,placeholderSign:Dt})}),m(i).forEach(t=>{e.push(t)}),m(s).forEach(t=>{e.push({...t,placeholderSign:Dt})}),e}),d=a(()=>m(o).length||m(s).length),u=a(()=>m(l).reduce((t,a)=>(t[a.key]=((e,t,a)=>{var r;const l={flexGrow:0,flexShrink:0,...a?{}:{flexGrow:e.flexGrow||0,flexShrink:e.flexShrink||1}};a||(l.flexShrink=1);const n={...null!=(r=e.style)?r:{},...l,flexBasis:"auto",width:e.width};return t||(e.maxWidth&&(n.maxWidth=e.maxWidth),e.minWidth&&(n.minWidth=e.minWidth)),n})(a,m(r),e.fixed),t),{})),p=a(()=>m(n).reduce((e,t)=>e+t.width,0)),h=e=>m(l).find(t=>t.key===e);return{columns:l,columnsStyles:u,columnsTotalWidth:p,fixedColumnsOnLeft:o,fixedColumnsOnRight:s,hasFixedColumns:d,mainColumns:c,normalColumns:i,visibleColumns:n,getColumn:h,getColumnStyle:e=>m(u)[e],updateColumnWidth:(e,t)=>{e.width=t},onColumnSorted:function(t){var a;const{key:r}=t.currentTarget.dataset;if(!r)return;const{sortState:l,sortBy:n}=e;let o=Ft.ASC;o=g(l)?Mt[l[r]]:Mt[n.order],null==(a=e.onColumnSort)||a.call(e,{column:h(r),key:r,order:o})}}}(e,C(e,"columns"),C(e,"fixed")),{scrollTo:R,scrollToLeft:k,scrollToTop:T,scrollToRow:I,onScroll:E,onVerticalScroll:H,scrollPos:F}=((e,{mainTableRef:t,leftTableRef:a,rightTableRef:r,onMaybeEndReached:l})=>{const n=d({scrollLeft:0,scrollTop:0});function o(e){var l,n,o;const{scrollTop:s}=e;null==(l=t.value)||l.scrollTo(e),null==(n=a.value)||n.scrollToTop(s),null==(o=r.value)||o.scrollToTop(s)}function s(e){n.value=e,o(e)}function i(e){n.value.scrollTop=e,o(m(n))}return p(()=>m(n).scrollTop,(e,t)=>{e>t&&l()}),{scrollPos:n,scrollTo:s,scrollToLeft:function(e){var a,r;n.value.scrollLeft=e,null==(r=null==(a=t.value)?void 0:a.scrollTo)||r.call(a,m(n))},scrollToTop:i,scrollToRow:function(e,a="auto"){var r;null==(r=t.value)||r.scrollToRow(e,a)},onScroll:function(t){var a;s(t),null==(a=e.onScroll)||a.call(e,t)},onVerticalScroll:function({scrollTop:e}){const{scrollTop:t}=m(n);e!==t&&i(e)}}})(e,{mainTableRef:r,leftTableRef:l,rightTableRef:n,onMaybeEndReached:function(){const{onEndReached:t}=e;if(!t)return;const{scrollTop:a}=m(F),r=m(B),l=m(J),n=r-(a+l)+e.hScrollbarSize;!ne.value&&m(O)>=0&&r<=a+m(Y)-m(ae)?(ne.value=!0,t(n)):ne.value=!1}}),j=c("table-v2"),N=t(),M=v(!1),{expandedRowKeys:D,lastRenderedRowIndex:O,isDynamic:A,isResetting:L,rowHeights:z,resetAfterIndex:$,onRowExpanded:W,onRowHeightChange:K,onRowHovered:P,onRowsRendered:G}=Ot(e,{mainTableRef:r,leftTableRef:l,rightTableRef:n,tableInstance:N,ns:j,isScrolling:M}),{data:_,depthMap:V}=((e,{expandedRowKeys:t,lastRenderedRowIndex:r,resetAfterIndex:l})=>{const n=d({}),o=a(()=>{const a={},{data:r,rowKey:l}=e,o=m(t);if(!o||!o.length)return r;const s=[],i=new Set;o.forEach(e=>i.add(e));let c=r.slice();for(c.forEach(e=>a[e[l]]=0);c.length>0;){const e=c.shift();s.push(e),i.has(e[l])&&x(e.children)&&e.children.length>0&&(c=[...e.children,...c],e.children.forEach(t=>a[t[l]]=a[e[l]]+1))}return n.value=a,s}),s=a(()=>{const{data:t,expandColumnKey:a}=e;return a?m(o):t});return p(s,(e,t)=>{e!==t&&(r.value=-1,l(0,!0))}),{data:s,depthMap:n}})(e,{expandedRowKeys:D,lastRenderedRowIndex:O,resetAfterIndex:$}),B=a(()=>{const{estimatedRowHeight:t,rowHeight:a}=e,r=m(_);return w(t)?Object.values(m(z)).reduce((e,t)=>e+t,0):r.length*a}),{bodyWidth:q,fixedTableHeight:U,mainTableHeight:Y,leftTableWidth:Z,rightTableWidth:X,windowHeight:J,footerHeight:Q,emptyStyle:ee,rootStyle:te,headerHeight:ae}=((e,{columnsTotalWidth:t,rowsHeight:r,fixedColumnsOnLeft:l,fixedColumnsOnRight:n})=>{const o=a(()=>{const{fixed:a,width:r,vScrollbarSize:l}=e,n=r-l;return a?Math.max(Math.round(m(t)),n):n}),s=a(()=>{const{height:t=0,maxHeight:a=0,footerHeight:l,hScrollbarSize:n}=e;if(a>0){const e=m(h),t=m(r),o=m(p)+e+t+n;return Math.min(o,a-l)}return t-l}),i=a(()=>{const{maxHeight:t}=e,a=m(s);if(w(t)&&t>0)return a;const l=m(r)+m(p)+m(h);return Math.min(a,l)}),c=e=>e.width,d=a(()=>Lt(m(l).map(c))),u=a(()=>Lt(m(n).map(c))),p=a(()=>Lt(e.headerHeight)),h=a(()=>{var t;return((null==(t=e.fixedData)?void 0:t.length)||0)*e.rowHeight}),f=a(()=>m(s)-m(p)-m(h)),y=a(()=>{const{style:t={},height:a,width:r}=e;return $t({...t,height:a,width:r})}),g=a(()=>$t({height:e.footerHeight})),v=a(()=>({top:S(m(p)),bottom:S(e.footerHeight),width:S(e.width)}));return{bodyWidth:o,fixedTableHeight:i,mainTableHeight:s,leftTableWidth:d,rightTableWidth:u,windowHeight:f,footerHeight:g,emptyStyle:v,rootStyle:y,headerHeight:p}})(e,{columnsTotalWidth:i,fixedColumnsOnLeft:u,fixedColumnsOnRight:h,rowsHeight:B}),re=d(),le=a(()=>{const t=0===m(_).length;return x(e.fixedData)?0===e.fixedData.length&&t:t});const ne=d(!1);return p(()=>m(B),()=>ne.value=!1),p(()=>e.expandedRowKeys,e=>D.value=e,{deep:!0}),{columns:o,containerRef:re,mainTableRef:r,leftTableRef:l,rightTableRef:n,isDynamic:A,isResetting:L,isScrolling:M,hasFixedColumns:f,columnsStyles:s,columnsTotalWidth:i,data:_,expandedRowKeys:D,depthMap:V,fixedColumnsOnLeft:u,fixedColumnsOnRight:h,mainColumns:y,bodyWidth:q,emptyStyle:ee,rootStyle:te,footerHeight:Q,mainTableHeight:Y,fixedTableHeight:U,leftTableWidth:Z,rightTableWidth:X,showEmpty:le,getRowHeight:function(t){const{estimatedRowHeight:a,rowHeight:r,rowKey:l}=e;return a?m(z)[m(_)[t][l]]||a:r},onColumnSorted:b,onRowHovered:P,onRowExpanded:W,onRowsRendered:G,onRowHeightChange:K,scrollTo:R,scrollToLeft:k,scrollToTop:T,scrollToRow:I,onScroll:E,onVerticalScroll:H}}const Pt=Symbol("tableV2"),Gt="tableV2GridScrollLeft",_t=String,Vt={type:o(Array),required:!0},Bt={type:o(Array)},qt={...Bt,required:!0},Ut=String,Yt={type:o(Array),default:()=>s([])},Zt={type:Number,required:!0},Xt={type:o([String,Number,Symbol]),default:"id"},Jt={type:o(Object)},Qt=l({class:String,columns:Vt,columnsStyles:{type:o(Object),required:!0},depth:Number,expandColumnKey:Ut,estimatedRowHeight:{...Rt.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:o(Function)},onRowHover:{type:o(Function)},onRowHeightChange:{type:o(Function)},rowData:{type:o(Object),required:!0},rowEventHandlers:{type:o(Object)},rowIndex:{type:Number,required:!0},rowKey:Xt,style:{type:o(Object)}}),ea={type:Number,required:!0},ta=l({class:String,columns:Vt,fixedHeaderData:{type:o(Array)},headerData:{type:o(Array),required:!0},headerHeight:{type:o([Number,Array]),default:50},rowWidth:ea,rowHeight:{type:Number,default:50},height:ea,width:ea}),aa=l({columns:Vt,data:qt,fixedData:Bt,estimatedRowHeight:Qt.estimatedRowHeight,width:Zt,height:Zt,headerWidth:Zt,headerHeight:ta.headerHeight,bodyWidth:Zt,rowHeight:Zt,cache:wt.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:Rt.scrollbarAlwaysOn,scrollbarStartGap:Rt.scrollbarStartGap,scrollbarEndGap:Rt.scrollbarEndGap,class:_t,style:Jt,containerStyle:Jt,getRowHeight:{type:o(Function),required:!0},rowKey:Qt.rowKey,onRowsRendered:{type:o(Function)},onScroll:{type:o(Function)}}),ra=l({cache:aa.cache,estimatedRowHeight:Qt.estimatedRowHeight,rowKey:Xt,headerClass:{type:o([String,Function])},headerProps:{type:o([Object,Function])},headerCellProps:{type:o([Object,Function])},headerHeight:ta.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:o([String,Function])},rowProps:{type:o([Object,Function])},rowHeight:{type:Number,default:50},cellProps:{type:o([Object,Function])},columns:Vt,data:qt,dataGetter:{type:o(Function)},fixedData:Bt,expandColumnKey:Qt.expandColumnKey,expandedRowKeys:Yt,defaultExpandedRowKeys:Yt,class:_t,fixed:Boolean,style:{type:o(Object)},width:Zt,height:Zt,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:Rt.hScrollbarSize,vScrollbarSize:Rt.vScrollbarSize,scrollbarAlwaysOn:kt.alwaysOn,sortBy:{type:o(Object),default:()=>({})},sortState:{type:o(Object),default:void 0},onColumnSort:{type:o(Function)},onExpandedRowsChange:{type:o(Function)},onEndReached:{type:o(Function)},onRowExpand:Qt.onRowExpand,onScroll:aa.onScroll,onRowsRendered:aa.onRowsRendered,rowEventHandlers:Qt.rowEventHandlers});var la=i({name:"ElTableV2Header",props:ta,setup(e,{slots:t,expose:r}){const l=c("table-v2"),n=T(Gt),o=d(),s=a(()=>$t({width:e.width,height:e.height})),i=a(()=>$t({width:e.rowWidth,height:e.height})),u=a(()=>we(m(e.headerHeight))),p=e=>{const t=m(o);b(()=>{(null==t?void 0:t.scroll)&&t.scroll({left:e})})},h=()=>{const a=l.e("fixed-header-row"),{columns:r,fixedHeaderData:n,rowHeight:o}=e;return null==n?void 0:n.map((e,l)=>{var n;const s=$t({height:o,width:"100%"});return null==(n=t.fixed)?void 0:n.call(t,{class:a,columns:r,rowData:e,rowIndex:-(l+1),style:s})})},f=()=>{const a=l.e("dynamic-header-row"),{columns:r}=e;return m(u).map((e,l)=>{var n;const o=$t({width:"100%",height:e});return null==(n=t.dynamic)?void 0:n.call(t,{class:a,columns:r,headerIndex:l,style:o})})};return I(()=>{(null==n?void 0:n.value)&&p(n.value)}),r({scrollToLeft:p}),()=>{if(!(e.height<=0))return E("div",{ref:o,class:e.class,style:m(s),role:"rowgroup"},[E("div",{style:m(i),class:l.e("header")},[f(),h()])])}}});const na=({name:e,clearCache:r,getColumnPosition:l,getColumnStartIndexForOffset:n,getColumnStopIndexForStartIndex:o,getEstimatedTotalHeight:s,getEstimatedTotalWidth:u,getColumnOffset:p,getRowOffset:h,getRowPosition:y,getRowStartIndexForOffset:g,getRowStopIndexForStartIndex:v,initCache:x,injectToInstance:S,validateProps:R})=>i({name:null!=e?e:"ElVirtualList",props:Rt,emits:[Ze,Xe],setup(e,{emit:i,expose:k,slots:C}){const T=c("vl");R(e);const I=t(),E=d(x(e,I));null==S||S(I,E);const A=d(),L=d(),z=d(),$=d(null),W=d({isScrolling:!1,scrollLeft:w(e.initScrollLeft)?e.initScrollLeft:0,scrollTop:w(e.initScrollTop)?e.initScrollTop:0,updateRequested:!1,xAxisScrollDir:Je,yAxisScrollDir:Je}),K=Ye(),P=a(()=>Number.parseInt(`${e.height}`,10)),G=a(()=>Number.parseInt(`${e.width}`,10)),_=a(()=>{const{totalColumn:t,totalRow:a,columnCache:r}=e,{isScrolling:l,xAxisScrollDir:s,scrollLeft:i}=m(W);if(0===t||0===a)return[0,0,0,0];const c=n(e,i,m(E)),d=o(e,c,i,m(E)),u=l&&s!==Qe?1:Math.max(1,r),p=l&&s!==Je?1:Math.max(1,r);return[Math.max(0,c-u),Math.max(0,Math.min(t-1,d+p)),c,d]}),V=a(()=>{const{totalColumn:t,totalRow:a,rowCache:r}=e,{isScrolling:l,yAxisScrollDir:n,scrollTop:o}=m(W);if(0===t||0===a)return[0,0,0,0];const s=g(e,o,m(E)),i=v(e,s,o,m(E)),c=l&&n!==Qe?1:Math.max(1,r),d=l&&n!==Je?1:Math.max(1,r);return[Math.max(0,s-c),Math.max(0,Math.min(a-1,i+d)),s,i]}),B=a(()=>s(e,m(E))),q=a(()=>u(e,m(E))),U=a(()=>{var t;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:e.direction,height:w(e.height)?`${e.height}px`:e.height,width:w(e.width)?`${e.width}px`:e.width},null!=(t=e.style)?t:{}]}),Y=a(()=>{const e=`${m(q)}px`;return{height:`${m(B)}px`,pointerEvents:m(W).isScrolling?"none":void 0,width:e}}),Z=()=>{const{totalColumn:t,totalRow:a}=e;if(t>0&&a>0){const[e,t,a,r]=m(_),[l,n,o,s]=m(V);i(Ze,{columnCacheStart:e,columnCacheEnd:t,rowCacheStart:l,rowCacheEnd:n,columnVisibleStart:a,columnVisibleEnd:r,rowVisibleStart:o,rowVisibleEnd:s})}const{scrollLeft:r,scrollTop:l,updateRequested:n,xAxisScrollDir:o,yAxisScrollDir:s}=m(W);i(Xe,{xAxisScrollDir:o,scrollLeft:r,yAxisScrollDir:s,scrollTop:l,updateRequested:n})},X=t=>{const{clientHeight:a,clientWidth:r,scrollHeight:l,scrollLeft:n,scrollTop:o,scrollWidth:s}=t.currentTarget,i=m(W);if(i.scrollTop===o&&i.scrollLeft===n)return;let c=n;if(Tt(e.direction))switch(Et()){case st:c=-n;break;case ct:c=s-r-n}W.value={...i,isScrolling:!0,scrollLeft:c,scrollTop:Math.max(0,Math.min(o,l-a)),updateRequested:!0,xAxisScrollDir:Ct(i.scrollLeft,c),yAxisScrollDir:Ct(i.scrollTop,o)},b(()=>re()),le(),Z()},J=(e,t)=>{const a=m(P),r=(B.value-a)/t*e;te({scrollTop:Math.min(B.value-a,r)})},Q=(e,t)=>{const a=m(G),r=(q.value-a)/t*e;te({scrollLeft:Math.min(q.value-a,r)})},{onWheel:ee}=(({atXEndEdge:e,atXStartEdge:t,atYEndEdge:a,atYStartEdge:r},l)=>{let n=null,o=0,s=0;const i=(l,n)=>{const o=l<=0&&t.value||l>=0&&e.value,s=n<=0&&r.value||n>=0&&a.value;return o&&s};return{hasReachedEdge:i,onWheel:e=>{Oe(n);let t=e.deltaX,a=e.deltaY;Math.abs(t)>Math.abs(a)?a=0:t=0,e.shiftKey&&0!==a&&(t=a,a=0),i(o,s)&&i(o+t,s+a)||(o+=t,s+=a,e.preventDefault(),n=Ae(()=>{l(o,s),o=0,s=0}))}}})({atXStartEdge:a(()=>W.value.scrollLeft<=0),atXEndEdge:a(()=>W.value.scrollLeft>=q.value-m(G)),atYStartEdge:a(()=>W.value.scrollTop<=0),atYEndEdge:a(()=>W.value.scrollTop>=B.value-m(P))},(e,t)=>{var a,r,l,n;null==(r=null==(a=L.value)?void 0:a.onMouseUp)||r.call(a),null==(n=null==(l=z.value)?void 0:l.onMouseUp)||n.call(l);const o=m(G),s=m(P);te({scrollLeft:Math.min(W.value.scrollLeft+e,q.value-o),scrollTop:Math.min(W.value.scrollTop+t,B.value-s)})});H(A,"wheel",ee,{passive:!1});const te=({scrollLeft:e=W.value.scrollLeft,scrollTop:t=W.value.scrollTop})=>{e=Math.max(e,0),t=Math.max(t,0);const a=m(W);t===a.scrollTop&&e===a.scrollLeft||(W.value={...a,xAxisScrollDir:Ct(a.scrollLeft,e),yAxisScrollDir:Ct(a.scrollTop,t),scrollLeft:e,scrollTop:t,updateRequested:!0},b(()=>re()),le(),Z())},ae=(t,a)=>{const{columnWidth:n,direction:o,rowHeight:s}=e,i=K.value(r&&n,r&&s,r&&o),c=`${t},${a}`;if(O(i,c))return i[c];{const[,r]=l(e,a,m(E)),n=m(E),s=Tt(o),[d,u]=y(e,t,n),[p]=l(e,a,n);return i[c]={position:"absolute",left:s?void 0:`${r}px`,right:s?`${r}px`:void 0,top:`${u}px`,height:`${d}px`,width:`${p}px`},i[c]}},re=()=>{W.value.isScrolling=!1,b(()=>{K.value(-1,null,null)})};F(()=>{if(!j)return;const{initScrollLeft:t,initScrollTop:a}=e,r=m(A);r&&(w(t)&&(r.scrollLeft=t),w(a)&&(r.scrollTop=a)),Z()});const le=()=>{const{direction:t}=e,{scrollLeft:a,scrollTop:r,updateRequested:l}=m(W),n=m(A);if(l&&n){if("rtl"===t)switch(Et()){case st:n.scrollLeft=-a;break;case it:n.scrollLeft=a;break;default:{const{clientWidth:e,scrollWidth:t}=n;n.scrollLeft=t-e-a;break}}else n.scrollLeft=Math.max(0,a);n.scrollTop=Math.max(0,r)}},{resetAfterColumnIndex:ne,resetAfterRowIndex:oe,resetAfter:se}=I.proxy;k({windowRef:A,innerRef:$,getItemStyleCache:K,scrollTo:te,scrollToItem:(t=0,a=0,r=et)=>{const l=m(W);a=Math.max(0,Math.min(a,e.totalColumn-1)),t=Math.max(0,Math.min(t,e.totalRow-1));const n=Le(T.namespace.value),o=m(E),i=s(e,o),c=u(e,o);te({scrollLeft:p(e,a,r,l.scrollLeft,o,c>e.width?n:0),scrollTop:h(e,t,r,l.scrollTop,o,i>e.height?n:0)})},states:W,resetAfterColumnIndex:ne,resetAfterRowIndex:oe,resetAfter:se});const ie=()=>{const t=N(e.innerElement),a=(()=>{var t;const[a,r]=m(_),[l,n]=m(V),{data:o,totalColumn:s,totalRow:i,useIsScrolling:c,itemKey:d}=e,u=[];if(i>0&&s>0)for(let e=l;e<=n;e++)for(let l=a;l<=r;l++){const a=d({columnIndex:l,data:o,rowIndex:e});u.push(f(D,{key:a},null==(t=C.default)?void 0:t.call(C,{columnIndex:l,data:o,isScrolling:c?m(W).isScrolling:void 0,style:ae(e,l),rowIndex:e})))}return u})();return[f(t,{style:m(Y),ref:$},M(t)?a:{default:()=>a})]};return()=>{const t=N(e.containerElement),{horizontalScrollbar:a,verticalScrollbar:r}=(()=>{const{scrollbarAlwaysOn:t,scrollbarStartGap:a,scrollbarEndGap:r,totalColumn:l,totalRow:n}=e,o=m(G),s=m(P),i=m(q),c=m(B),{scrollLeft:d,scrollTop:u}=m(W);return{horizontalScrollbar:f(Ht,{ref:L,alwaysOn:t,startGap:a,endGap:r,class:T.e("horizontal"),clientSize:o,layout:"horizontal",onScroll:Q,ratio:100*o/i,scrollFrom:d/(i-o),total:n,visible:!0}),verticalScrollbar:f(Ht,{ref:z,alwaysOn:t,startGap:a,endGap:r,class:T.e("vertical"),clientSize:s,layout:"vertical",onScroll:J,ratio:100*s/c,scrollFrom:u/(c-s),total:l,visible:!0})}})(),l=ie();return f("div",{key:0,class:T.e("wrapper"),role:e.role},[f(t,{class:e.className,style:m(U),onScroll:X,ref:A},M(t)?l:{default:()=>l}),a,r])}}}),{max:oa,min:sa,floor:ia}=Math,ca={column:"columnWidth",row:"rowHeight"},da={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},ua=(e,t,a,r)=>{const[l,n,o]=[a[r],e[ca[r]],a[da[r]]];if(t>o){let e=0;if(o>=0){const t=l[o];e=t.offset+t.size}for(let a=o+1;a<=t;a++){const t=n(a);l[a]={offset:e,size:t},e+=t}a[da[r]]=t}return l[t]},ma=(e,t,a,r,l,n)=>{for(;a<=r;){const o=a+ia((r-a)/2),s=ua(e,o,t,n).offset;if(s===l)return o;s<l?a=o+1:r=o-1}return oa(0,a-1)},pa=(e,t,a,r)=>{const[l,n]=[t[r],t[da[r]]];return(n>0?l[n].offset:0)>=a?ma(e,t,0,n,a,r):((e,t,a,r,l)=>{const n="column"===l?e.totalColumn:e.totalRow;let o=1;for(;a<n&&ua(e,a,t,l).offset<r;)a+=o,o*=2;return ma(e,t,ia(a/2),sa(a,n-1),r,l)})(e,t,oa(0,n),a,r)},ha=({totalRow:e},{estimatedRowHeight:t,lastVisitedRowIndex:a,row:r})=>{let l=0;if(a>=e&&(a=e-1),a>=0){const e=r[a];l=e.offset+e.size}return l+(e-a-1)*t},fa=({totalColumn:e},{column:t,estimatedColumnWidth:a,lastVisitedColumnIndex:r})=>{let l=0;if(r>e&&(r=e-1),r>=0){const e=t[r];l=e.offset+e.size}return l+(e-r-1)*a},ya={column:fa,row:ha},ga=(e,t,a,r,l,n,o)=>{const[s,i]=["row"===n?e.height:e.width,ya[n]],c=ua(e,t,l,n),d=i(e,l),u=oa(0,sa(d-s,c.offset)),m=oa(0,c.offset-s+o+c.size);switch(a===tt&&(a=r>=m-s&&r<=u+s?et:rt),a){case at:return u;case lt:return m;case rt:return Math.round(m+(u-m)/2);default:return r>=m&&r<=u?r:m>u||r<m?m:u}},va=na({name:"ElDynamicSizeGrid",getColumnPosition:(e,t,a)=>{const r=ua(e,t,a,"column");return[r.size,r.offset]},getRowPosition:(e,t,a)=>{const r=ua(e,t,a,"row");return[r.size,r.offset]},getColumnOffset:(e,t,a,r,l,n)=>ga(e,t,a,r,l,"column",n),getRowOffset:(e,t,a,r,l,n)=>ga(e,t,a,r,l,"row",n),getColumnStartIndexForOffset:(e,t,a)=>pa(e,a,t,"column"),getColumnStopIndexForStartIndex:(e,t,a,r)=>{const l=ua(e,t,r,"column"),n=a+e.width;let o=l.offset+l.size,s=t;for(;s<e.totalColumn-1&&o<n;)s++,o+=ua(e,t,r,"column").size;return s},getEstimatedTotalHeight:ha,getEstimatedTotalWidth:fa,getRowStartIndexForOffset:(e,t,a)=>pa(e,a,t,"row"),getRowStopIndexForStartIndex:(e,t,a,r)=>{const{totalRow:l,height:n}=e,o=ua(e,t,r,"row"),s=a+n;let i=o.size+o.offset,c=t;for(;c<l-1&&i<s;)c++,i+=ua(e,c,r,"row").size;return c},injectToInstance:(e,t)=>{const a=({columnIndex:a,rowIndex:r},l)=>{var n,o;l=!!A(l)||l,w(a)&&(t.value.lastVisitedColumnIndex=Math.min(t.value.lastVisitedColumnIndex,a-1)),w(r)&&(t.value.lastVisitedRowIndex=Math.min(t.value.lastVisitedRowIndex,r-1)),null==(n=e.exposed)||n.getItemStyleCache.value(-1,null,null),l&&(null==(o=e.proxy)||o.$forceUpdate())};Object.assign(e.proxy,{resetAfterColumnIndex:(e,t)=>{a({columnIndex:e},t)},resetAfterRowIndex:(e,t)=>{a({rowIndex:e},t)},resetAfter:a})},initCache:({estimatedColumnWidth:e=50,estimatedRowHeight:t=50})=>({column:{},estimatedColumnWidth:e,estimatedRowHeight:t,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:e,rowHeight:t})=>{}}),wa=na({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:e},t)=>[e,t*e],getRowPosition:({rowHeight:e},t)=>[e,t*e],getEstimatedTotalHeight:({totalRow:e,rowHeight:t})=>t*e,getEstimatedTotalWidth:({totalColumn:e,columnWidth:t})=>t*e,getColumnOffset:({totalColumn:e,columnWidth:t,width:a},r,l,n,o,s)=>{a=Number(a);const i=Math.max(0,e*t-a),c=Math.min(i,r*t),d=Math.max(0,r*t-a+s+t);switch("smart"===l&&(l=n>=d-a&&n<=c+a?et:rt),l){case at:return c;case lt:return d;case rt:{const e=Math.round(d+(c-d)/2);return e<Math.ceil(a/2)?0:e>i+Math.floor(a/2)?i:e}default:return n>=d&&n<=c?n:d>c||n<d?d:c}},getRowOffset:({rowHeight:e,height:t,totalRow:a},r,l,n,o,s)=>{t=Number(t);const i=Math.max(0,a*e-t),c=Math.min(i,r*e),d=Math.max(0,r*e-t+s+e);switch(l===tt&&(l=n>=d-t&&n<=c+t?et:rt),l){case at:return c;case lt:return d;case rt:{const e=Math.round(d+(c-d)/2);return e<Math.ceil(t/2)?0:e>i+Math.floor(t/2)?i:e}default:return n>=d&&n<=c?n:d>c||n<d?d:c}},getColumnStartIndexForOffset:({columnWidth:e,totalColumn:t},a)=>Math.max(0,Math.min(t-1,Math.floor(a/e))),getColumnStopIndexForStartIndex:({columnWidth:e,totalColumn:t,width:a},r,l)=>{const n=r*e,o=Math.ceil((a+l-n)/e);return Math.max(0,Math.min(t-1,r+o-1))},getRowStartIndexForOffset:({rowHeight:e,totalRow:t},a)=>Math.max(0,Math.min(t-1,Math.floor(a/e))),getRowStopIndexForStartIndex:({rowHeight:e,totalRow:t,height:a},r,l)=>{const n=r*e,o=Math.ceil((a+l-n)/e);return Math.max(0,Math.min(t-1,r+o-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:e,rowHeight:t})=>{}});var ba=i({name:"ElTableV2Grid",props:aa,setup(e,{slots:t,expose:r}){const{ns:l}=T(Pt),{bodyRef:n,fixedRowHeight:o,gridHeight:s,hasHeader:i,headerRef:c,headerHeight:u,totalHeight:h,forceUpdate:f,itemKey:y,onItemRendered:v,resetAfterRowIndex:x,scrollTo:S,scrollToTop:R,scrollToRow:k,scrollLeft:C}=(e=>{const t=d(),r=d(),l=d(0),n=a(()=>{const{data:t,rowHeight:a,estimatedRowHeight:r}=e;if(!r)return t.length*a}),o=a(()=>{const{fixedData:t,rowHeight:a}=e;return((null==t?void 0:t.length)||0)*a}),s=a(()=>Lt(e.headerHeight)),i=a(()=>{const{height:t}=e;return Math.max(0,t-m(s)-m(o))}),c=a(()=>m(s)+m(o)>0);return p(()=>e.bodyWidth,()=>{var t;w(e.estimatedRowHeight)&&(null==(t=r.value)||t.resetAfter({columnIndex:0},!1))}),{bodyRef:r,forceUpdate:function(){var e,a;null==(e=m(r))||e.$forceUpdate(),null==(a=m(t))||a.$forceUpdate()},fixedRowHeight:o,gridHeight:i,hasHeader:c,headerHeight:s,headerRef:t,totalHeight:n,itemKey:({data:t,rowIndex:a})=>t[a][e.rowKey],onItemRendered:function({rowCacheStart:t,rowCacheEnd:a,rowVisibleStart:r,rowVisibleEnd:l}){var n;null==(n=e.onRowsRendered)||n.call(e,{rowCacheStart:t,rowCacheEnd:a,rowVisibleStart:r,rowVisibleEnd:l})},resetAfterRowIndex:function(e,t){var a;null==(a=r.value)||a.resetAfterRowIndex(e,t)},scrollTo:function(e,a){const n=m(t),o=m(r);g(e)?(null==n||n.scrollToLeft(e.scrollLeft),l.value=e.scrollLeft,null==o||o.scrollTo(e)):(null==n||n.scrollToLeft(e),l.value=e,null==o||o.scrollTo({scrollLeft:e,scrollTop:a}))},scrollToTop:function(e){var t;null==(t=m(r))||t.scrollTo({scrollTop:e})},scrollToRow:function(e,t){var a;null==(a=m(r))||a.scrollToItem(e,1,t)},scrollLeft:l}})(e);z(Gt,C),L(async()=>{var e;await b();const t=null==(e=n.value)?void 0:e.states.scrollTop;t&&R(Math.round(t)+1)}),r({forceUpdate:f,totalHeight:h,scrollTo:S,scrollToTop:R,scrollToRow:k,resetAfterRowIndex:x});const I=()=>e.bodyWidth;return()=>{const{cache:a,columns:r,data:d,fixedData:p,useIsScrolling:h,scrollbarAlwaysOn:f,scrollbarEndGap:g,scrollbarStartGap:b,style:x,rowHeight:S,bodyWidth:R,estimatedRowHeight:k,headerWidth:C,height:T,width:H,getRowHeight:F,onScroll:j}=e,N=w(k),M=N?va:wa,D=m(u);return E("div",{role:"table",class:[l.e("table"),e.class],style:x},[E(M,{ref:n,data:d,useIsScrolling:h,itemKey:y,columnCache:0,columnWidth:N?I:R,totalColumn:1,totalRow:d.length,rowCache:a,rowHeight:N?F:S,width:H,height:m(s),class:l.e("body"),role:"rowgroup",scrollbarStartGap:b,scrollbarEndGap:g,scrollbarAlwaysOn:f,onScroll:j,onItemRendered:v,perfMode:!1},{default:e=>{var a;const l=d[e.rowIndex];return null==(a=t.row)?void 0:a.call(t,{...e,columns:r,rowData:l})}}),m(i)&&E(la,{ref:c,class:l.e("header-wrapper"),columns:r,headerData:d,headerHeight:e.headerHeight,fixedHeaderData:p,rowWidth:C,rowHeight:S,width:H,height:Math.min(D+m(o),T)},{dynamic:t.header,fixed:t.row})])}}});var xa=(e,{slots:t})=>{const{mainTableRef:a,...r}=e;return E(ba,$({ref:a},r),"function"==typeof(l=t)||"[object Object]"===Object.prototype.toString.call(l)&&!R(l)?t:{default:()=>[t]});var l};var Sa=(e,{slots:t})=>{if(!e.columns.length)return;const{leftTableRef:a,...r}=e;return E(ba,$({ref:a},r),"function"==typeof(l=t)||"[object Object]"===Object.prototype.toString.call(l)&&!R(l)?t:{default:()=>[t]});var l};var Ra=(e,{slots:t})=>{if(!e.columns.length)return;const{rightTableRef:a,...r}=e;return E(ba,$({ref:a},r),"function"==typeof(l=t)||"[object Object]"===Object.prototype.toString.call(l)&&!R(l)?t:{default:()=>[t]});var l};const ka=e=>{const{isScrolling:t}=T(Pt),r=d(!1),l=d(),n=a(()=>w(e.estimatedRowHeight)&&e.rowIndex>=0),o=a(()=>{const{rowData:t,rowIndex:a,rowKey:r,onRowHover:l}=e,n=e.rowEventHandlers||{},o={};return Object.entries(n).forEach(([e,l])=>{k(l)&&(o[e]=e=>{l({event:e,rowData:t,rowIndex:a,rowKey:r})})}),l&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach(({name:e,hovered:n})=>{const s=o[e];o[e]=e=>{l({event:e,hovered:n,rowData:t,rowIndex:a,rowKey:r}),null==s||s(e)}}),o});return F(()=>{m(n)&&((t=!1)=>{const a=m(l);if(!a)return;const{columns:n,onRowHeightChange:o,rowKey:s,rowIndex:i,style:c}=e,{height:d}=a.getBoundingClientRect();r.value=!0,b(()=>{if(t||d!==Number.parseInt(c.height)){const e=n[0],t=(null==e?void 0:e.placeholderSign)===Dt;null==o||o({rowKey:s,height:d,rowIndex:i},e&&!t&&e.fixed)}})})(!0)}),{isScrolling:t,measurable:n,measured:r,rowRef:l,eventHandlers:o,onExpand:t=>{const{onRowExpand:a,rowData:r,rowIndex:l,rowKey:n}=e;null==a||a({expanded:t,rowData:r,rowIndex:l,rowKey:n})}}};var Ca=i({name:"ElTableV2TableRow",props:Qt,setup(e,{expose:t,slots:a,attrs:r}){const{eventHandlers:l,isScrolling:n,measurable:o,measured:s,rowRef:i,onExpand:c}=ka(e);return t({onExpand:c}),()=>{const{columns:t,columnsStyles:d,expandColumnKey:u,depth:p,rowData:h,rowIndex:f,style:y}=e;let g=t.map((e,r)=>{const l=x(h.children)&&h.children.length>0&&e.key===u;return a.cell({column:e,columns:t,columnIndex:r,depth:p,style:d[e.key],rowData:h,rowIndex:f,isScrolling:m(n),expandIconProps:l?{rowData:h,rowIndex:f,onExpand:c}:void 0})});if(a.row&&(g=a.row({cells:g.map(e=>x(e)&&1===e.length?e[0]:e),style:y,columns:t,depth:p,rowData:h,rowIndex:f,isScrolling:m(n)})),m(o)){const{height:t,...a}=y||{},n=m(s);return E("div",$({ref:i,class:e.class,style:n?y:a,role:"row"},r,m(l)),[g])}return E("div",$(r,{ref:i,class:e.class,style:y,role:"row"},m(l)),[g])}}});var Ta=(e,{slots:t})=>{const{columns:a,columnsStyles:r,depthMap:l,expandColumnKey:n,expandedRowKeys:o,estimatedRowHeight:s,hasFixedColumns:i,rowData:c,rowIndex:d,style:u,isScrolling:m,rowProps:p,rowClass:h,rowKey:f,rowEventHandlers:y,ns:g,onRowHovered:v,onRowExpanded:w}=e,b=zt(h,{columns:a,rowData:c,rowIndex:d},""),x=zt(p,{columns:a,rowData:c,rowIndex:d}),S=c[f],k=l[S]||0,C=Boolean(n),T=d<0,I=[g.e("row"),b,{[g.e(`row-depth-${k}`)]:C&&d>=0,[g.is("expanded")]:C&&o.includes(S),[g.is("fixed")]:!k&&T,[g.is("customized")]:Boolean(t.row)}],H=i?v:void 0,F={...x,columns:a,columnsStyles:r,class:I,depth:k,expandColumnKey:n,estimatedRowHeight:T?void 0:s,isScrolling:m,rowIndex:d,rowData:c,rowKey:S,rowEventHandlers:y,style:u};return E(Ca,$(F,{onRowExpand:w,onMouseenter:e=>{null==H||H({hovered:!0,rowKey:S,event:e,rowData:c,rowIndex:d})},onMouseleave:e=>{null==H||H({hovered:!1,rowKey:S,event:e,rowData:c,rowIndex:d})},rowkey:S}),"function"==typeof(j=t)||"[object Object]"===Object.prototype.toString.call(j)&&!R(j)?t:{default:()=>[t]});var j};const Ia=(e,{slots:t})=>{var a;const{cellData:r,style:l}=e,n=(null==(a=null==r?void 0:r.toString)?void 0:a.call(r))||"",o=W(t,"default",e,()=>[n]);return E("div",{class:e.class,title:n,style:l},[o])};Ia.displayName="ElTableV2Cell",Ia.inheritAttrs=!1;var Ea=Ia;var Ha=e=>{const{expanded:t,expandable:a,onExpand:r,style:l,size:n}=e,o={onClick:a?()=>r(!t):void 0,class:e.class};return E(P,$(o,{size:n,style:l}),{default:()=>[E(K,null,null)]})};const Fa=({columns:e,column:t,columnIndex:a,depth:r,expandIconProps:l,isScrolling:n,rowData:o,rowIndex:s,style:i,expandedRowKeys:c,ns:d,cellProps:u,expandColumnKey:m,indentSize:p,iconSize:h,rowKey:f},{slots:y})=>{const v=$t(i);if(t.placeholderSign===Dt)return E("div",{class:d.em("row-cell","placeholder"),style:v},null);const{cellRenderer:w,dataKey:b,dataGetter:x}=t,S=k(x)?x({columns:e,column:t,columnIndex:a,rowData:o,rowIndex:s}):G(o,null!=b?b:""),R=zt(u,{cellData:S,columns:e,column:t,columnIndex:a,rowIndex:s,rowData:o}),C={class:d.e("cell-text"),columns:e,column:t,columnIndex:a,cellData:S,isScrolling:n,rowData:o,rowIndex:s},T=Wt(w),I=T?T(C):W(y,"default",C,()=>[E(Ea,C,null)]),H=[d.e("row-cell"),t.class,t.align===jt.CENTER&&d.is("align-center"),t.align===jt.RIGHT&&d.is("align-right")],F=s>=0&&m&&t.key===m,j=s>=0&&c.includes(o[f]);let N;const M=`margin-inline-start: ${r*p}px;`;return F&&(N=g(l)?E(Ha,$(l,{class:[d.e("expand-icon"),d.is("expanded",j)],size:h,expanded:j,style:M,expandable:!0}),null):E("div",{style:[M,`width: ${h}px; height: ${h}px;`].join(" ")},null)),E("div",$({class:H,style:v},R,{role:"cell"}),[N,I])};Fa.inheritAttrs=!1;var ja=Fa;const Na=l({class:String,columns:Vt,columnsStyles:{type:o(Object),required:!0},headerIndex:Number,style:{type:o(Object)}});var Ma=i({name:"ElTableV2HeaderRow",props:Na,setup:(e,{slots:t})=>()=>{const{columns:a,columnsStyles:r,headerIndex:l,style:n}=e;let o=a.map((e,n)=>t.cell({columns:a,column:e,columnIndex:n,headerIndex:l,style:r[e.key]}));return t.header&&(o=t.header({cells:o.map(e=>x(e)&&1===e.length?e[0]:e),columns:a,headerIndex:l})),E("div",{class:e.class,style:n,role:"row"},[o])}});var Da=({columns:e,columnsStyles:t,headerIndex:a,style:r,headerClass:l,headerProps:n,ns:o},{slots:s})=>{const i={columns:e,headerIndex:a},c=[o.e("header-row"),zt(l,i,""),{[o.is("customized")]:Boolean(s.header)}],d={...zt(n,i),columnsStyles:t,class:c,columns:e,headerIndex:a,style:r};return E(Ma,d,"function"==typeof(u=s)||"[object Object]"===Object.prototype.toString.call(u)&&!R(u)?s:{default:()=>[s]});var u};const Oa=(e,{slots:t})=>W(t,"default",e,()=>{var t,a;return[E("div",{class:e.class,title:null==(t=e.column)?void 0:t.title},[null==(a=e.column)?void 0:a.title])]});Oa.displayName="ElTableV2HeaderCell",Oa.inheritAttrs=!1;var Aa=Oa;var La=e=>{const{sortOrder:t}=e;return E(P,{size:14,class:e.class},{default:()=>[t===Ft.ASC?E(_,null,null):E(V,null,null)]})};var za=(e,{slots:t})=>{const{column:a,ns:r,style:l,onColumnSorted:n}=e,o=$t(l);if(a.placeholderSign===Dt)return E("div",{class:r.em("header-row-cell","placeholder"),style:o},null);const{headerCellRenderer:s,headerClass:i,sortable:c}=a,d={...e,class:r.e("header-cell-text")},u=Wt(s),m=u?u(d):W(t,"default",d,()=>[E(Aa,d,null)]),{sortBy:p,sortState:h,headerCellProps:f}=e;let y,g;if(h){const e=h[a.key];y=Boolean(Mt[e]),g=y?e:Ft.ASC}else y=a.key===p.key,g=y?p.order:Ft.ASC;const v=[r.e("header-cell"),zt(i,e,""),a.align===jt.CENTER&&r.is("align-center"),a.align===jt.RIGHT&&r.is("align-right"),c&&r.is("sortable")],w={...zt(f,e),onClick:a.sortable?n:void 0,class:v,style:o,"data-key":a.key};return E("div",$(w,{role:"columnheader"}),[m,c&&E(La,{class:[r.e("sort-icon"),y&&r.is("sorting")],sortOrder:g},null)])};const $a=(e,{slots:t})=>{var a;return E("div",{class:e.class,style:e.style},[null==(a=t.default)?void 0:a.call(t)])};$a.displayName="ElTableV2Footer";var Wa=$a;const Ka=(e,{slots:t})=>{const a=W(t,"default",{},()=>[E(ge,null,null)]);return E("div",{class:e.class,style:e.style},[a])};Ka.displayName="ElTableV2Empty";var Pa=Ka;const Ga=(e,{slots:t})=>{var a;return E("div",{class:e.class,style:e.style},[null==(a=t.default)?void 0:a.call(t)])};Ga.displayName="ElTableV2Overlay";var _a=Ga;function Va(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!R(e)}var Ba=i({name:"ElTableV2",props:ra,setup(e,{slots:t,expose:a}){const r=c("table-v2"),{columnsStyles:l,fixedColumnsOnLeft:n,fixedColumnsOnRight:o,mainColumns:s,mainTableHeight:i,fixedTableHeight:d,leftTableWidth:u,rightTableWidth:p,data:h,depthMap:f,expandedRowKeys:y,hasFixedColumns:g,mainTableRef:v,leftTableRef:w,rightTableRef:b,isDynamic:x,isResetting:S,isScrolling:R,bodyWidth:k,emptyStyle:C,rootStyle:T,footerHeight:I,showEmpty:H,scrollTo:F,scrollToLeft:j,scrollToTop:N,scrollToRow:M,getRowHeight:D,onColumnSorted:O,onRowHeightChange:A,onRowHovered:L,onRowExpanded:W,onRowsRendered:K,onScroll:P,onVerticalScroll:G}=Kt(e);return a({scrollTo:F,scrollToLeft:j,scrollToTop:N,scrollToRow:M}),z(Pt,{ns:r,isResetting:S,isScrolling:R}),()=>{const{cache:a,cellProps:c,estimatedRowHeight:S,expandColumnKey:R,fixedData:F,headerHeight:j,headerClass:N,headerProps:M,headerCellProps:z,sortBy:_,sortState:V,rowHeight:B,rowClass:q,rowEventHandlers:U,rowKey:Y,rowProps:Z,scrollbarAlwaysOn:X,indentSize:J,iconSize:Q,useIsScrolling:ee,vScrollbarSize:te,width:ae}=e,re=m(h),le={cache:a,class:r.e("main"),columns:m(s),data:re,fixedData:F,estimatedRowHeight:S,bodyWidth:m(k),headerHeight:j,headerWidth:m(k),height:m(i),mainTableRef:v,rowKey:Y,rowHeight:B,scrollbarAlwaysOn:X,scrollbarStartGap:2,scrollbarEndGap:te,useIsScrolling:ee,width:ae,getRowHeight:D,onRowsRendered:K,onScroll:P},ne=m(u),oe=m(d),se={cache:a,class:r.e("left"),columns:m(n),data:re,fixedData:F,estimatedRowHeight:S,leftTableRef:w,rowHeight:B,bodyWidth:ne,headerWidth:ne,headerHeight:j,height:oe,rowKey:Y,scrollbarAlwaysOn:X,scrollbarStartGap:2,scrollbarEndGap:te,useIsScrolling:ee,width:ne,getRowHeight:D,onScroll:G},ie=m(p),ce={cache:a,class:r.e("right"),columns:m(o),data:re,fixedData:F,estimatedRowHeight:S,rightTableRef:b,rowHeight:B,bodyWidth:ie,headerWidth:ie,headerHeight:j,height:oe,rowKey:Y,scrollbarAlwaysOn:X,scrollbarStartGap:2,scrollbarEndGap:te,width:ie,style:`--${m(r.namespace)}-table-scrollbar-size: ${te}px`,useIsScrolling:ee,getRowHeight:D,onScroll:G},de=m(l),ue={ns:r,depthMap:m(f),columnsStyles:de,expandColumnKey:R,expandedRowKeys:m(y),estimatedRowHeight:S,hasFixedColumns:m(g),rowProps:Z,rowClass:q,rowKey:Y,rowEventHandlers:U,onRowHovered:L,onRowExpanded:W,onRowHeightChange:A},me={cellProps:c,expandColumnKey:R,indentSize:J,iconSize:Q,rowKey:Y,expandedRowKeys:m(y),ns:r},pe={ns:r,headerClass:N,headerProps:M,columnsStyles:de},he={ns:r,sortBy:_,sortState:V,headerCellProps:z,onColumnSorted:O},fe={row:e=>E(Ta,$(e,ue),{row:t.row,cell:e=>{let a;return t.cell?E(ja,$(e,me,{style:de[e.column.key]}),Va(a=t.cell(e))?a:{default:()=>[a]}):E(ja,$(e,me,{style:de[e.column.key]}),null)}}),header:e=>E(Da,$(e,pe),{header:t.header,cell:e=>{let a;return t["header-cell"]?E(za,$(e,he,{style:de[e.column.key]}),Va(a=t["header-cell"](e))?a:{default:()=>[a]}):E(za,$(e,he,{style:de[e.column.key]}),null)}})},ye=[e.class,r.b(),r.e("root"),{[r.is("dynamic")]:m(x)}],ge={class:r.e("footer"),style:m(I)};return E("div",{class:ye,style:m(T)},[E(xa,le,Va(fe)?fe:{default:()=>[fe]}),E(Sa,se,Va(fe)?fe:{default:()=>[fe]}),E(Ra,ce,Va(fe)?fe:{default:()=>[fe]}),t.footer&&E(Wa,ge,{default:t.footer}),m(H)&&E(Pa,{class:r.e("empty"),style:m(C)},{default:t.empty}),t.overlay&&E(_a,{class:r.e("overlay")},{default:t.overlay})])}}});const qa=l({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:o(Function)}});var Ua=i({name:"ElAutoResizer",props:qa,setup(e,{slots:t}){const a=c("auto-resizer"),{height:r,width:l,sizer:n}=(e=>{const t=d(),a=d(0),r=d(0);let l;return F(()=>{l=B(t,([e])=>{const{width:t,height:l}=e.contentRect,{paddingLeft:n,paddingRight:o,paddingTop:s,paddingBottom:i}=getComputedStyle(e.target),c=Number.parseInt(n)||0,d=Number.parseInt(o)||0,u=Number.parseInt(s)||0,m=Number.parseInt(i)||0;a.value=t-c-d,r.value=l-u-m}).stop}),h(()=>{null==l||l()}),p([a,r],([t,a])=>{var r;null==(r=e.onResize)||r.call(e,{width:t,height:a})}),{sizer:t,width:a,height:r}})(e),o={width:"100%",height:"100%"};return()=>{var e;return E("div",{ref:n,class:a.b(),style:o},[null==(e=t.default)?void 0:e.call(t,{height:r.value,width:l.value})])}}});const Ya=q(Ba),Za=q(Ua),Xa={class:"upload select"},Ja=ye(i({__name:"TestLog",emits:["handleLine","beforeHandle","afterHandle"],setup(t,{emit:a}){const r=a,l=d(null),n=d(null);async function o(t){n.value?.classList.remove("drag");const a=t.target.files;if(!a||0===a.length)return;r("beforeHandle");const l=e.service({fullscreen:!0,text:"正在解析……请稍候",lock:!0,spinner:'<div style="width:0;height:0"></div>'});for(let e=0;e<a.length;e++){const t=a[e],l=await t.text();for(const e of l.split("\n"))r("handleLine",e)}l.close(),r("afterHandle"),n.value?.classList.remove("drag")}function s(e){e.preventDefault(),n.value?.classList.add("drag")}function i(e){e.preventDefault(),n.value?.classList.remove("drag")}return F(()=>{l.value?.addEventListener("change",o),n.value?.addEventListener("dragover",s),n.value?.addEventListener("dragleave",i)}),U(()=>{l.value?.removeEventListener("change",o),n.value?.removeEventListener("dragover",s),n.value?.removeEventListener("dragleave",i)}),(e,t)=>(Z(),Y("div",Xa,[X("div",{ref_key:"select",ref:n,class:"upload-select"},[t[0]||(t[0]=X("div",{class:"upload text"},[X("span",null,"+"),X("p",null,"上传或拖入ACT日志")],-1)),X("input",{ref_key:"input",ref:l,type:"file"},null,512)],512)]))}}),[["__scopeId","data-v-6722092f"]]),Qa=[{name:"铁壁",id:1191,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"盾阵",id:1856,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"干预",id:1174,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"预警",id:74,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"武装",id:1176,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"神圣领域",id:82,type:"multiplier",performance:{physics:0,magic:0,darkness:0},isFriendly:!0},{name:"圣光幕帘",id:1362,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"圣盾阵",id:2674,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"骑士的坚守",id:2675,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"壁垒",id:77,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"极致防御",id:3829,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"极致护盾",id:3830,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"原初的直觉",id:735,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的勇猛",id:1857,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的武猛",id:1858,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"战栗",id:87,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"复仇",id:89,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"摆脱",id:1457,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"死斗",id:409,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"原初的血气",id:2678,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的血潮",id:2679,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的血烟",id:2680,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"戮罪",id:3832,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"至黑之夜",id:1178,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"弃明投暗",id:746,type:"multiplier",performance:{physics:.9,magic:.8,darkness:1},isFriendly:!0},{name:"暗影墙",id:747,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"暗黑布道",id:1894,type:"multiplier",performance:{physics:.95,magic:.9,darkness:1},isFriendly:!0},{name:"暗影卫",id:3835,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"行尸走肉",id:810,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"死而不僵",id:811,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"出死入生",id:3255,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"献奉",id:2682,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"石之心",id:1840,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"残暴弹",id:1898,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"伪装",id:1832,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"星云",id:1834,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"光之心",id:1839,type:"multiplier",performance:{physics:.95,magic:.85,darkness:1},isFriendly:!0},{name:"超火流星",id:1836,type:"multiplier",performance:{physics:0,magic:0,darkness:0},isFriendly:!0},{name:"刚玉之心",id:2683,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"刚玉之清",id:2684,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"神祝祷",id:1218,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"节制",id:1873,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"水流幕",id:2708,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"鼓舞",id:297,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"激励",id:1918,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"炽天的幕帘",id:1917,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"野战治疗阵",id:299,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"异想的幻光",id:317,type:"multiplier",performance:{physics:1,magic:.95,darkness:1},isFriendly:!0},{name:"炽天的幻光",id:1875,type:"multiplier",performance:{physics:1,magic:.95,darkness:1},isFriendly:!0},{name:"生命回生法",id:2710,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"怒涛之计",id:2711,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"命运之轮",id:849,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"天星交错",id:1889,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"擢升",id:2717,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"中间学派",id:1921,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"均衡诊断",id:2607,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"齐衡诊断",id:2608,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"均衡预后",id:2609,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"坚角清汁",id:2618,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"白牛清汁",id:2619,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"整体论",id:3003,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"整体盾",id:3365,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"输血",id:2612,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"泛输血",id:2613,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"心眼",id:1232,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"金刚极意",id:1179,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"行吟",id:1934,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"策动",id:1951,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"防守之桑巴",id:1826,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"即兴表演结束",id:2697,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"残影",id:488,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"魔罩",id:168,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"守护之光",id:2702,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"守护纹",id:2597,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"抗死",id:2707,type:"multiplier",performance:{physics:1,magic:.9,darkness:1},isFriendly:!0},{name:"雪仇",id:1193,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!1},{name:"牵制",id:1195,type:"multiplier",performance:{physics:.9,magic:.95,darkness:1},isFriendly:!1},{name:"昏乱",id:1203,type:"multiplier",performance:{physics:.95,magic:.9,darkness:1},isFriendly:!1},{name:"武装解除",id:860,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!1},{name:"减速",id:9,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!1},{name:"体力增加",id:2120,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"腐臭",id:1715,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!1},{name:"智力精神降低",id:2115,type:"multiplier",performance:{physics:1,magic:.9,darkness:1},isFriendly:!1},{name:"龙之力",id:2500,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"超硬化",id:1722,type:"multiplier",performance:{physics:.1,magic:.1,darkness:1},isFriendly:!0},{name:"玄结界",id:2496,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"仙人盾",id:2119,type:"multiplier",performance:{physics:.95,magic:.95,darkness:1},isFriendly:!0},{name:"强力守护",id:1719,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"哥布防御",id:2114,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"铜墙铁盾",id:194,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"坚守要塞",id:195,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"终极堡垒",id:196,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"原初大地",id:863,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"暗黑之力",id:864,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"灵魂之青",id:1931,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"坦培拉涂层",id:3686,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"油性坦培拉涂层",id:3687,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"世界树之干",id:3890,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"建筑神之塔",id:3892,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"太阳星座",id:3896,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"神爱抚",id:3903,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0}],er=[...Qa],tr=new Map;let ar="Chinese";function rr(e){if(ar!==e||0===tr.size){tr.clear();for(const t of"Chinese"===e?Qa:er){const e=Ce[t.id][1];t.fullIcon=Te(e),tr.set(t.id.toString(16).toUpperCase().padStart(2,"0"),t)}ar=e}}function lr(e){return tr.get(e)}function nr(e,t){if("absorbed"===e.type)return"useful";if("dot"===t||"darkness"===t)return"unuseful";if(0===e.performance.darkness&&0===e.performance.magic&&0===e.performance.physics||1===e.performance.darkness&&1===e.performance.magic&&1===e.performance.physics)return"useful";const a="physics"===t?"magic":"physics";return 2*(100-100*e.performance[t])===100-100*e.performance[a]?"half-useful":1===e.performance[t]?"unuseful":"useful"}rr("Chinese");function or(e,t){return Object.entries(Ce).reduce((a,[r,[l,n]])=>(e.test(l)&&a.set(r,{name:l,icon:n,isFriendly:t}),a),new Map)}const sr=or(/(?:耐性|防御力)(?:大幅)?(?:降低|提升|低下|下降)|受伤(?:加重|减轻)|体力(?:增加|衰减|减少)|伤害屏障/,!0),ir=or(/(?:精神|力量|灵巧|智力){1,2}(?:大幅)?降低/,!1),cr=be("hash"),dr=J("keigennRecord2.1",{state:()=>({userOptions:{scale:a(()=>ur(cr.scale,1)),opacity:a(()=>ur(cr.opacity,.9)),targetType:a(()=>ur(cr.targetType,"icon")),iconType:a(()=>ur(cr.iconType,3)),parseAA:a(()=>ur(cr.parseAA,!0)),parseDoT:a(()=>ur(cr.parseDoT,!1)),minimize:a(()=>ur(cr.minimize,!1)),actionCN:a(()=>ur(cr.actionCN,!0)),statusCN:a(()=>ur(cr.statusCN,!0))},isBrowser:!1}),getters:{icon4k:e=>e.userOptions.scale>=2||window.devicePixelRatio>=2?"_hr1":""},actions:{checkIsBrowser(){this.isBrowser=!window.OverlayPluginApi&&!cr.OVERLAY_WS&&!cr.HOST_PORT,this.isBrowser&&setTimeout(()=>this.checkIsBrowser(),1e3)},formatterName:e=>e,initEnvironment(e){/^[A-Z]\S+ [A-Z]\S+$/.test(e)?rr("Global"):rr("Chinese")}}});function ur(e,t){return"boolean"==typeof t?"0"!==e&&"false"!==e?.toLocaleLowerCase()&&("1"===e||"true"===e?.toLocaleLowerCase()||t):"number"==typeof t?Number.isNaN(+e)?t:+e:"string"==typeof t?e:t}function mr(e){return{dodge:"闪避","damage done":"击中","blocked damage":"格挡","parried damage":"招架","instant death":"即死",heal:"治疗","crit heal":"暴击治疗"}[e]}function pr(e){const t=function(e){switch(!0){case e.endsWith("33"):return"instant death";case/2\w{4}4$/.test(e):return"crit heal";case e.endsWith("1"):return"dodge";case e.endsWith("3"):return"damage done";case e.endsWith("4"):return"heal";case e.endsWith("5"):return"blocked damage";case e.endsWith("6"):return"parried damage";default:throw new Error(`Unknown effect flag ${e}`)}}(e),a=function(e){switch(!0){case/2\w{3}$/.test(e):return"crit damage";case/4\w{3}$/.test(e):return"direct hit damage";case/6\w{3}$/.test(e):return"crit direct hit damage";default:return"damage"}}(e),r=function(e){switch(!0){case/7?[1-4]\w{3}[35]$/.test(e):case/[16]$/.test(e):return"physics";case/^E$/.test(e):case/5\w{4}$/.test(e):return"magic";case/^(?:\d0)?3$/.test(e):case/6\w{4}$/.test(e):return"darkness";default:return"physics"}}(e);return{effect:t,properties:a,type:r}}const hr=["3E","113","213","313"],fr=["A10","E"],yr=["04"],gr=["01","03","05","06","36"];function vr(e){let t=0,a=e[8]??"",r=e[9]??"";hr.includes(a)&&(t+=2,a=e[8+t]??a,r=e[8+t+1]??r),fr.includes(a)&&(t+=2,a=e[8+t]??a,r=e[8+t+1]??r);const l=function(e){if(void 0===e)return 0;const t=e.length;if(t<=4)return 0;let a=Number.parseInt(e.slice(0,t-4),16);if("4"===e[t-4]){const r=Number.parseInt(e.slice(t-2,t),16);a=a-r+(r<<16)}return a}(r),n=`00${a}`.slice(-2);return{amount:l,lowByte:n,flags:a,isHeal:yr.includes(n),isAttack:gr.includes(n)}}const wr=[Number(409).toString(16).toUpperCase(),Number(810).toString(16).toUpperCase(),Number(811).toString(16).toUpperCase(),Number(1836).toString(16).toUpperCase()];const br={class:"amount"},xr={class:"row-info"},Sr=ye(i({__name:"Amount",props:{row:{}},setup(e){const t=e,{amount:r,maxHp:l,currentHp:n,shield:o,source:s,type:i,keigenns:c,effect:d}=t.row,u=Math.round(l*+o/100),p=Math.round(n/l*100);let h=0;if("instant death"!==d&&"dodge"!==d){let e=1;"blocked damage"===d?e=.8:"parried damage"===d&&(e=.85);let t=1;for(const a of c)"absorbed"!==a.type&&(t*=a.performance[i]??1);h=1-t*e}const f=(r&&Math.round((r+u)/(1-h))||0).toLocaleString(),y=(100*h).toFixed(2),g=a(()=>r.toLocaleString()),v=i,w=(b=t.row).currentHp-b.amount<0&&!b.keigenns.find(e=>wr.includes(e.effectId));var b;const x=(()=>{const e=[u>0?"有盾不准":"",c.find(e=>e.name.includes("受伤加重"))?"不算易伤":""].filter(Boolean);return e.length?`（${e.join("、")}）`:""})();return(e,t)=>{const a=Fe,r=je;return Z(),Q(r,{"append-to":".wrapper",trigger:"hover",enterable:!1,"hide-after":0,width:180},{reference:ee(()=>[X("span",br,[X("span",{class:le(m(v))},[X("span",{class:le({lethal:m(w)})},ae(m(g)),3)],2)])]),default:ee(()=>[X("ul",xr,[X("li",null,"伤害来源: "+ae(m(s)),1),X("li",null,"玩家护盾: "+ae(m(o))+"%",1),X("li",null,"玩家血量: "+ae(m(p))+"%",1),m(h)<1&&"dot"!==m(i)?(Z(),Y(D,{key:0},[E(a),X("li",null,[t[0]||(t[0]=re(" 玩家减伤率: ",-1)),X("strong",null,ae(m(y))+"%",1)]),X("li",null,[t[1]||(t[1]=re(" 倒推裸吃伤害: ",-1)),X("span",{class:le(m(v))},ae(m(f)),3)]),X("li",null,ae(m(x)),1)],64)):te("",!0)])]),_:1})}}}),[["__scopeId","data-v-7f67f40d"]]),Rr={key:0},kr={key:1,class:"status-container"},Cr=["title","data-duration","data-sourcePov"],Tr=["src","alt"],Ir={class:"flags"},Er=ye(i({__name:"StatusShow",props:{row:{type:Object,required:!0}},setup(e){const t=e,a=dr(),r=a.userOptions,l=a.icon4k;return(e,a)=>"dot"===t.row.type?(Z(),Y("div",Rr," （不支持） ")):(Z(),Y("div",kr,[(Z(!0),Y(D,null,ne(t.row.keigenns,(e,n)=>(Z(),Y("span",{key:n},[X("span",{class:"status",title:`${m(r).statusCN?e.name:e.effect}(${e.source})`,"data-duration":e.remainingDuration,"data-sourcePov":e.isPov},[X("img",{class:le(`statusIcon ${m(nr)(e,t.row.type)}`),src:m(Me)(`/i/${e.fullIcon}${m(l)}.png`),alt:e.effect,loading:"lazy",onError:a[0]||(a[0]=(...e)=>m(Ne)&&m(Ne)(...e))},null,42,Tr)],8,Cr)]))),128)),X("span",Ir,ae("damage done"===t.row.effect?"":m(mr)(t.row.effect)),1)]))}}),[["__scopeId","data-v-9b1eaeae"]]),Hr={class:"target"},Fr=["src","alt"],jr={key:1,class:"alt-text"},Nr=ye(i({__name:"Target",props:{row:{type:Object,required:!0}},setup(e){const t=e,r=dr(),l=d(!1);function n(e){l.value=!0;e.target.style.display="none"}const o=a(()=>!l.value&&"icon"===(r.userOptions.targetType??"icon"));return(e,a)=>{return Z(),Y("div",Hr,[m(o)?(Z(),Y("img",{key:0,class:le(`jobIcon cj${m(r).userOptions.iconType}`),src:(l=t.row.jobIcon,s=m(r).userOptions.iconType,`https://souma.diemoe.net/resources/img/cj${s}/${l.replace(/([A-Z])/g," $1").trim()}.png`),alt:t.row.jobIcon,onError:n},null,42,Fr)):(Z(),Y("span",jr,ae(t.row.job),1))]);var l,s}}}),[["__scopeId","data-v-0c7a0405"]]),Mr="[取消筛选]",Dr=ye(i({__name:"Table",props:{rows:{},actionKey:{}},setup(e){const t=e,r=dr().userOptions,l=oe("contextMenu"),n=d(""),o=d(""),s=d(!1),i=d(0),c=d(0),u=d(null);xe(l,()=>{s.value=!1});const p=a(()=>[Mr,...Array.from(new Set(t.rows.map(e=>e[t.actionKey])))]),h=a(()=>[{label:"[取消筛选]",value:"",job:-1},...Array.from(new Map(t.rows.map(e=>[e.target,e])).values()).map(e=>({label:`${e.job}(${e.target})`,value:e.target,job:e.jobEnum}))].sort((e,t)=>He.enumSortMethod(e.job,t.job)));function y(){if(u.value){const e=u.value[t.actionKey];n.value===e?n.value="":n.value=e,s.value=!1}}function g(){if(u.value){const e=u.value.target;o.value===e?o.value="":o.value=e,s.value=!1}}const v=a(()=>t.rows.filter(e=>{const a=!n.value||n.value===Mr||e[t.actionKey]===n.value,r=!o.value||o.value===Mr||e.target===o.value;return a&&r})),w=a(()=>[{key:"time",title:"时间",dataKey:"time",width:40,align:"center",class:"col-time"},{key:"action",title:"技能",dataKey:t.actionKey,width:64,align:"center",class:"col-action",headerCellRenderer:()=>f("div",{class:"header-filter"},[f(ze,{size:"small",modelValue:n.value,placeholder:"技能",clearable:!1,style:"width:4.5em",teleported:!1,onChange:e=>n.value=e===Mr?"":e},()=>p.value.map(e=>f($e,{key:e,label:e,value:e})))]),cellRenderer:({rowData:e})=>f("span",e[t.actionKey]??"")},{key:"target",title:"职业",dataKey:"target",width:32,align:"center",class:"col-target",headerCellRenderer:()=>f("div",{class:"header-filter"},[f(ze,{size:"small",modelValue:o.value,placeholder:"职业",clearable:!1,style:"width:4.7em;text-overflow:clip;white-space:nowrap",class:"col-target-select",teleported:!1,onChange:e=>{o.value=e===Mr?"":e}},()=>h.value.map(e=>f($e,{key:e.value,label:e.label,value:e.value})))]),cellRenderer:({rowData:e})=>f(Nr,{row:e})},{key:"amount",title:"伤害",dataKey:"amount",width:45,align:"right",class:"col-amount",cellRenderer:({rowData:e})=>f(Sr,{row:e})},{key:"keigenns",title:"减伤",dataKey:"keigenns",width:100,align:"left",flexGrow:1,class:"col-keigenns",cellRenderer:({rowData:e})=>f(Er,{row:e})}]);let b=null;const x=a(()=>({onClick:({rowData:e})=>{const{actionCN:t,amount:a,job:l,keigenns:n,time:o,type:s,effect:i,currentHp:c,maxHp:d,shield:u}=e,m="damage done"===i?"":`,${mr(i)}`,p=`${o} ${l} ${t} ${a.toLocaleString()}(${h=s,{physics:"物理",magic:"魔法",darkness:"暗黑",dot:"持续伤害"}[h]}) 减伤:${0===n.length&&""===m?"无":n.map(e=>r.statusCN?e.name:e.effect).join(",")+m} HP:${c}/${d}(${Math.round(c/d*100)}%)+盾:${Math.round(d*+u/100)}(${u}%)`;var h;Ee(p).then(()=>{b?.close(),b=ie.success({message:"复制成功",duration:800})}).catch(()=>ie.error("复制失败"))},onContextmenu:({rowData:e,event:t})=>{const a=t;u.value=e,i.value=a.clientX,c.value=a.clientY,s.value=!0}}));return(e,t)=>{const a=Ya,r=Za;return Z(),Q(r,{style:{height:"100%",width:"100%"}},{default:ee(({height:t,width:r})=>[E(a,{"header-class":"keigenn-table-header",class:"keigenn-table",columns:w.value,data:v.value,width:r,height:t,"row-height":28,"header-height":24,"row-key":"key","scrollbar-always-on":"","row-event-handlers":x.value},null,8,["columns","data","width","height","row-event-handlers"]),m(s)?(Z(),Y("div",{key:0,ref_key:"contextMenu",ref:l,class:"context-menu",style:se({top:`${m(c)}px`,left:`${m(i)}px`})},[X("ul",null,[X("li",{onClick:y},ae(m(n)===(m(u)?.[e.actionKey]??"")?`取消筛选 [${m(u)?.[e.actionKey]??"此技能"}]`:`只看 [${m(u)?.[e.actionKey]??"此技能"}]`),1),X("li",{onClick:g},ae(m(o)===m(u)?.target?`取消筛选 [${m(u)?.job??"此职业"}]`:`只看 [${m(u)?.job??"此职业"}]`),1)])],4)):te("",!0)]),_:1})}}}),[["__scopeId","data-v-06d51d88"]]),Or="function"==typeof structuredClone?structuredClone:e=>{if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e.source,e.flags);if(Array.isArray(e))return e.map(e=>Or(e));if(Object.getPrototypeOf(e)===Object.prototype){const t={};for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=Or(e[a]));return t}return e},Ar={class:"header-select"},Lr={style:{height:"100%"}},zr={key:0,class:"testLog"},$r="souma-keigenn-record-2",Wr=ye(i({__name:"keigennRecord2",setup(e){const t=We(),r=dr(),l=r.userOptions;r.checkIsBrowser();const n=d(l.minimize),o=a(()=>l.actionCN?"actionCN":"action"),s=d(!1);let i=!1;const c=Se("keigenn-record-2-pov-name",""),u=Se("keigenn-record-2-pov-id",""),p=Se("keigenn-record-2-party-list",[]),h=Se("keigenn-record-2-job-map",{}),f=Se("keigenn-record-2-party-event-party",[]),g=d(0),v=d([{zoneName:"",duration:"00:00",table:ce([]),key:"init",timestamp:-1}]),w={rsv:/^262\|(?<timestamp>[^|]*)\|[^|]*\|[^|]*\|_rsv_(?<id>\d+)_[^|]+\|(?<real>[^|]*)\|/i,ability:Ge.ability(),statusEffectExplicit:Ge.statusEffectExplicit(),gainsEffect:Ge.gainsEffect(),losesEffect:Ge.losesEffect(),inCombat:/^260\|(?<timestamp>[^|]*)\|(?<inACTCombat>[^|]*)\|(?<inGameCombat>[^|]*)\|/,changeZone:Ge.changeZone(),partyList:/^11\|(?<timestamp>[^|]*)\|(?<partyCount>\d*)\|(?<list>(?:\w{8}\|)*)\w{16}/,primaryPlayer:/^02\|(?<timestamp>[^|]*)\|(?<id>[^|]*)\|(?<name>[^|]*)/,addCombatant:Ge.addedCombatant(),removingCombatant:Ge.removingCombatant(),networkDoT:Ge.networkDoT()},b=d(0),x=Se("souma-keigenn-record-2-zone-name",""),S=Se("souma-keigenn-record-2-rsv-data",{}),R={},k={friendly:{},enemy:{}};function C(){var e;s.value=!0,i=!1,b.value=0,g.value=0,v.value.length=0,v.value.push({zoneName:"",duration:"00:00",table:ce([]),key:"placeholder",timestamp:-1}),(e=v.value[0]).table.length=0,e.zoneName="",e.duration="00:00",e.key="init",M()}function T(){v.value=v.value.filter(e=>"00:00"!==e.duration&&0!==e.table.length),i=!0,s.value=!1}function I(e){for(const t in w){const a=w[t].exec(e);if(a){const n=e.split("|");switch(t){case"statusEffectExplicit":a.groups?.targetId.startsWith("1")&&(R[a.groups.targetId]=a.groups.currentShield);break;case"gainsEffect":{const e=n[Pe.GainsEffect.fields.effectId],t=n[Pe.GainsEffect.fields.effect],a=n[Pe.GainsEffect.fields.target],r=n[Pe.GainsEffect.fields.targetId],l=Number.parseInt(n[Pe.GainsEffect.fields.count],16);let o=lr(e);if(!o){const t=r.startsWith("1")&&sr.get(Number.parseInt(e,16).toString())||r.startsWith("4")&&ir.get(Number.parseInt(e,16).toString());if(!t)return;const a=Te(t.icon),n=l>1?Ie(a,l):a;o={type:"multiplier",performance:{physics:1,magic:1,darkness:1},id:Number.parseInt(e,16),fullIcon:n,name:t.name,isFriendly:t.isFriendly}}const s=n[Pe.GainsEffect.fields.duration],i=n[Pe.GainsEffect.fields.source],c=n[Pe.GainsEffect.fields.sourceId],d=new Date(n[Pe.GainsEffect.fields.timestamp]).getTime()+1e3*Number.parseFloat(s),m={name:o.name,type:o.type,count:l,effect:t,effectId:e,source:i,sourceId:c,target:a,targetId:r,expirationTimestamp:d,performance:o.performance,fullIcon:o.fullIcon,isPov:u.value===c};r.startsWith("1")&&o.isFriendly?(void 0===k.friendly[r]&&(k.friendly[r]={}),k.friendly[r][e]=m):r.startsWith("4")&&!o.isFriendly&&(void 0===k.enemy[a]&&(k.enemy[a]={}),k.enemy[a][e]=m)}break;case"losesEffect":{const e=n[Pe.LosesEffect.fields.target],t=n[Pe.LosesEffect.fields.targetId],a=n[Pe.LosesEffect.fields.effectId];t.startsWith("1")?k.friendly[t]&&Reflect.deleteProperty(k.friendly[t],a):k.enemy[e]&&Reflect.deleteProperty(k.enemy[e],a)}break;case"addCombatant":if("00"!==n[Pe.AddedCombatant.fields.job]){const e=n[Pe.AddedCombatant.fields.job],t=new Date(n[Pe.AddedCombatant.fields.timestamp]).getTime();h.value[n[Pe.AddedCombatant.fields.id]]={job:Number.parseInt(e,16),timestamp:t}}break;case"removingCombatant":Reflect.deleteProperty(h.value,n[Pe.RemovedCombatant.fields.id]);break;case"primaryPlayer":{u.value=n[Pe.ChangedPlayer.fields.id];const e=n[Pe.ChangedPlayer.fields.name];if(c.value===e)return;c.value=e,r.initEnvironment(n[Pe.ChangedPlayer.fields.name])}break;case"partyList":p.value=a.groups?.list?.split("|")??[];break;case"changeZone":x.value=n[Pe.ChangeZone.fields.name],N(new Date(n[Pe.ChangeZone.fields.timestamp]).getTime());break;case"inCombat":{const e="1"===n[Pe.InCombat.fields.inACTCombat],t="1"===n[Pe.InCombat.fields.inGameCombat],a=new Date(n[Pe.InCombat.fields.timestamp]).getTime();if(e||t){if(b.value>0)return;return"placeholder"===v.value[0].key&&v.value.splice(0,1),0!==v.value[0].table.length&&(v.value.unshift({zoneName:"",duration:"00:00",table:ce([]),key:n[Pe.InCombat.fields.timestamp],timestamp:a}),v.value.length>=3&&v.value.splice(v.value.length-1,1)),b.value=a,v.value[0].zoneName=x.value,void(g.value=0)}if(!e&&!t)return void N(a)}break;case"rsv":{const e=Number(a.groups?.id),t=n[Pe.RSVData.fields.value];e&&t&&(S.value[Number(e)]=t)}break;case"networkDoT":if(!l.parseDoT)return;{const e=n[Pe.NetworkDoT.fields.which],t=n[Pe.NetworkDoT.fields.id];if("DoT"!==e||t.startsWith("4")||t!==u.value&&!p.value.includes(t)&&!f.value.find(e=>e.id===t))return;const a=n[Pe.NetworkDoT.fields.name],r=n[Pe.NetworkDoT.fields.damage],l=Number.parseInt(r,16),o=new Date(n[Pe.Ability.fields.timestamp]??"???").getTime(),s=Number(n[Pe.NetworkDoT.fields.currentHp]),i=Number(n[Pe.NetworkDoT.fields.maxHp]),c=O(0===b.value?0:o-b.value),d=H(t),m=He.jobToFullName(He.jobEnumToJob(d)).simple2,h=d,y=He.jobEnumToIcon(h);j({key:v.value[0].table.length.toString(),time:c,id:void 0,action:e,actionCN:e,source:"",target:a,targetId:t,job:m,jobIcon:y,jobEnum:h,amount:l,keigenns:[],currentHp:s,maxHp:i,effect:"damage done",type:"dot",shield:R[t]??"0",povId:u.value})}break;case"ability":if(0===b.value)return;{const e=vr(n);if(e.isAttack&&e.amount>=0){const t=n[Pe.Ability.fields.sourceId]??"???",r=n[Pe.Ability.fields.targetId]??"???";if(!t.startsWith("4")||!r.startsWith("1"))return;if(r!==u.value&&!p.value.includes(r)&&!f.value.find(e=>e.id===r))return;const o=new Date(n[Pe.Ability.fields.timestamp]??"???").getTime(),s=n[Pe.Ability.fields.ability],i=s.match(/^_rsv_(?<id>\d+)_/),c=n[Pe.Ability.fields.id]??"???";let d=s;if(i){const e=Number(i.groups?.id);d=S.value[e]??s.match(/^_(?<id>rsv_\d+)_/)?.groups?.id}else if(d=d.replace(/unknown_.*/,"攻击"),!1===l.parseAA&&/^攻击|攻撃|[Aa]ttack$/.test(d))return;const m=Ke(Number.parseInt(c,16)),h=m&&""!==m?m:d,y=Number(n[Pe.Ability.fields.targetCurrentHp])??"???",g=Number(n[Pe.Ability.fields.targetMaxHp])??"???",w=n[Pe.Ability.fields.source]??"???",x=n[Pe.Ability.fields.target]??"???",{effect:C,type:T}=pr(e.flags),I=O(0===b.value?0:o-b.value),E=H(r),F=He.jobToFullName(He.jobEnumToJob(E)).simple2,N=E,M=He.jobEnumToIcon(N),D=Or(Object.values(k.friendly[r]??[]).concat(Object.values(k.enemy[w]??[])).filter(e=>{const t=Math.max(0,(e.expirationTimestamp-o)/1e3);return e.remainingDuration=t>=999?"":t.toFixed(t>.05&&t<.95?1:0),Number(e.remainingDuration)>-3}));j({key:v.value[0].table.length.toString(),time:I,id:c,action:d,actionCN:h,source:w,target:x,targetId:r,job:F,jobIcon:M,jobEnum:N,amount:e.amount,keigenns:D,currentHp:y,maxHp:g,effect:C,type:T,shield:R[a.groups.targetId]??"0",povId:u.value}),v.value[0].duration=O(new Date(n[Pe.Ability.fields.timestamp]).getTime()-b.value)}}}}}}function H(e){return[h.value[e],f.value.find(t=>t.id===e)??{job:0,timestamp:0}].sort((e,t)=>t.timestamp-e.timestamp)[0].job}function j(e){v.value[0].table.unshift(e)}function N(e){0!==b.value&&(v.value[0].duration=O(e-b.value),v.value[0]=fe(v.value[0]),b.value=0,k.friendly={},k.enemy={},M())}function M(){i&&localStorage.setItem($r,JSON.stringify(v.value.filter(e=>"placeholder"!==e.key&&e.timestamp>0).slice().sort((e,t)=>t.timestamp-e.timestamp).slice(0,3)))}function O(e){const t=Math.max(Math.floor(e/6e4),0),a=Math.max(Math.floor((e-6e4*t)/1e3),0);return`${t<10?"0":""}${t}:${a<10?"0":""}${a}`}function A(){n.value=!n.value}function L(){const e={...v.value[0].table[0],key:crypto.randomUUID()};v.value[0].table.unshift(e)}return r.isBrowser&&(c.value="测试用户"),""!==c.value&&r.initEnvironment(c.value),F(()=>{const e=Re({storageKey:"keigenn-record-2-theme"}),t=ke(e);!1===e.value&&t();for(const a in h.value){const e=h.value[a];Date.now()-e.timestamp>864e5&&Reflect.deleteProperty(h.value,a)}!function(){const e=localStorage.getItem($r);if(e)try{const t=JSON.parse(e);v.value.length=0,v.value.push(...t)}catch(t){throw v.value.length=0,t}}(),_e("LogLine",e=>{I(e.rawLine)}),_e("PartyChanged",e=>{f.value=e.party.map(e=>({...e,timestamp:Date.now()}))}),_e("ChangePrimaryPlayer",e=>{c.value=e.charName,u.value=Number(e.charID).toString(16).toUpperCase()})}),(e,a)=>{const s=$e,i=ze,c=Ve,d=Dr,u=Ja;return Z(),Y(D,null,[X("div",{class:"wrapper",style:se({"--scale":m(l).scale,"--opacity":m(l).opacity}),onContextmenu:a[1]||(a[1]=y(()=>{},["prevent"]))},[X("header",null,[X("div",Ar,[de(E(i,{modelValue:m(g),"onUpdate:modelValue":a[0]||(a[0]=e=>me(g)?g.value=e:null),size:"small",class:le(["combat-select",m(r).isBrowser?"browser":"act"]),"popup-class-name":"combat-select-popup",offset:0,"show-arrow":!1},{default:ee(()=>[(Z(!0),Y(D,null,ne(m(v).length,e=>(Z(),Q(s,{key:`${m(v)[e-1].key}-${m(v)[e-1].duration}-${m(v)[e-1].zoneName}`,value:e-1,label:`${m(v)[e-1].duration} ${m(v)[e-1].zoneName}`},null,8,["value","label"]))),128))]),_:1},8,["modelValue","class"]),[[ue,!m(n)]])]),m(r).isBrowser?te("",!0):(Z(),Q(c,{key:0,class:le(["minimize",m(n)?"in-minimize":"not-minimize"]),icon:m(n)?m(pe):m(he),circle:"",style:se({opacity:m(n)?.5:1}),onClick:A},null,8,["class","icon","style"]))]),de(X("main",Lr,[E(d,{rows:m(v)[m(g)].table,"action-key":m(o)},null,8,["rows","action-key"])],512),[[ue,!m(n)]])],36),m(r).isBrowser||m(t)?(Z(),Y("div",zr,[m(t)?(Z(),Q(c,{key:0,onClick:L},{default:ee(()=>a[2]||(a[2]=[re(" 测试 ",-1)])),_:1,__:[2]})):te("",!0),E(u,{"m-1":"",onBeforeHandle:C,onAfterHandle:T,onHandleLine:I})])):te("",!0)],64)}}}),[["__scopeId","data-v-b2ec4bd3"]]);export{Wr as default};
