import{_ as e}from"./ActWrapper-C4mLrMUb.js";import{a,r as t,c as n}from"./overlay_plugin_api-DHbPkDtN.js";import{d as s,f as i,i as o,aG as c,k as r,w as m,o as l,c as p,G as u,u as d,t as f}from"./index-Bs3XIB3F.js";import{_ as I}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./useDev-CtxOMi7C.js";import"./useDemo-odHMXSXp.js";import"./index-C4zhJhmZ.js";const _={key:0},D={key:1},g=I(s({__name:"instancedAreaInfo",setup(s){const I=i({islandId:0,instanceNum:""}),g=[732,763,795,827,920,975,1252],h=Object.fromEntries(g.map(e=>[e,new Map])),j=async e=>{if(!g.includes(e.zoneID))return void(I.islandId=0);const a=(await n({call:"getCombatants"})).combatants.filter(e=>541===e.BNpcNameID&&e.ID).sort((e,a)=>e.ID-a.ID)[0];if(!a)return;const t=a.ID-1073741824,s=Date.now(),i=h[e.zoneID],o=i.get(t);if(I.islandId=t,o){const e=s-o.timestamp,a=`这个岛${e<6e4?`${Math.floor(e/1e3)}秒`:`${Math.floor(e/6e4)}分钟`}前来过，是第${o.count}个遇到的岛`;o.timestamp=s,n({call:"cactbotSay",text:a})}else{i.set(t,{timestamp:s,count:i.size+1});const e=`这个岛第一次来，现在总共遇到了${i.size}个岛`;n({call:"cactbotSay",text:e})}},N={"":"①","":"②","":"③","":"④","":"⑤","":"⑥","":"⑦","":"⑧","":"⑨"},b=e=>{if("00"===e.line[0]&&"0039"===e.line[2]){const a=e.line[4].match(/当前所在副本区为“([^”]+)(?<instance>[])”/)??e.line[4].match(/You are now in the instanced area (.+?)(?<instance>[])”/)??e.line[4].match(/インスタンスエリア「(.+?)(?<instance>[])」/);a&&(I.instanceNum=N[a.groups?.instance])}else"01"===e.line[0]&&(I.instanceNum="")};return o(()=>{a("LogLine",b),a("ChangeZone",j)}),c(()=>{t("LogLine",b),t("ChangeZone",j)}),(a,t)=>{const n=e;return l(),r(n,null,{default:m(()=>[d(I).instanceNum?(l(),p("p",_,f(d(I).instanceNum),1)):u("",!0),d(I).islandId?(l(),p("p",D,f(d(I).islandId)+"号岛 ",1)):u("",!0)]),_:1})}}}),[["__scopeId","data-v-db42191a"]]);export{g as default};
