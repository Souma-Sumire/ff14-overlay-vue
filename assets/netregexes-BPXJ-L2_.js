const e={GameLog:{type:"00",name:"GameLog",source:"FFXIV_ACT_Plugin",messageType:"ChatLog",fields:{type:0,timestamp:1,code:2,name:3,line:4},subFields:{code:{"0039":{name:"message",canAnonymize:!0},"0038":{name:"echo",canAnonymize:!0},"0044":{name:"dialog",canAnonymize:!0},"0839":{name:"message",canAnonymize:!0}}},firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{code:["0044","0839"]}}},ChangeZone:{type:"01",name:"ChangeZone",source:"FFXIV_ACT_Plugin",messageType:"Territory",fields:{type:0,timestamp:1,id:2,name:3},lastInclude:!0,canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all"}},ChangedPlayer:{type:"02",name:"ChangedPlayer",source:"FFXIV_ACT_Plugin",messageType:"ChangePrimaryPlayer",fields:{type:0,timestamp:1,id:2,name:3},playerIds:{2:3},lastInclude:!0,canAnonymize:!0,firstOptionalField:void 0},AddedCombatant:{type:"03",name:"AddedCombatant",source:"FFXIV_ACT_Plugin",messageType:"AddCombatant",fields:{type:0,timestamp:1,id:2,name:3,job:4,level:5,ownerId:6,worldId:7,world:8,npcNameId:9,npcBaseId:10,currentHp:11,hp:12,currentMp:13,mp:14,x:17,y:18,z:19,heading:20},playerIds:{2:3,6:null},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{id:"4.{7}"},combatantIdFields:2}},RemovedCombatant:{type:"04",name:"RemovedCombatant",source:"FFXIV_ACT_Plugin",messageType:"RemoveCombatant",fields:{type:0,timestamp:1,id:2,name:3,job:4,level:5,owner:6,world:8,npcNameId:9,npcBaseId:10,currentHp:11,hp:12,currentMp:13,mp:14,x:17,y:18,z:19,heading:20},playerIds:{2:3,6:null},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{id:"4.{7}"},combatantIdFields:2}},PartyList:{type:"11",name:"PartyList",source:"FFXIV_ACT_Plugin",messageType:"PartyList",fields:{type:0,timestamp:1,partyCount:2,id0:3,id1:4,id2:5,id3:6,id4:7,id5:8,id6:9,id7:10,id8:11,id9:12,id10:13,id11:14,id12:15,id13:16,id14:17,id15:18,id16:19,id17:20,id18:21,id19:22,id20:23,id21:24,id22:25,id23:26},playerIds:{3:null,4:null,5:null,6:null,7:null,8:null,9:null,10:null,11:null,12:null,13:null,14:null,15:null,16:null,17:null,18:null,19:null,20:null,21:null,22:null,23:null,24:null,25:null,26:null},firstOptionalField:3,canAnonymize:!0,lastInclude:!0},PlayerStats:{type:"12",name:"PlayerStats",source:"FFXIV_ACT_Plugin",messageType:"PlayerStats",fields:{type:0,timestamp:1,job:2,strength:3,dexterity:4,vitality:5,intelligence:6,mind:7,piety:8,attackPower:9,directHit:10,criticalHit:11,attackMagicPotency:12,healMagicPotency:13,determination:14,skillSpeed:15,spellSpeed:16,tenacity:18,localContentId:19},canAnonymize:!0,lastInclude:!0,firstOptionalField:void 0},StartsUsing:{type:"20",name:"StartsUsing",source:"FFXIV_ACT_Plugin",messageType:"StartsCasting",fields:{type:0,timestamp:1,sourceId:2,source:3,id:4,ability:5,targetId:6,target:7,castTime:8,x:9,y:10,z:11,heading:12},possibleRsvFields:5,blankFields:[6],playerIds:{2:3,6:7},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{sourceId:"4.{7}"},combatantIdFields:[2,6]}},Ability:{type:"21",name:"Ability",source:"FFXIV_ACT_Plugin",messageType:"ActionEffect",fields:{type:0,timestamp:1,sourceId:2,source:3,id:4,ability:5,targetId:6,target:7,flags:8,damage:9,targetCurrentHp:24,targetMaxHp:25,targetCurrentMp:26,targetMaxMp:27,targetX:30,targetY:31,targetZ:32,targetHeading:33,currentHp:34,maxHp:35,currentMp:36,maxMp:37,x:40,y:41,z:42,heading:43,sequence:44,targetIndex:45,targetCount:46,ownerId:47,ownerName:48,effectDisplayType:49,actionId:50,actionAnimationId:51,animationLockTime:52,rotationHex:53},possibleRsvFields:5,playerIds:{2:3,6:7,47:48},blankFields:[6,47,48],canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{sourceId:"4.{7}"},combatantIdFields:[2,6]}},NetworkAOEAbility:{type:"22",name:"NetworkAOEAbility",source:"FFXIV_ACT_Plugin",messageType:"AOEActionEffect",fields:{type:0,timestamp:1,sourceId:2,source:3,id:4,ability:5,targetId:6,target:7,flags:8,damage:9,targetCurrentHp:24,targetMaxHp:25,targetCurrentMp:26,targetMaxMp:27,targetX:30,targetY:31,targetZ:32,targetHeading:33,currentHp:34,maxHp:35,currentMp:36,maxMp:37,x:40,y:41,z:42,heading:43,sequence:44,targetIndex:45,targetCount:46,ownerId:47,ownerName:48,effectDisplayType:49,actionId:50,actionAnimationId:51,animationLockTime:52,rotationHex:53},possibleRsvFields:5,playerIds:{2:3,6:7,47:48},blankFields:[6,47,48],canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{sourceId:"4.{7}"},combatantIdFields:[2,6]}},NetworkCancelAbility:{type:"23",name:"NetworkCancelAbility",source:"FFXIV_ACT_Plugin",messageType:"CancelAction",fields:{type:0,timestamp:1,sourceId:2,source:3,id:4,name:5,reason:6},possibleRsvFields:5,playerIds:{2:3},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{sourceId:"4.{7}"},combatantIdFields:2}},NetworkDoT:{type:"24",name:"NetworkDoT",source:"FFXIV_ACT_Plugin",messageType:"DoTHoT",fields:{type:0,timestamp:1,id:2,name:3,which:4,effectId:5,damage:6,currentHp:7,maxHp:8,currentMp:9,maxMp:10,x:13,y:14,z:15,heading:16,sourceId:17,source:18,damageType:19,sourceCurrentHp:20,sourceMaxHp:21,sourceCurrentMp:22,sourceMaxMp:23,sourceX:26,sourceY:27,sourceZ:28,sourceHeading:29},playerIds:{2:3,17:18},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{id:"1.{7}",which:"DoT",effectId:"0*?[1-9A-F][0-9A-F]*"},combatantIdFields:[2,17]}},WasDefeated:{type:"25",name:"WasDefeated",source:"FFXIV_ACT_Plugin",messageType:"Death",fields:{type:0,timestamp:1,targetId:2,target:3,sourceId:4,source:5},playerIds:{2:3,4:5},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{targetId:"4.{7}"},combatantIdFields:2}},GainsEffect:{type:"26",name:"GainsEffect",source:"FFXIV_ACT_Plugin",messageType:"StatusAdd",fields:{type:0,timestamp:1,effectId:2,effect:3,duration:4,sourceId:5,source:6,targetId:7,target:8,count:9,targetMaxHp:10,sourceMaxHp:11},possibleRsvFields:3,playerIds:{5:6,7:8},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:[{sourceId:"[E4].{7}",targetId:"1.{7}"},{sourceId:"[E4].{7}",targetId:"4.{7}"},{effectId:["B9A","808"]}],combatantIdFields:[5,7]}},HeadMarker:{type:"27",name:"HeadMarker",source:"FFXIV_ACT_Plugin",messageType:"TargetIcon",fields:{type:0,timestamp:1,targetId:2,target:3,id:6,data0:7},playerIds:{2:3},possiblePlayerIds:[7],canAnonymize:!0,firstOptionalField:7,analysisOptions:{include:"all",combatantIdFields:2}},NetworkRaidMarker:{type:"28",name:"NetworkRaidMarker",source:"FFXIV_ACT_Plugin",messageType:"WaymarkMarker",fields:{type:0,timestamp:1,operation:2,waymark:3,id:4,name:5,x:6,y:7,z:8},playerIds:{4:5},canAnonymize:!0,firstOptionalField:void 0},NetworkTargetMarker:{type:"29",name:"NetworkTargetMarker",source:"FFXIV_ACT_Plugin",messageType:"SignMarker",fields:{type:0,timestamp:1,operation:2,waymark:3,id:4,name:5,targetId:6,targetName:7},playerIds:{4:5,6:7},firstOptionalField:void 0},LosesEffect:{type:"30",name:"LosesEffect",source:"FFXIV_ACT_Plugin",messageType:"StatusRemove",fields:{type:0,timestamp:1,effectId:2,effect:3,sourceId:5,source:6,targetId:7,target:8,count:9},possibleRsvFields:3,playerIds:{5:6,7:8},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:[{sourceId:"[E4].{7}",targetId:"1.{7}"},{sourceId:"[E4].{7}",targetId:"4.{7}"},{effectId:["B9A","808"]}],combatantIdFields:[5,7]}},NetworkGauge:{type:"31",name:"NetworkGauge",source:"FFXIV_ACT_Plugin",messageType:"Gauge",fields:{type:0,timestamp:1,id:2,data0:3,data1:4,data2:5,data3:6},playerIds:{2:null},firstUnknownField:3,canAnonymize:!0,firstOptionalField:void 0},NetworkWorld:{type:"32",name:"NetworkWorld",source:"FFXIV_ACT_Plugin",messageType:"World",fields:{type:0,timestamp:1},isUnknown:!0,firstOptionalField:void 0},ActorControl:{type:"33",name:"ActorControl",source:"FFXIV_ACT_Plugin",messageType:"Director",fields:{type:0,timestamp:1,instance:2,command:3,data0:4,data1:5,data2:6,data3:7},possiblePlayerIds:[4,5,6,7],canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},NameToggle:{type:"34",name:"NameToggle",source:"FFXIV_ACT_Plugin",messageType:"NameToggle",fields:{type:0,timestamp:1,id:2,name:3,targetId:4,targetName:5,toggle:6},playerIds:{2:3,4:5},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},Tether:{type:"35",name:"Tether",source:"FFXIV_ACT_Plugin",messageType:"Tether",fields:{type:0,timestamp:1,sourceId:2,source:3,targetId:4,target:5,id:8},playerIds:{2:3,4:5},canAnonymize:!0,firstUnknownField:9,firstOptionalField:void 0,analysisOptions:{include:"all",combatantIdFields:[2,4]}},LimitBreak:{type:"36",name:"LimitBreak",source:"FFXIV_ACT_Plugin",messageType:"LimitBreak",fields:{type:0,timestamp:1,valueHex:2,bars:3},canAnonymize:!0,firstOptionalField:void 0},NetworkEffectResult:{type:"37",name:"NetworkEffectResult",source:"FFXIV_ACT_Plugin",messageType:"EffectResult",fields:{type:0,timestamp:1,id:2,name:3,sequenceId:4,currentHp:5,maxHp:6,currentMp:7,maxMp:8,currentShield:9,x:11,y:12,z:13,heading:14},playerIds:{2:3},firstUnknownField:22,canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},StatusEffect:{type:"38",name:"StatusEffect",source:"FFXIV_ACT_Plugin",messageType:"StatusList",fields:{type:0,timestamp:1,targetId:2,target:3,jobLevelData:4,hp:5,maxHp:6,mp:7,maxMp:8,currentShield:9,x:11,y:12,z:13,heading:14,data0:15,data1:16,data2:17,data3:18,data4:19,data5:20},playerIds:{2:3},firstUnknownField:18,canAnonymize:!0,firstOptionalField:18},NetworkUpdateHP:{type:"39",name:"NetworkUpdateHP",source:"FFXIV_ACT_Plugin",messageType:"UpdateHp",fields:{type:0,timestamp:1,id:2,name:3,currentHp:4,maxHp:5,currentMp:6,maxMp:7,x:10,y:11,z:12,heading:13},playerIds:{2:3},canAnonymize:!0,firstOptionalField:void 0},Map:{type:"40",name:"Map",source:"FFXIV_ACT_Plugin",messageType:"ChangeMap",fields:{type:0,timestamp:1,id:2,regionName:3,placeName:4,placeNameSub:5},canAnonymize:!0,firstOptionalField:void 0,lastInclude:!0,analysisOptions:{include:"all"}},SystemLogMessage:{type:"41",name:"SystemLogMessage",source:"FFXIV_ACT_Plugin",messageType:"SystemLogMessage",fields:{type:0,timestamp:1,instance:2,id:3,param0:4,param1:5,param2:6},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all"}},StatusList3:{type:"42",name:"StatusList3",source:"FFXIV_ACT_Plugin",messageType:"StatusList3",fields:{type:0,timestamp:1,id:2,name:3},playerIds:{2:3},canAnonymize:!0,firstOptionalField:4,firstUnknownField:4},ParserInfo:{type:"249",name:"ParserInfo",source:"FFXIV_ACT_Plugin",messageType:"Settings",fields:{type:0,timestamp:1},globalInclude:!0,canAnonymize:!0,firstOptionalField:void 0},ProcessInfo:{type:"250",name:"ProcessInfo",source:"FFXIV_ACT_Plugin",messageType:"Process",fields:{type:0,timestamp:1},globalInclude:!0,canAnonymize:!0,firstOptionalField:void 0},Debug:{type:"251",name:"Debug",source:"FFXIV_ACT_Plugin",messageType:"Debug",fields:{type:0,timestamp:1},globalInclude:!0,canAnonymize:!1,firstOptionalField:void 0},PacketDump:{type:"252",name:"PacketDump",source:"FFXIV_ACT_Plugin",messageType:"PacketDump",fields:{type:0,timestamp:1},canAnonymize:!1,firstOptionalField:void 0},Version:{type:"253",name:"Version",source:"FFXIV_ACT_Plugin",messageType:"Version",fields:{type:0,timestamp:1},globalInclude:!0,canAnonymize:!0,firstOptionalField:void 0},Error:{type:"254",name:"Error",source:"FFXIV_ACT_Plugin",messageType:"Error",fields:{type:0,timestamp:1},canAnonymize:!1,firstOptionalField:void 0},None:{type:"[0-9]+",name:"None",source:"FFXIV_ACT_Plugin",messageType:"None",fields:{type:0,timestamp:1},isUnknown:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},LineRegistration:{type:"256",name:"LineRegistration",source:"OverlayPlugin",messageType:"256",fields:{type:0,timestamp:1,id:2,source:3,name:4,version:5},globalInclude:!0,canAnonymize:!0,firstOptionalField:void 0},MapEffect:{type:"257",name:"MapEffect",source:"OverlayPlugin",messageType:"257",fields:{type:0,timestamp:1,instance:2,flags:3,location:4,data0:5,data1:6},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all"}},FateDirector:{type:"258",name:"FateDirector",source:"OverlayPlugin",messageType:"258",fields:{type:0,timestamp:1,category:2,fateId:4,progress:5},canAnonymize:!0,firstOptionalField:void 0},CEDirector:{type:"259",name:"CEDirector",source:"OverlayPlugin",messageType:"259",fields:{type:0,timestamp:1,popTime:2,timeRemaining:3,ceKey:5,numPlayers:6,status:7,progress:9},canAnonymize:!0,firstOptionalField:void 0},InCombat:{type:"260",name:"InCombat",source:"OverlayPlugin",messageType:"260",fields:{type:0,timestamp:1,inACTCombat:2,inGameCombat:3,isACTChanged:4,isGameChanged:5},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all"}},CombatantMemory:{type:"261",name:"CombatantMemory",source:"OverlayPlugin",messageType:"261",fields:{type:0,timestamp:1,change:2,id:3},canAnonymize:!0,firstOptionalField:5,repeatingFields:{startingIndex:4,label:"pair",names:["key","value"],sortKeys:!0,primaryKey:"key",possibleKeys:["CurrentWorldID","WorldID","WorldName","BNpcID","BNpcNameID","PartyType","ID","OwnerID","WeaponId","Type","Job","Level","Name","CurrentHP","MaxHP","CurrentMP","MaxMP","PosX","PosY","PosZ","Heading","MonsterType","Status","ModelStatus","AggressionStatus","TargetID","IsTargetable","Radius","Distance","EffectiveDistance","NPCTargetID","CurrentGP","MaxGP","CurrentCP","MaxCP","PCTargetID","IsCasting1","IsCasting2","CastBuffID","CastTargetID","CastGroundTargetX","CastGroundTargetY","CastGroundTargetZ","CastDurationCurrent","CastDurationMax","TransformationId"],keysToAnonymize:{3:"Name",OwnerID:null,TargetID:null,PCTargetID:null,NPCTargetID:null,CastTargetID:null}},analysisOptions:{include:"filter",filters:[{id:"4.{7}",change:"Change",pair:[{key:"ModelStatus",value:".*"}]},{id:"4.{7}",change:"Change",pair:[{key:"WeaponId",value:".*"}]},{id:"4.{7}",change:"Change",pair:[{key:"TransformationId",value:".*"}]}],combatantIdFields:3}},RSVData:{type:"262",name:"RSVData",source:"OverlayPlugin",messageType:"262",fields:{type:0,timestamp:1,locale:2,key:4,value:5},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},StartsUsingExtra:{type:"263",name:"StartsUsingExtra",source:"OverlayPlugin",messageType:"263",fields:{type:0,timestamp:1,sourceId:2,id:3,x:4,y:5,z:6,heading:7},playerIds:{2:null},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{sourceId:"4.{7}"},combatantIdFields:2}},AbilityExtra:{type:"264",name:"AbilityExtra",source:"OverlayPlugin",messageType:"264",fields:{type:0,timestamp:1,sourceId:2,id:3,globalEffectCounter:4,dataFlag:5,x:6,y:7,z:8,heading:9,animationTargetId:10},blankFields:[6,7,8],playerIds:{2:null},canAnonymize:!0,firstOptionalField:void 0},ContentFinderSettings:{type:"265",name:"ContentFinderSettings",source:"OverlayPlugin",messageType:"265",fields:{type:0,timestamp:1,zoneId:2,zoneName:3,inContentFinderContent:4,unrestrictedParty:5,minimalItemLevel:6,silenceEcho:7,explorerMode:8,levelSync:9},canAnonymize:!0,firstOptionalField:void 0},NpcYell:{type:"266",name:"NpcYell",source:"OverlayPlugin",messageType:"266",fields:{type:0,timestamp:1,npcId:2,npcNameId:3,npcYellId:4},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all",combatantIdFields:2}},BattleTalk2:{type:"267",name:"BattleTalk2",source:"OverlayPlugin",messageType:"267",fields:{type:0,timestamp:1,npcId:2,instance:3,npcNameId:4,instanceContentTextId:5,displayMs:6},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all",combatantIdFields:2}},Countdown:{type:"268",name:"Countdown",source:"OverlayPlugin",messageType:"268",fields:{type:0,timestamp:1,id:2,worldId:3,countdownTime:4,result:5,name:6},playerIds:{2:6},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},CountdownCancel:{type:"269",name:"CountdownCancel",source:"OverlayPlugin",messageType:"269",fields:{type:0,timestamp:1,id:2,worldId:3,name:4},playerIds:{2:4},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},ActorMove:{type:"270",name:"ActorMove",source:"OverlayPlugin",messageType:"270",fields:{type:0,timestamp:1,id:2,heading:3,x:6,y:7,z:8},playerIds:{2:null},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},ActorSetPos:{type:"271",name:"ActorSetPos",source:"OverlayPlugin",messageType:"271",fields:{type:0,timestamp:1,id:2,heading:3,x:6,y:7,z:8},playerIds:{2:null},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{id:"4.{7}"},combatantIdFields:2}},SpawnNpcExtra:{type:"272",name:"SpawnNpcExtra",source:"OverlayPlugin",messageType:"272",fields:{type:0,timestamp:1,id:2,parentId:3,tetherId:4,animationState:5},playerIds:{3:null},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all",combatantIdFields:[2,3]}},ActorControlExtra:{type:"273",name:"ActorControlExtra",source:"OverlayPlugin",messageType:"273",fields:{type:0,timestamp:1,id:2,category:3,param1:4,param2:5,param3:6,param4:7},playerIds:{2:null},possiblePlayerIds:[4,5,6,7],canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all",combatantIdFields:2}},ActorControlSelfExtra:{type:"274",name:"ActorControlSelfExtra",source:"OverlayPlugin",messageType:"274",fields:{type:0,timestamp:1,id:2,category:3,param1:4,param2:5,param3:6,param4:7,param5:8,param6:9},playerIds:{2:null},possiblePlayerIds:[4,5,6,7,8,9],canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all",combatantIdFields:2}}},t={latest:e},a=t.latest;class i extends Error{constructor(){super("This code shouldn't be reached")}}const n="[^:]*",s=["effect","ability"],r=(e,t)=>{if(!0!==e)return!1;if(void 0===t)return!0;if(!Array.isArray(t))return!1;for(const a of t)if("object"!=typeof a)return!1;return!0},o=(e,o)=>((e,t,o)=>{e=e??{};const d=[];for(const a in o){const e=o[a];e&&d.push(e.field)}l.validateParams(e,t,["capture",...d]);const c=l.trueIfUndefined(e.capture),p=Object.keys(o).sort((e,t)=>parseInt(e)-parseInt(t));let m;if(c){const t=[];for(const e in o)t.push(e);let a=t.pop();if(void 0===a)m=p[p.length-1]??"0";else{for(;o[a]?.optional&&!((o[a]?.field??"")in e);)a=t.pop();m=a??"0"}}else{m="0";for(const t in o){if("object"!=typeof(o[t]??{}))continue;const a=o[t]?.field;void 0!==a&&a in e&&(m=t)}}const y=parseInt(m),u=`(?:${a.Ability.messageType}|${a.NetworkAOEAbility.messageType})`,g="Ability"!==t?a[t].messageType:u,f=parseInt(a[t].type).toString(16).toUpperCase(),I=f.length<2?`00${f}`.slice(-2):f,F="Ability"!==t?I:"(?:15|16)";let C="";C+=c?`(?<timestamp>\\y{Timestamp}) ${g} (?<type>${F})`:`\\y{Timestamp} ${g} ${F}`;let v=1;for(const a in o){const d=o[a];if(void 0===d)continue;const p=d.field;if("timestamp"===p||"type"===p)continue;const m=parseInt(a),u=m-v-1;if(1===u?C+=`:${n}`:u>1&&(C+=`(?::${n}){${u}}`),v=m,C+=":","object"!=typeof d)throw new Error(`${t}: invalid value: ${JSON.stringify(d)}`);const g=void 0!==p&&s.includes(p)?"(?:[^:]|: )*?":n,f=d.value?.toString()??g,I=e[p];if(r(o[a]?.repeating,I)){const e="(?:$|:)";let t=I;const s=o[a]?.sortKeys,r=o[a]?.primaryKey,d=o[a]?.possibleKeys;if(void 0===r||void 0===d)throw new i;s&&(d.sort((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase())),void 0!==t&&(t=[...t].sort((e,t)=>{if("object"!=typeof e||void 0===e[r])return 0;const a=e[r];if("string"!=typeof a||!d?.includes(a))return 0;if("object"!=typeof t||void 0===t[r])return 0;const i=t[r];return"string"==typeof i&&d?.includes(i)?a.toLowerCase().localeCompare(i.toLowerCase()):0})));const m=t;d.forEach(t=>{const i=m?.find(e=>r in e&&e[r]===t);let s="";o[a]?.repeatingKeys?.forEach(a=>{let o=i?.[a];void 0!==i&&a in i||(o=a===r?t:n),"string"!=typeof o&&(Array.isArray(o)?(o.length<1||o.some(e=>"string"!=typeof e))&&(o=n):o=n),s+=l.maybeCapture(a!==r&&c,p+t,o,f)+e}),s.length>0&&(C+=`(?:${s})${void 0!==i?"":"?"}`)})}else o[a]?.repeating||(C+=void 0!==p?l.maybeCapture(c,p,I,f):I);if(m>=y)break}return C+="(?:$|:)",l.parse(C)})(o,e,((e,a,i)=>{const n=t[a][e];void 0===i&&(i=Object.keys(n.fields),"repeatingFields"in n&&i.push(n.repeatingFields.label));const s={},r=n.firstOptionalField;for(const[t,o]of Object.entries(n.fields)){if(!i.includes(t))continue;const e={field:t,optional:void 0!==r&&o>=r};"type"===t&&(e.value=n.type),s[o]=e}return"repeatingFields"in n&&i.includes(n.repeatingFields.label)&&(s[n.repeatingFields.startingIndex]={field:n.repeatingFields.label,optional:void 0!==r&&n.repeatingFields.startingIndex>=r,repeating:!0,repeatingKeys:[...n.repeatingFields.names],sortKeys:n.repeatingFields.sortKeys,primaryKey:n.repeatingFields.primaryKey,possibleKeys:[...n.repeatingFields.possibleKeys]}),s})(e,l.logVersion));class l{static logVersion="latest";static startsUsing(e){return o("StartsUsing",e)}static ability(e){return o("Ability",e)}static abilityFull(e){return this.ability(e)}static headMarker(e){return o("HeadMarker",e)}static addedCombatant(e){return o("AddedCombatant",e)}static addedCombatantFull(e){return this.addedCombatant(e)}static removingCombatant(e){return o("RemovedCombatant",e)}static gainsEffect(e){return o("GainsEffect",e)}static statusEffectExplicit(e){return o("StatusEffect",e)}static losesEffect(e){return o("LosesEffect",e)}static tether(e){return o("Tether",e)}static wasDefeated(e){return o("WasDefeated",e)}static networkDoT(e){return o("NetworkDoT",e)}static echo(e){return void 0===e&&(e={}),l.validateParams(e,"echo",["type","timestamp","code","name","line","capture"]),e.code="0038",l.gameLog(e)}static dialog(e){return void 0===e&&(e={}),l.validateParams(e,"dialog",["type","timestamp","code","name","line","capture"]),e.code="0044",l.gameLog(e)}static message(e){return void 0===e&&(e={}),l.validateParams(e,"message",["type","timestamp","code","name","line","capture"]),e.code="0839",l.gameLog(e)}static gameLog(e){return o("GameLog",e)}static gameNameLog(e){return l.gameLog(e)}static statChange(e){return o("PlayerStats",e)}static changeZone(e){return o("ChangeZone",e)}static network6d(e){return o("ActorControl",e)}static nameToggle(e){return o("NameToggle",e)}static map(e){return o("Map",e)}static systemLogMessage(e){return o("SystemLogMessage",e)}static mapEffect(e){return o("MapEffect",e)}static fateDirector(e){return o("FateDirector",e)}static ceDirector(e){return o("CEDirector",e)}static inCombat(e){return o("InCombat",e)}static combatantMemory(e){return o("CombatantMemory",e)}static startsUsingExtra(e){return o("StartsUsingExtra",e)}static abilityExtra(e){return o("AbilityExtra",e)}static contentFinderSettings(e){return o("ContentFinderSettings",e)}static npcYell(e){return o("NpcYell",e)}static battleTalk2(e){return o("BattleTalk2",e)}static countdown(e){return o("Countdown",e)}static countdownCancel(e){return o("CountdownCancel",e)}static actorMove(e){return o("ActorMove",e)}static actorSetPos(e){return o("ActorSetPos",e)}static spawnNpcExtra(e){return o("SpawnNpcExtra",e)}static actorControlExtra(e){return o("ActorControlExtra",e)}static actorControlSelfExtra(e){return o("ActorControlSelfExtra",e)}static maybeCapture(e,t,a,i){return void 0===a&&(a=i??n),a=l.anyOf(a),e?l.namedCapture(t,a):a}static optional(e){return`(?:${e})?`}static namedCapture(e,t){return e.includes(">"),e.includes("<"),`(?<${e}>${t})`}static anyOf(...e){let t=[];const[a]=e;return t=1===e.length?"string"==typeof a||a instanceof RegExp?[a]:Array.isArray(a)?a:[]:e,(e=>{const[t]=e;return void 0!==t&&1===e.length?`${t instanceof RegExp?t.source:t}`:`(?:${e.map(e=>e instanceof RegExp?e.source:e).join("|")})`})(t)}static parse(e){const t={Timestamp:"^.{14}",NetTimestamp:".{33}",NetField:"(?:[^|]*\\|)",LogType:"[0-9A-Fa-f]{2}",AbilityCode:"[0-9A-Fa-f]{1,8}",ObjectId:"[0-9A-F]{8}",Name:"(?:[^\\s:|]+(?: [^\\s:|]+)?|)",Float:"-?[0-9]+(?:[.,][0-9]+)?(?:E-?[0-9]+)?"};let a="i";return e instanceof RegExp&&(a+=(e.global?"g":"")+(e.multiline?"m":""),e=e.source),e=e.replace(/\\y\{(.*?)\}/g,(e,a)=>t[a]||e),new RegExp(e,a)}static parseGlobal(e){const t=l.parse(e);let a="gi";return e instanceof RegExp&&(a+=e.multiline?"m":""),new RegExp(t.source,a)}static trueIfUndefined(e){return void 0===e||!!e}static validateParams(e,t,a){if(null===e)return;if("object"!=typeof e)return;const i=Object.keys(e);for(const n of i)if(!a.includes(n))throw new Error(`${t}: invalid parameter '${n}'.  Valid params: ${JSON.stringify(a)}`)}}const d="\\|",c="[^|]*",p=/^\^\^/,m=["ability","name","source","target","line"],y={echo:"0038",dialog:"0044",message:"0839"},u={setAnimState:"003E",publicContentText:"0834",logMsg:"020F",logMsgParams:"0210"},g=(e,a,i)=>{const n=t[a][e];void 0===i&&(i=Object.keys(n.fields),"repeatingFields"in n&&i.push(n.repeatingFields.label));const s={},r=n.firstOptionalField;for(const[t,o]of Object.entries(n.fields)){if(!i.includes(t))continue;const e={field:t,optional:void 0!==r&&o>=r};"type"===t&&(e.value=n.type),s[o]=e}return"repeatingFields"in n&&i.includes(n.repeatingFields.label)&&(s[n.repeatingFields.startingIndex]={field:n.repeatingFields.label,optional:void 0!==r&&n.repeatingFields.startingIndex>=r,repeating:!0,repeatingKeys:[...n.repeatingFields.names],sortKeys:n.repeatingFields.sortKeys,primaryKey:n.repeatingFields.primaryKey,possibleKeys:[...n.repeatingFields.possibleKeys]}),s},f=(e,t)=>{if(!0!==e)return!1;if(void 0===t)return!0;if(!Array.isArray(t))return!1;for(const a of t)if("object"!=typeof a)return!1;return!0},I=(e,t,a)=>{e=e??{};const n=[];for(const i in a){const e=a[i];e&&n.push(e.field)}l.validateParams(e,t,["capture",...n]);const s=l.trueIfUndefined(e.capture),r=Object.keys(a).sort((e,t)=>parseInt(e)-parseInt(t));let o;if(s){const t=[];for(const e in a)t.push(e);let i=t.pop();if(void 0===i)o=r[r.length-1]??"0";else{for(;a[i]?.optional&&!((a[i]?.field??"")in e);)i=t.pop();o=i??"0"}}else{o="0";for(const t in a){if("object"!=typeof(a[t]??{}))continue;const i=a[t]?.field;void 0!==i&&i in e&&(o=t)}}const p=parseInt(o),y=Object.keys(e).filter(e=>m.includes(e));let u=C.flagTranslationsNeeded&&y.length>0?"^^":"^",g=-1;for(const m in a){const n=parseInt(m),r=n-g-1;1===r?u+="\\y{NetField}":r>1&&(u+=`\\y{NetField}{${r}}`),g=n;const o=a[m];if("object"!=typeof o)throw new Error(`${t}: invalid value: ${JSON.stringify(o)}`);const y=o.field,I=o.value?.toString()??c,F=e[y];if(f(a[m]?.repeating,F)){let e=F;const t=a[m]?.sortKeys,n=a[m]?.primaryKey,r=a[m]?.possibleKeys;if(void 0===n||void 0===r)throw new i;t&&(r.sort((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase())),void 0!==e&&(e=[...e].sort((e,t)=>{if("object"!=typeof e||void 0===e[n])return 0;const a=e[n];if("string"!=typeof a||!r?.includes(a))return 0;if("object"!=typeof t||void 0===t[n])return 0;const i=t[n];return"string"==typeof i&&r?.includes(i)?a.toLowerCase().localeCompare(i.toLowerCase()):0})));const o=e;r.forEach(e=>{const t=o?.find(t=>n in t&&t[n]===e);let i="";a[m]?.repeatingKeys?.forEach(a=>{let r=t?.[a];void 0!==t&&a in t||(r=a===n?e:c),"string"!=typeof r&&(Array.isArray(r)?(r.length<1||r.some(e=>"string"!=typeof e))&&(r=c):r=c),i+=l.maybeCapture(a!==n&&s,y+e,r,I)+d}),i.length>0&&(u+=`(?:${i})${void 0!==t?"":"?"}`)})}else a[m]?.repeating||(u+=void 0!==y?l.maybeCapture(s,y,F,I)+d:I+d);if(n>=p)break}return l.parse(u)},F=(e,t)=>I(t,e,g(e,C.logVersion));class C{static logVersion="latest";static flagTranslationsNeeded=!1;static setFlagTranslationsNeeded(e){C.flagTranslationsNeeded=e}static doesNetRegexNeedTranslation(e){const t="string"==typeof e?e:e.source;return!!p.exec(t)}static startsUsing(e){return F("StartsUsing",e)}static ability(e){return I(e,"Ability",{...g("Ability",C.logVersion),0:{field:"type",value:"2[12]",optional:!1}})}static abilityFull(e){return this.ability(e)}static headMarker(e){return F("HeadMarker",e)}static addedCombatant(e){return I(e,"AddedCombatant",g("AddedCombatant",C.logVersion))}static addedCombatantFull(e){return C.addedCombatant(e)}static removingCombatant(e){return F("RemovedCombatant",e)}static gainsEffect(e){return F("GainsEffect",e)}static statusEffectExplicit(e){return F("StatusEffect",e)}static losesEffect(e){return F("LosesEffect",e)}static tether(e){return F("Tether",e)}static wasDefeated(e){return F("WasDefeated",e)}static networkDoT(e){return F("NetworkDoT",e)}static echo(e){return void 0===e&&(e={}),l.validateParams(e,"Echo",["type","timestamp","code","name","line","capture"]),C.gameLog({...e,code:y.echo})}static dialog(e){return void 0===e&&(e={}),l.validateParams(e,"Dialog",["type","timestamp","code","name","line","capture"]),C.gameLog({...e,code:y.dialog})}static message(e){return void 0===e&&(e={}),l.validateParams(e,"Message",["type","timestamp","code","name","line","capture"]),C.gameLog({...e,code:y.message})}static gameLog(e){return F("GameLog",e)}static gameNameLog(e){return C.gameLog(e)}static statChange(e){return F("PlayerStats",e)}static changeZone(e){return F("ChangeZone",e)}static network6d(e){return F("ActorControl",e)}static nameToggle(e){return F("NameToggle",e)}static map(e){return F("Map",e)}static systemLogMessage(e){return F("SystemLogMessage",e)}static mapEffect(e){return F("MapEffect",e)}static fateDirector(e){return F("FateDirector",e)}static ceDirector(e){return F("CEDirector",e)}static inCombat(e){return F("InCombat",e)}static combatantMemory(e){return F("CombatantMemory",e)}static rsvData(e){return F("RSVData",e)}static startsUsingExtra(e){return F("StartsUsingExtra",e)}static abilityExtra(e){return F("AbilityExtra",e)}static contentFinderSettings(e){return F("ContentFinderSettings",e)}static npcYell(e){return F("NpcYell",e)}static battleTalk2(e){return F("BattleTalk2",e)}static countdown(e){return F("Countdown",e)}static countdownCancel(e){return F("CountdownCancel",e)}static actorMove(e){return F("ActorMove",e)}static actorSetPos(e){return F("ActorSetPos",e)}static spawnNpcExtra(e){return F("SpawnNpcExtra",e)}static actorControlExtra(e){return F("ActorControlExtra",e)}static actorControlSelfExtra(e){return F("ActorControlSelfExtra",e)}}const v={wipe:C.network6d({command:["40000010","4000000F"]}),cactbotWipeEcho:C.echo({line:"cactbot wipe.*?"}),userWipeEcho:C.echo({line:"end"})};export{C as N,l as R,i as U,u as a,v as c,y as g,a as l};
