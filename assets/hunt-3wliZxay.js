import{a as e,_ as a}from"./shared-common-CQtq0auS.js";import{h as t,x as n,u as r,G as l,b6 as o,o as i,w as c,c as s,n as u,b as m,d as y,f as p,e as d,F as h,r as f,a as v,i as x,g as N,y as w,p as j,v as g,s as T,t as z,z as b,dA as k}from"./vendor-vue-i6lpFrx4.js";import{h as A,f as I,Z as C,V as S,o as P}from"./shared-core-Cqp6K9za.js";import{M as $}from"./map-DW4z5uTS.js";import{m as E,a as O,j as _,c as B,s as V}from"./cactbot-DtpbXwrG.js";import{f as M,g as L,x as Y,V as F,U,S as R,a as X,E as Z,n as D,d as H,W as G,aG as J,aH as W,q,_ as K}from"./vendor-element-plus-C8e3lHeC.js";const Q=JSON.parse('[{"x":1094,"y":1080,"territory":"132","placeName":{"en":"Gridania Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":793,"y":1380,"territory":"153","placeName":{"en":"Camp Tranquil","ja":"キャンプ・トランキル","cn":"恬静路营地"}},{"x":1203,"y":953,"territory":"153","placeName":{"en":"Quarrymill","ja":"クォーリーミル","cn":"石场水车"}},{"x":736,"y":688,"territory":"130","placeName":{"en":"Ul\'dah Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":860,"y":1023,"territory":"129","placeName":{"en":"Limsa Lominsa Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":907,"y":811,"territory":"180","placeName":{"en":"Camp Overlook","ja":"キャンプ・オーバールック","cn":"瞭望阵营地"}},{"x":881,"y":967,"territory":"250","placeName":{"en":"Wolves\' Den Pier","ja":"ウルヴズジェイル係船場","cn":"狼狱停船场"}},{"x":1064,"y":356,"territory":"156","placeName":{"en":"Revenant\'s Toll","ja":"レヴナンツトール","cn":"丧灵钟"}},{"x":1024,"y":1023,"territory":"144","placeName":{"en":"Gold Saucer Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":897,"y":1114,"territory":"418","placeName":{"en":"Ishgard Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":1474,"y":1697,"territory":"397","placeName":{"en":"Falcon\'s Nest","ja":"ファルコンネスト","cn":"隼巢"}},{"x":1530,"y":1052,"territory":"398","placeName":{"en":"Tailfeather","ja":"テイルフェザー","cn":"尾羽集落"}},{"x":734,"y":1056,"territory":"398","placeName":{"en":"Anyx Trine","ja":"不浄の三塔","cn":"不洁三塔"}},{"x":466,"y":1322,"territory":"400","placeName":{"en":"Zenith","ja":"白亜の宮殿","cn":"天极白垩宫"}},{"x":1278,"y":1580,"territory":"400","placeName":{"en":"Moghome","ja":"モグモグホーム","cn":"莫古力之家"}},{"x":450,"y":626,"territory":"401","placeName":{"en":"Ok\' Zundu","ja":"オク・ズンド","cn":"尊杜集落"}},{"x":442,"y":1548,"territory":"401","placeName":{"en":"Camp Cloudtop","ja":"キャンプ・クラウドトップ","cn":"云顶营地"}},{"x":338,"y":454,"territory":"402","placeName":{"en":"Helix","ja":"ポート・ヘリックス","cn":"螺旋港"}},{"x":1312,"y":948,"territory":"478","placeName":{"en":"Idyllshire Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":1178,"y":1218,"territory":"635","placeName":{"en":"Rhalgr\'s Reach Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":1440,"y":1270,"territory":"612","placeName":{"en":"The Peering Stones","ja":"ピーリングストーンズ","cn":"对等石"}},{"x":395,"y":515,"territory":"612","placeName":{"en":"Castrum Oriens","ja":"カストルム・オリエンス","cn":"帝国东方堡"}},{"x":1135,"y":275,"territory":"620","placeName":{"en":"Ala Gannha","ja":"アラガーナ","cn":"阿拉加纳"}},{"x":753,"y":1770,"territory":"620","placeName":{"en":"Ala Ghiri","ja":"アラギリ","cn":"阿拉基利"}},{"x":373,"y":1005,"territory":"621","placeName":{"en":"Porta Praetoria","ja":"ポルタ・プレトリア","cn":"天营门"}},{"x":1640,"y":1675,"territory":"621","placeName":{"en":"The Ala Mhigan Quarter","ja":"アラミガン・クォーター","cn":"阿拉米格人居住区"}},{"x":1118,"y":950,"territory":"628","placeName":{"en":"Kugane Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":1384,"y":762,"territory":"613","placeName":{"en":"Tamamizu","ja":"碧のタマミズ","cn":"碧玉水"}},{"x":1112,"y":440,"territory":"613","placeName":{"en":"Crick","ja":"筋違砦","cn":"痉挛寨"}},{"x":1457,"y":933,"territory":"614","placeName":{"en":"Namai","ja":"ナマイ村","cn":"茨菰村"}},{"x":1269,"y":620,"territory":"614","placeName":{"en":"The House of the Fierce","ja":"烈士庵","cn":"烈士庵"}},{"x":1580,"y":1363,"territory":"622","placeName":{"en":"Reunion","ja":"再会の市","cn":"重逢集市"}},{"x":1102,"y":1057,"territory":"622","placeName":{"en":"The Dawn Throne","ja":"明けの玉座","cn":"晨曦王座"}},{"x":269,"y":1141,"territory":"622","placeName":{"en":"Dhoro Iloh","ja":"ドーロ・イロー","cn":"朵洛衣楼"}},{"x":1178,"y":1218,"territory":"635","placeName":{"en":"Rhalgr\'s Reach Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":1118,"y":950,"territory":"628","placeName":{"en":"Kugane Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":1286,"y":1100,"territory":"759","placeName":{"en":"Doman Enclave Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":1778,"y":995,"territory":"813","placeName":{"en":"Fort Jobb","ja":"ジョッブ砦","cn":"乔布要塞"}},{"x":290,"y":795,"territory":"813","placeName":{"en":"The Ostall Imperative","ja":"オスタル厳命城","cn":"奥斯塔尔严命城"}},{"x":1692,"y":1313,"territory":"814","placeName":{"en":"Stilltide","ja":"スティルタイド","cn":"滞潮村"}},{"x":780,"y":1410,"territory":"814","placeName":{"en":"Wright","ja":"ライト村","cn":"工匠村"}},{"x":598,"y":400,"territory":"814","placeName":{"en":"Tomra","ja":"トメラの村","cn":"图姆拉村"}},{"x":1270,"y":800,"territory":"815","placeName":{"en":"Mord Souq","ja":"モルド・スーク","cn":"鼹灵集市"}},{"x":1423,"y":1332,"territory":"815","placeName":{"en":"The Inn at Journey\'s Head","ja":"旅立ちの宿","cn":"上路客店"}},{"x":513,"y":811,"territory":"815","placeName":{"en":"Twine","ja":"トゥワイン","cn":"络尾聚落"}},{"x":680,"y":1535,"territory":"816","placeName":{"en":"Lydha Lran","ja":"リダ・ラーン","cn":"群花馆"}},{"x":952,"y":167,"territory":"816","placeName":{"en":"Pla Enni","ja":"プラ・エンニ茸窟","cn":"普拉恩尼茸洞"}},{"x":1405,"y":337,"territory":"816","placeName":{"en":"Wolekdorf","ja":"ヴォレクドルフ","cn":"云村"}},{"x":921,"y":1321,"territory":"817","placeName":{"en":"Slitherbough","ja":"スリザーバウ","cn":"蛇行枝"}},{"x":1405,"y":830,"territory":"817","placeName":{"en":"Fanow","ja":"ファノヴの里","cn":"法诺村"}},{"x":1585,"y":825,"territory":"818","placeName":{"en":"The Ondo Cups","ja":"オンドの潮溜まり","cn":"鳍人潮池"}},{"x":882,"y":1242,"territory":"818","placeName":{"en":"The Macarenses Angle","ja":"マカレンサス広場","cn":"马克连萨斯广场"}},{"x":894,"y":1024,"territory":"819","placeName":{"en":"The Crystarium Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":1025,"y":1020,"territory":"820","placeName":{"en":"Eulmore Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":1025,"y":1025,"territory":"962","placeName":{"en":"Old Sharlayan Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":1076,"y":967,"territory":"963","placeName":{"en":"Radz-at-Han Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":1467,"y":545,"territory":"956","placeName":{"en":"The Archeion","ja":"アルケイオン保管院","cn":"公堂保管院"}},{"x":1032,"y":975,"territory":"956","placeName":{"en":"Sharlayan Hamlet","ja":"リトルシャーレアン","cn":"小萨雷安"}},{"x":294,"y":1326,"territory":"956","placeName":{"en":"Aporia","ja":"アポリア本部","cn":"无路总部"}},{"x":1220,"y":1652,"territory":"957","placeName":{"en":"Yedlihmad","ja":"イェドリマン","cn":"新港"}},{"x":498,"y":1060,"territory":"957","placeName":{"en":"The Great Work","ja":"デミールの遺烈郷","cn":"代米尔遗烈乡"}},{"x":1428,"y":777,"territory":"957","placeName":{"en":"Palaka\'s Stand","ja":"パーラカの里","cn":"波洛伽护法村"}},{"x":616,"y":1504,"territory":"958","placeName":{"en":"Camp Broken Glass","ja":"キャンプ・ブロークングラス","cn":"碎璃营地"}},{"x":1542,"y":845,"territory":"958","placeName":{"en":"Tertium","ja":"テルティウム駅","cn":"第三站"}},{"x":457,"y":1674,"territory":"959","placeName":{"en":"Sinus Lacrimarum","ja":"涙の入江","cn":"泪湾"}},{"x":1023,"y":511,"territory":"959","placeName":{"en":"Bestways Burrow","ja":"ベストウェイ・バロー","cn":"最佳威兔洞"}},{"x":480,"y":1290,"territory":"960","placeName":{"en":"Reah Tahra","ja":"リア・ターラ","cn":"半途终旅"}},{"x":1085,"y":365,"territory":"960","placeName":{"en":"Abode of the Ea","ja":"イーアの里","cn":"异亚村落"}},{"x":1515,"y":1355,"territory":"960","placeName":{"en":"Base Omicron","ja":"オミクロンベース","cn":"奥密克戎基地"}},{"x":1182,"y":1150,"territory":"961","placeName":{"en":"Anagnorisis","ja":"アナグノリシス天測園","cn":"醒悟天测园"}},{"x":390,"y":1566,"territory":"961","placeName":{"en":"The Twelve Wonders","ja":"十二節の園","cn":"十二奇园"}},{"x":493,"y":802,"territory":"961","placeName":{"en":"Poieten Oikos","ja":"ポイエテーン・オイコス","cn":"创作者之家"}},{"x":1070,"y":911,"territory":"1185","placeName":{"en":"Tuliyollal Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":1024,"y":1186,"territory":"1186","placeName":{"en":"Solution Nine Aetheryte Plaza","ja":"エーテライト・プラザ","cn":"以太之光广场"}},{"x":1356,"y":607,"territory":"1187","placeName":{"en":"Wachunpelo","ja":"ワチュン・ペロ","cn":"瓦丘恩佩洛"}},{"x":1490,"y":1659,"territory":"1187","placeName":{"en":"Worlar\'s Echo","ja":"ウォーラーの残響","cn":"沃拉的回响"}},{"x":854,"y":545,"territory":"1188","placeName":{"en":"Ok\'hanu","ja":"オック・ハヌ","cn":"哈努聚落"}},{"x":1565,"y":1228,"territory":"1188","placeName":{"en":"Many Fires","ja":"朋友の灯火","cn":"朋友的灯火"}},{"x":546,"y":1335,"territory":"1188","placeName":{"en":"Earthenshire","ja":"アースンシャイア","cn":"土陶郡"}},{"x":1812,"y":788,"territory":"1188","placeName":{"en":"Dock Poga","ja":"ポガ停船所","cn":"水果码头"}},{"x":626,"y":592,"territory":"1189","placeName":{"en":"Iq Br\'aax","ja":"イクブラーシャ","cn":"红豹村"}},{"x":1745,"y":1550,"territory":"1189","placeName":{"en":"Mamook","ja":"マムーク","cn":"玛穆克"}},{"x":1403,"y":1488,"territory":"1190","placeName":{"en":"Hhusatahwi","ja":"フーサタイ宿場町","cn":"胡萨塔伊驿镇"}},{"x":1335,"y":456,"territory":"1190","placeName":{"en":"Mehwahhetsoan","ja":"メワヘイゾーン","cn":"美花黑泽恩"}},{"x":732,"y":909,"territory":"1190","placeName":{"en":"Sheshenewezi Springs","ja":"シェシェネ青燐泉","cn":"谢申内青磷泉"}},{"x":1539,"y":1231,"territory":"1191","placeName":{"en":"Yyasulani Station","ja":"ヤースラニ駅","cn":"亚斯拉尼站"}},{"x":805,"y":1145,"territory":"1191","placeName":{"en":"Electrope Strike","ja":"エレクトロープ採石場","cn":"雷转质矿场"}},{"x":802,"y":441,"territory":"1191","placeName":{"en":"The Outskirts","ja":"アウトスカーツ","cn":"边郊镇"}},{"x":1024,"y":1821,"territory":"1192","placeName":{"en":"Leynode Mnemo","ja":"レイノード・メモリス","cn":"地场节点·忆"}},{"x":1681,"y":741,"territory":"1192","placeName":{"en":"Leynode Pyro","ja":"レイノード・ファイア","cn":"地场节点·火"}},{"x":769,"y":627,"territory":"1192","placeName":{"en":"Leynode Aero","ja":"レイノード・ウィンド","cn":"地场节点·风"}}]'),ee={key:0},ae={style:{position:"absolute",top:"1em",right:"1em","z-index":"22"}},te={"w-40":"",flex:""},ne={class:"flex items-center","w-40":"","p-l-2":""},re={class:"map-container",flex:"~ wrap"},le={class:"options","position-absolute":"","right-0":"","top-0":"","mr-2":"","mt-1":"",p0:""},oe={class:"option"},ie={class:"option"},ce={class:"option"},se={class:"option"},ue=["src"],me=["onClick"],ye=["innerHTML"],pe="",de=a(t({__name:"hunt",setup(a){const{wsConnected:t}=A({allowClose:!0,addWsParam:!0}),de={"7.0":"7.0 金曦之遗辉","6.0":"6.0 晓月之终途","5.0":"5.0 暗影之逆焰","4.0":"4.0 红莲之狂潮"},he=[_.Urqopacha,_.Kozamauka,_.YakTel,_.Shaaloani,_.HeritageFound,_.LivingMemory,_.Labyrinthos,_.Thavnair,_.Garlemald,_.MareLamentorum,_.Elpis,_.UltimaThule,_.Lakeland,_.AmhAraeng,_.IlMheg,_.Kholusia,_.TheRaktikaGreatwood,_.TheTempest,_.TheFringes,_.TheRubySea,_.ThePeaks,_.Yanxia,_.TheLochs,_.TheAzimSteppe],fe=n([]);function ve(e){switch(e){case _.Urqopacha:case _.Kozamauka:case _.YakTel:case _.Shaaloani:case _.HeritageFound:case _.LivingMemory:return"7.0";case _.Labyrinthos:case _.Thavnair:case _.Garlemald:case _.MareLamentorum:case _.Elpis:case _.UltimaThule:return"6.0";case _.AmhAraeng:case _.IlMheg:case _.Kholusia:case _.Lakeland:case _.TheRaktikaGreatwood:case _.TheTempest:return"5.0";case _.TheFringes:case _.TheRubySea:case _.ThePeaks:case _.Yanxia:case _.TheLochs:case _.TheAzimSteppe:default:return"4.0"}}const xe={1:["1"],2:["1-2","1","2"],3:["1-3","1","2","3"],4:["1-3","4-6","1","2","3","4","5","6"],5:["1-3","4-6","1","2","3","4","5","6"],6:["1-3","4-6","1","2","3","4","5","6"]},Ne=["255, 0, 0","255, 255, 0","0, 128, 255"],we=["255, 0, 0","240, 255, 0","0, 222, 255"],je={"--ins1-color":`rgba(${Ne[0]},0.4)`,"--ins2-color":`rgba(${Ne[1]},0.4)`,"--ins3-color":`rgba(${Ne[2]},0.4)`,"--ins4-color":`rgba(${Ne[0]},0.4)`,"--ins5-color":`rgba(${Ne[1]},0.4)`,"--ins6-color":`rgba(${Ne[2]},0.4)`},ge=["One","Two","Three","Four","A","B","C","D"],Te=.291015625,ze=n(-1),be=I(),ke={},Ae=new Set,Ie=r("souma-hunt-game-version","7.0"),Ce=r("souma-hunt-monsters-2",[]),Se=l(()=>Ce.value.filter(e=>fe.value.filter(e=>ve(e)===Ie.value).includes(e.zoneId))),Pe=l(()=>Object.fromEntries(he.map(e=>[e,xe[ma(e)]]))),$e=r("souma-hunt-show-number",!0),Ee=r("souma-hunt-play-sound",!1),Oe=r("souma-hunt-sound-volume",.2),_e=n({}),Be=r("souma-hunt-zone-id",n(-1)),Ve=r("souma-hunt-save-instance",ze.value),Me=r("souma-hunt-use-post-namazu",!1);o(()=>{_e.value=Object.fromEntries(he.map(e=>[e,xe[ma(e)][0]]))});for(const e of Object.values(E)){const{id:a,rank:t}=e;Object.entries(e.name).forEach(([e,n])=>{n&&(Array.isArray(n)?n.forEach(e=>{ke[e.toLowerCase()]={id:a,rank:t,name:e}}):ke[n.toLowerCase()]={id:a,rank:t,name:n})})}function Le(e){const a=(e.instance-1)%3;return`<span style='color:rgb(${we[a]})'>${e.number}</span>`}function Ye(){Ae.clear(),Se.value.forEach(e=>e.text=Le(e)),Se.value.forEach(e=>{if(!aa(e)||Ae.has(e.id))return;const a=Se.value.filter(a=>{const t=(n=e.worldX,r=e.worldY,l=a.worldX,o=a.worldY,{both:Math.sqrt((n-l)**2+(r-o)**2),x:Math.abs(n-l),y:Math.abs(r-o)});var n,r,l,o;return aa(a)&&!Ae.has(a.id)&&a.zoneId===e.zoneId&&t.both<35});a.length>=2?(a.forEach((e,a)=>{a>0&&Ae.add(e.id)}),a[0].text=a.toSorted((e,a)=>e.instance-a.instance).map(e=>Le(e)).join(" ")):a.forEach(e=>{e.text=Le(e)})}),Se.value.forEach(e=>{Ae.has(e.id)&&(e.text="")})}function Fe(){const e=(new Date).getTime(),a=Se.value.filter(a=>a.zoneId===Be.value&&e-a.timestamp<5e3);a.forEach(e=>{e.instance=ze.value;let t=-1;for(let n=1;n<=6;n++)if(!a.some(e=>e.number===n)){t=n;break}if(-1===t)return t=0,void(e.text="");e.number=t,e.text=t.toString()})}const Ue=e=>{Be.value=e.zoneID,Fe(),ze.value=1},Re=e=>{if(he.includes(Be.value))if("00"===e.line[0]&&"0039"===e.line[2]){const a=e.line[4].match(new RegExp(`(?:当前所在副本区为“|You are now in the instanced area |インスタンスエリア「)(?<zoneName>.+?)(?<zoneInstanced>[${pe}]).*`));a&&a.groups&&a.groups.zoneInstanced&&(ze.value=pe.indexOf(a.groups.zoneInstanced)+1,Ve.value=ze.value,M.close(),Fe(),We())}else if("03"===e.line[0]){const a=e.line[3],t=ke[a.toLowerCase()],n=t?.rank;if(t&&"A"===n){Ie.value=ve(Be.value);const a=ze.value,t=(new Date).getTime(),n=e.line[2],r=Number(e.line[17]),l=Number(e.line[18]),o=Number(e.line[19]),i=Ce.value.find(t=>t.id===e.line[2]&&t.zoneId===Be.value&&t.instance===a);if(i)i.timestamp=t,i.worldX=r,i.worldY=l,i.worldZ=o;else{const e=Ce.value.filter(e=>e.zoneId===Be.value&&e.instance===a);let i=-1;for(let a=1;a<=6;a++)if(!e.some(e=>e.number===a)){i=a;break}-1===i&&(i=0),Ce.value.push({timestamp:t,id:n,worldX:r,worldY:l,worldZ:o,zoneId:Be.value,instance:a,number:i,text:i.toString()}),Ee.value&&ia()}Ye(),We()}}else if("25"===e.line[0]){const a=e.line[2];Ce.value=Ce.value.filter(e=>e.id!==a),Ye(),We()}};function Xe(e,a){return Math.random()*(a-e)+e}function Ze(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let a="";for(let t=0;t<10;t++)a+=e.charAt(Math.floor(62*Math.random()));return a}async function De(e,a,t){ze.value=a,Be.value=e,Re({line:["03",(new Date).toISOString(),Ze(),"クイーンホーク","00","64","0000","00","","13361","17707","32956266","32956266","10000","10000","","",(323.26+Xe(-t,t)).toFixed(2),(56.25+Xe(-t,t)).toFixed(2),(58.79+Xe(-t,t)).toFixed(2),"-3.03","9b64e809cf609144"]}),await async function(e){return new Promise(a=>{setTimeout(()=>{a(!0)},1e3*e)})}(.2)}function He(){Ce.value=Ce.value.filter(e=>ve(e.zoneId)!==Ie.value)}function Ge(){(async()=>{He(),await De(fe.value[0],1,60),await De(fe.value[0],1,60),await De(fe.value[0],2,60),await De(fe.value[0],2,60),await De(fe.value[0],3,180),await De(fe.value[0],3,180),await De(fe.value[0],4,240),await De(fe.value[0],4,240),await De(fe.value[0],5,300),await De(fe.value[0],5,300),await De(fe.value[0],6,360),await De(fe.value[0],6,360),await De(fe.value[1],1,120),await De(fe.value[1],1,120)})()}function Je(){We()}function We(){if(!Me.value)return;const e=Se.value.filter(e=>e.zoneId===Be.value&&e.instance===ze.value).sort((e,a)=>e.number-a.number),a={A:{X:0,Y:0,Z:0,Active:!1},B:{X:0,Y:0,Z:0,Active:!1},C:{X:0,Y:0,Z:0,Active:!1},D:{X:0,Y:0,Z:0,Active:!1},One:{X:0,Y:0,Z:0,Active:!1},Two:{X:0,Y:0,Z:0,Active:!1},Three:{X:0,Y:0,Z:0,Active:!1},Four:{X:0,Y:0,Z:0,Active:!1}};ge.forEach((t,n)=>{const r=e[n];a[t]=r?{X:r.worldX,Y:r.worldZ,Z:r.worldY,Active:!0}:{X:0,Y:0,Z:0,Active:!1}}),B({call:"PostNamazu",c:"DoWaymarks",p:JSON.stringify(a)})}function qe(){M.confirm(`确定要清空「${de[Ie.value]}」全部已发现的怪物吗？`,"全部清空",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{He(),Ke()})}function Ke(){for(const e in _e.value){const a=Number(e);_e.value[a]=Pe.value[a][0]}}function Qe(e){return`ins${e.instance}`}function ea(e){return $e.value?e.text:""}function aa(e){const a=function(e){return _e.value[e.zoneId]}(e);if(a.includes("-")){const t=a.split("-").map(e=>Number(e)),n=t[t.length-1],r=t[0];return e.instance>=r&&e.instance<=n}return e.instance.toString()===a}function ta(e){const a=e.map(e=>{const{text:a,...t}=e;return t}),t=JSON.stringify(a),n=k.compressToEncodedURIComponent(t),r=document.createElement("textarea");r.value=n,document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r),K({title:"已复制到剪贴板",message:"请粘贴到记事本或其他地方",type:"success"})}function na(){ta(Se.value)}function ra(){M.prompt("请输入要导入的字符串","导入",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"textarea",inputValue:"",inputValidator:e=>{try{const a=k.decompressFromEncodedURIComponent(e),t=JSON.parse(a);return Array.isArray(t)?!t.every(e=>ve(e.zoneId)!==Ie.value)||`该字符串不属于「${de[Ie.value]}」，请检查`:"数据格式错误"}catch(a){return"数据格式错误"}}}).then(({value:e})=>{Promise.race([M.confirm("要舍弃当前的数据，并全部替换为导入的数据吗？","你的地图上还有怪物！",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),0===Se.value.length?Promise.resolve():new Promise(()=>{})]).then(()=>{const a=k.decompressFromEncodedURIComponent(e),t=JSON.parse(a),n=Ce.value.filter(e=>ve(e.zoneId)!==Ie.value);Ce.value=[...n,...t],Ye(),M.close(),K({title:"导入成功",message:`已导入${t.length}条数据`,type:"success"})}).catch(()=>{})})}function la(){M.prompt("请输入要导入的字符串","单独导入某个图",{confirmButtonText:"单独导入",cancelButtonText:"取消",inputType:"textarea",inputValue:"",inputValidator:e=>{try{const a=k.decompressFromEncodedURIComponent(e),t=JSON.parse(a);return 1!==new Set(t.map(e=>e.zoneId)).size?"导入的字符串不止一个地图，你是不是选错了？":!!Array.isArray(t)||"数据格式错误"}catch(a){return"数据格式错误"}}}).then(({value:e})=>{const a=k.decompressFromEncodedURIComponent(e),t=JSON.parse(a),n=$[t[0].zoneId].name.cn,r=Se.value.filter(e=>e.zoneId===t[0].zoneId);Promise.race([M.confirm("要舍弃当前的数据，并替换为导入的数据吗？",`你的「${n}」上还有怪物！`,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),0===r.length?Promise.resolve():new Promise(()=>{})]).then(()=>{Ce.value=[...Ce.value.filter(e=>e.zoneId!==t[0].zoneId),...t],Ye(),M.close(),K({title:"导入成功",message:`已导入${t.length}条数据`,type:"success"})}).catch(()=>{})})}function oa(){M.prompt("请输入要导入的字符串","单独导入某条线",{confirmButtonText:"单独导入",cancelButtonText:"取消",inputType:"textarea",inputValue:"",inputValidator:e=>{try{const a=k.decompressFromEncodedURIComponent(e),t=JSON.parse(a),n=new Set(t.map(e=>e.zoneId)),r=new Set(t.map(e=>e.instance));return 1!==n.size||1!==r.size?"导入的字符串不止一个地图或线，你是不是选错了？":!!Array.isArray(t)||"数据格式错误"}catch(a){return"数据格式错误"}}}).then(({value:e})=>{const a=k.decompressFromEncodedURIComponent(e),t=JSON.parse(a),n=$[t[0].zoneId].name.cn,r=t[0].instance.toString(),l=Se.value.filter(e=>e.zoneId===t[0].zoneId&&e.instance===t[0].instance);Promise.race([M.confirm("要舍弃当前的数据，并替换为导入的数据吗？",`你的「${n}」的${r}线上还有怪物！`,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),0===l.length?Promise.resolve():new Promise(()=>{})]).then(()=>{Ce.value=[...Ce.value.filter(e=>e.zoneId!==t[0].zoneId||e.instance!==t[0].instance),...t],Ye(),M.close(),K({title:"导入成功",message:`已导入${t.length}条数据`,type:"success"})}).catch(()=>{})})}function ia(){const e=new Audio(V);e.volume=Oe.value,e.play()}function ca(e,a){const t=function(e){return 2*Math.max(...Pe.value[e].filter(e=>/^[1-6]$/.test(e)).map(e=>Number(e)))}(e),n=Se.value.filter(a=>a.zoneId===e).length;return`${a+1}图 ${$[e].name.cn} / ${$[e].name.ja} / ${$[e].name.en} （${n}/${t}）${n===t?"✅":""}`}function sa(e){const a=C[e.zoneId],t=a.sizeFactor,n=a.offsetX,r=a.offsetY,l=new S(Number(e.worldX),Number(e.worldY)),o=new S(n,r),i=P(l,o,t);return{position:"absolute",left:i.x*Te+"px",top:i.y*Te+"px"}}function ua(){const e=Ce.value.length;Ce.value=Ce.value.filter(e=>e.timestamp>0&&e.timestamp>Date.now()-864e5),e!==Ce.value.length&&L.info(`已清理${Ce.value.length}条过期数据`);const a=Se.value.toSorted((e,a)=>a.timestamp-e.timestamp),t=a.length>0?a[0].timestamp:0;return new Promise(e=>{t>0&&(Date.now()-t>144e5&&M.confirm("尚存有4小时前的怪物数据，可能已经过期，是否清空？","数据过期",{confirmButtonText:"全部清空",cancelButtonText:"取消",type:""}).then(()=>{He()}).catch(()=>{}).finally(()=>{e(void 0)}),e(void 0))})}function ma(e){switch(e){case _.Urqopacha:case _.Kozamauka:case _.YakTel:case _.Shaaloani:case _.HeritageFound:case _.LivingMemory:return 3;default:return 1}}function ya(e){return Q.filter(a=>a.territory===e.toString())}return i(async()=>{c(Ee,e=>{if(e){const e=new Audio(V);e.volume=0,e.play()}},{immediate:!0}),c(Ie,()=>{fe.value=he.filter(e=>ve(e)===Ie.value)},{immediate:!0}),0===Se.value.length&&Ke(),await(async()=>new Promise(e=>{const a=window.setInterval(()=>{t.value&&(clearInterval(a),e())},1e3)}))(),O("LogLine",Re),O("ChangeZone",Ue),M.close(),await ua(),be.value?(L.success("处于开发模式下，默认选择1线"),ze.value=1,Ve.value=1):M.prompt("请切一次线，或者手动指定","你在几线",{confirmButtonText:"确认",inputPattern:/^[1-6]$/,inputErrorMessage:"只能输入1-6",showCancelButton:!1,showClose:!1,closeOnClickModal:!1,closeOnPressEscape:!1,closeOnHashChange:!1,inputValue:(Ve.value>0?Ve.value:1).toString()}).then(({value:e})=>{ze.value=Number(e),Ve.value=ze.value}),c(Ie,()=>{ua()},{immediate:!1})}),(a,n)=>{const r=e,l=Z,o=X,i=R,c=U,k=Y,A=F,I=D,C=H,S=G,P=J,E=W,O=q;return v(),s("div",{style:je},[p(t)?u("",!0):(v(),s("h3",ee," 无法连接到ACTWebSocket，找怪功能无法工作，但你可以导入导出数据。 ")),m("span",ae,[y(r,{"storage-key":"hunt-theme"})]),y(A,null,{default:d(()=>[y(k,null,{default:d(()=>[y(c,{inline:""},{default:d(()=>[y(i,{label:"资料片"},{default:d(()=>[m("div",te,[y(o,{modelValue:p(Ie),"onUpdate:modelValue":n[0]||(n[0]=e=>x(Ie)?Ie.value=e:null),placeholder:"请选择"},{default:d(()=>[(v(!0),s(h,null,f(Object.entries(de),([e,a])=>(v(),N(l,{key:e,label:a,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1})]),_:1}),y(A,{class:"menu"},{default:d(()=>[y(k,null,{default:d(()=>[y(I,{type:"primary",onClick:qe},{default:d(()=>[...n[5]||(n[5]=[w(" 全部清空 ",-1)])]),_:1}),y(I,{text:"",bg:"",onClick:na},{default:d(()=>[...n[6]||(n[6]=[w(" 全部导出 ",-1)])]),_:1}),y(I,{text:"",bg:"",onClick:ra},{default:d(()=>[...n[7]||(n[7]=[w(" 全部导入 ",-1)])]),_:1}),y(I,{text:"",bg:"",onClick:la},{default:d(()=>[...n[8]||(n[8]=[w(" 单独导入某个图 ",-1)])]),_:1}),y(I,{text:"",bg:"","m-r-5":"",onClick:oa},{default:d(()=>[...n[9]||(n[9]=[w(" 单独导入某条线 ",-1)])]),_:1})]),_:1}),y(k,null,{default:d(()=>[y(C,{modelValue:p($e),"onUpdate:modelValue":n[1]||(n[1]=e=>x($e)?$e.value=e:null),label:"显示数字","w-15":""},null,8,["modelValue"]),y(C,{modelValue:p(Ee),"onUpdate:modelValue":n[2]||(n[2]=e=>x(Ee)?Ee.value=e:null),label:"启用音效"},null,8,["modelValue"]),j(m("div",ne,[y(S,{modelValue:p(Oe),"onUpdate:modelValue":n[3]||(n[3]=e=>x(Oe)?Oe.value=e:null),min:0,max:1,step:.1,size:"small",class:"flex-grow"},null,8,["modelValue"]),y(I,{size:"small","m-l-1":"",onClick:ia},{default:d(()=>[...n[10]||(n[10]=[w(" 试听 ",-1)])]),_:1})],512),[[g,p(Ee)]])]),_:1}),y(k,{"p-l-3":""},{default:d(()=>[y(C,{modelValue:p(Me),"onUpdate:modelValue":n[4]||(n[4]=e=>x(Me)?Me.value=e:null),label:"场地标点(需要邮差)"},null,8,["modelValue"])]),_:1})]),_:1}),y(k,{class:"map-container",flex:"~ wrap","m-t-1":""},{default:d(()=>[p(be)?(v(),N(k,{key:0},{default:d(()=>[n[14]||(n[14]=w(" DEV： ",-1)),y(I,{type:"warning",onClick:Ge},{default:d(()=>[...n[11]||(n[11]=[w(" 添加怪物 ",-1)])]),_:1}),y(I,{type:"warning",onClick:Ye},{default:d(()=>[...n[12]||(n[12]=[w(" 合并怪物 ",-1)])]),_:1}),y(I,{type:"warning",onClick:Je},{default:d(()=>[...n[13]||(n[13]=[w(" 邮差标点 ",-1)])]),_:1})]),_:1})):u("",!0)]),_:1}),m("div",re,[(v(!0),s(h,null,f(p(fe),(e,a)=>{return v(),s("div",{key:e,class:"map-info",flex:"~ col","position-relative":""},[m("h3",{class:"map-title",style:T({width:"596px"}),"position-absolute":"","mb-0":"","ml-2":"","mt-1":"",p0:""},z(ca(e,a)),5),m("ul",le,[m("li",oe,[y(I,{size:"small","w-5em":"",onClick:a=>{return t=e,void M.confirm(`要清空「${$[t].name.cn}」的怪物吗？`,"本图清空",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Ce.value=Ce.value.filter(e=>e.zoneId!==t),_e.value[t]=Pe.value[t][0],Ye()});var t}},{default:d(()=>[...n[15]||(n[15]=[w(" 本图清空 ",-1)])]),_:1},8,["onClick"])]),m("li",ie,[y(I,{size:"small","w-5em":"",onClick:a=>function(e){const a=Se.value.filter(a=>a.zoneId===e);if(!a)throw new Error("找不到该地图");ta(a)}(e)},{default:d(()=>[...n[16]||(n[16]=[w(" 本图导出 ",-1)])]),_:1},8,["onClick"])]),j(m("li",ce,[j(y(I,{size:"small","w-5em":"",onClick:a=>function(e){const a=_e.value[e];M.confirm(`确定要清空「${$[e].name.cn}」的${a}线的怪物吗？`,`${a}线清空`,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Ce.value=Ce.value.filter(t=>!(t.zoneId===e&&t.instance===Number(a))),Ye()})}(e)},{default:d(()=>[w(z(p(_e)[e])+"线清空 ",1)]),_:2},1032,["onClick"]),[[g,!(1!==ma(e)&&p(_e)[e]?.includes("-"))]])],512),[[g,1!==ma(e)]]),j(m("li",se,[j(y(I,{size:"small","w-5em":"",onClick:a=>function(e){const a=_e.value[e];if(a.includes("-")){const t=a.split("-").map(e=>Number(e)),n=t[t.length-1],r=t[0],l=Se.value.filter(a=>a.zoneId===e&&a.instance>=r&&a.instance<=n);if(!l)throw new Error("找不到该地图");ta(l)}else{const t=Se.value.filter(t=>t.zoneId===e&&t.instance===Number(a));if(!t)throw new Error("找不到该地图");ta(t)}}(e)},{default:d(()=>[w(z(p(_e)[e])+"线导出 ",1)]),_:2},1032,["onClick"]),[[g,!(1!==ma(e)&&p(_e)[e]?.includes("-"))]])],512),[[g,1!==ma(e)]])]),j(m("aside",{class:"map-filter","position-absolute":"",style:T([{top:"2em"},{width:"596px"}]),"ml-2":"",flex:"~ justify-start"},[y(E,{modelValue:p(_e)[e],"onUpdate:modelValue":a=>p(_e)[e]=a,size:"small",onChange:Ye},{default:d(()=>[(v(!0),s(h,null,f(p(Pe)[e],e=>(v(),N(P,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])],4),[[g,1!==ma(e)]]),m("div",{class:"map-image",style:T({width:"596px",height:"596px"})},[m("img",{alt:"map",src:(ve(e),t=$[e].id,`https://v2.xivapi.com/api/asset/map/${t}`),style:T({width:"596px",height:"596px"})},null,12,ue),(v(!0),s(h,null,f(ya(e),(e,a)=>(v(),s("div",{key:`${e.territory}-${a}`,style:T({position:"absolute",left:(e.x-1)*Te+"px",top:(e.y-1)*Te+"px"})},[y(O,{class:"box-item",effect:"dark",content:`${e.placeName.cn} / ${e.placeName.ja} / ${e.placeName.en}`,placement:"top"},{default:d(()=>[m("img",{class:"aetherytes",alt:"aetheryte",src:"//cafemaker.wakingsands.com/img-misc/mappy/aetheryte.png",style:T({height:"29.8px"})},null,4)]),_:1},8,["content"])],4))),128)),m("div",null,[m("article",null,[(v(!0),s(h,null,f(p(Se).filter(a=>a.zoneId===e),e=>j((v(),s("div",{key:`${e.zoneId}-${e.id}`,style:T(sa(e))},[m("div",{class:"point",onClick:a=>function(e){const a=Se.value.filter(a=>a.zoneId===e.zoneId&&a.instance===e.instance),t=Math.max(...a.map(e=>e.number));a.forEach(e=>{e.number===t?e.number=1:e.number+=1}),Ye(),e.instance===ze.value&&e.zoneId===Be.value&&We()}(e)},[m("div",{class:b(`point-inner ${Qe(e)}`)},null,2),m("aside",{class:"point-number",innerHTML:ea(e)},null,8,ye)],8,me)],4)),[[g,aa(e)]])),128))])])],4)]);var t}),128))])])}}}),[["__scopeId","data-v-a2e3def0"]]);export{de as default};
