import{_ as e}from"./DragJob-Bar7p4qO.js";import{t as r,at as a,r as t,c as n,f as i,w as o,v as s,x as l,A as u,F as c,L as p,a9 as v,u as d,O as m,M as f,K as b,S as g}from"./vue-vendor-wZ_5aAzA.js";import{j as h}from"./util-BKsnXaYI.js";import{N as x}from"./netregexes-r2K2MLa5.js";import{a as y}from"./overlay_plugin_api-DU1DlPio.js";import{u as j}from"./index-CKUOrbjt.js";import{_ as w}from"./_plugin-vue_export-helper-BCo6x5W8.js";const P=w(r({__name:"showBarrier",setup(r){a((e=>({"21bf6ff8":d(S),e74d3e0e:d(N)})));const w={statusEffectExplicit:x.statusEffectExplicit()};let P=0;const _=t([]),E=t(""),A=t(window.location.href),I=n((()=>new URLSearchParams(A.value.split("?")[1]))),L=n((()=>"1"===I.value.get("showSettings"))),S=n((()=>40*Number(I.value.get("lineHeight")||1)+"px")),N=n((()=>`${Number(I.value.get("fontSize")||26)}px`)),$=n((()=>I.value.get("type")||"1"));const C=j("cactbotRuntime-sortArr",h);function U(e){C.value=e}function O(){_.value.sort(((e,r)=>e.id===E.value?-1:r.id===E.value?1:e.job===r.job?r.id.localeCompare(e.id):C.value.indexOf(e.job)-C.value.indexOf(r.job)))}function R(e){return"1"===$.value?`${e.barrierPercent}`:"2"===$.value?`${e.barrierAmount}`:`${e.barrierPercent}%(${e.barrierAmount})`}return i((()=>{y("LogLine",(e=>{!function(e){var r,a,t;const n=w.statusEffectExplicit.exec(e);if(null==(r=null==n?void 0:n.groups)?void 0:r.targetId.startsWith("1")){const e=_.value.find((e=>{var r;return e.id===(null==(r=n.groups)?void 0:r.targetId)}));e&&(e.barrierPercent=Number(null==(a=n.groups)?void 0:a.currentShield),e.barrierAmount=Math.round(Number(null==(t=n.groups)?void 0:t.maxHp)*e.barrierPercent/100))}}(e.rawLine)})),y("PartyChanged",(e=>{_.value=e.party.filter((e=>e.inParty)).map((e=>({...e,barrierPercent:0,barrierAmount:0})))})),y("ChangePrimaryPlayer",(e=>{E.value=Number(e.charID).toString(16).toUpperCase()})),o([_,E,C],(()=>{clearInterval(P),E.value?O():P=setInterval((()=>{E.value&&(O(),clearInterval(P))}),100)}),{immediate:!0}),window.addEventListener("hashchange",(e=>A.value=e.newURL))})),(r,a)=>{const t=e;return l(),s("div",null,[u("ul",null,[(l(!0),s(p,null,v(d(_),(e=>(l(),s("li",{key:e.id},[c(u("span",{"m-r-2":""},b(e.name),513),[[m,d(L)]]),u("span",{style:g(0===e.barrierPercent?{opacity:.25,color:"white"}:{opacity:1,color:"#f5da3c"})},b(R(e)),5)])))),128))]),c(f(t,{style:{"z-index":"10000"},party:d(_),"m-b-1":"","p-1":"",onUpdateSortArr:U},null,8,["party"]),[[m,d(L)]])])}}}),[["__scopeId","data-v-243d7cc7"]]);export{P as default};
