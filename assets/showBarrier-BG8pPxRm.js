import{_ as e}from"./ActWrapper-Czp4gDVr.js";import{u as r,_ as a}from"./DragJob-Bb3FpPdF.js";import{d as t,r as s,h as i,i as o,B as n,k as l,w as u,p,u as m,o as c,a as d,l as b,c as v,F as f,m as g,t as j,v as x,q as h,b as y}from"./index-B2QP4S3_.js";import{N as _}from"./netregexes-DsAXea56.js";import{a as w}from"./overlay_plugin_api-DHbPkDtN.js";import{_ as P}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./useDev-C6r0D8zs.js";import"./useDemo-B6GsGOH2.js";import"./index-iXmw8Fyr.js";import"./util-BSI8OlRX.js";import"./index-ChopGqwI.js";import"./index-DzgqdolD.js";import"./use-form-common-props-DfVsyJG2.js";import"./index-BIgCz001.js";import"./_baseClone-C85h6RWJ.js";import"./regexes-Blkj7yOl.js";const E=P(t({__name:"showBarrier",setup(t){p(e=>({v38cc43cb:m(S),eae0bb00:m($)}));const P=r(),E={statusEffectExplicit:_.statusEffectExplicit()};let C=0;const I=s([]),L=s(""),N=s(window.location.href),A=i(()=>new URLSearchParams(N.value.split("?")[1])),D=i(()=>"1"===A.value.get("showSettings")),S=i(()=>40*Number(A.value.get("lineHeight")||1)+"px"),$=i(()=>`${Number(A.value.get("fontSize")||26)}px`),H=i(()=>A.value.get("type")||"1");function R(){I.value.sort((e,r)=>e.id===L.value?-1:r.id===L.value?1:e.job===r.job?r.id.localeCompare(e.id):P.arr.indexOf(e.job)-P.arr.indexOf(r.job))}function U(e){return"1"===H.value?`${e.barrierPercent}`:"2"===H.value?`${e.barrierAmount}`:`${e.barrierPercent}%(${e.barrierAmount})`}return o(()=>{w("LogLine",e=>{!function(e){const r=E.statusEffectExplicit.exec(e);if(r?.groups?.targetId.startsWith("1")){const e=I.value.find(e=>e.id===r.groups?.targetId);e&&(e.barrierPercent=Number(r.groups?.currentShield),e.barrierAmount=Math.round(Number(r.groups?.maxHp)*e.barrierPercent/100))}}(e.rawLine)}),w("PartyChanged",e=>{I.value=e.party.filter(e=>e.inParty).map(e=>({...e,barrierPercent:0,barrierAmount:0}))}),w("ChangePrimaryPlayer",e=>{L.value=Number(e.charID).toString(16).toUpperCase()}),n([I,L,P.arr],()=>{clearInterval(C),L.value?R():C=window.setInterval(()=>{L.value&&(R(),clearInterval(C))},100)},{immediate:!0}),window.addEventListener("hashchange",e=>N.value=e.newURL)}),(r,t)=>{const s=a,i=e;return c(),l(i,null,{default:u(()=>[d("div",null,[d("ul",null,[(c(!0),v(f,null,g(m(I),e=>(c(),v("li",{key:e.id},[b(d("span",{"m-r-2":""},j(e.name),513),[[x,m(D)]]),d("span",{style:h(0===e.barrierPercent?{opacity:.25,color:"white"}:{opacity:1,color:"#f5da3c"})},j(U(e)),5)]))),128))]),b(y(s,{style:{"z-index":"10000"},party:m(I),"m-b-1":"","p-1":""},null,8,["party"]),[[x,m(D)]])])]),_:1})}}}),[["__scopeId","data-v-d26e0ae1"]]);export{E as default};
