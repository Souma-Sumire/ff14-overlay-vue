import{c as e,d as l,n as t,e as a,aE as i,J as s,F as n,G as o,aF as r,aG as d,l as c,D as u,aD as m,j as k,k as p,b as S,aH as f,an as y,X as g,aj as b,au as h,a8 as v,aA as T,N as _,M as V,E as w,a as x}from"./vendor-element-plus-BVM8ID8U.js";import{a8 as $,a9 as j,u as z,U,aa as C,ab as B,ac as D,q as J,ad as N,v as F,y as I}from"./shared-core-C66uuNY0.js";import{o as E,A as M,t as O,H as L,r as A,v as G,J as H,K as q,I as K,R as P,am as R,u as X,Z as Y,c as Z,B as Q,V as W,Y as ee,dv as le,O as te}from"./vendor-vue-iK2zA9mI.js";import{_ as ae,a as ie,b as se}from"./shared-common-Cc1o9pRN.js";import"./cactbot-DRs0Yy4Y.js";const ne={class:"action-icon-wrapper"},oe=["src"],re={key:1,class:"action-icon-placeholder"},de=ae(E({__name:"ActionIcon",props:{id:{}},setup(e){const l=e,t=A("");return M([()=>l.id,j],([e])=>{t.value=$(e)},{immediate:!0}),(e,l)=>(O(),L("div",ne,[t.value?(O(),L("img",{key:0,src:t.value,class:"action-icon",alt:""},null,8,oe)):(O(),L("div",re))]))}}),[["__scopeId","data-v-8bcec3d8"]]),ce={class:"btn-text"},ue={class:"job-selector-content"},me=ae(E({__name:"JobSelector",props:{modelValue:{}},emits:["update:modelValue"],setup(n,{emit:o}){const r=n,d=o,{t:c,locale:u}=z(),m=Object.freeze(U.getBattleJobs()),k=Z(()=>{const e=C(u.value);return m.map(l=>{const t=U.jobToFullName(l);return{value:U.jobToJobEnum(l),label:t[e]??t.en}})}),p=Z(()=>r.modelValue&&0!==r.modelValue.length?r.modelValue.length===m.length?c("keySkillTimerSettings.col.allJobs"):c("keySkillTimerSettings.col.jobsCount",{count:r.modelValue.length}):c("keySkillTimerSettings.col.allJobs"));function S(e){d("update:modelValue",e)}return(o,r)=>{const d=a,c=t,u=l,m=e,f=s;return O(),G(f,{placement:"bottom",width:280,trigger:"click","popper-class":"job-selector-popper"},{reference:H(()=>[K(c,{size:"small",class:"job-popover-btn"},{default:H(()=>[K(d,null,{default:H(()=>[K(X(i))]),_:1}),q("span",ce,Y(p.value),1)]),_:1})]),default:H(()=>[q("div",ue,[K(m,{"model-value":n.modelValue,multiple:"",filterable:"",placeholder:"Select Jobs",size:"default",class:"full-width","collapse-tags":"","collapse-tags-tooltip":"","onUpdate:modelValue":S},{default:H(()=>[(O(!0),L(P,null,R(k.value,e=>(O(),G(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["model-value"])])]),_:1})}}}),[["__scopeId","data-v-a8044493"]]),ke={class:"settings-table-wrapper"},pe={class:"action-buttons"},Se={style:{display:"flex","align-items":"center",gap:"8px"}},fe={style:{color:"var(--el-text-color-secondary)","font-size":"12px"}},ye={class:"tts-header"},ge=ae(E({__name:"SettingsTable",emits:["delete","move"],setup(e,{emit:l}){const i=l,s=B(),f=Z(()=>s.keySkillsData.chinese);function y(e,l){if(e){l(D(e,50).map(e=>({value:e.id.toString(),label:e.name,id:e.id})))}else l([])}return(e,l)=>{const g=a,b=t,h=c,v=o,T=m,_=p,V=k,w=S,x=n;return O(),L("div",ke,[K(x,{data:f.value,border:"",size:"small","row-key":e=>e.key,height:"100%",class:"custom-table","header-row-class-name":"table-header"},{default:H(()=>[K(v,{label:e.$t("keySkillTimerSettings.col.action"),width:"90",fixed:"left",align:"center"},{default:H(({row:l,$index:t})=>[q("div",pe,[K(b,{link:"",size:"small",disabled:0===t,onClick:e=>i("move",t,t-1)},{default:H(()=>[K(g,null,{default:H(()=>[K(X(r))]),_:1})]),_:1},8,["disabled","onClick"]),K(b,{link:"",size:"small",disabled:t===f.value.length-1,onClick:e=>i("move",t,t+1)},{default:H(()=>[K(g,null,{default:H(()=>[K(X(d))]),_:1})]),_:1},8,["disabled","onClick"]),K(h,{title:e.$t("keySkillTimerSettings.deleteConfirmTitle"),onConfirm:e=>i("delete",l.key)},{reference:H(()=>[K(b,{link:"",size:"small",type:"danger"},{default:H(()=>[K(g,null,{default:H(()=>[K(X(u))]),_:1})]),_:1})]),_:1},8,["title","onConfirm"])])]),_:1},8,["label"]),K(v,{label:e.$t("keySkillTimerSettings.col.preview"),width:"50",align:"center"},{default:H(({row:e})=>[(O(),G(de,{id:e.id,key:e.id},null,8,["id"]))]),_:1},8,["label"]),K(v,{label:e.$t("keySkillTimerSettings.col.id"),"min-width":"200"},{default:H(({row:e})=>[K(T,{modelValue:e.id,"onUpdate:modelValue":l=>e.id=l,"fetch-suggestions":y,placeholder:"...",size:"small",style:{width:"100%"},clearable:"","trigger-on-focus":!1},{default:H(({item:e})=>[q("div",Se,[(O(),G(de,{id:e.id,key:e.id,size:20},null,8,["id"])),q("span",null,Y(e.label),1),q("span",fe,"("+Y(e.value)+")",1)])]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),K(v,{width:"130"},{header:H(()=>[q("div",ye,[l[1]||(l[1]=q("span",null,"TTS",-1)),K(_,{modelValue:X(s).enableTts.chinese,"onUpdate:modelValue":l[0]||(l[0]=e=>X(s).enableTts.chinese=e),size:"small"},null,8,["modelValue"])])]),default:H(({row:e})=>[K(V,{modelValue:e.tts,"onUpdate:modelValue":l=>e.tts=l,size:"small",disabled:!X(s).enableTts.chinese},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),K(v,{label:e.$t("keySkillTimerSettings.col.duration"),"min-width":"180",align:"left"},{default:H(({row:e})=>[K(V,{modelValue:e.duration,"onUpdate:modelValue":l=>e.duration=l,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),K(v,{label:e.$t("keySkillTimerSettings.col.recast"),"min-width":"220",align:"left"},{default:H(({row:e})=>[K(V,{modelValue:e.recast1000ms,"onUpdate:modelValue":l=>e.recast1000ms=l,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),K(v,{label:e.$t("keySkillTimerSettings.col.job"),width:"100",align:"center"},{default:H(({row:e})=>[K(me,{modelValue:e.job,"onUpdate:modelValue":l=>e.job=l},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),K(v,{label:e.$t("keySkillTimerSettings.col.minLevel"),width:"110",align:"center"},{default:H(({row:e})=>[K(w,{modelValue:e.minLevel,"onUpdate:modelValue":l=>e.minLevel=l,min:1,max:100,size:"small",controls:!1,class:"level-input"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),K(v,{label:e.$t("keySkillTimerSettings.col.line"),width:"110",align:"center"},{default:H(({row:e})=>[K(w,{modelValue:e.line,"onUpdate:modelValue":l=>e.line=l,min:1,max:10,size:"small",controls:!1,class:"line-input"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"])]),_:1},8,["data","row-key"])])}}}),[["__scopeId","data-v-9afbe668"]]),be={class:"page-container"},he={class:"header-toolbar"},ve={class:"left-tools"},Te={class:"preset-list",style:{height:"400px","overflow-y":"auto"}},_e={class:"preset-info"},Ve={class:"name"},we={class:"search-drawer-content",style:{height:"450px",padding:"12px"}},xe={class:"center-tools"},$e={class:"right-tools"},je={class:"page-content"},ze=ae(E({__name:"keySkillTimerSettings",setup(e){const{t:l}=z(),i=B(),r=A(!1);function d(){w.confirm(l("keySkillTimerSettings.resetConfirmMsg"),l("keySkillTimerSettings.confirmTitle"),{confirmButtonText:l("keySkillTimerSettings.confirmBtn"),cancelButtonText:l("keySkillTimerSettings.cancelBtn"),type:"warning"}).then(()=>{i.keySkillsData.chinese=[...N],x.success(l("keySkillTimerSettings.resetSuccessMsg"))}).catch(()=>{})}function c(e,t){i.keySkillsData.chinese.unshift({key:crypto.randomUUID(),id:e,tts:t||"",duration:0,recast1000ms:0,job:[],line:1,minLevel:1}),x.success(`${l("keySkillTimerSettings.addSkill")}: ${t||e}`)}function u(){const e=JSON.stringify(i.keySkillsData),t=le.compressToBase64(e);I(t).then(()=>x.success(l("keySkillTimerSettings.copySuccess"))).catch(()=>x.error(l("keySkillTimerSettings.copyFailed")))}function m(){w.prompt(l("keySkillTimerSettings.importPromptMsg"),l("keySkillTimerSettings.importTitle"),{confirmButtonText:l("keySkillTimerSettings.confirmBtn"),cancelButtonText:l("keySkillTimerSettings.cancelBtn"),inputType:"textarea",inputValidator:e=>{try{const t=le.decompressFromBase64(e),a=JSON.parse(t);return"object"==typeof a&&null!==a||l("keySkillTimerSettings.dataFormatError")}catch(t){const e=t instanceof Error?t.message:String(t);return`${l("keySkillTimerSettings.dataFormatError")}: ${e}`}}}).then(e=>{const{value:t}=e;if(t){const e=le.decompressFromBase64(t),a=JSON.parse(e);"object"==typeof a&&null!==a?(i.keySkillsData.chinese=a.chinese,x.success(l("keySkillTimerSettings.importSuccess"))):x.error(l("keySkillTimerSettings.importFormatError"))}}).catch(()=>{})}Q(async()=>{try{await J()}catch(e){}finally{r.value=!0}});const p=A(""),S=te([]);let $;return M(p,e=>{$&&clearTimeout($),$=window.setTimeout(()=>{S.value=D(e)},300)}),(e,l)=>{const w=t,x=a,$=h,j=k,z=o,U=n,C=b,B=s,D=g,J=ie,I=se,E=ge,M=f;return W((O(),L("div",be,[q("div",he,[q("div",ve,[K(B,{placement:"bottom-start",width:550,trigger:"click","popper-class":"skill-library-popover"},{reference:H(()=>[K(w,{type:"primary",icon:X(T),loading:!r.value},{default:H(()=>[ee(Y(e.$t("keySkillTimerSettings.searchSkill")),1)]),_:1},8,["icon","loading"])]),default:H(()=>[K(C,{type:"border-card",class:"search-tabs"},{default:H(()=>[K($,{label:e.$t("keySkillTimerSettings.presets")},{default:H(()=>[q("div",Te,[(O(!0),L(P,null,R(X(N),l=>(O(),L("div",{key:l.key,class:"preset-item"},[q("div",_e,[K(de,{id:l.id,size:24},null,8,["id"]),q("span",Ve,Y(X(F)(Number(l.id))||l.tts||e.$t("keySkillTimerSettings.unknownSkill")),1)]),K(w,{link:"",type:"primary",onClick:e=>c(Number(l.id),X(F)(Number(l.id))||l.tts)},{default:H(()=>[K(x,null,{default:H(()=>[K(X(v))]),_:1})]),_:1},8,["onClick"])]))),128))])]),_:1},8,["label"]),K($,{label:e.$t("keySkillTimerSettings.searchTab")},{default:H(()=>[q("div",we,[K(j,{modelValue:p.value,"onUpdate:modelValue":l[0]||(l[0]=e=>p.value=e),clearable:"",placeholder:e.$t("keySkillTimerSettings.skillName"),"prefix-icon":X(T),style:{"margin-bottom":"12px"},size:"default"},null,8,["modelValue","placeholder","prefix-icon"]),K(U,{data:S.value,style:{width:"100%"},height:"390px",size:"default"},{default:H(()=>[K(z,{width:"40",align:"center"},{default:H(({row:e})=>[K(de,{id:e.id,size:20},null,8,["id"])]),_:1}),K(z,{prop:"id",label:e.$t("keySkillTimerSettings.col.shortId"),width:"80"},null,8,["label"]),K(z,{prop:"name",label:e.$t("keySkillTimerSettings.skillName")},null,8,["label"]),K(z,{width:"50",align:"center"},{default:H(({row:e})=>[K(w,{link:"",type:"primary",onClick:l=>c(e.id,e.name)},{default:H(()=>[K(x,null,{default:H(()=>[K(X(v))]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1},8,["label"])]),_:1})]),_:1})]),q("div",xe,[K(D,null,{default:H(()=>[K(w,{icon:X(_),onClick:u},{default:H(()=>[ee(Y(e.$t("keySkillTimerSettings.export")),1)]),_:1},8,["icon"]),K(w,{icon:X(V),onClick:m},{default:H(()=>[ee(Y(e.$t("keySkillTimerSettings.import")),1)]),_:1},8,["icon"])]),_:1}),K(w,{type:"danger",icon:X(y),onClick:d},{default:H(()=>[ee(Y(e.$t("keySkillTimerSettings.restoreDefault")),1)]),_:1},8,["icon"])]),q("div",$e,[K(J,{"storage-key":"key-skill-timer-2"}),K(I,{teleported:!1})])]),q("main",je,[K(E,{onDelete:l[1]||(l[1]=e=>function(e){const l=i.keySkillsData.chinese,t=l.findIndex(l=>l.key===e);-1!==t&&l.splice(t,1)}(e)),onMove:l[2]||(l[2]=(e,l)=>function(e,l){const t=i.keySkillsData.chinese;if(l<0||l>=t.length||e===l)return;const a=t[e];a&&(t.splice(e,1),t.splice(l,0,a))}(e,l))})])])),[[M,!r.value,void 0,{fullscreen:!0,lock:!0}]])}}}),[["__scopeId","data-v-95579d14"]]);export{ze as default};
