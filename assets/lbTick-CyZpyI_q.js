import{_ as e}from"./ActWrapper-DLXfFngs.js";import{d as t,h as n,r as i,f as a,B as s,i as o,aG as r,k as l,w as c,o as u,G as p,l as m,u as T,e as h,t as f,a as d,c as v,F as L,m as g,v as C}from"./index-z92eqeNR.js";/* empty css                  */import{u as j}from"./useDemo-B-m_Mmmz.js";import{u as b}from"./useDev-DLnVKuzg.js";import{a as _,r as y}from"./overlay_plugin_api-DHbPkDtN.js";import{u as D}from"./useZone-CTx8-3H1.js";import{E as k}from"./index-B4NDD8P-.js";import{_ as w}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./el-card-B6LMoTVr.js";import"./zoneInfo-Kvs06RCG.js";import"./zone_info-C8YMEhdS.js";import"./content_type-uhloenTS.js";import"./index-FQlygPHH.js";import"./use-form-common-props-BiXdWGU6.js";const x={class:"lb-container"},F={id:"percent"},E={id:"bonusTotal"},A={id:"extra"},B=3e4,z=w(t({__name:"lbTick",setup(t){const{zoneType:w}=D(),z=b(),I=j(),$=n(()=>"Pvp"!==w.value),Z=i(),G=a({prev:0,ratio:0,bonusTotal:0,chain:0,chainList:[]});function U(){G.prev=0,G.ratio=0,G.chain=0,G.chainList=[],G.bonusTotal=0}const J=e=>{if($.value)if("36"===e.line[0]){const t=parseInt(e.line[2],16),n=t-G.prev;if(G.prev=t,G.ratio=t/B,0===t||n<-.1)G.chain=0,G.chainList=[];else{if(!(n>220))return void(G.chain=0);{G.chain+=n,G.bonusTotal+=n;const t=G.chainList[G.chainList.length-1];t&&t.timestamp+1e3>new Date(e.line[1]).getTime()&&(t.num===G.chain-300||t.num===G.chain-60)?G.chainList[G.chainList.length-1].num=G.chain:G.chainList.push({key:crypto.randomUUID(),num:G.chain,timestamp:new Date(e.line[1]).getTime()})}}}else"33"===e.line[0]&&["40000010","4000000F"].includes(e.line[3])&&U()};function K(){Z.value?.(),Z.value=function(e,t=2){const n=[];return function(i){let a=0;e({line:i[0],type:"LogLine",rawLine:""});for(let s=1;s<i.length;s++){const o=new Date(i[s][1]),r=new Date(i[s-1][1]);a+=o.getTime()-r.getTime();const l=window.setTimeout(()=>{e({line:i[s],type:"LogLine",rawLine:""})},a/t);n.push(l)}}([["36","2021-12-28T21:38:30.3580000+08:00","0000"],["36","2021-12-28T21:38:33.3580000+08:00","00DC"],["36","2021-12-28T21:38:34.8290000+08:00","0208"],["36","2021-12-28T21:38:36.3460000+08:00","02E4"],["36","2021-12-28T21:38:37.8630000+08:00","0410"],["36","2021-12-28T21:38:39.3360000+08:00","04EC"],["36","2021-12-28T21:38:42.3720000+08:00","05C8"],["36","2021-12-28T21:38:45.3620000+08:00","06A4"],["36","2021-12-28T21:38:47.8140000+08:00","07D0"],["36","2021-12-28T21:38:47.8140000+08:00","08FC"],["36","2021-12-28T21:38:47.8140000+08:00","0A28"],["36","2021-12-28T21:38:47.8140000+08:00","0B54"],["36","2021-12-28T21:38:47.8140000+08:00","0C80"],["36","2021-12-28T21:38:48.3510000+08:00","0D5C"],["36","2021-12-28T21:38:50.6220000+08:00","0E88"],["36","2021-12-28T21:38:50.8900000+08:00","0FB4"],["36","2021-12-28T21:38:51.0230000+08:00","10E0"],["36","2021-12-28T21:38:51.1570000+08:00","120C"],["36","2021-12-28T21:38:51.3360000+08:00","12E8"],["36","2021-12-28T21:38:54.3690000+08:00","13C4"],["36","2021-12-28T21:38:57.3570000+08:00","14A0"],["36","2021-12-28T21:38:58.3360000+08:00","15CC"],["36","2021-12-28T21:38:58.3360000+08:00","16F8"],["36","2021-12-28T21:38:58.3360000+08:00","1824"],["36","2021-12-28T21:38:58.3360000+08:00","1950"],["36","2021-12-28T21:38:58.3360000+08:00","1A7C"],["36","2021-12-28T21:39:00.3410000+08:00","1B58"],["36","2021-12-28T21:39:03.3690000+08:00","1C34"],["36","2021-12-28T21:39:04.2630000+08:00","1D60"],["36","2021-12-28T21:39:06.3600000+08:00","1E3C"]]),()=>{n.forEach(clearTimeout),n.length=0}}(J,1)}return s(()=>[I.value,z.value],()=>{Z.value?.(),U()}),o(()=>{_("ChangeZone",U),_("LogLine",J)}),r(()=>{y("ChangeZone",U),y("LogLine",J)}),(t,n)=>{const i=k,a=e;return u(),l(a,null,{default:c(()=>[T(z)||T(I)?(u(),l(i,{key:0,type:"primary",class:"test-btn",onClick:K},{default:c(()=>[h(f(t.$t("lbTick.test")),1)]),_:1})):p("",!0),m(d("div",x,[d("p",F,f(t.$t("lbTick.lb"))+f((100*T(G).ratio).toFixed(2))+"% ",1),d("p",E,f(t.$t("lbTick.bonus"))+":"+f((T(G).bonusTotal/B*100).toFixed(0))+"% ",1),d("div",A,[(u(!0),v(L,null,g(T(G).chainList,e=>(u(),v("p",{key:e.key,class:"anime"}," +"+f((e.num/B*100).toFixed(0))+"% ",1))),128))])],512),[[C,T($)]])]),_:1})}}}),[["__scopeId","data-v-e8d2049e"]]);export{z as default};
