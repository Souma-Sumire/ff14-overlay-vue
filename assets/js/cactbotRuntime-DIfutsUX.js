import{_ as a}from"./DragJob-CebY0qGi.js";import{t as e,r as t,f as n,ae as o,v as r,x as l,E as s,L as i,A as u,G as p,M as m,u as c,D as d,h as f,K as y,a9 as v,S as b,C as h,J as j,ab as g}from"./vue-vendor-Bz5Jh0Fv.js";import{a as _}from"./index-CbFRtWf0.js";import"./style-l0sNRNKZ.js";import{U as x}from"./util-DL4pAhxD.js";import{a as k,c as w}from"./overlay_plugin_api-DU1DlPio.js";/* empty css                */import{u as P}from"./index-BQ4hghqY.js";import{_ as C}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./element-plus-im0ZkkqX.js";const J={class:"text-white text-shadow-sm text-shadow-color-black"},T={class:"players"},D={class:"name"},O={key:0,style:{position:"fixed",bottom:"0"}},R=C(e({__name:"cactbotRuntime",setup(e){function C(a,e,t=0){return Array.from({length:e},(()=>a)).map(((a,e)=>a+(+e+1+t)))}_.setTheme("dark");const R=t(!1),V=P("cactbotRuntime-sortArr",[]),S=[{id:"10000001",name:"虚构暗骑",job:32,inParty:!0},{id:"10000002",name:"虚构骑士",job:19,inParty:!0},{id:"10000003",name:"虚构占星",job:33,inParty:!0},{id:"10000004",name:"虚构学者",job:28,inParty:!0},{id:"10000005",name:"虚构忍者",job:30,inParty:!0},{id:"10000006",name:"虚构龙骑",job:22,inParty:!0},{id:"10000008",name:"虚构舞者",job:38,inParty:!0},{id:"10000007",name:"虚构画家",job:42,inParty:!0}],U=P("cactbotRuntime-data",{party:[]}),E=P("cactbotRuntime-showTips",t(!0)),M=P("cactbotRuntime-roleSelectLength",{tank:0,healer:0,dps:0,crafter:0,gatherer:0,none:0}),A={tank:["MT","ST",...C("T",6,2)],healer:[...C("H",8)],dps:[...C("D",8)],crafter:[...C("C",8)],gatherer:[...C("G",8)],none:[...C("N",8)]};function L(a){const e=F(a);return A[e].filter(((a,t)=>t<M.value[e]))}const G=location.href.includes("localhost"),N=t(!1),z=t(G?S[2].name:"");function F(a){return[1,3,19,21,32,37].includes(a)?"tank":[6,24,28,33,40].includes(a)?"healer":[2,4,5,7,20,22,23,25,26,27,29,30,31,34,35,36,38,39,41,42].includes(a)?"dps":x.isCraftingJob(x.jobEnumToJob(a))?"crafter":x.isGatheringJob(x.jobEnumToJob(a))?"gatherer":"none"}function I(a){return A[F(a.job)].find((a=>!U.value.party.find((e=>e.rp===a))))??"unknown"}function q(){const a=[...A.tank,...A.healer,...A.dps,...A.crafter,...A.gatherer,...A.none];U.value.party.sort(((e,t)=>a.indexOf(e.rp??"unknown")-a.indexOf(t.rp??"unknown"))),w({call:"broadcast",source:"soumaRuntimeJS",msg:{party:U.value.party}})}function B(){N.value=!0}function H(){N.value=!1}function K(a){V.value=a,W()}function W(){!function(){U.value.party.sort(((a,e)=>V.value.indexOf(a.job)-V.value.indexOf(e.job)));for(const a of U.value.party)a.rp=void 0;for(const a of U.value.party)a.rp=I(a)}(),function(){for(const a in M.value)Object.prototype.hasOwnProperty.call(M.value,a)&&(M.value[a]=U.value.party.reduce(((e,t)=>F(t.job)===a?e+1:e),0))}(),q()}function Q(){const a={party:S};E.value&&(R.value=!0),U.value.party=a.party.filter((a=>a.inParty)).map((a=>({...a,rp:"unknown"}))),W()}return n((()=>{q(),k("PartyChanged",(a=>{E.value&&(R.value=!0),G&&0===a.party.length||(U.value.party=a.party.filter((a=>a.inParty)).map((a=>({...a,rp:"unknown"}))),W())})),k("ChangePrimaryPlayer",(a=>{G||(z.value=a.charName)})),k("BroadcastMessage",(a=>{"soumaUserJS"===a.source&&"object"==typeof a.msg&&null!==a.msg&&"requestData"===Reflect.get(a.msg,"text")&&q()}))})),(e,t)=>{const n=o("vxe-modal"),_=o("vxe-option"),k=o("vxe-select"),w=a;return l(),r("div",{onMouseenter:B,onMouseleave:H},[s(u("span",J,"...",512),[[m,c(U).party.length<=1]]),i(n,{modelValue:c(R),"onUpdate:modelValue":t[0]||(t[0]=a=>f(R)?R.value=a:null),size:"small",position:{left:10,top:10},width:"90vw",onClose:t[1]||(t[1]=a=>{R.value=!1,E.value=!1})},{title:d((()=>t[3]||(t[3]=[u("span",null,"用法",-1)]))),default:d((()=>t[4]||(t[4]=[u("p",null,"使悬浮窗的位置分配对应游戏内的实际位置（D1D2等）",-1),u("ul",null,[u("li",null,"临时：下拉选择框修改。"),u("li",null,"长期：用鼠标拖动职能顺序。")],-1)]))),_:1},8,["modelValue"]),u("main",{style:b({width:c(N)?+(c(U).party.find((a=>36===a.job))?1:0)+18+"em":"4em"})},[u("div",T,[i(g,{name:"animate__animated animate__bounce","enter-active-class":"animate__fadeInLeft","leave-active-class":"animate__fadeOutLeft"},{default:d((()=>[(l(!0),r(y,null,v(c(U).party,((a,e)=>{return s((l(),r("section",{key:a.id,flex:"~ nowrap",style:b({opacity:c(N)?1:.5}),class:"player"},[i(k,{modelValue:a.rp,"onUpdate:modelValue":e=>a.rp=e,size:"mini","class-name":"select",onChange:a=>function(a){const e=U.value.party.find((e=>e.rp===U.value.party[a].rp&&e.id!==U.value.party[a].id));e&&(e.rp=I(e)),q()}(e)},{default:d((()=>[(l(!0),r(y,null,v(L(a.job),((a,e)=>(l(),h(_,{key:e,value:a,label:a},null,8,["value","label"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]),u("span",D,j((t=a.job,x.nameToFullName(x.jobEnumToJob(t)).simple1))+" "+j(c(N)?a.name:""),1)],4)),[[m,c(U).party.length>1&&(c(N)||a.name===c(z))]]);var t})),128))])),_:1})]),s(i(w,{party:c(U).party,"m-b-1":"","p-1":"",onUpdateSortArr:K},null,8,["party"]),[[m,c(N)]])],4),c(G)?(l(),r("div",O,[u("button",{onClick:t[2]||(t[2]=a=>{c(U).party=c(U).party.filter((a=>a.name===c(z))),W()})}," 测试单人 "),u("button",{onClick:Q}," 测试组队 ")])):p("",!0)],32)}}}),[["__scopeId","data-v-6265d712"]]);export{R as default};
