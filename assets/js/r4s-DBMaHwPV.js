import"./index-CpheYv7i.js";/* empty css                  *//* empty css                  *//* empty css                 *//* empty css                        */import{t as e,r as a,c as t,v as l,x as s,E as n,M as r,u,L as o,D as i,A as d,J as m,K as v,I as p}from"./vue-vendor-Bbuz3Kwb.js";import{N as c}from"./netregexes-QpAZTWa9.js";import{a as f,c as g}from"./overlay_plugin_api-C1Kk3pZW.js";import{u as x}from"./index-bbahPALZ.js";import{d as h,e as j,f as y,h as T}from"./element-plus-QcyfhpSy.js";import{_}from"./_plugin-vue_export-helper-BCo6x5W8.js";const w={"w-30":""},S=_(e({__name:"r4s",setup(e){var _,S;const V={gainsEffects:c.gainsEffect({effectId:["F9F","343"],targetId:"1[a-zA-Z0-9]{7}"})},b=a(Date.now()),E=a([]),I=t((()=>{if(0===E.value.length||0===E.value[0].end)return"0";const e=Math.abs(b.value-E.value[0].end).toString().padStart(5,"0");return`${e.slice(0,2)}.${e.slice(2,4)}`})),L=a("flex"===(null==(S=null==(_=document.getElementById("unlocked"))?void 0:_.style)?void 0:S.display));document.addEventListener("onOverlayStateUpdate",(e=>{var a;L.value=!1===(null==(a=null==e?void 0:e.detail)?void 0:a.isLocked)}));const z=x("special-r4s-settings",{ms:.65,text:"穿",test:!1});f("LogLine",(e=>{var a;for(const t in V){const l=V[t].exec(e.rawLine);if(l)switch(t){case"gainsEffects":{if("343"===(null==(a=l.groups)?void 0:a.effectId)&&!1===z.value.test)return;const e=+l.groups.duration,t=Date.now(),s=t+1e3*+e;if(E.value.find((e=>Math.abs(e.start-t)<=1e3&&Math.abs(e.end-s)<=1e3)))return;E.value.push({start:t,end:s,duration:e,alreadyTTS:!1}),E.value.sort(((e,a)=>e.end-a.end));break}}}}));let A=0;function D(){b.value=Date.now();b.value;A=b.value,E.value=E.value.filter((e=>e.end>0&&!(e.end<b.value&&!0===e.alreadyTTS))),E.value.length>0&&"0"!==I.value&&Math.abs(Number.parseFloat(I.value))<=z.value.ms&&!1===E.value[0].alreadyTTS&&(E.value[0].alreadyTTS=!0,g({call:"cactbotSay",text:z.value.text})),requestAnimationFrame((()=>{D()}))}return setInterval((()=>{D()}),4.175),(e,a)=>{const t=j,c=y,f=T,g=h;return l(),s(v,null,[n(o(g,{class:"settings"},{default:i((()=>[d("form",null,[a[3]||(a[3]=p(" 剩余秒 ")),o(t,{modelValue:u(z).ms,"onUpdate:modelValue":a[0]||(a[0]=e=>u(z).ms=e),min:0,max:1e4,size:"small",step:.001},null,8,["modelValue"])]),d("form",w,[a[4]||(a[4]=p(" TTS文本 ")),o(c,{modelValue:u(z).text,"onUpdate:modelValue":a[1]||(a[1]=e=>u(z).text=e),size:"small"},null,8,["modelValue"])]),a[6]||(a[6]=p()),a[7]||(a[7]=d("span",null," 若无法输入，先切换到ACT，再点击此悬浮窗 ",-1)),d("form",null,[o(f,{modelValue:u(z).test,"onUpdate:modelValue":a[2]||(a[2]=e=>u(z).test=e),size:"small"},null,8,["modelValue"]),a[5]||(a[5]=p(" 使用吉星相位测试 "))])])),_:1},512),[[r,u(L)]]),n(d("h1",{"w-50":"","text-right":"","color-white":""},m(u(I)),513),[[r,"0"!==u(I)]])],64)}}}),[["__scopeId","data-v-18aa19fc"]]);export{S as default};
