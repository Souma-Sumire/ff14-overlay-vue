import{_ as e}from"./DragJob-ukMYIzls.js";import{t as r,at as a,r as t,c as n,f as i,w as o,v as s,x as l,A as u,K as c,a9 as p,u as v,E as d,M as m,L as f,J as b,S as g}from"./vue-vendor-Bbuz3Kwb.js";import{j as h}from"./util-DL4pAhxD.js";import{N as x}from"./netregexes-QpAZTWa9.js";import{a as y}from"./overlay_plugin_api-C1Kk3pZW.js";import{u as j}from"./index-bbahPALZ.js";import{_ as w}from"./_plugin-vue_export-helper-BCo6x5W8.js";const P=w(r({__name:"showBarrier",setup(r){a((e=>({"21bf6ff8":v(S),e74d3e0e:v(N)})));const w={statusEffectExplicit:x.statusEffectExplicit()};let P=0;const _=t([]),E=t(""),A=t(window.location.href),I=n((()=>new URLSearchParams(A.value.split("?")[1]))),L=n((()=>"1"===I.value.get("showSettings"))),S=n((()=>40*Number(I.value.get("lineHeight")||1)+"px")),N=n((()=>`${Number(I.value.get("fontSize")||26)}px`)),C=n((()=>I.value.get("type")||"1"));const $=j("cactbotRuntime-sortArr",h);function U(e){$.value=e}function D(){_.value.sort(((e,r)=>e.id===E.value?-1:r.id===E.value?1:e.job===r.job?r.id.localeCompare(e.id):$.value.indexOf(e.job)-$.value.indexOf(r.job)))}function R(e){return"1"===C.value?`${e.barrierPercent}`:"2"===C.value?`${e.barrierAmount}`:`${e.barrierPercent}%(${e.barrierAmount})`}return i((()=>{y("LogLine",(e=>{!function(e){var r,a,t;const n=w.statusEffectExplicit.exec(e);if(null==(r=null==n?void 0:n.groups)?void 0:r.targetId.startsWith("1")){const e=_.value.find((e=>{var r;return e.id===(null==(r=n.groups)?void 0:r.targetId)}));e&&(e.barrierPercent=Number(null==(a=n.groups)?void 0:a.currentShield),e.barrierAmount=Math.round(Number(null==(t=n.groups)?void 0:t.maxHp)*e.barrierPercent/100))}}(e.rawLine)})),y("PartyChanged",(e=>{_.value=e.party.filter((e=>e.inParty)).map((e=>({...e,barrierPercent:0,barrierAmount:0})))})),y("ChangePrimaryPlayer",(e=>{E.value=Number(e.charID).toString(16).toUpperCase()})),o([_,E,$],(()=>{clearInterval(P),E.value?D():P=setInterval((()=>{E.value&&(D(),clearInterval(P))}),100)}),{immediate:!0}),window.addEventListener("hashchange",(e=>A.value=e.newURL))})),(r,a)=>{const t=e;return s(),l("div",null,[u("ul",null,[(s(!0),l(c,null,p(v(_),(e=>(s(),l("li",{key:e.id},[d(u("span",{"m-r-2":""},b(e.name),513),[[m,v(L)]]),u("span",{style:g(0===e.barrierPercent?{opacity:.25,color:"white"}:{opacity:1,color:"#f5da3c"})},b(R(e)),5)])))),128))]),d(f(t,{style:{"z-index":"10000"},party:v(_),"m-b-1":"","p-1":"",onUpdateSortArr:U},null,8,["party"]),[[m,v(L)]])])}}}),[["__scopeId","data-v-243d7cc7"]]);export{P as default};
