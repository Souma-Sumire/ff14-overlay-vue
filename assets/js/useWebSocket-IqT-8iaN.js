import{A as e}from"./actWS-BajPEIJJ.js";import{c as o}from"./overlay_plugin_api-DU1DlPio.js";import{k as t}from"./element-plus-QcyfhpSy.js";import{r as n,f as a,w as s}from"./vue-vendor-Bbuz3Kwb.js";function l(e){return new Promise(((o,t)=>{const n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.select();try{document.execCommand("copy"),o()}catch(a){t(a)}finally{document.body.removeChild(n)}}))}function r(l={allowClose:!1,addWsParam:!0}){const r=n(void 0),c=n(!1),i=n("overlay");function u(){Promise.race([o({call:"cactbotRequestState"}),new Promise(((e,o)=>{setTimeout((()=>{o(new Error("Timeout"))}),1e3)}))]).then((()=>{r.value=!0,i.value="websocket"})).catch((()=>{r.value=!1,i.value="overlay"}))}return a((()=>{!function(){const e=window.navigator.userAgent,o=e.includes("MSIE "),t=e.includes("Trident/");return o||t}()?(s(r,(o=>{o?t.close():c.value||t.alert(`请按照下图设置<img src='${e}' style='width:100%'>`,l.allowClose?"未连接到 ACT":"未连接到 ACT，无法使用",{dangerouslyUseHTMLString:!0,closeOnClickModal:!1,showClose:!1,closeOnPressEscape:!1,closeOnHashChange:!1,showCancelButton:l.allowClose,showConfirmButton:!1,cancelButtonText:"我偏要看看",buttonSize:"small"}).catch((()=>{c.value=!0}))})),!window.location.href.includes("OVERLAY_WS")&&l.addWsParam&&function(){const e=window.location.href,[o,t=""]=e.split("#"),[n,a=""]=t.split("?"),s=new URLSearchParams(a);let l="";s.forEach(((e,o)=>{"OVERLAY_WS"!==o&&(l+=`${o}=${encodeURIComponent(e)}&`)})),l+="OVERLAY_WS=ws://127.0.0.1:10501/ws";let r=o;n&&(r+=`#${n}`,l&&(r+=`?${l}`)),window.location.href=r,location.reload()}(),u(),setInterval((()=>{u()}),3e3)):t.alert("不支持 IE 浏览器，请使用 Chrome、Firefox、Edge 等现代浏览器访问。","提示",{type:"error",showConfirmButton:!1,showClose:!1})})),{wsConnected:r,useType:i}}export{l as c,r as u};
