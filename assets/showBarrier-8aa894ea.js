import{_ as e}from"./ActWrapper-5069e8c1.js";import{u as r,_ as a}from"./DragJob-b424de72.js";import{k as t,r as s,c as i,J as o,K as n,x as u,y as l,aQ as c,u as p,o as m,q as d,z as v,l as b,F as f,ae as g,E as h,H as j,U as y,G as x}from"./vue-49c48d91.js";import{N as w,a as P}from"./cactbot-49e370f3.js";import{_}from"./_plugin-vue_export-helper-6a8c15be.js";import"./element-plus-901ad096.js";import"./vendor-979eac9e.js";import"./useDev-861d544b.js";import"./useDemo-86956ef5.js";import"./util-3591e9ca.js";const E=_(t({__name:"showBarrier",setup(t){c(e=>({"38cc43cb":p(C),eae0bb00:p(D)}));const _=r(),E={statusEffectExplicit:w.statusEffectExplicit()};let I=0;const L=s([]),N=s(""),S=s(window.location.href),A=i(()=>new URLSearchParams(S.value.split("?")[1])),$=i(()=>"1"===A.value.get("showSettings")),C=i(()=>40*Number(A.value.get("lineHeight")||1)+"px"),D=i(()=>`${Number(A.value.get("fontSize")||26)}px`),U=i(()=>A.value.get("type")||"1");function z(){L.value.sort((e,r)=>e.id===N.value?-1:r.id===N.value?1:e.job===r.job?r.id.localeCompare(e.id):_.arr.indexOf(e.job)-_.arr.indexOf(r.job))}function H(e){return"1"===U.value?`${e.barrierPercent}`:"2"===U.value?`${e.barrierAmount}`:`${e.barrierPercent}%(${e.barrierAmount})`}return o(()=>{P("LogLine",e=>{!function(e){const r=E.statusEffectExplicit.exec(e);if(r?.groups?.targetId.startsWith("1")){const e=L.value.find(e=>e.id===r.groups?.targetId);e&&(e.barrierPercent=Number(r.groups?.currentShield),e.barrierAmount=Math.round(Number(r.groups?.maxHp)*e.barrierPercent/100))}}(e.rawLine)}),P("PartyChanged",e=>{L.value=e.party.filter(e=>e.inParty).map(e=>({...e,barrierPercent:0,barrierAmount:0}))}),P("ChangePrimaryPlayer",e=>{N.value=Number(e.charID).toString(16).toUpperCase()}),n([L,N,_.arr],()=>{clearInterval(I),N.value?z():I=window.setInterval(()=>{N.value&&(z(),clearInterval(I))},100)},{immediate:!0}),window.addEventListener("hashchange",e=>S.value=e.newURL)}),(r,t)=>{const s=a,i=e;return m(),u(i,null,{default:l(()=>[d("div",null,[d("ul",null,[(m(!0),b(f,null,g(p(L),e=>(m(),b("li",{key:e.id},[v(d("span",{"m-r-2":""},h(e.name),513),[[j,p($)]]),d("span",{style:y(0===e.barrierPercent?{opacity:.25,color:"white"}:{opacity:1,color:"#f5da3c"})},h(H(e)),5)]))),128))]),v(x(s,{style:{"z-index":"10000"},party:p(L),"m-b-1":"","p-1":""},null,8,["party"]),[[j,p($)]])])]),_:1})}}}),[["__scopeId","data-v-d26e0ae1"]]);export{E as default};
