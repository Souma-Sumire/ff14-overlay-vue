var pe=Object.defineProperty;var ue=(i,e,t)=>e in i?pe(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var J=(i,e,t)=>(ue(i,typeof e!="symbol"?e+"":e,t),t);const me=["CurrentWorldID","WorldID","WorldName","BNpcID","BNpcNameID","PartyType","ID","OwnerID","WeaponId","Type","Job","Level","Name","CurrentHP","MaxHP","CurrentMP","MaxMP","PosX","PosY","PosZ","Heading","MonsterType","Status","ModelStatus","AggressionStatus","TargetID","IsTargetable","Radius","Distance","EffectiveDistance","NPCTargetID","CurrentGP","MaxGP","CurrentCP","MaxCP","PCTargetID","IsCasting1","IsCasting2","CastBuffID","CastTargetID","CastGroundTargetX","CastGroundTargetY","CastGroundTargetZ","CastDurationCurrent","CastDurationMax","TransformationId"],le={GameLog:{type:"00",name:"GameLog",source:"FFXIV_ACT_Plugin",messageType:"ChatLog",fields:{type:0,timestamp:1,code:2,name:3,line:4},subFields:{code:{"0039":{name:"message",canAnonymize:!0},"0038":{name:"echo",canAnonymize:!0},"0044":{name:"dialog",canAnonymize:!0},"0839":{name:"message",canAnonymize:!0}}},firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{code:["0044","0839"]}}},ChangeZone:{type:"01",name:"ChangeZone",source:"FFXIV_ACT_Plugin",messageType:"Territory",fields:{type:0,timestamp:1,id:2,name:3},lastInclude:!0,canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all"}},ChangedPlayer:{type:"02",name:"ChangedPlayer",source:"FFXIV_ACT_Plugin",messageType:"ChangePrimaryPlayer",fields:{type:0,timestamp:1,id:2,name:3},playerIds:{2:3},lastInclude:!0,canAnonymize:!0,firstOptionalField:void 0},AddedCombatant:{type:"03",name:"AddedCombatant",source:"FFXIV_ACT_Plugin",messageType:"AddCombatant",fields:{type:0,timestamp:1,id:2,name:3,job:4,level:5,ownerId:6,worldId:7,world:8,npcNameId:9,npcBaseId:10,currentHp:11,hp:12,currentMp:13,mp:14,x:17,y:18,z:19,heading:20},playerIds:{2:3,6:null},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{id:"4.{7}"},combatantIdFields:2}},RemovedCombatant:{type:"04",name:"RemovedCombatant",source:"FFXIV_ACT_Plugin",messageType:"RemoveCombatant",fields:{type:0,timestamp:1,id:2,name:3,job:4,level:5,owner:6,world:8,npcNameId:9,npcBaseId:10,currentHp:11,hp:12,currentMp:13,mp:14,x:17,y:18,z:19,heading:20},playerIds:{2:3,6:null},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{id:"4.{7}"},combatantIdFields:2}},PartyList:{type:"11",name:"PartyList",source:"FFXIV_ACT_Plugin",messageType:"PartyList",fields:{type:0,timestamp:1,partyCount:2,id0:3,id1:4,id2:5,id3:6,id4:7,id5:8,id6:9,id7:10,id8:11,id9:12,id10:13,id11:14,id12:15,id13:16,id14:17,id15:18,id16:19,id17:20,id18:21,id19:22,id20:23,id21:24,id22:25,id23:26},playerIds:{3:null,4:null,5:null,6:null,7:null,8:null,9:null,10:null,11:null,12:null,13:null,14:null,15:null,16:null,17:null,18:null,19:null,20:null,21:null,22:null,23:null,24:null,25:null,26:null},firstOptionalField:3,canAnonymize:!0,lastInclude:!0},PlayerStats:{type:"12",name:"PlayerStats",source:"FFXIV_ACT_Plugin",messageType:"PlayerStats",fields:{type:0,timestamp:1,job:2,strength:3,dexterity:4,vitality:5,intelligence:6,mind:7,piety:8,attackPower:9,directHit:10,criticalHit:11,attackMagicPotency:12,healMagicPotency:13,determination:14,skillSpeed:15,spellSpeed:16,tenacity:18,localContentId:19},canAnonymize:!0,lastInclude:!0,firstOptionalField:void 0},StartsUsing:{type:"20",name:"StartsUsing",source:"FFXIV_ACT_Plugin",messageType:"StartsCasting",fields:{type:0,timestamp:1,sourceId:2,source:3,id:4,ability:5,targetId:6,target:7,castTime:8,x:9,y:10,z:11,heading:12},possibleRsvFields:5,blankFields:[6],playerIds:{2:3,6:7},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{sourceId:"4.{7}"},combatantIdFields:[2,6]}},Ability:{type:"21",name:"Ability",source:"FFXIV_ACT_Plugin",messageType:"ActionEffect",fields:{type:0,timestamp:1,sourceId:2,source:3,id:4,ability:5,targetId:6,target:7,flags:8,damage:9,targetCurrentHp:24,targetMaxHp:25,targetCurrentMp:26,targetMaxMp:27,targetX:30,targetY:31,targetZ:32,targetHeading:33,currentHp:34,maxHp:35,currentMp:36,maxMp:37,x:40,y:41,z:42,heading:43,sequence:44,targetIndex:45,targetCount:46,ownerId:47,ownerName:48,effectDisplayType:49,actionId:50,actionAnimationId:51,animationLockTime:52,rotationHex:53},possibleRsvFields:5,playerIds:{2:3,6:7,47:48},blankFields:[6,47,48],canAnonymize:!0,firstOptionalField:47,analysisOptions:{include:"filter",filters:{sourceId:"4.{7}"},combatantIdFields:[2,6]}},NetworkAOEAbility:{type:"22",name:"NetworkAOEAbility",source:"FFXIV_ACT_Plugin",messageType:"AOEActionEffect",fields:{type:0,timestamp:1,sourceId:2,source:3,id:4,ability:5,targetId:6,target:7,flags:8,damage:9,targetCurrentHp:24,targetMaxHp:25,targetCurrentMp:26,targetMaxMp:27,targetX:30,targetY:31,targetZ:32,targetHeading:33,currentHp:34,maxHp:35,currentMp:36,maxMp:37,x:40,y:41,z:42,heading:43,sequence:44,targetIndex:45,targetCount:46,ownerId:47,ownerName:48,effectDisplayType:49,actionId:50,actionAnimationId:51,animationLockTime:52,rotationHex:53},possibleRsvFields:5,playerIds:{2:3,6:7,47:48},blankFields:[6,47,48],canAnonymize:!0,firstOptionalField:47,analysisOptions:{include:"filter",filters:{sourceId:"4.{7}"},combatantIdFields:[2,6]}},NetworkCancelAbility:{type:"23",name:"NetworkCancelAbility",source:"FFXIV_ACT_Plugin",messageType:"CancelAction",fields:{type:0,timestamp:1,sourceId:2,source:3,id:4,name:5,reason:6},possibleRsvFields:5,playerIds:{2:3},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{sourceId:"4.{7}"},combatantIdFields:2}},NetworkDoT:{type:"24",name:"NetworkDoT",source:"FFXIV_ACT_Plugin",messageType:"DoTHoT",fields:{type:0,timestamp:1,id:2,name:3,which:4,effectId:5,damage:6,currentHp:7,maxHp:8,currentMp:9,maxMp:10,x:13,y:14,z:15,heading:16,sourceId:17,source:18,damageType:19,sourceCurrentHp:20,sourceMaxHp:21,sourceCurrentMp:22,sourceMaxMp:23,sourceX:26,sourceY:27,sourceZ:28,sourceHeading:29},playerIds:{2:3,17:18},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{id:"1.{7}",which:"DoT",effectId:"0*?[1-9A-F][0-9A-F]*"},combatantIdFields:[2,17]}},WasDefeated:{type:"25",name:"WasDefeated",source:"FFXIV_ACT_Plugin",messageType:"Death",fields:{type:0,timestamp:1,targetId:2,target:3,sourceId:4,source:5},playerIds:{2:3,4:5},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{targetId:"4.{7}"},combatantIdFields:2}},GainsEffect:{type:"26",name:"GainsEffect",source:"FFXIV_ACT_Plugin",messageType:"StatusAdd",fields:{type:0,timestamp:1,effectId:2,effect:3,duration:4,sourceId:5,source:6,targetId:7,target:8,count:9,targetMaxHp:10,sourceMaxHp:11},possibleRsvFields:3,playerIds:{5:6,7:8},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:[{sourceId:"[E4].{7}",targetId:"1.{7}"},{sourceId:"[E4].{7}",targetId:"4.{7}"},{effectId:["B9A","808"]}],combatantIdFields:[5,7]}},HeadMarker:{type:"27",name:"HeadMarker",source:"FFXIV_ACT_Plugin",messageType:"TargetIcon",fields:{type:0,timestamp:1,targetId:2,target:3,id:6,data0:7},playerIds:{2:3},possiblePlayerIds:[7],canAnonymize:!0,firstOptionalField:7,analysisOptions:{include:"all",combatantIdFields:2}},NetworkRaidMarker:{type:"28",name:"NetworkRaidMarker",source:"FFXIV_ACT_Plugin",messageType:"WaymarkMarker",fields:{type:0,timestamp:1,operation:2,waymark:3,id:4,name:5,x:6,y:7,z:8},playerIds:{4:5},canAnonymize:!0,firstOptionalField:void 0},NetworkTargetMarker:{type:"29",name:"NetworkTargetMarker",source:"FFXIV_ACT_Plugin",messageType:"SignMarker",fields:{type:0,timestamp:1,operation:2,waymark:3,id:4,name:5,targetId:6,targetName:7},playerIds:{4:5,6:7},firstOptionalField:void 0},LosesEffect:{type:"30",name:"LosesEffect",source:"FFXIV_ACT_Plugin",messageType:"StatusRemove",fields:{type:0,timestamp:1,effectId:2,effect:3,sourceId:5,source:6,targetId:7,target:8,count:9},possibleRsvFields:3,playerIds:{5:6,7:8},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:[{sourceId:"[E4].{7}",targetId:"1.{7}"},{sourceId:"[E4].{7}",targetId:"4.{7}"},{effectId:["B9A","808"]}],combatantIdFields:[5,7]}},NetworkGauge:{type:"31",name:"NetworkGauge",source:"FFXIV_ACT_Plugin",messageType:"Gauge",fields:{type:0,timestamp:1,id:2,data0:3,data1:4,data2:5,data3:6},playerIds:{2:null},firstUnknownField:3,canAnonymize:!0,firstOptionalField:void 0},NetworkWorld:{type:"32",name:"NetworkWorld",source:"FFXIV_ACT_Plugin",messageType:"World",fields:{type:0,timestamp:1},isUnknown:!0,firstOptionalField:void 0},ActorControl:{type:"33",name:"ActorControl",source:"FFXIV_ACT_Plugin",messageType:"Director",fields:{type:0,timestamp:1,instance:2,command:3,data0:4,data1:5,data2:6,data3:7},possiblePlayerIds:[4,5,6,7],canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},NameToggle:{type:"34",name:"NameToggle",source:"FFXIV_ACT_Plugin",messageType:"NameToggle",fields:{type:0,timestamp:1,id:2,name:3,targetId:4,targetName:5,toggle:6},playerIds:{2:3,4:5},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},Tether:{type:"35",name:"Tether",source:"FFXIV_ACT_Plugin",messageType:"Tether",fields:{type:0,timestamp:1,sourceId:2,source:3,targetId:4,target:5,id:8},playerIds:{2:3,4:5},canAnonymize:!0,firstUnknownField:9,firstOptionalField:void 0,analysisOptions:{include:"all",combatantIdFields:[2,4]}},LimitBreak:{type:"36",name:"LimitBreak",source:"FFXIV_ACT_Plugin",messageType:"LimitBreak",fields:{type:0,timestamp:1,valueHex:2,bars:3},canAnonymize:!0,firstOptionalField:void 0},NetworkEffectResult:{type:"37",name:"NetworkEffectResult",source:"FFXIV_ACT_Plugin",messageType:"EffectResult",fields:{type:0,timestamp:1,id:2,name:3,sequenceId:4,currentHp:5,maxHp:6,currentMp:7,maxMp:8,currentShield:9,x:11,y:12,z:13,heading:14},playerIds:{2:3},firstUnknownField:22,canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},StatusEffect:{type:"38",name:"StatusEffect",source:"FFXIV_ACT_Plugin",messageType:"StatusList",fields:{type:0,timestamp:1,targetId:2,target:3,jobLevelData:4,hp:5,maxHp:6,mp:7,maxMp:8,currentShield:9,x:11,y:12,z:13,heading:14,data0:15,data1:16,data2:17,data3:18,data4:19,data5:20},playerIds:{2:3},firstUnknownField:18,canAnonymize:!0,firstOptionalField:18},NetworkUpdateHP:{type:"39",name:"NetworkUpdateHP",source:"FFXIV_ACT_Plugin",messageType:"UpdateHp",fields:{type:0,timestamp:1,id:2,name:3,currentHp:4,maxHp:5,currentMp:6,maxMp:7,x:10,y:11,z:12,heading:13},playerIds:{2:3},canAnonymize:!0,firstOptionalField:void 0},Map:{type:"40",name:"Map",source:"FFXIV_ACT_Plugin",messageType:"ChangeMap",fields:{type:0,timestamp:1,id:2,regionName:3,placeName:4,placeNameSub:5},canAnonymize:!0,firstOptionalField:void 0,lastInclude:!0,analysisOptions:{include:"all"}},SystemLogMessage:{type:"41",name:"SystemLogMessage",source:"FFXIV_ACT_Plugin",messageType:"SystemLogMessage",fields:{type:0,timestamp:1,instance:2,id:3,param0:4,param1:5,param2:6},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all"}},StatusList3:{type:"42",name:"StatusList3",source:"FFXIV_ACT_Plugin",messageType:"StatusList3",fields:{type:0,timestamp:1,id:2,name:3},playerIds:{2:3},canAnonymize:!0,firstOptionalField:4,firstUnknownField:4},ParserInfo:{type:"249",name:"ParserInfo",source:"FFXIV_ACT_Plugin",messageType:"Settings",fields:{type:0,timestamp:1},globalInclude:!0,canAnonymize:!0,firstOptionalField:void 0},ProcessInfo:{type:"250",name:"ProcessInfo",source:"FFXIV_ACT_Plugin",messageType:"Process",fields:{type:0,timestamp:1},globalInclude:!0,canAnonymize:!0,firstOptionalField:void 0},Debug:{type:"251",name:"Debug",source:"FFXIV_ACT_Plugin",messageType:"Debug",fields:{type:0,timestamp:1},globalInclude:!0,canAnonymize:!1,firstOptionalField:void 0},PacketDump:{type:"252",name:"PacketDump",source:"FFXIV_ACT_Plugin",messageType:"PacketDump",fields:{type:0,timestamp:1},canAnonymize:!1,firstOptionalField:void 0},Version:{type:"253",name:"Version",source:"FFXIV_ACT_Plugin",messageType:"Version",fields:{type:0,timestamp:1},globalInclude:!0,canAnonymize:!0,firstOptionalField:void 0},Error:{type:"254",name:"Error",source:"FFXIV_ACT_Plugin",messageType:"Error",fields:{type:0,timestamp:1},canAnonymize:!1,firstOptionalField:void 0},None:{type:"[0-9]+",name:"None",source:"FFXIV_ACT_Plugin",messageType:"None",fields:{type:0,timestamp:1},isUnknown:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},LineRegistration:{type:"256",name:"LineRegistration",source:"OverlayPlugin",messageType:"256",fields:{type:0,timestamp:1,id:2,source:3,name:4,version:5},globalInclude:!0,canAnonymize:!0,firstOptionalField:void 0},MapEffect:{type:"257",name:"MapEffect",source:"OverlayPlugin",messageType:"257",fields:{type:0,timestamp:1,instance:2,flags:3,location:4,data0:5,data1:6},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all"}},FateDirector:{type:"258",name:"FateDirector",source:"OverlayPlugin",messageType:"258",fields:{type:0,timestamp:1,category:2,fateId:4,progress:5},canAnonymize:!0,firstOptionalField:void 0},CEDirector:{type:"259",name:"CEDirector",source:"OverlayPlugin",messageType:"259",fields:{type:0,timestamp:1,popTime:2,timeRemaining:3,ceKey:5,numPlayers:6,status:7,progress:9},canAnonymize:!0,firstOptionalField:void 0},InCombat:{type:"260",name:"InCombat",source:"OverlayPlugin",messageType:"260",fields:{type:0,timestamp:1,inACTCombat:2,inGameCombat:3,isACTChanged:4,isGameChanged:5},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all"}},CombatantMemory:{type:"261",name:"CombatantMemory",source:"OverlayPlugin",messageType:"261",fields:{type:0,timestamp:1,change:2,id:3},canAnonymize:!0,firstOptionalField:5,repeatingFields:{startingIndex:4,label:"pair",names:["key","value"],sortKeys:!0,primaryKey:"key",possibleKeys:me,keysToAnonymize:{3:"Name",OwnerID:null,TargetID:null,PCTargetID:null,NPCTargetID:null,CastTargetID:null}},analysisOptions:{include:"filter",filters:[{id:"4.{7}",change:"Change",pair:[{key:"ModelStatus",value:".*"}]},{id:"4.{7}",change:"Change",pair:[{key:"WeaponId",value:".*"}]},{id:"4.{7}",change:"Change",pair:[{key:"TransformationId",value:".*"}]}],combatantIdFields:3}},RSVData:{type:"262",name:"RSVData",source:"OverlayPlugin",messageType:"262",fields:{type:0,timestamp:1,locale:2,key:4,value:5},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},StartsUsingExtra:{type:"263",name:"StartsUsingExtra",source:"OverlayPlugin",messageType:"263",fields:{type:0,timestamp:1,sourceId:2,id:3,x:4,y:5,z:6,heading:7},playerIds:{2:null},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{sourceId:"4.{7}"},combatantIdFields:2}},AbilityExtra:{type:"264",name:"AbilityExtra",source:"OverlayPlugin",messageType:"264",fields:{type:0,timestamp:1,sourceId:2,id:3,globalEffectCounter:4,dataFlag:5,x:6,y:7,z:8,heading:9},blankFields:[6],playerIds:{2:null},canAnonymize:!0,firstOptionalField:void 0},ContentFinderSettings:{type:"265",name:"ContentFinderSettings",source:"OverlayPlugin",messageType:"265",fields:{type:0,timestamp:1,zoneId:2,zoneName:3,inContentFinderContent:4,unrestrictedParty:5,minimalItemLevel:6,silenceEcho:7,explorerMode:8,levelSync:9},canAnonymize:!0,firstOptionalField:void 0},NpcYell:{type:"266",name:"NpcYell",source:"OverlayPlugin",messageType:"266",fields:{type:0,timestamp:1,npcId:2,npcNameId:3,npcYellId:4},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all",combatantIdFields:2}},BattleTalk2:{type:"267",name:"BattleTalk2",source:"OverlayPlugin",messageType:"267",fields:{type:0,timestamp:1,npcId:2,instance:3,npcNameId:4,instanceContentTextId:5,displayMs:6},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all",combatantIdFields:2}},Countdown:{type:"268",name:"Countdown",source:"OverlayPlugin",messageType:"268",fields:{type:0,timestamp:1,id:2,worldId:3,countdownTime:4,result:5,name:6},playerIds:{2:6},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},CountdownCancel:{type:"269",name:"CountdownCancel",source:"OverlayPlugin",messageType:"269",fields:{type:0,timestamp:1,id:2,worldId:3,name:4},playerIds:{2:4},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},ActorMove:{type:"270",name:"ActorMove",source:"OverlayPlugin",messageType:"270",fields:{type:0,timestamp:1,id:2,heading:3,x:6,y:7,z:8},playerIds:{2:null},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"never"}},ActorSetPos:{type:"271",name:"ActorSetPos",source:"OverlayPlugin",messageType:"271",fields:{type:0,timestamp:1,id:2,heading:3,x:6,y:7,z:8},playerIds:{2:null},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"filter",filters:{id:"4.{7}"},combatantIdFields:2}},SpawnNpcExtra:{type:"272",name:"SpawnNpcExtra",source:"OverlayPlugin",messageType:"272",fields:{type:0,timestamp:1,id:2,parentId:3,tetherId:4,animationState:5},playerIds:{3:null},canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all",combatantIdFields:[2,3]}},ActorControlExtra:{type:"273",name:"ActorControlExtra",source:"OverlayPlugin",messageType:"273",fields:{type:0,timestamp:1,id:2,category:3,param1:4,param2:5,param3:6,param4:7},playerIds:{2:null},possiblePlayerIds:[4,5,6,7],canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all",combatantIdFields:2}},ActorControlSelfExtra:{type:"274",name:"ActorControlSelfExtra",source:"OverlayPlugin",messageType:"274",fields:{type:0,timestamp:1,id:2,category:3,param1:4,param2:5,param3:6,param4:7,param5:8,param6:9},playerIds:{2:null},possiblePlayerIds:[4,5,6,7,8,9],canAnonymize:!0,firstOptionalField:void 0,analysisOptions:{include:"all",combatantIdFields:2}}},se={latest:le},ye=le;console.assert(ye);const Q=se.latest;class de extends Error{constructor(){super("This code shouldn't be reached")}}const ee=":",D="[^:]*",ge="(?:[^:]|: )*?",fe=["effect","ability"],Fe=(i,e,t)=>{const a=se[e][i];t===void 0&&(t=Object.keys(a.fields),"repeatingFields"in a&&t.push(a.repeatingFields.label));const r={},d=a.firstOptionalField;for(const[c,C]of Object.entries(a.fields)){if(!t.includes(c))continue;const k={field:c,optional:d!==void 0&&C>=d};c==="type"&&(k.value=a.type),r[C]=k}return"repeatingFields"in a&&t.includes(a.repeatingFields.label)&&(r[a.repeatingFields.startingIndex]={field:a.repeatingFields.label,optional:d!==void 0&&a.repeatingFields.startingIndex>=d,repeating:!0,repeatingKeys:[...a.repeatingFields.names],sortKeys:a.repeatingFields.sortKeys,primaryKey:a.repeatingFields.primaryKey,possibleKeys:[...a.repeatingFields.possibleKeys]}),r},Ie=(i,e)=>{if(i!==!0)return!1;if(e===void 0)return!0;if(!Array.isArray(e))return!1;for(const t of e)if(typeof t!="object")return!1;return!0},Ce=(i,e,t)=>{var K,j,G,W,B,o,y,h,V;i=i??{};const a=[];for(const l in t){const u=t[l];u&&a.push(u.field)}I.validateParams(i,e,["capture",...a]);const r=I.trueIfUndefined(i.capture),d=Object.keys(t).sort((l,u)=>parseInt(l)-parseInt(u));let c;if(r){const l=[];for(const g in t)l.push(g);let u=l.pop();if(u===void 0)c=d[d.length-1]??"0";else{for(;(K=t[u])!=null&&K.optional&&!((((j=t[u])==null?void 0:j.field)??"")in i);)u=l.pop();c=u??"0"}}else{c="0";for(const l in t){if(typeof(t[l]??{})!="object")continue;const g=(G=t[l])==null?void 0:G.field;g!==void 0&&g in i&&(c=l)}}const C=parseInt(c),k=`(?:${Q.Ability.messageType}|${Q.NetworkAOEAbility.messageType})`,re="(?:15|16)",M=e!=="Ability"?Q[e].messageType:k,X=parseInt(Q[e].type).toString(16).toUpperCase(),q=X.length<2?`00${X}`.slice(-2):X,R=e!=="Ability"?q:re;let T="";r?T+=`(?<timestamp>\\y{Timestamp}) ${M} (?<type>${R})`:T+=`\\y{Timestamp} ${M} ${R}`;let U=1;for(const l in t){const u=t[l];if(u===void 0)continue;const g=u.field;if(g==="timestamp"||g==="type")continue;const z=parseInt(l),Y=z-U-1;if(Y===1?T+=`${ee}${D}`:Y>1&&(T+=`(?:${ee}${D}){${Y}}`),U=z,T+=ee,typeof u!="object")throw new Error(`${e}: invalid value: ${JSON.stringify(u)}`);const w=g!==void 0&&fe.includes(g)?ge:D,O=((W=u.value)==null?void 0:W.toString())??w,S=i[g];if(Ie((B=t[l])==null?void 0:B.repeating,S)){const A="(?:$|:)";let m=S;const N=(o=t[l])==null?void 0:o.sortKeys,f=(y=t[l])==null?void 0:y.primaryKey,P=(h=t[l])==null?void 0:h.possibleKeys;if(f===void 0||P===void 0)throw new de;N&&(P.sort((p,F)=>p.toLowerCase().localeCompare(F.toLowerCase())),m!==void 0&&(m=[...m].sort((p,F)=>{if(typeof p!="object"||p[f]===void 0)return console.warn("Invalid argument passed to trigger:",p),0;const L=p[f];if(typeof L!="string"||!(P!=null&&P.includes(L)))return console.warn("Invalid argument passed to trigger:",p),0;if(typeof F!="object"||F[f]===void 0)return console.warn("Invalid argument passed to trigger:",F),0;const $=F[f];return typeof $!="string"||!(P!=null&&P.includes($))?(console.warn("Invalid argument passed to trigger:",F),0):L.toLowerCase().localeCompare($.toLowerCase())})));const x=m;P.forEach(p=>{var $,oe;const F=x==null?void 0:x.find(_=>f in _&&_[f]===p);let L="";(oe=($=t[l])==null?void 0:$.repeatingKeys)==null||oe.forEach(_=>{let E=F==null?void 0:F[_];(F===void 0||!(_ in F))&&(_===f?E=p:E=D),typeof E!="string"&&(Array.isArray(E)?(E.length<1||E.some(ce=>typeof ce!="string"))&&(E=D):E=D),L+=I.maybeCapture(_===f?!1:r,g+p,E,O)+A}),L.length>0&&(T+=`(?:${L})${F!==void 0?"":"?"}`)})}else(V=t[l])!=null&&V.repeating||(g!==void 0?T+=I.maybeCapture(r,g,S,O):T+=S);if(z>=C)break}return T+="(?:$|:)",I.parse(T)},n=(i,e)=>Ce(e,i,Fe(i,I.logVersion)),v=class v{static startsUsing(e){return n("StartsUsing",e)}static ability(e){return n("Ability",e)}static abilityFull(e){return this.ability(e)}static headMarker(e){return n("HeadMarker",e)}static addedCombatant(e){return n("AddedCombatant",e)}static addedCombatantFull(e){return this.addedCombatant(e)}static removingCombatant(e){return n("RemovedCombatant",e)}static gainsEffect(e){return n("GainsEffect",e)}static statusEffectExplicit(e){return n("StatusEffect",e)}static losesEffect(e){return n("LosesEffect",e)}static tether(e){return n("Tether",e)}static wasDefeated(e){return n("WasDefeated",e)}static networkDoT(e){return n("NetworkDoT",e)}static echo(e){return typeof e>"u"&&(e={}),v.validateParams(e,"echo",["type","timestamp","code","name","line","capture"]),e.code="0038",v.gameLog(e)}static dialog(e){return typeof e>"u"&&(e={}),v.validateParams(e,"dialog",["type","timestamp","code","name","line","capture"]),e.code="0044",v.gameLog(e)}static message(e){return typeof e>"u"&&(e={}),v.validateParams(e,"message",["type","timestamp","code","name","line","capture"]),e.code="0839",v.gameLog(e)}static gameLog(e){return n("GameLog",e)}static gameNameLog(e){return v.gameLog(e)}static statChange(e){return n("PlayerStats",e)}static changeZone(e){return n("ChangeZone",e)}static network6d(e){return n("ActorControl",e)}static nameToggle(e){return n("NameToggle",e)}static map(e){return n("Map",e)}static systemLogMessage(e){return n("SystemLogMessage",e)}static mapEffect(e){return n("MapEffect",e)}static fateDirector(e){return n("FateDirector",e)}static ceDirector(e){return n("CEDirector",e)}static inCombat(e){return n("InCombat",e)}static combatantMemory(e){return n("CombatantMemory",e)}static startsUsingExtra(e){return n("StartsUsingExtra",e)}static abilityExtra(e){return n("AbilityExtra",e)}static contentFinderSettings(e){return n("ContentFinderSettings",e)}static npcYell(e){return n("NpcYell",e)}static battleTalk2(e){return n("BattleTalk2",e)}static countdown(e){return n("Countdown",e)}static countdownCancel(e){return n("CountdownCancel",e)}static actorMove(e){return n("ActorMove",e)}static actorSetPos(e){return n("ActorSetPos",e)}static spawnNpcExtra(e){return n("SpawnNpcExtra",e)}static actorControlExtra(e){return n("ActorControlExtra",e)}static actorControlSelfExtra(e){return n("ActorControlSelfExtra",e)}static maybeCapture(e,t,a,r){return a===void 0&&(a=r??D),a=v.anyOf(a),e?v.namedCapture(t,a):a}static optional(e){return`(?:${e})?`}static namedCapture(e,t){return e.includes(">")&&console.error(`"${e}" contains ">".`),e.includes("<")&&console.error(`"${e}" contains ">".`),`(?<${e}>${t})`}static anyOf(...e){const t=d=>{const[c]=d;return c!==void 0&&d.length===1?`${c instanceof RegExp?c.source:c}`:`(?:${d.map(C=>C instanceof RegExp?C.source:C).join("|")})`};let a=[];const[r]=e;return e.length===1?typeof r=="string"||r instanceof RegExp?a=[r]:Array.isArray(r)?a=r:a=[]:a=e,t(a)}static parse(e){const t={Timestamp:"^.{14}",NetTimestamp:".{33}",NetField:"(?:[^|]*\\|)",LogType:"[0-9A-Fa-f]{2}",AbilityCode:"[0-9A-Fa-f]{1,8}",ObjectId:"[0-9A-F]{8}",Name:"(?:[^\\s:|]+(?: [^\\s:|]+)?|)",Float:"-?[0-9]+(?:[.,][0-9]+)?(?:E-?[0-9]+)?"};let a="i";return e instanceof RegExp&&(a+=(e.global?"g":"")+(e.multiline?"m":""),e=e.source),e=e.replace(/\\y\{(.*?)\}/g,(r,d)=>t[d]||r),new RegExp(e,a)}static parseGlobal(e){const t=v.parse(e);let a="gi";return e instanceof RegExp&&(a+=e.multiline?"m":""),new RegExp(t.source,a)}static trueIfUndefined(e){return typeof e>"u"?!0:!!e}static validateParams(e,t,a){if(e===null||typeof e!="object")return;const r=Object.keys(e);for(const d of r)if(!a.includes(d))throw new Error(`${t}: invalid parameter '${d}'.  Valid params: ${JSON.stringify(a)}`)}};J(v,"logVersion","latest");let I=v;const te="\\|",Z="[^|]*",Te="^^",Ae=/^\^\^/,ve=["ability","name","source","target","line"],be=ve,ae={echo:"0038",dialog:"0044",message:"0839"},he={setAnimState:"003E",publicContentText:"0834",logMsg:"020F",logMsgParams:"0210"},ie=(i,e,t)=>{const a=se[e][i];t===void 0&&(t=Object.keys(a.fields),"repeatingFields"in a&&t.push(a.repeatingFields.label));const r={},d=a.firstOptionalField;for(const[c,C]of Object.entries(a.fields)){if(!t.includes(c))continue;const k={field:c,optional:d!==void 0&&C>=d};c==="type"&&(k.value=a.type),r[C]=k}return"repeatingFields"in a&&t.includes(a.repeatingFields.label)&&(r[a.repeatingFields.startingIndex]={field:a.repeatingFields.label,optional:d!==void 0&&a.repeatingFields.startingIndex>=d,repeating:!0,repeatingKeys:[...a.repeatingFields.names],sortKeys:a.repeatingFields.sortKeys,primaryKey:a.repeatingFields.primaryKey,possibleKeys:[...a.repeatingFields.possibleKeys]}),r},Oe=(i,e)=>{if(i!==!0)return!1;if(e===void 0)return!0;if(!Array.isArray(e))return!1;for(const t of e)if(typeof t!="object")return!1;return!0},ne=(i,e,t)=>{var q,R,T,U,K,j,G,W,B;i=i??{};const a=[];for(const o in t){const y=t[o];y&&a.push(y.field)}I.validateParams(i,e,["capture",...a]);const r=I.trueIfUndefined(i.capture),d=Object.keys(t).sort((o,y)=>parseInt(o)-parseInt(y));let c;if(r){const o=[];for(const h in t)o.push(h);let y=o.pop();if(y===void 0)c=d[d.length-1]??"0";else{for(;(q=t[y])!=null&&q.optional&&!((((R=t[y])==null?void 0:R.field)??"")in i);)y=o.pop();c=y??"0"}}else{c="0";for(const o in t){if(typeof(t[o]??{})!="object")continue;const h=(T=t[o])==null?void 0:T.field;h!==void 0&&h in i&&(c=o)}}const C=parseInt(c),k=Object.keys(i).filter(o=>be.includes(o));let M=H.flagTranslationsNeeded&&k.length>0?Te:"^",X=-1;for(const o in t){const y=parseInt(o),h=y-X-1;h===1?M+="\\y{NetField}":h>1&&(M+=`\\y{NetField}{${h}}`),X=y;const V=t[o];if(typeof V!="object")throw new Error(`${e}: invalid value: ${JSON.stringify(V)}`);const l=V.field,u=((U=V.value)==null?void 0:U.toString())??Z,g=i[l];if(Oe((K=t[o])==null?void 0:K.repeating,g)){let z=g;const Y=(j=t[o])==null?void 0:j.sortKeys,w=(G=t[o])==null?void 0:G.primaryKey,O=(W=t[o])==null?void 0:W.possibleKeys;if(w===void 0||O===void 0)throw new de;Y&&(O.sort((A,m)=>A.toLowerCase().localeCompare(m.toLowerCase())),z!==void 0&&(z=[...z].sort((A,m)=>{if(typeof A!="object"||A[w]===void 0)return console.warn("Invalid argument passed to trigger:",A),0;const N=A[w];if(typeof N!="string"||!(O!=null&&O.includes(N)))return console.warn("Invalid argument passed to trigger:",A),0;if(typeof m!="object"||m[w]===void 0)return console.warn("Invalid argument passed to trigger:",m),0;const f=m[w];return typeof f!="string"||!(O!=null&&O.includes(f))?(console.warn("Invalid argument passed to trigger:",m),0):N.toLowerCase().localeCompare(f.toLowerCase())})));const S=z;O.forEach(A=>{var f,P;const m=S==null?void 0:S.find(x=>w in x&&x[w]===A);let N="";(P=(f=t[o])==null?void 0:f.repeatingKeys)==null||P.forEach(x=>{let p=m==null?void 0:m[x];(m===void 0||!(x in m))&&(x===w?p=A:p=Z),typeof p!="string"&&(Array.isArray(p)?(p.length<1||p.some(F=>typeof F!="string"))&&(p=Z):p=Z),N+=I.maybeCapture(x===w?!1:r,l+A,p,u)+te}),N.length>0&&(M+=`(?:${N})${m!==void 0?"":"?"}`)})}else(B=t[o])!=null&&B.repeating||(l!==void 0?M+=I.maybeCapture(r,l,g,u)+te:M+=u+te);if(y>=C)break}return I.parse(M)},s=(i,e)=>ne(e,i,ie(i,H.logVersion)),b=class b{static setFlagTranslationsNeeded(e){b.flagTranslationsNeeded=e}static doesNetRegexNeedTranslation(e){console.assert(b.flagTranslationsNeeded);const t=typeof e=="string"?e:e.source;return!!Ae.exec(t)}static startsUsing(e){return s("StartsUsing",e)}static ability(e){return ne(e,"Ability",{...ie("Ability",b.logVersion),0:{field:"type",value:"2[12]",optional:!1}})}static abilityFull(e){return this.ability(e)}static headMarker(e){return s("HeadMarker",e)}static addedCombatant(e){return ne(e,"AddedCombatant",ie("AddedCombatant",b.logVersion))}static addedCombatantFull(e){return b.addedCombatant(e)}static removingCombatant(e){return s("RemovedCombatant",e)}static gainsEffect(e){return s("GainsEffect",e)}static statusEffectExplicit(e){return s("StatusEffect",e)}static losesEffect(e){return s("LosesEffect",e)}static tether(e){return s("Tether",e)}static wasDefeated(e){return s("WasDefeated",e)}static networkDoT(e){return s("NetworkDoT",e)}static echo(e){return typeof e>"u"&&(e={}),I.validateParams(e,"Echo",["type","timestamp","code","name","line","capture"]),b.gameLog({...e,code:ae.echo})}static dialog(e){return typeof e>"u"&&(e={}),I.validateParams(e,"Dialog",["type","timestamp","code","name","line","capture"]),b.gameLog({...e,code:ae.dialog})}static message(e){return typeof e>"u"&&(e={}),I.validateParams(e,"Message",["type","timestamp","code","name","line","capture"]),b.gameLog({...e,code:ae.message})}static gameLog(e){return s("GameLog",e)}static gameNameLog(e){return b.gameLog(e)}static statChange(e){return s("PlayerStats",e)}static changeZone(e){return s("ChangeZone",e)}static network6d(e){return s("ActorControl",e)}static nameToggle(e){return s("NameToggle",e)}static map(e){return s("Map",e)}static systemLogMessage(e){return s("SystemLogMessage",e)}static mapEffect(e){return s("MapEffect",e)}static fateDirector(e){return s("FateDirector",e)}static ceDirector(e){return s("CEDirector",e)}static inCombat(e){return s("InCombat",e)}static combatantMemory(e){return s("CombatantMemory",e)}static startsUsingExtra(e){return s("StartsUsingExtra",e)}static abilityExtra(e){return s("AbilityExtra",e)}static contentFinderSettings(e){return s("ContentFinderSettings",e)}static npcYell(e){return s("NpcYell",e)}static battleTalk2(e){return s("BattleTalk2",e)}static countdown(e){return s("Countdown",e)}static countdownCancel(e){return s("CountdownCancel",e)}static actorMove(e){return s("ActorMove",e)}static actorSetPos(e){return s("ActorSetPos",e)}static spawnNpcExtra(e){return s("SpawnNpcExtra",e)}static actorControlExtra(e){return s("ActorControlExtra",e)}static actorControlSelfExtra(e){return s("ActorControlSelfExtra",e)}};J(b,"logVersion","latest"),J(b,"flagTranslationsNeeded",!1);let H=b;const we={wipe:H.network6d({command:["40000010","4000000F"]}),cactbotWipeEcho:H.echo({line:"cactbot wipe.*?"}),userWipeEcho:H.echo({line:"end"})};export{H as N,I as R,de as U,he as a,we as c,ae as g,Q as l};
