import{_ as e}from"./ActWrapper-5069e8c1.js";import{f as s}from"./element-plus-901ad096.js";import{u as a}from"./useDemo-86956ef5.js";import{u as l}from"./useDev-861d544b.js";import{u as i}from"./useZone-1661c0fc.js";import{u as t,c as o}from"./keySkills-78bd60df.js";import{a as r,r as n}from"./cactbot-49e370f3.js";import{k as c,aW as u,c as p,J as m,L as k,x as d,y as f,o as y,l as _,B as j,u as g,U as h,q as v,F as w,ae as S,A as b,E as C,G as P,D as I}from"./vue-49c48d91.js";import{_ as D}from"./_plugin-vue_export-helper-6a8c15be.js";import"./vendor-979eac9e.js";import"./res-zoneInfo-5ea06bcd.js";import"./util-3591e9ca.js";import"./res-action-f84fe53b.js";import"./chineseToIcon-e0fcd48d.js";import"./res-status-9bc9036c.js";import"./tts-30083447.js";const x={class:"skills-grid"},L=["onClick"],T={class:"buff-filter"},F=["src"],$={key:1,class:"test"},z=D(c({__name:"keySkillTimer",setup(c){const D=u("hash"),z=t(),{zoneType:A}=i(),E=p(()=>"Pvp"===A.value),N=l(),G=a(),O=e=>{z.party=e.party},R=e=>{if(!E.value)if("21"===e.line[0]||"22"===e.line[0]&&"0"===e.line[45]){const s=Number.parseInt(e.line[4],16),a=o(s),l=e.line[2];z.triggerSkill(a,l,!0)}else"33"===e.line[0]&&["40000010","4000000F"].includes(e.line[3])&&z.wipe()},U=e=>{z.language=e.charName.includes(" ")?"global":"chinese"};function W(e){z.speed=e,z.usedSkills.forEach(e=>{z.triggerSkill(e.id,e.owner.id,!1)})}function X(){window.open("/#/keySkillTimerSettings","_blank")}return m(()=>{r("PartyChanged",O),r("LogLine",R),r("ChangePrimaryPlayer",U)}),k(()=>{n("PartyChanged",O),n("LogLine",R),n("ChangePrimaryPlayer",U),Object.values(z.skillStates).forEach(e=>{e.rafId&&cancelAnimationFrame(e.rafId)})}),(a,l)=>{const i=s,t=e;return y(),d(t,null,{readme:f(()=>l[3]||(l[3]=[v("span",{class:"demo-text"},[I(" 当前为演示数据，锁定后将显示真实数据。"),v("br"),I(" 请尽量拉宽窗口，点击技能可模拟触发。 ")],-1)])),default:f(()=>[g(E)?j("",!0):(y(),_("div",{key:0,class:"key-skills-timer-container",style:h({"--scale":g(D).scale?.toString(),"--opacity":g(D).opacity?.toString()})},[v("div",x,[(y(!0),_(w,null,S(g(z).usedSkills,e=>(y(),_("div",{key:e.key,class:b(["buff-container",`line${e.line}`]),style:h({zIndex:g(G)||g(N)?99:void 0}),onClick:()=>g(G)||g(N)?function(e,s){(N||G)&&z.triggerSkill(e.id,e.owner.id,s)}(e,!0):null},[v("div",T,[v("span",{class:b(["duration",[g(z).skillStates[e.key]?.isRecast?"cooldown":"active"]])},C(g(z).skillStates[e.key]?.text||""),3),v("img",{src:e.src},null,8,F),g(z).skillStates[e.key]?.active?(y(),_("div",{key:g(z).skillStates[e.key]?.startTime||0,class:"cooldown-layer",style:h({clipPath:`inset(${g(z).skillStates[e.key]?.clipPercent??0}% 0 0 0)`})},null,4)):j("",!0)]),e.owner.hasDuplicate.skill||e.owner.hasDuplicate.job?(y(),_("span",{key:0,class:b(`job has-duplicate ${e.owner.hasDuplicate.job?"duplicate-show-name":"duplicate-show-job-name"} ${e.owner.jobIcon.toLowerCase()}`)},C(e.owner.hasDuplicate.job?e.owner.name:e.owner.jobName),3)):j("",!0)],14,L))),128))])],4)),g(N)||g(G)?(y(),_("div",$,[P(i,{onClick:g(z).demoFullParty},{default:f(()=>l[4]||(l[4]=[I(" 模拟全部职业 ",-1)])),_:1,__:[4]},8,["onClick"]),P(i,{onClick:l[0]||(l[0]=()=>g(z).shuffle())},{default:f(()=>l[5]||(l[5]=[I(" 模拟8人小队 ",-1)])),_:1,__:[5]}),g(N)?(y(),d(i,{key:0,onClick:l[1]||(l[1]=()=>W(1))},{default:f(()=>l[6]||(l[6]=[I(" 测试触发(1X) ",-1)])),_:1,__:[6]})):j("",!0),g(N)?(y(),d(i,{key:1,onClick:l[2]||(l[2]=()=>W(5))},{default:f(()=>l[7]||(l[7]=[I(" 测试触发(5X) ",-1)])),_:1,__:[7]})):j("",!0),P(i,{onClick:g(z).wipe},{default:f(()=>l[8]||(l[8]=[I(" 模拟团灭 ",-1)])),_:1,__:[8]},8,["onClick"]),P(i,{type:"primary",onClick:X},{default:f(()=>l[9]||(l[9]=[I(" 设置 ",-1)])),_:1,__:[9]})])):j("",!0)]),_:1})}}}),[["__scopeId","data-v-45f756b1"]]);export{z as default};
