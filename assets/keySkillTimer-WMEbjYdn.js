import{c as e,_ as l}from"./shared-common-Cq8ZvUJj.js";import{ab as s,F as a,b as i,q as t,f as n,ae as r}from"./shared-core-BmMhxsPZ.js";import{a as o,r as c}from"./cactbot-CmNinDrW.js";import{n as k}from"./vendor-element-plus-BMs_zvkp.js";import{d,G as u,o as m,B as y,h as f,g as p,a as S,c as g,n as w,f as h,b as v,F as b,r as j,s as C,z as _,t as T,e as $,y as x}from"./vendor-vue-lrbWrvEl.js";const P={class:"demo-text"},I={key:0,class:"key-skills-timer-container"},K={class:"skills-grid"},F=["onClick"],L={class:"buff-filter"},D=["src"],z={key:1,class:"test"},E=l(d({__name:"keySkillTimer",setup(l){const d=s(),{zoneType:E}=a(),N=u(()=>"Pvp"===E.value),q=n(),A=i(),B=e=>{d.party=e.party.filter(e=>e.inParty)},G=e=>{if(!N.value)if("21"===e.line[0]||"22"===e.line[0]&&"0"===e.line[45]){const l=Number.parseInt(e.line[4],16),s=r(l),a=e.line[2];d.triggerSkill([l,s],a,!0)}else"33"===e.line[0]&&["40000010","4000000F"].includes(e.line[3])&&d.wipe()};function O(e){d.speed=e,d.usedSkills.forEach(e=>{d.triggerSkill([e.id],e.owner.id,!1)})}function R(){window.open("/ff14-overlay-vue/#/keySkillTimerSettings","_blank","width=1550,height=1024")}return m(()=>{t(),o("PartyChanged",B),o("LogLine",G)}),y(()=>{c("PartyChanged",B),c("LogLine",G),Object.values(d.skillStates).forEach(e=>{e.rafId&&cancelAnimationFrame(e.rafId)})}),(l,s)=>{const a=k,i=e;return S(),f(i,null,{readme:p(()=>[v("span",P,[x(T(l.$t("keySkillTimer.demo-text1")),1),s[3]||(s[3]=v("br",null,null,-1)),x(" "+T(l.$t("keySkillTimer.demo-text2")),1)])]),default:p(()=>[h(N)?w("",!0):(S(),g("div",I,[v("div",K,[(S(!0),g(b,null,j(h(d).usedSkills,e=>(S(),g("div",{key:e.instanceKey,class:_(["buff-container",`line${e.line}`]),style:C({zIndex:h(A)||h(q)?99:void 0}),onClick:()=>h(A)||h(q)?function(e,l){(q||A)&&d.triggerSkill([e.id],e.owner.id,l)}(e,!0):null},[v("div",L,[v("span",{class:_(["duration",[h(d).skillStates[e.instanceKey]?.isRecast?"cooldown":"active"]])},T(h(d).skillStates[e.instanceKey]?.text||""),3),v("img",{src:e.src},null,8,D),h(d).skillStates[e.instanceKey]?.active?(S(),g("div",{key:h(d).skillStates[e.instanceKey]?.startTime||0,class:"cooldown-layer",style:C({clipPath:`inset(${h(d).skillStates[e.instanceKey]?.clipPercent??0}% 0 0 0)`})},null,4)):w("",!0)]),e.owner.hasDuplicate.skill||e.owner.hasDuplicate.job?(S(),g("span",{key:0,class:_(`job has-duplicate ${e.owner.hasDuplicate.job?"duplicate-show-name":"duplicate-show-job-name"} ${e.owner.jobIcon.toLowerCase()}`)},T(e.owner.hasDuplicate.job?e.owner.name:e.owner.jobName),3)):w("",!0)],14,F))),128))])])),h(q)||h(A)?(S(),g("div",z,[$(a,{onClick:h(d).demoFullParty},{default:p(()=>[x(T(l.$t("keySkillTimer.test-all-jobs")),1)]),_:1},8,["onClick"]),$(a,{onClick:s[0]||(s[0]=()=>h(d).shuffle())},{default:p(()=>[x(T(l.$t("keySkillTimer.test-8-party")),1)]),_:1}),h(q)?(S(),f(a,{key:0,onClick:s[1]||(s[1]=()=>O(1))},{default:p(()=>[x(T(l.$t("keySkillTimer.test-trigger-1x")),1)]),_:1})):w("",!0),h(q)?(S(),f(a,{key:1,onClick:s[2]||(s[2]=()=>O(5))},{default:p(()=>[x(T(l.$t("keySkillTimer.test-trigger-5x")),1)]),_:1})):w("",!0),$(a,{onClick:h(d).wipe},{default:p(()=>[x(T(l.$t("keySkillTimer.test-wipe")),1)]),_:1},8,["onClick"]),$(a,{type:"primary",onClick:R},{default:p(()=>[x(T(l.$t("keySkillTimer.settings")),1)]),_:1})])):w("",!0)]),_:1})}}}),[["__scopeId","data-v-f11cf5a5"]]);export{E as default};
