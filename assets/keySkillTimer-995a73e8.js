import{_ as e}from"./ActWrapper-fdd654fb.js";import{d as s,c as i,o as a,aW as t,g as l,j as o,n,e as r,B as c,u as p,p as m,f as u,F as d,k,q as y,t as f,i as j,h as _}from"./index-bfe82241.js";import{E as g}from"./el-button-048c19d9.js";import{u as h}from"./useDemo-77ed4871.js";import{u as v}from"./useDev-9388fa49.js";import{u as w}from"./useZone-f90a94b3.js";import{u as S,c as C}from"./keySkills-8fdc36e4.js";import{a as b,r as P}from"./overlay_plugin_api-974cdd44.js";import{d as x}from"./index-cbf1dbe7.js";import{_ as I}from"./_plugin-vue_export-helper-6a8c15be.js";import"./el-card-8a5879f0.js";import"./index-cc6a9cde.js";import"./use-form-common-props-8ac8e3f9.js";import"./zoneInfo-40d5d60a.js";import"./zone_info-e69ac441.js";import"./content_type-e6dd7239.js";import"./demoParty-b4a6cc19.js";import"./util-12a91873.js";import"./actionChinese-1e4b8aeb.js";import"./lz-string-84ffe694.js";import"./_commonjsHelpers-9516e90c.js";import"./chineseToIcon-e0fcd48d.js";import"./status-9bc9036c.js";import"./tts-5e313398.js";const K={class:"skills-grid"},z=["onClick"],D={class:"buff-filter"},L=["src"],F={key:1,class:"test"},T=I(s({__name:"keySkillTimer",setup(s){const I=x("hash"),T=S(),{zoneType:A}=w(),E=i(()=>"Pvp"===A.value),N=v(),$=h(),X=e=>{T.party=e.party},q=e=>{if(!E.value)if("21"===e.line[0]||"22"===e.line[0]&&"0"===e.line[45]){const s=Number.parseInt(e.line[4],16),i=C(s),a=e.line[2];T.triggerSkill(i,a,!0)}else"33"===e.line[0]&&["40000010","4000000F"].includes(e.line[3])&&T.wipe()},H=e=>{T.language=e.charName.includes(" ")?"global":"chinese"};function W(e){T.speed=e,T.usedSkills.forEach(e=>{T.triggerSkill(e.id,e.owner.id,!1)})}function B(){window.open("/#/keySkillTimerSettings","_blank")}return a(()=>{b("PartyChanged",X),b("LogLine",q),b("ChangePrimaryPlayer",H)}),t(()=>{P("PartyChanged",X),P("LogLine",q),P("ChangePrimaryPlayer",H),Object.values(T.skillStates).forEach(e=>{e.rafId&&cancelAnimationFrame(e.rafId)})}),(s,i)=>{const a=g,t=e;return n(),l(t,null,{readme:o(()=>i[3]||(i[3]=[u("span",{class:"demo-text"},[_(" 当前为演示数据，锁定后将显示真实数据。"),u("br"),_(" 请尽量拉宽窗口，点击技能可模拟触发。 ")],-1)])),default:o(()=>[p(E)?c("",!0):(n(),r("div",{key:0,class:"key-skills-timer-container",style:m({"--scale":p(I).scale?.toString(),"--opacity":p(I).opacity?.toString()})},[u("div",K,[(n(!0),r(d,null,k(p(T).usedSkills,e=>(n(),r("div",{key:e.instanceKey,class:y(["buff-container",`line${e.line}`]),style:m({zIndex:p($)||p(N)?99:void 0}),onClick:()=>p($)||p(N)?function(e,s){(N||$)&&T.triggerSkill(e.id,e.owner.id,s)}(e,!0):null},[u("div",D,[u("span",{class:y(["duration",[p(T).skillStates[e.instanceKey]?.isRecast?"cooldown":"active"]])},f(p(T).skillStates[e.instanceKey]?.text||""),3),u("img",{src:e.src},null,8,L),p(T).skillStates[e.instanceKey]?.active?(n(),r("div",{key:p(T).skillStates[e.instanceKey]?.startTime||0,class:"cooldown-layer",style:m({clipPath:`inset(${p(T).skillStates[e.instanceKey]?.clipPercent??0}% 0 0 0)`})},null,4)):c("",!0)]),e.owner.hasDuplicate.skill||e.owner.hasDuplicate.job?(n(),r("span",{key:0,class:y(`job has-duplicate ${e.owner.hasDuplicate.job?"duplicate-show-name":"duplicate-show-job-name"} ${e.owner.jobIcon.toLowerCase()}`)},f(e.owner.hasDuplicate.job?e.owner.name:e.owner.jobName),3)):c("",!0)],14,z))),128))])],4)),p(N)||p($)?(n(),r("div",F,[j(a,{onClick:p(T).demoFullParty},{default:o(()=>i[4]||(i[4]=[_(" 模拟全部职业 ",-1)])),_:1,__:[4]},8,["onClick"]),j(a,{onClick:i[0]||(i[0]=()=>p(T).shuffle())},{default:o(()=>i[5]||(i[5]=[_(" 模拟8人小队 ",-1)])),_:1,__:[5]}),p(N)?(n(),l(a,{key:0,onClick:i[1]||(i[1]=()=>W(1))},{default:o(()=>i[6]||(i[6]=[_(" 测试触发(1X) ",-1)])),_:1,__:[6]})):c("",!0),p(N)?(n(),l(a,{key:1,onClick:i[2]||(i[2]=()=>W(5))},{default:o(()=>i[7]||(i[7]=[_(" 测试触发(5X) ",-1)])),_:1,__:[7]})):c("",!0),j(a,{onClick:p(T).wipe},{default:o(()=>i[8]||(i[8]=[_(" 模拟团灭 ",-1)])),_:1,__:[8]},8,["onClick"]),j(a,{type:"primary",onClick:B},{default:o(()=>i[9]||(i[9]=[_(" 设置 ",-1)])),_:1,__:[9]})])):c("",!0)]),_:1})}}}),[["__scopeId","data-v-ad749771"]]);export{T as default};
