import{_ as e}from"./ActWrapper-hpaT-NH0.js";import{d as s,g as a,h as i,aX as t,j as l,w as o,o as n,c as r,B as c,u as p,p as m,a as u,F as d,l as f,q as y,t as k,b as j,e as _}from"./index-Cszkdx3I.js";/* empty css                  */import{u as g}from"./useDemo-CA9VBus9.js";import{u as h}from"./useDev-C4jjTvHz.js";import{u as v}from"./useZone-BmF0zNl_.js";import{u as w,c as S}from"./keySkills-ByobeHQ-.js";import{a as b,r as C}from"./overlay_plugin_api-DHbPkDtN.js";import{d as P}from"./index-COlHhxXh.js";import{E as x}from"./index-BVwtjF5f.js";import{_ as I}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./el-card-a93Y44Ox.js";import"./zoneInfo-zWYximu4.js";import"./zone_info-C7ipylWh.js";import"./content_type-lMHx3DqW.js";import"./demoParty-jZSp7Lmk.js";import"./util-BOtaAWHW.js";import"./actionChinese-Ci6nVS5q.js";import"./chineseToIcon-xFdmTerz.js";import"./status-BoSfddpn.js";import"./tts-BkZGqxam.js";import"./index-D8Wn8WCv.js";import"./use-form-common-props-Cusxipjl.js";const K={class:"skills-grid"},D=["onClick"],z={class:"buff-filter"},F=["src"],L={key:1,class:"test"},T=I(s({__name:"keySkillTimer",setup(s){const I=P("hash"),T=w(),{zoneType:E}=v(),X=a(()=>"Pvp"===E.value),$=h(),N=g(),A=e=>{T.party=e.party.filter(e=>e.inParty)},B=e=>{if(!X.value)if("21"===e.line[0]||"22"===e.line[0]&&"0"===e.line[45]){const s=Number.parseInt(e.line[4],16),a=S(s),i=e.line[2];T.triggerSkill(a,i,!0)}else"33"===e.line[0]&&["40000010","4000000F"].includes(e.line[3])&&T.wipe()},Z=e=>{T.language=e.charName.includes(" ")?"global":"chinese"};function q(e){T.speed=e,T.usedSkills.forEach(e=>{T.triggerSkill(e.id,e.owner.id,!1)})}function G(){window.open("/ff14-overlay-vue/#/keySkillTimerSettings","_blank")}return i(()=>{b("PartyChanged",A),b("LogLine",B),b("ChangePrimaryPlayer",Z)}),t(()=>{C("PartyChanged",A),C("LogLine",B),C("ChangePrimaryPlayer",Z),Object.values(T.skillStates).forEach(e=>{e.rafId&&cancelAnimationFrame(e.rafId)})}),(s,a)=>{const i=x,t=e;return n(),l(t,null,{readme:o(()=>a[3]||(a[3]=[u("span",{class:"demo-text"},[_(" 当前为演示数据，锁定后将显示真实数据。"),u("br"),_(" 请尽量拉宽窗口，点击技能可模拟触发。 ")],-1)])),default:o(()=>[p(X)?c("",!0):(n(),r("div",{key:0,class:"key-skills-timer-container",style:m({"--scale":p(I).scale?.toString(),"--opacity":p(I).opacity?.toString()})},[u("div",K,[(n(!0),r(d,null,f(p(T).usedSkills,e=>(n(),r("div",{key:e.instanceKey,class:y(["buff-container",`line${e.line}`]),style:m({zIndex:p(N)||p($)?99:void 0}),onClick:()=>p(N)||p($)?function(e,s){($||N)&&T.triggerSkill(e.id,e.owner.id,s)}(e,!0):null},[u("div",z,[u("span",{class:y(["duration",[p(T).skillStates[e.instanceKey]?.isRecast?"cooldown":"active"]])},k(p(T).skillStates[e.instanceKey]?.text||""),3),u("img",{src:e.src},null,8,F),p(T).skillStates[e.instanceKey]?.active?(n(),r("div",{key:p(T).skillStates[e.instanceKey]?.startTime||0,class:"cooldown-layer",style:m({clipPath:`inset(${p(T).skillStates[e.instanceKey]?.clipPercent??0}% 0 0 0)`})},null,4)):c("",!0)]),e.owner.hasDuplicate.skill||e.owner.hasDuplicate.job?(n(),r("span",{key:0,class:y(`job has-duplicate ${e.owner.hasDuplicate.job?"duplicate-show-name":"duplicate-show-job-name"} ${e.owner.jobIcon.toLowerCase()}`)},k(e.owner.hasDuplicate.job?e.owner.name:e.owner.jobName),3)):c("",!0)],14,D))),128))])],4)),p($)||p(N)?(n(),r("div",L,[j(i,{onClick:p(T).demoFullParty},{default:o(()=>a[4]||(a[4]=[_(" 模拟全部职业 ",-1)])),_:1,__:[4]},8,["onClick"]),j(i,{onClick:a[0]||(a[0]=()=>p(T).shuffle())},{default:o(()=>a[5]||(a[5]=[_(" 模拟8人小队 ",-1)])),_:1,__:[5]}),p($)?(n(),l(i,{key:0,onClick:a[1]||(a[1]=()=>q(1))},{default:o(()=>a[6]||(a[6]=[_(" 测试触发(1X) ",-1)])),_:1,__:[6]})):c("",!0),p($)?(n(),l(i,{key:1,onClick:a[2]||(a[2]=()=>q(5))},{default:o(()=>a[7]||(a[7]=[_(" 测试触发(5X) ",-1)])),_:1,__:[7]})):c("",!0),j(i,{onClick:p(T).wipe},{default:o(()=>a[8]||(a[8]=[_(" 模拟团灭 ",-1)])),_:1,__:[8]},8,["onClick"]),j(i,{type:"primary",onClick:G},{default:o(()=>a[9]||(a[9]=[_(" 设置 ",-1)])),_:1,__:[9]})])):c("",!0)]),_:1})}}}),[["__scopeId","data-v-f7397e13"]]);export{T as default};
