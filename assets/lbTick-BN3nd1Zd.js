import{_ as e}from"./ActWrapper-BGHAfHL4.js";import{d as n,g as i,r as t,f as a,V as s,h as o,bd as r,j as l,w as c,o as p,z as u,k as m,u as T,e as h,a as f,t as d,c as L,F as v,l as g,v as j}from"./index-Cd9qHeJv.js";/* empty css                  */import{u as C}from"./useDemo-DCk8UnwV.js";import{u as _}from"./useDev-f1cuzwwT.js";import{a as y,r as D}from"./overlay_plugin_api-DHbPkDtN.js";import{u as b}from"./useZone-Dtu8m8tJ.js";import{E as x}from"./index-CYNQnJEH.js";import{_ as w}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./el-card-e3tbEaMv.js";import"./index-bheNiw7n.js";import"./zoneInfo-7Z04Y0Eq.js";import"./zone_info-BK1oa_54.js";import"./content_type-uhloenTS.js";import"./index-DqrhK5wJ.js";import"./use-form-common-props-BZU9S4Ln.js";const F={class:"lb-container"},E={id:"percent"},k={id:"bonusTotal"},z={id:"extra"},A=3e4,I=w(n({__name:"lbTick",setup(n){const{zoneType:w}=b(),I=_(),B=C(),Z=i(()=>"Pvp"!==w.value),U=t(),H=a({prev:0,ratio:0,bonusTotal:0,chain:0,chainList:[]});function J(){H.prev=0,H.ratio=0,H.chain=0,H.chainList=[],H.bonusTotal=0}const N=e=>{if(Z.value)if("36"===e.line[0]){const n=parseInt(e.line[2],16),i=n-H.prev;if(H.prev=n,H.ratio=n/A,0===n||i<-.1)H.chain=0,H.chainList=[];else{if(!(i>220))return void(H.chain=0);{H.chain+=i,H.bonusTotal+=i;const n=H.chainList[H.chainList.length-1];n&&n.timestamp+1e3>new Date(e.line[1]).getTime()&&(n.num===H.chain-300||n.num===H.chain-60)?H.chainList[H.chainList.length-1].num=H.chain:H.chainList.push({key:crypto.randomUUID(),num:H.chain,timestamp:new Date(e.line[1]).getTime()})}}}else"33"===e.line[0]&&["40000010","4000000F"].includes(e.line[3])&&J()};function P(){U.value?.(),U.value=function(e,n=2){const i=[];return function(t){let a=0;e({line:t[0],type:"LogLine",rawLine:""});for(let s=1;s<t.length;s++){const o=new Date(t[s][1]),r=new Date(t[s-1][1]);a+=o.getTime()-r.getTime();const l=window.setTimeout(()=>{e({line:t[s],type:"LogLine",rawLine:""})},a/n);i.push(l)}}([["36","2021-12-28T21:38:30.3580000+08:00","0000"],["36","2021-12-28T21:38:33.3580000+08:00","00DC"],["36","2021-12-28T21:38:34.8290000+08:00","0208"],["36","2021-12-28T21:38:36.3460000+08:00","02E4"],["36","2021-12-28T21:38:37.8630000+08:00","0410"],["36","2021-12-28T21:38:39.3360000+08:00","04EC"],["36","2021-12-28T21:38:42.3720000+08:00","05C8"],["36","2021-12-28T21:38:45.3620000+08:00","06A4"],["36","2021-12-28T21:38:47.8140000+08:00","07D0"],["36","2021-12-28T21:38:47.8140000+08:00","08FC"],["36","2021-12-28T21:38:47.8140000+08:00","0A28"],["36","2021-12-28T21:38:47.8140000+08:00","0B54"],["36","2021-12-28T21:38:47.8140000+08:00","0C80"],["36","2021-12-28T21:38:48.3510000+08:00","0D5C"],["36","2021-12-28T21:38:50.6220000+08:00","0E88"],["36","2021-12-28T21:38:50.8900000+08:00","0FB4"],["36","2021-12-28T21:38:51.0230000+08:00","10E0"],["36","2021-12-28T21:38:51.1570000+08:00","120C"],["36","2021-12-28T21:38:51.3360000+08:00","12E8"],["36","2021-12-28T21:38:54.3690000+08:00","13C4"],["36","2021-12-28T21:38:57.3570000+08:00","14A0"],["36","2021-12-28T21:38:58.3360000+08:00","15CC"],["36","2021-12-28T21:38:58.3360000+08:00","16F8"],["36","2021-12-28T21:38:58.3360000+08:00","1824"],["36","2021-12-28T21:38:58.3360000+08:00","1950"],["36","2021-12-28T21:38:58.3360000+08:00","1A7C"],["36","2021-12-28T21:39:00.3410000+08:00","1B58"],["36","2021-12-28T21:39:03.3690000+08:00","1C34"],["36","2021-12-28T21:39:04.2630000+08:00","1D60"],["36","2021-12-28T21:39:06.3600000+08:00","1E3C"]]),()=>{i.forEach(clearTimeout),i.length=0}}(N,1)}return s(()=>[B.value,I.value],()=>{U.value?.(),J()}),o(()=>{y("ChangeZone",J),y("LogLine",N)}),r(()=>{D("ChangeZone",J),D("LogLine",N)}),(n,i)=>{const t=x,a=e;return p(),l(a,null,{default:c(()=>[T(I)||T(B)?(p(),l(t,{key:0,type:"primary",class:"test-btn",onClick:P},{default:c(()=>[...i[0]||(i[0]=[h(" 测试 ",-1)])]),_:1})):u("",!0),m(f("div",F,[f("p",E,"LB:"+d((100*T(H).ratio).toFixed(2))+"%",1),f("p",k," 奖励:"+d((T(H).bonusTotal/A*100).toFixed(0))+"% ",1),f("div",z,[(p(!0),L(v,null,g(T(H).chainList,e=>(p(),L("p",{key:e.key,class:"anime"}," +"+d((e.num/A*100).toFixed(0))+"% ",1))),128))])],512),[[j,T(Z)]])]),_:1})}}}),[["__scopeId","data-v-ff6eea14"]]);export{I as default};
