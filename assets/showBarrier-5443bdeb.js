import{_ as e}from"./ActWrapper-1c9e0cef.js";import{_ as r}from"./DragJob-12bd5032.js";import{t as a,r as t,c as s,e as i,f as o,D as n,E as l,ay as u,u as p,x as c,A as m,F as d,v as f,L as v,a9 as b,K as g,O as j,S as x,M as h}from"./vue-vendor-d1e06839.js";import{j as y}from"./util-c5e2dd68.js";import{N as P}from"./netregexes-ed180b06.js";import{a as _}from"./overlay_plugin_api-974cdd44.js";import{u as w}from"./index-2ddc6e0c.js";import{_ as E}from"./_plugin-vue_export-helper-6a8c15be.js";import"./index-01789691.js";import"./element-plus-e8d3f599.js";/* empty css                */import"./useDevMode-49806891.js";/* empty css                    */import"./regexes-da03e94d.js";const A=E(a({__name:"showBarrier",setup(a){u(e=>({c386f606:p(C),49228832:p(D)}));const E={statusEffectExplicit:P.statusEffectExplicit()};let A=0;const I=t([]),L=t(""),S=t(window.location.href),N=s(()=>new URLSearchParams(S.value.split("?")[1])),$=s(()=>"1"===N.value.get("showSettings")),C=s(()=>40*Number(N.value.get("lineHeight")||1)+"px"),D=s(()=>`${Number(N.value.get("fontSize")||26)}px`),U=s(()=>N.value.get("type")||"1");const M=w("cactbotRuntime-sortArr",y);function O(e){M.value=e}function R(){I.value.sort((e,r)=>e.id===L.value?-1:r.id===L.value?1:e.job===r.job?r.id.localeCompare(e.id):M.value.indexOf(e.job)-M.value.indexOf(r.job))}function k(e){return"1"===U.value?`${e.barrierPercent}`:"2"===U.value?`${e.barrierAmount}`:`${e.barrierPercent}%(${e.barrierAmount})`}return i(()=>{_("LogLine",e=>{!function(e){const r=E.statusEffectExplicit.exec(e);if(r?.groups?.targetId.startsWith("1")){const e=I.value.find(e=>e.id===r.groups?.targetId);e&&(e.barrierPercent=Number(r.groups?.currentShield),e.barrierAmount=Math.round(Number(r.groups?.maxHp)*e.barrierPercent/100))}}(e.rawLine)}),_("PartyChanged",e=>{I.value=e.party.filter(e=>e.inParty).map(e=>({...e,barrierPercent:0,barrierAmount:0}))}),_("ChangePrimaryPlayer",e=>{L.value=Number(e.charID).toString(16).toUpperCase()}),o([I,L,M],()=>{clearInterval(A),L.value?R():A=setInterval(()=>{L.value&&(R(),clearInterval(A))},100)},{immediate:!0}),window.addEventListener("hashchange",e=>S.value=e.newURL)}),(a,t)=>{const s=r,i=e;return c(),n(i,null,{default:l(()=>[m("div",null,[m("ul",null,[(c(!0),f(v,null,b(p(I),e=>(c(),f("li",{key:e.id},[d(m("span",{"m-r-2":""},g(e.name),513),[[j,p($)]]),m("span",{style:x(0===e.barrierPercent?{opacity:.25,color:"white"}:{opacity:1,color:"#f5da3c"})},g(k(e)),5)]))),128))]),d(h(s,{style:{"z-index":"10000"},party:p(I),"p-1":"","m-b-1":"",onUpdateSortArr:O},null,8,["party"]),[[j,p($)]])])]),_:1})}}}),[["__scopeId","data-v-bcf69598"]]);export{A as default};
