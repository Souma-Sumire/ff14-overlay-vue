import{_ as a}from"./ActWrapper-CbcL5jAX.js";import{a as e,r as t,c as n}from"./overlay_plugin_api-DHbPkDtN.js";import{d as s,f as i,i as o,aG as c,k as r,w as l,o as m,c as p,G as u,u as d,t as f}from"./index-BbxLgENd.js";import{_ as I}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./el-card-ueHS-Ymd.js";import"./useDev-D9oVSqhX.js";import"./useDemo-DNfUh66e.js";const _={key:0},D={key:1},g=I(s({__name:"instancedAreaInfo",setup(s){const I=i({islandId:0,instanceNum:""}),g=[732,763,795,827,920,975,1252],h=Object.fromEntries(g.map(a=>[a,new Map])),j=async a=>{if(!g.includes(a.zoneID))return void(I.islandId=0);const e=(await n({call:"getCombatants"})).combatants.filter(a=>541===a.BNpcNameID&&a.ID).sort((a,e)=>a.ID-e.ID)[0];if(!e)return;const t=e.ID-1073741824,s=Date.now(),i=h[a.zoneID],o=i.get(t);if(I.islandId=t,o){const a=s-o.timestamp,e=`这个岛${a<6e4?`${Math.floor(a/1e3)}秒`:`${Math.floor(a/6e4)}分钟`}前来过，是第${o.count}个遇到的岛`;o.timestamp=s,n({call:"cactbotSay",text:e})}else{i.set(t,{timestamp:s,count:i.size+1});const a=`这个岛第一次来，现在总共遇到了${i.size}个岛`;n({call:"cactbotSay",text:a})}},N={"":"①","":"②","":"③","":"④","":"⑤","":"⑥","":"⑦","":"⑧","":"⑨"},b=a=>{if("00"===a.line[0]&&"0039"===a.line[2]){const e=a.line[4].match(/当前所在副本区为“([^”]+)(?<instance>[])”/)??a.line[4].match(/You are now in the instanced area (.+?)(?<instance>[])”/)??a.line[4].match(/インスタンスエリア「(.+?)(?<instance>[])」/);e&&(I.instanceNum=N[e.groups?.instance])}else"01"===a.line[0]&&(I.instanceNum="")};return o(()=>{e("LogLine",b),e("ChangeZone",j)}),c(()=>{t("LogLine",b),t("ChangeZone",j)}),(e,t)=>{const n=a;return m(),r(n,null,{default:l(()=>[d(I).instanceNum?(m(),p("p",_,f(d(I).instanceNum),1)):u("",!0),d(I).islandId?(m(),p("p",D,f(d(I).islandId)+"号岛 ",1)):u("",!0)]),_:1})}}}),[["__scopeId","data-v-db42191a"]]);export{g as default};
