import{c as e,_ as l}from"./shared-common-9tgN7nPx.js";import{ab as s,F as a,b as i,q as t,f as n,ae as r}from"./shared-core-Do8QyWoI.js";import{a as o,r as c}from"./cactbot-DtpbXwrG.js";import{n as k}from"./vendor-element-plus-CsMNiL2J.js";import{d,G as u,o as m,B as y,h as f,g as p,a as S,c as g,n as w,f as b,b as h,F as v,r as j,s as C,z as _,t as T,e as $,y as x}from"./vendor-vue-MSvGQJWD.js";const P={class:"demo-text"},I={key:0,class:"key-skills-timer-container"},K={class:"skills-grid"},F=["onClick"],L={class:"buff-filter"},D=["src"],z={key:1,class:"test"},E=l(d({__name:"keySkillTimer",setup(l){const d=s(),{zoneType:E}=a(),N=u(()=>"Pvp"===E.value),q=n(),A=i(),B=e=>{d.party=e.party.filter(e=>e.inParty)},G=e=>{if(!N.value)if("21"===e.line[0]||"22"===e.line[0]&&"0"===e.line[45]){const l=Number.parseInt(e.line[4],16),s=r(l),a=e.line[2];d.triggerSkill([l,s],a,!0)}else"33"===e.line[0]&&["40000010","4000000F"].includes(e.line[3])&&d.wipe()};function O(e){d.speed=e,d.usedSkills.forEach(e=>{d.triggerSkill([e.id],e.owner.id,!1)})}function R(){window.open("/ff14-overlay-vue/#/keySkillTimerSettings","_blank","width=1550,height=1024")}return m(()=>{t(),o("PartyChanged",B),o("LogLine",G)}),y(()=>{c("PartyChanged",B),c("LogLine",G),Object.values(d.skillStates).forEach(e=>{e.rafId&&cancelAnimationFrame(e.rafId)})}),(l,s)=>{const a=k,i=e;return S(),f(i,null,{readme:p(()=>[h("span",P,[x(T(l.$t("keySkillTimer.demo-text1")),1),s[3]||(s[3]=h("br",null,null,-1)),x(" "+T(l.$t("keySkillTimer.demo-text2")),1)])]),default:p(()=>[b(N)?w("",!0):(S(),g("div",I,[h("div",K,[(S(!0),g(v,null,j(b(d).usedSkills,e=>(S(),g("div",{key:e.instanceKey,class:_(["buff-container",`line${e.line}`]),style:C({zIndex:b(A)||b(q)?99:void 0}),onClick:()=>b(A)||b(q)?function(e,l){(q||A)&&d.triggerSkill([e.id],e.owner.id,l)}(e,!0):null},[h("div",L,[h("span",{class:_(["duration",[b(d).skillStates[e.instanceKey]?.isRecast?"cooldown":"active"]])},T(b(d).skillStates[e.instanceKey]?.text||""),3),h("img",{src:e.src},null,8,D),b(d).skillStates[e.instanceKey]?.active?(S(),g("div",{key:b(d).skillStates[e.instanceKey]?.startTime||0,class:"cooldown-layer",style:C({clipPath:`inset(${b(d).skillStates[e.instanceKey]?.clipPercent??0}% 0 0 0)`})},null,4)):w("",!0)]),e.owner.hasDuplicate.skill||e.owner.hasDuplicate.job?(S(),g("span",{key:0,class:_(`job has-duplicate ${e.owner.hasDuplicate.job?"duplicate-show-name":"duplicate-show-job-name"} ${e.owner.jobIcon.toLowerCase()}`)},T(e.owner.hasDuplicate.job?e.owner.name:e.owner.jobName),3)):w("",!0)],14,F))),128))])])),b(q)||b(A)?(S(),g("div",z,[$(a,{onClick:b(d).demoFullParty},{default:p(()=>[x(T(l.$t("keySkillTimer.test-all-jobs")),1)]),_:1},8,["onClick"]),$(a,{onClick:s[0]||(s[0]=()=>b(d).shuffle())},{default:p(()=>[x(T(l.$t("keySkillTimer.test-8-party")),1)]),_:1}),b(q)?(S(),f(a,{key:0,onClick:s[1]||(s[1]=()=>O(1))},{default:p(()=>[x(T(l.$t("keySkillTimer.test-trigger-1x")),1)]),_:1})):w("",!0),b(q)?(S(),f(a,{key:1,onClick:s[2]||(s[2]=()=>O(5))},{default:p(()=>[x(T(l.$t("keySkillTimer.test-trigger-5x")),1)]),_:1})):w("",!0),$(a,{onClick:b(d).wipe},{default:p(()=>[x(T(l.$t("keySkillTimer.test-wipe")),1)]),_:1},8,["onClick"]),$(a,{type:"primary",onClick:R},{default:p(()=>[x(T(l.$t("keySkillTimer.settings")),1)]),_:1})])):w("",!0)]),_:1})}}}),[["__scopeId","data-v-b3cca820"]]);export{E as default};
