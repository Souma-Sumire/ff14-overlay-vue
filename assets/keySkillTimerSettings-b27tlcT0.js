import{E as e,a as l,n as t,b as a,aC as i,J as s,F as n,G as o,aD as r,aE as d,l as c,D as u,aB as m,j as k,k as p,h as S,aF as f,an as y,X as g,aj as b,au as h,ac as v,ax as T,N as _,M as V,f as w,g as x}from"./vendor-element-plus-BMs_zvkp.js";import{a8 as $,a9 as j,u as z,U,aa as C,ab as B,ac as D,q as F,ad as J,v as N,y as I}from"./shared-core-BmMhxsPZ.js";import{d as E,x as M,w as L,c as O,a as G,G as q,h as A,g as P,b as X,e as H,F as K,r as Q,f as R,t as W,o as Y,I as Z,p as ee,y as le,du as te}from"./vendor-vue-lrbWrvEl.js";import{_ as ae,a as ie,b as se}from"./shared-common-Cq8ZvUJj.js";import"./cactbot-CmNinDrW.js";const ne={class:"action-icon-wrapper"},oe=["src"],re={key:1,class:"action-icon-placeholder"},de=ae(E({__name:"ActionIcon",props:{id:{}},setup(e){const l=e,t=M("");return L([()=>l.id,j],([e])=>{t.value=$(e)},{immediate:!0}),(e,l)=>(G(),O("div",ne,[t.value?(G(),O("img",{key:0,src:t.value,class:"action-icon",alt:""},null,8,oe)):(G(),O("div",re))]))}}),[["__scopeId","data-v-8bcec3d8"]]),ce={class:"btn-text"},ue={class:"job-selector-content"},me=ae(E({__name:"JobSelector",props:{modelValue:{}},emits:["update:modelValue"],setup(n,{emit:o}){const r=n,d=o,{t:c,locale:u}=z(),m=Object.freeze(U.getBattleJobs()),k=q(()=>{const e=C(u.value);return m.map(l=>{const t=U.jobToFullName(l);return{value:U.jobToJobEnum(l),label:t[e]??t.en}})}),p=q(()=>r.modelValue&&0!==r.modelValue.length?r.modelValue.length===m.length?c("keySkillTimerSettings.col.allJobs"):c("keySkillTimerSettings.col.jobsCount",{count:r.modelValue.length}):c("keySkillTimerSettings.col.allJobs"));function S(e){d("update:modelValue",e)}return(o,r)=>{const d=a,c=t,u=l,m=e,f=s;return G(),A(f,{placement:"bottom",width:280,trigger:"click","popper-class":"job-selector-popper"},{reference:P(()=>[H(c,{size:"small",class:"job-popover-btn"},{default:P(()=>[H(d,null,{default:P(()=>[H(R(i))]),_:1}),X("span",ce,W(p.value),1)]),_:1})]),default:P(()=>[X("div",ue,[H(m,{"model-value":n.modelValue,multiple:"",filterable:"",placeholder:"Select Jobs",size:"default",class:"full-width","collapse-tags":"","collapse-tags-tooltip":"","onUpdate:modelValue":S},{default:P(()=>[(G(!0),O(K,null,Q(k.value,e=>(G(),A(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["model-value"])])]),_:1})}}}),[["__scopeId","data-v-a8044493"]]),ke={class:"settings-table-wrapper"},pe={class:"action-buttons"},Se={style:{display:"flex","align-items":"center",gap:"8px"}},fe={style:{color:"var(--el-text-color-secondary)","font-size":"12px"}},ye={class:"tts-header"},ge=ae(E({__name:"SettingsTable",emits:["delete","move"],setup(e,{emit:l}){const i=l,s=B(),f=q(()=>s.keySkillsData.chinese);function y(e,l){if(e){l(D(e,50).map(e=>({value:e.id.toString(),label:e.name,id:e.id})))}else l([])}return(e,l)=>{const g=a,b=t,h=c,v=o,T=m,_=p,V=k,w=S,x=n;return G(),O("div",ke,[H(x,{data:f.value,border:"",size:"small","row-key":e=>e.key,height:"100%",class:"custom-table","header-row-class-name":"table-header"},{default:P(()=>[H(v,{label:e.$t("keySkillTimerSettings.col.action"),width:"90",fixed:"left",align:"center"},{default:P(({row:l,$index:t})=>[X("div",pe,[H(b,{link:"",size:"small",disabled:0===t,onClick:e=>i("move",t,t-1)},{default:P(()=>[H(g,null,{default:P(()=>[H(R(r))]),_:1})]),_:1},8,["disabled","onClick"]),H(b,{link:"",size:"small",disabled:t===f.value.length-1,onClick:e=>i("move",t,t+1)},{default:P(()=>[H(g,null,{default:P(()=>[H(R(d))]),_:1})]),_:1},8,["disabled","onClick"]),H(h,{title:e.$t("keySkillTimerSettings.deleteConfirmTitle"),onConfirm:e=>i("delete",l.key)},{reference:P(()=>[H(b,{link:"",size:"small",type:"danger"},{default:P(()=>[H(g,null,{default:P(()=>[H(R(u))]),_:1})]),_:1})]),_:1},8,["title","onConfirm"])])]),_:1},8,["label"]),H(v,{label:e.$t("keySkillTimerSettings.col.preview"),width:"50",align:"center"},{default:P(({row:e})=>[(G(),A(de,{id:e.id,key:e.id},null,8,["id"]))]),_:1},8,["label"]),H(v,{label:e.$t("keySkillTimerSettings.col.id"),"min-width":"200"},{default:P(({row:e})=>[H(T,{modelValue:e.id,"onUpdate:modelValue":l=>e.id=l,"fetch-suggestions":y,placeholder:"...",size:"small",style:{width:"100%"},clearable:"","trigger-on-focus":!1},{default:P(({item:e})=>[X("div",Se,[(G(),A(de,{id:e.id,key:e.id,size:20},null,8,["id"])),X("span",null,W(e.label),1),X("span",fe,"("+W(e.value)+")",1)])]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),H(v,{width:"130"},{header:P(()=>[X("div",ye,[l[1]||(l[1]=X("span",null,"TTS",-1)),H(_,{modelValue:R(s).enableTts.chinese,"onUpdate:modelValue":l[0]||(l[0]=e=>R(s).enableTts.chinese=e),size:"small"},null,8,["modelValue"])])]),default:P(({row:e})=>[H(V,{modelValue:e.tts,"onUpdate:modelValue":l=>e.tts=l,size:"small",disabled:!R(s).enableTts.chinese},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),H(v,{label:e.$t("keySkillTimerSettings.col.duration"),"min-width":"180",align:"left"},{default:P(({row:e})=>[H(V,{modelValue:e.duration,"onUpdate:modelValue":l=>e.duration=l,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),H(v,{label:e.$t("keySkillTimerSettings.col.recast"),"min-width":"220",align:"left"},{default:P(({row:e})=>[H(V,{modelValue:e.recast1000ms,"onUpdate:modelValue":l=>e.recast1000ms=l,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),H(v,{label:e.$t("keySkillTimerSettings.col.job"),width:"100",align:"center"},{default:P(({row:e})=>[H(me,{modelValue:e.job,"onUpdate:modelValue":l=>e.job=l},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),H(v,{label:e.$t("keySkillTimerSettings.col.minLevel"),width:"110",align:"center"},{default:P(({row:e})=>[H(w,{modelValue:e.minLevel,"onUpdate:modelValue":l=>e.minLevel=l,min:1,max:100,size:"small",controls:!1,class:"level-input"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),H(v,{label:e.$t("keySkillTimerSettings.col.line"),width:"110",align:"center"},{default:P(({row:e})=>[H(w,{modelValue:e.line,"onUpdate:modelValue":l=>e.line=l,min:1,max:10,size:"small",controls:!1,class:"line-input"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"])]),_:1},8,["data","row-key"])])}}}),[["__scopeId","data-v-9afbe668"]]),be={class:"page-container"},he={class:"header-toolbar"},ve={class:"left-tools"},Te={class:"preset-list",style:{height:"400px","overflow-y":"auto"}},_e={class:"preset-info"},Ve={class:"name"},we={class:"search-drawer-content",style:{height:"450px",padding:"12px"}},xe={class:"center-tools"},$e={class:"right-tools"},je={class:"page-content"},ze=ae(E({__name:"keySkillTimerSettings",setup(e){const{t:l}=z(),i=B(),r=M(!1);function d(){w.confirm(l("keySkillTimerSettings.resetConfirmMsg"),l("keySkillTimerSettings.confirmTitle"),{confirmButtonText:l("keySkillTimerSettings.confirmBtn"),cancelButtonText:l("keySkillTimerSettings.cancelBtn"),type:"warning"}).then(()=>{i.keySkillsData.chinese=[...J],x.success(l("keySkillTimerSettings.resetSuccessMsg"))}).catch(()=>{})}function c(e,t){i.keySkillsData.chinese.unshift({key:crypto.randomUUID(),id:e,tts:t||"",duration:0,recast1000ms:0,job:[],line:1,minLevel:1}),x.success(`${l("keySkillTimerSettings.addSkill")}: ${t||e}`)}function u(){const e=JSON.stringify(i.keySkillsData),t=te.compressToBase64(e);I(t).then(()=>x.success(l("keySkillTimerSettings.copySuccess"))).catch(()=>x.error(l("keySkillTimerSettings.copyFailed")))}function m(){w.prompt(l("keySkillTimerSettings.importPromptMsg"),l("keySkillTimerSettings.importTitle"),{confirmButtonText:l("keySkillTimerSettings.confirmBtn"),cancelButtonText:l("keySkillTimerSettings.cancelBtn"),inputType:"textarea",inputValidator:e=>{try{const t=te.decompressFromBase64(e),a=JSON.parse(t);return"object"==typeof a&&null!==a||l("keySkillTimerSettings.dataFormatError")}catch(t){const e=t instanceof Error?t.message:String(t);return`${l("keySkillTimerSettings.dataFormatError")}: ${e}`}}}).then(({value:e})=>{if(e){const t=te.decompressFromBase64(e),a=JSON.parse(t);"object"==typeof a&&null!==a?(i.keySkillsData.chinese=a.chinese,x.success(l("keySkillTimerSettings.importSuccess"))):x.error(l("keySkillTimerSettings.importFormatError"))}}).catch(()=>{})}Y(async()=>{try{await F()}catch(e){}finally{r.value=!0}});const p=M(""),S=Z([]);let $;return L(p,e=>{$&&clearTimeout($),$=window.setTimeout(()=>{S.value=D(e)},300)}),(e,l)=>{const w=t,x=a,$=h,j=k,z=o,U=n,C=b,B=s,D=g,F=ie,I=se,E=ge,M=f;return ee((G(),O("div",be,[X("div",he,[X("div",ve,[H(B,{placement:"bottom-start",width:550,trigger:"click","popper-class":"skill-library-popover"},{reference:P(()=>[H(w,{type:"primary",icon:R(T),loading:!r.value},{default:P(()=>[le(W(e.$t("keySkillTimerSettings.searchSkill")),1)]),_:1},8,["icon","loading"])]),default:P(()=>[H(C,{type:"border-card",class:"search-tabs"},{default:P(()=>[H($,{label:e.$t("keySkillTimerSettings.presets")},{default:P(()=>[X("div",Te,[(G(!0),O(K,null,Q(R(J),l=>(G(),O("div",{key:l.key,class:"preset-item"},[X("div",_e,[H(de,{id:l.id,size:24},null,8,["id"]),X("span",Ve,W(R(N)(Number(l.id))||l.tts||e.$t("keySkillTimerSettings.unknownSkill")),1)]),H(w,{link:"",type:"primary",onClick:e=>c(Number(l.id),R(N)(Number(l.id))||l.tts)},{default:P(()=>[H(x,null,{default:P(()=>[H(R(v))]),_:1})]),_:1},8,["onClick"])]))),128))])]),_:1},8,["label"]),H($,{label:e.$t("keySkillTimerSettings.searchTab")},{default:P(()=>[X("div",we,[H(j,{modelValue:p.value,"onUpdate:modelValue":l[0]||(l[0]=e=>p.value=e),clearable:"",placeholder:e.$t("keySkillTimerSettings.skillName"),"prefix-icon":R(T),style:{"margin-bottom":"12px"},size:"default"},null,8,["modelValue","placeholder","prefix-icon"]),H(U,{data:S.value,style:{width:"100%"},height:"390px",size:"default"},{default:P(()=>[H(z,{width:"40",align:"center"},{default:P(({row:e})=>[H(de,{id:e.id,size:20},null,8,["id"])]),_:1}),H(z,{prop:"id",label:e.$t("keySkillTimerSettings.col.shortId"),width:"80"},null,8,["label"]),H(z,{prop:"name",label:e.$t("keySkillTimerSettings.skillName")},null,8,["label"]),H(z,{width:"50",align:"center"},{default:P(({row:e})=>[H(w,{link:"",type:"primary",onClick:l=>c(e.id,e.name)},{default:P(()=>[H(x,null,{default:P(()=>[H(R(v))]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1},8,["label"])]),_:1})]),_:1})]),X("div",xe,[H(D,null,{default:P(()=>[H(w,{icon:R(_),onClick:u},{default:P(()=>[le(W(e.$t("keySkillTimerSettings.export")),1)]),_:1},8,["icon"]),H(w,{icon:R(V),onClick:m},{default:P(()=>[le(W(e.$t("keySkillTimerSettings.import")),1)]),_:1},8,["icon"])]),_:1}),H(w,{type:"danger",icon:R(y),onClick:d},{default:P(()=>[le(W(e.$t("keySkillTimerSettings.restoreDefault")),1)]),_:1},8,["icon"])]),X("div",$e,[H(F,{"storage-key":"key-skill-timer-2"}),H(I,{teleported:!1})])]),X("main",je,[H(E,{onDelete:l[1]||(l[1]=e=>function(e){const l=i.keySkillsData.chinese,t=l.findIndex(l=>l.key===e);-1!==t&&l.splice(t,1)}(e)),onMove:l[2]||(l[2]=(e,l)=>function(e,l){const t=i.keySkillsData.chinese;if(l<0||l>=t.length||e===l)return;const a=t[e];a&&(t.splice(e,1),t.splice(l,0,a))}(e,l))})])])),[[M,!r.value,void 0,{fullscreen:!0,lock:!0}]])}}}),[["__scopeId","data-v-6ccb46e2"]]);export{ze as default};
