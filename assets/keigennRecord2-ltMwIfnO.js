import{u as e,a as t}from"./useLang-D9mhVQKB.js";import{E as r}from"./index-cSJq7UaI.js";import{U as a,h as n,bL as l,P as o,bM as s,ak as i,aJ as c,d,S as u,r as m,f as p,u as h,A as f,j as y,z as g,ad as w,bh as v,M as b,Q as x,ao as R,ab as S,bg as k,O as C,ah as T,B as I,X as E,a3 as H,b as F,aQ as j,i as D,ap as M,n as N,aF as $,aZ as A,F as O,bA as L,a2 as z,bN as W,V as K,T as _,ae as P,Y as G,bD as V,bO as B,bP as q,ax as U,a0 as Z,bk as Y,c as X,o as J,a as Q,t as ee,x as te,aH as re,k as ae,w as ne,D as le,e as oe,s as se,m as ie,bj as ce,bQ as de,q as ue,E as me,g as pe,bR as he,bc as fe,y as ye,l as ge,v as we,a5 as ve,aU as be,aT as xe,aK as Re,bS as Se}from"./index-C_vJrq5H.js";import{_ as ke}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{E as Ce}from"./el-empty-DEWNinop.js";import{B as Te,d as Ie,c as Ee}from"./el-tag-CL4elYdq.js";import{c as He}from"./clipboard-BKuKuDeo.js";import{U as Fe}from"./util-BSI8OlRX.js";import"./el-popper-VrKIWMTN.js";/* empty css                   */import{E as je}from"./el-divider-DHK6bPKQ.js";import{E as De}from"./index-q9r_JlkM.js";import{s as Me,c as Ne,a as $e}from"./status-DO8_dJa3.js";import{h as Ae,g as Oe}from"./xivapi-a6oZXlzI.js";import{c as Le,r as ze}from"./raf-BsVmNUKN.js";import{c as We}from"./vnode-DCFdyNXF.js";import{a as Ke,E as _e}from"./el-select-nw4Uy7Vr.js";/* empty css                  */import{u as Pe}from"./useDev-Cul7tw2w.js";import{u as Ge}from"./useIndexedDB-BFQzRBFl.js";import{g as Ve}from"./actionChinese-DM96CSZ4.js";import{l as Be}from"./regexes-Blkj7yOl.js";import{N as qe}from"./netregexes-DsAXea56.js";import{a as Ue}from"./overlay_plugin_api-DHbPkDtN.js";import{Z as Ze}from"./zoneInfo-Kvs06RCG.js";import{E as Ye}from"./index-BiQCIIgT.js";import"./use-form-common-props-gFrq1vXC.js";import"./index-BQUC8YF5.js";import"./index-D0Ykw6Qx.js";import"./focus-trap-cRSfNoTL.js";import"./index-D9P7iDwm.js";import"./zone_info-C8YMEhdS.js";import"./index-qmBAyEMl.js";var Xe=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function Je(e,t){return e===t||!(!Xe(e)||!Xe(t))}function Qe(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!Je(e[r],t[r]))return!1;return!0}const et=()=>{const e=a().proxy.$props;return n(()=>{const t=(e,t,r)=>({});return e.perfMode?l(t):function(e,t){void 0===t&&(t=Qe);var r=null;function a(){for(var a=[],n=0;n<arguments.length;n++)a[n]=arguments[n];if(r&&r.lastThis===this&&t(a,r.lastArgs))return r.lastResult;var l=e.apply(this,a);return r={lastResult:l,lastArgs:a,lastThis:this},l}return a.clear=function(){r=null},a}(t)})},tt="itemRendered",rt="scroll",at="forward",nt="backward",lt="auto",ot="smart",st="start",it="center",ct="end",dt="horizontal",ut="vertical",mt="negative",pt="positive-ascending",ht="positive-descending",ft={[dt]:"left",[ut]:"top"},yt=s({type:i([Number,Function]),required:!0}),gt=s({type:Number}),wt=s({type:Number,default:2}),vt=s({type:String,values:["ltr","rtl"],default:"ltr"}),bt=s({type:Number,default:0}),xt=s({type:Number,required:!0}),Rt=s({type:String,values:["horizontal","vertical"],default:ut}),St=o({className:{type:String,default:""},containerElement:{type:i([String,Object]),default:"div"},data:{type:i(Array),default:()=>c([])},direction:vt,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},innerProps:{type:i(Object),default:()=>({})},style:{type:i([Object,String,Array])},useIsScrolling:Boolean,width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:Boolean}),kt=o({cache:wt,estimatedItemSize:gt,layout:Rt,initScrollOffset:bt,total:xt,itemSize:yt,...St}),Ct={type:Number,default:6},Tt={type:Number,default:0},It={type:Number,default:2},Et=o({columnCache:wt,columnWidth:yt,estimatedColumnWidth:gt,estimatedRowHeight:gt,initScrollLeft:bt,initScrollTop:bt,itemKey:{type:i(Function),default:({columnIndex:e,rowIndex:t})=>`${t}:${e}`},rowCache:wt,rowHeight:yt,totalColumn:xt,totalRow:xt,hScrollbarSize:Ct,vScrollbarSize:Ct,scrollbarStartGap:Tt,scrollbarEndGap:It,role:String,...St}),Ht=o({alwaysOn:Boolean,class:String,layout:Rt,total:xt,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:Ct,startGap:Tt,endGap:It,visible:Boolean}),Ft=(e,t)=>e<t?at:nt,jt=e=>"rtl"===e;let Dt=null;function Mt(e=!1){if(null===Dt||e){const e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",t.direction="rtl";const r=document.createElement("div"),a=r.style;return a.width="100px",a.height="100px",e.appendChild(r),document.body.appendChild(e),e.scrollLeft>0?Dt=ht:(e.scrollLeft=1,Dt=0===e.scrollLeft?mt:pt),document.body.removeChild(e),Dt}return Dt}const Nt=d({name:"ElVirtualScrollBar",props:Ht,emits:["scroll","start-move","stop-move"],setup(e,{emit:t}){const r=n(()=>e.startGap+e.endGap),a=u("virtual-scrollbar"),l=u("scrollbar"),o=m(),s=m();let i=null,c=null;const d=p({isDragging:!1,traveled:0}),v=n(()=>Te[e.layout]),b=n(()=>e.clientSize-h(r)),x=n(()=>({position:"absolute",width:`${dt===e.layout?b.value:e.scrollbarSize}px`,height:`${dt===e.layout?e.scrollbarSize:b.value}px`,[ft[e.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"})),R=n(()=>{const t=e.ratio;if(t>=100)return Number.POSITIVE_INFINITY;if(t>=50)return t*b.value/100;const r=b.value/3;return Math.floor(Math.min(Math.max(t*b.value/100,20),r))}),S=n(()=>{if(!Number.isFinite(R.value))return{display:"none"};const t=`${R.value}px`,r=function({move:e,size:t,bar:r},a){const n={},l=`translate${r.axis}(${e}px)`;return n[r.size]=t,n.transform=l,"horizontal"===a?n.height="100%":n.width="100%",n}({bar:v.value,size:t,move:d.traveled},e.layout);return r}),k=n(()=>Math.ceil(e.clientSize-R.value-h(r))),C=()=>{window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",I),document.onselectstart=c,c=null;const e=h(s);e&&(e.removeEventListener("touchmove",E),e.removeEventListener("touchend",I))},T=e=>{e.stopImmediatePropagation(),e.ctrlKey||[1,2].includes(e.button)||(d.isDragging=!0,d[v.value.axis]=e.currentTarget[v.value.offset]-(e[v.value.client]-e.currentTarget.getBoundingClientRect()[v.value.direction]),t("start-move"),(()=>{window.addEventListener("mousemove",E),window.addEventListener("mouseup",I);const e=h(s);e&&(c=document.onselectstart,document.onselectstart=()=>!1,e.addEventListener("touchmove",E,{passive:!0}),e.addEventListener("touchend",I))})())},I=()=>{d.isDragging=!1,d[v.value.axis]=0,t("stop-move"),C()},E=e=>{const{isDragging:r}=d;if(!r)return;if(!s.value||!o.value)return;const a=d[v.value.axis];if(!a)return;Le(i);const n=-1*(o.value.getBoundingClientRect()[v.value.direction]-e[v.value.client])-(s.value[v.value.offset]-a);i=ze(()=>{d.traveled=Math.max(0,Math.min(n,k.value)),t("scroll",n,k.value)})},H=e=>{const r=Math.abs(e.target.getBoundingClientRect()[v.value.direction]-e[v.value.client])-s.value[v.value.offset]/2;d.traveled=Math.max(0,Math.min(r,k.value)),t("scroll",r,k.value)};return f(()=>e.scrollFrom,e=>{d.isDragging||(d.traveled=Math.ceil(e*k.value))}),y(()=>{C()}),()=>g("div",{role:"presentation",ref:o,class:[a.b(),e.class,(e.alwaysOn||d.isDragging)&&"always-on"],style:x.value,onMousedown:w(H,["stop","prevent"]),onTouchstartPrevent:T},g("div",{ref:s,class:l.e("thumb"),style:S.value,onMousedown:T},[]))}});var $t=(e=>(e.ASC="asc",e.DESC="desc",e))($t||{}),At=(e=>(e.LEFT="left",e.CENTER="center",e.RIGHT="right",e))(At||{}),Ot=(e=>(e.LEFT="left",e.RIGHT="right",e))(Ot||{});const Lt={asc:"desc",desc:"asc"},zt=Symbol("placeholder");const Wt=(e,{mainTableRef:t,leftTableRef:r,rightTableRef:l,tableInstance:o,ns:s,isScrolling:i})=>{const c=a(),{emit:d}=c,u=b(!1),p=m(e.defaultExpandedRowKeys||[]),f=m(-1),y=b(null),g=m({}),w=m({}),v=b({}),S=b({}),k=b({}),C=n(()=>x(e.estimatedRowHeight));function T({hovered:e,rowKey:t}){if(i.value)return;o.vnode.el.querySelectorAll(`[rowkey="${String(t)}"]`).forEach(t=>{e?t.classList.add(s.is("hovered")):t.classList.remove(s.is("hovered"))})}const I=Ie(()=>{var e,a,n,o;u.value=!0,g.value={...h(g),...h(w)},E(h(y),!1),w.value={},y.value=null,null==(e=t.value)||e.forceUpdate(),null==(a=r.value)||a.forceUpdate(),null==(n=l.value)||n.forceUpdate(),null==(o=c.proxy)||o.$forceUpdate(),u.value=!1},0);function E(e,a=!1){h(C)&&[t,r,l].forEach(t=>{const r=h(t);r&&r.resetAfterRowIndex(e,a)})}return{expandedRowKeys:p,lastRenderedRowIndex:f,isDynamic:C,isResetting:u,rowHeights:g,resetAfterIndex:E,onRowExpanded:function({expanded:t,rowData:r,rowIndex:a,rowKey:n}){var l,i;const c=[...h(p)],u=c.indexOf(n);t?-1===u&&c.push(n):u>-1&&c.splice(u,1),p.value=c,d("update:expandedRowKeys",c),null==(l=e.onRowExpand)||l.call(e,{expanded:t,rowData:r,rowIndex:a,rowKey:n}),null==(i=e.onExpandedRowsChange)||i.call(e,c),o.vnode.el.querySelector(`.${s.is("hovered")}[rowkey="${String(n)}"]`)&&R(()=>T({hovered:!0,rowKey:n}))},onRowHovered:T,onRowsRendered:function(t){var r;null==(r=e.onRowsRendered)||r.call(e,t),t.rowCacheEnd>h(f)&&(f.value=t.rowCacheEnd)},onRowHeightChange:function({rowKey:e,height:t,rowIndex:r},a){a?a===Ot.RIGHT?k.value[e]=t:v.value[e]=t:S.value[e]=t;const n=Math.max(...[v,k,S].map(t=>t.value[e]||0));h(g)[e]!==n&&(!function(e,t,r){const a=h(y);(null===a||a>r)&&(y.value=r),w.value[e]=t}(e,n,r),I())}}},Kt=(e,t)=>e+t,_t=e=>S(e)?e.reduce(Kt,0):e,Pt=(e,t,r={})=>T(e)?e(t):null!=e?e:r,Gt=e=>(["width","maxWidth","minWidth","height"].forEach(t=>{e[t]=k(e[t])}),e),Vt=e=>C(e)?t=>g(e,t):e;function Bt(e){const t=m(),r=m(),l=m(),{columns:o,columnsStyles:s,columnsTotalWidth:i,fixedColumnsOnLeft:c,fixedColumnsOnRight:d,hasFixedColumns:p,mainColumns:y,onColumnSorted:g}=function(e,t,r){const a=n(()=>h(t).map((e,t)=>{var r,a;return{...e,key:null!=(a=null!=(r=e.key)?r:e.dataKey)?a:t}})),l=n(()=>h(a).filter(e=>!e.hidden)),o=n(()=>h(l).filter(e=>"left"===e.fixed||!0===e.fixed)),s=n(()=>h(l).filter(e=>"right"===e.fixed)),i=n(()=>h(l).filter(e=>!e.fixed)),c=n(()=>{const e=[];return h(o).forEach(t=>{e.push({...t,placeholderSign:zt})}),h(i).forEach(t=>{e.push(t)}),h(s).forEach(t=>{e.push({...t,placeholderSign:zt})}),e}),d=n(()=>h(o).length||h(s).length),u=n(()=>h(a).reduce((t,a)=>(t[a.key]=((e,t,r)=>{var a;const n={flexGrow:0,flexShrink:0,...r?{}:{flexGrow:e.flexGrow||0,flexShrink:e.flexShrink||1}};r||(n.flexShrink=1);const l={...null!=(a=e.style)?a:{},...n,flexBasis:"auto",width:e.width};return t||(e.maxWidth&&(l.maxWidth=e.maxWidth),e.minWidth&&(l.minWidth=e.minWidth)),l})(a,h(r),e.fixed),t),{})),m=n(()=>h(l).reduce((e,t)=>e+t.width,0)),p=e=>h(a).find(t=>t.key===e);return{columns:a,columnsStyles:u,columnsTotalWidth:m,fixedColumnsOnLeft:o,fixedColumnsOnRight:s,hasFixedColumns:d,mainColumns:c,normalColumns:i,visibleColumns:l,getColumn:p,getColumnStyle:e=>h(u)[e],updateColumnWidth:(e,t)=>{e.width=t},onColumnSorted:function(t){var r;const{key:a}=t.currentTarget.dataset;if(!a)return;const{sortState:n,sortBy:l}=e;let o=$t.ASC;o=v(n)?Lt[n[a]]:Lt[l.order],null==(r=e.onColumnSort)||r.call(e,{column:p(a),key:a,order:o})}}}(e,I(e,"columns"),I(e,"fixed")),{scrollTo:w,scrollToLeft:R,scrollToTop:C,scrollToRow:T,onScroll:E,onVerticalScroll:H,scrollPos:F}=((e,{mainTableRef:t,leftTableRef:r,rightTableRef:a,onMaybeEndReached:n})=>{const l=m({scrollLeft:0,scrollTop:0});function o(e){var n,l,o;const{scrollTop:s}=e;null==(n=t.value)||n.scrollTo(e),null==(l=r.value)||l.scrollToTop(s),null==(o=a.value)||o.scrollToTop(s)}function s(e){l.value=e,o(e)}function i(e){l.value.scrollTop=e,o(h(l))}return f(()=>h(l).scrollTop,(e,t)=>{e>t&&n()}),{scrollPos:l,scrollTo:s,scrollToLeft:function(e){var r,a;l.value.scrollLeft=e,null==(a=null==(r=t.value)?void 0:r.scrollTo)||a.call(r,h(l))},scrollToTop:i,scrollToRow:function(e,r="auto"){var a;null==(a=t.value)||a.scrollToRow(e,r)},onScroll:function(t){var r;s(t),null==(r=e.onScroll)||r.call(e,t)},onVerticalScroll:function({scrollTop:e}){const{scrollTop:t}=h(l);e!==t&&i(e)}}})(e,{mainTableRef:t,leftTableRef:r,rightTableRef:l,onMaybeEndReached:function(){const{onEndReached:t}=e;if(!t)return;const{scrollTop:r}=h(F),a=h(B),n=h(J),l=a-(r+n)+e.hScrollbarSize;!le.value&&h($)>=0&&a<=r+h(Z)-h(re)?(le.value=!0,t(l)):le.value=!1}}),j=u("table-v2"),D=a(),M=b(!1),{expandedRowKeys:N,lastRenderedRowIndex:$,isDynamic:A,isResetting:O,rowHeights:L,resetAfterIndex:z,onRowExpanded:W,onRowHeightChange:K,onRowHovered:_,onRowsRendered:P}=Wt(e,{mainTableRef:t,leftTableRef:r,rightTableRef:l,tableInstance:D,ns:j,isScrolling:M}),{data:G,depthMap:V}=((e,{expandedRowKeys:t,lastRenderedRowIndex:r,resetAfterIndex:a})=>{const l=m({}),o=n(()=>{const r={},{data:a,rowKey:n}=e,o=h(t);if(!o||!o.length)return a;const s=[],i=new Set;o.forEach(e=>i.add(e));let c=a.slice();for(c.forEach(e=>r[e[n]]=0);c.length>0;){const e=c.shift();s.push(e),i.has(e[n])&&S(e.children)&&e.children.length>0&&(c=[...e.children,...c],e.children.forEach(t=>r[t[n]]=r[e[n]]+1))}return l.value=r,s}),s=n(()=>{const{data:t,expandColumnKey:r}=e;return r?h(o):t});return f(s,(e,t)=>{e!==t&&(r.value=-1,a(0,!0))}),{data:s,depthMap:l}})(e,{expandedRowKeys:N,lastRenderedRowIndex:$,resetAfterIndex:z}),B=n(()=>{const{estimatedRowHeight:t,rowHeight:r}=e,a=h(G);return x(t)?Object.values(h(L)).reduce((e,t)=>e+t,0):a.length*r}),{bodyWidth:q,fixedTableHeight:U,mainTableHeight:Z,leftTableWidth:Y,rightTableWidth:X,windowHeight:J,footerHeight:Q,emptyStyle:ee,rootStyle:te,headerHeight:re}=((e,{columnsTotalWidth:t,rowsHeight:r,fixedColumnsOnLeft:a,fixedColumnsOnRight:l})=>{const o=n(()=>{const{fixed:r,width:a,vScrollbarSize:n}=e,l=a-n;return r?Math.max(Math.round(h(t)),l):l}),s=n(()=>{const{height:t=0,maxHeight:a=0,footerHeight:n,hScrollbarSize:l}=e;if(a>0){const e=h(p),t=h(r),o=h(m)+e+t+l;return Math.min(o,a-n)}return t-n}),i=n(()=>{const{maxHeight:t}=e,a=h(s);if(x(t)&&t>0)return a;const n=h(r)+h(m)+h(p);return Math.min(a,n)}),c=e=>e.width,d=n(()=>_t(h(a).map(c))),u=n(()=>_t(h(l).map(c))),m=n(()=>_t(e.headerHeight)),p=n(()=>{var t;return((null==(t=e.fixedData)?void 0:t.length)||0)*e.rowHeight}),f=n(()=>h(s)-h(m)-h(p)),y=n(()=>{const{style:t={},height:r,width:a}=e;return Gt({...t,height:r,width:a})}),g=n(()=>Gt({height:e.footerHeight})),w=n(()=>({top:k(h(m)),bottom:k(e.footerHeight),width:k(e.width)}));return{bodyWidth:o,fixedTableHeight:i,mainTableHeight:s,leftTableWidth:d,rightTableWidth:u,windowHeight:f,footerHeight:g,emptyStyle:w,rootStyle:y,headerHeight:m}})(e,{columnsTotalWidth:i,fixedColumnsOnLeft:c,fixedColumnsOnRight:d,rowsHeight:B}),ae=m(),ne=n(()=>{const t=0===h(G).length;return S(e.fixedData)?0===e.fixedData.length&&t:t});const le=m(!1);return f(()=>h(B),()=>le.value=!1),f(()=>e.expandedRowKeys,e=>N.value=e,{deep:!0}),{columns:o,containerRef:ae,mainTableRef:t,leftTableRef:r,rightTableRef:l,isDynamic:A,isResetting:O,isScrolling:M,hasFixedColumns:p,columnsStyles:s,columnsTotalWidth:i,data:G,expandedRowKeys:N,depthMap:V,fixedColumnsOnLeft:c,fixedColumnsOnRight:d,mainColumns:y,bodyWidth:q,emptyStyle:ee,rootStyle:te,footerHeight:Q,mainTableHeight:Z,fixedTableHeight:U,leftTableWidth:Y,rightTableWidth:X,showEmpty:ne,getRowHeight:function(t){const{estimatedRowHeight:r,rowHeight:a,rowKey:n}=e;return r?h(L)[h(G)[t][n]]||r:a},onColumnSorted:g,onRowHovered:_,onRowExpanded:W,onRowsRendered:P,onRowHeightChange:K,scrollTo:w,scrollToLeft:R,scrollToTop:C,scrollToRow:T,onScroll:E,onVerticalScroll:H}}const qt=Symbol("tableV2"),Ut="tableV2GridScrollLeft",Zt=String,Yt={type:i(Array),required:!0},Xt={type:i(Array)},Jt={...Xt,required:!0},Qt=String,er={type:i(Array),default:()=>c([])},tr={type:Number,required:!0},rr={type:i([String,Number,Symbol]),default:"id"},ar={type:i(Object)},nr=o({class:String,columns:Yt,columnsStyles:{type:i(Object),required:!0},depth:Number,expandColumnKey:Qt,estimatedRowHeight:{...Et.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:i(Function)},onRowHover:{type:i(Function)},onRowHeightChange:{type:i(Function)},rowData:{type:i(Object),required:!0},rowEventHandlers:{type:i(Object)},rowIndex:{type:Number,required:!0},rowKey:rr,style:{type:i(Object)}}),lr={type:Number,required:!0},or=o({class:String,columns:Yt,fixedHeaderData:{type:i(Array)},headerData:{type:i(Array),required:!0},headerHeight:{type:i([Number,Array]),default:50},rowWidth:lr,rowHeight:{type:Number,default:50},height:lr,width:lr}),sr=o({columns:Yt,data:Jt,fixedData:Xt,estimatedRowHeight:nr.estimatedRowHeight,width:tr,height:tr,headerWidth:tr,headerHeight:or.headerHeight,bodyWidth:tr,rowHeight:tr,cache:kt.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:Et.scrollbarAlwaysOn,scrollbarStartGap:Et.scrollbarStartGap,scrollbarEndGap:Et.scrollbarEndGap,class:Zt,style:ar,containerStyle:ar,getRowHeight:{type:i(Function),required:!0},rowKey:nr.rowKey,onRowsRendered:{type:i(Function)},onScroll:{type:i(Function)}}),ir=o({cache:sr.cache,estimatedRowHeight:nr.estimatedRowHeight,rowKey:rr,headerClass:{type:i([String,Function])},headerProps:{type:i([Object,Function])},headerCellProps:{type:i([Object,Function])},headerHeight:or.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:i([String,Function])},rowProps:{type:i([Object,Function])},rowHeight:{type:Number,default:50},cellProps:{type:i([Object,Function])},columns:Yt,data:Jt,dataGetter:{type:i(Function)},fixedData:Xt,expandColumnKey:nr.expandColumnKey,expandedRowKeys:er,defaultExpandedRowKeys:er,class:Zt,fixed:Boolean,style:{type:i(Object)},width:tr,height:tr,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:Et.hScrollbarSize,vScrollbarSize:Et.vScrollbarSize,scrollbarAlwaysOn:Ht.alwaysOn,sortBy:{type:i(Object),default:()=>({})},sortState:{type:i(Object),default:void 0},onColumnSort:{type:i(Function)},onExpandedRowsChange:{type:i(Function)},onEndReached:{type:i(Function)},onRowExpand:nr.onRowExpand,onScroll:sr.onScroll,onRowsRendered:sr.onRowsRendered,rowEventHandlers:nr.rowEventHandlers});var cr=d({name:"ElTableV2Header",props:or,setup(e,{slots:t,expose:r}){const a=u("table-v2"),l=E(Ut),o=m(),s=n(()=>Gt({width:e.width,height:e.height})),i=n(()=>Gt({width:e.rowWidth,height:e.height})),c=n(()=>Ee(h(e.headerHeight))),d=e=>{const t=h(o);R(()=>{(null==t?void 0:t.scroll)&&t.scroll({left:e})})},p=()=>{const r=a.e("fixed-header-row"),{columns:n,fixedHeaderData:l,rowHeight:o}=e;return null==l?void 0:l.map((e,a)=>{var l;const s=Gt({height:o,width:"100%"});return null==(l=t.fixed)?void 0:l.call(t,{class:r,columns:n,rowData:e,rowIndex:-(a+1),style:s})})},f=()=>{const r=a.e("dynamic-header-row"),{columns:n}=e;return h(c).map((e,a)=>{var l;const o=Gt({width:"100%",height:e});return null==(l=t.dynamic)?void 0:l.call(t,{class:r,columns:n,headerIndex:a,style:o})})};return H(()=>{(null==l?void 0:l.value)&&d(l.value)}),r({scrollToLeft:d}),()=>{if(!(e.height<=0))return F("div",{ref:o,class:e.class,style:h(s),role:"rowgroup"},[F("div",{style:h(i),class:a.e("header")},[f(),p()])])}}});const dr=({name:e,clearCache:t,getColumnPosition:r,getColumnStartIndexForOffset:l,getColumnStopIndexForStartIndex:o,getEstimatedTotalHeight:s,getEstimatedTotalWidth:i,getColumnOffset:c,getRowOffset:p,getRowPosition:f,getRowStartIndexForOffset:y,getRowStopIndexForStartIndex:w,initCache:v,injectToInstance:b,validateProps:S})=>d({name:null!=e?e:"ElVirtualList",props:Et,emits:[tt,rt],setup(e,{emit:d,expose:k,slots:C}){const T=u("vl");S(e);const I=a(),E=m(v(e,I));null==b||b(I,E);const H=m(),F=m(),z=m(),W=m(null),K=m({isScrolling:!1,scrollLeft:x(e.initScrollLeft)?e.initScrollLeft:0,scrollTop:x(e.initScrollTop)?e.initScrollTop:0,updateRequested:!1,xAxisScrollDir:at,yAxisScrollDir:at}),_=et(),P=n(()=>Number.parseInt(`${e.height}`,10)),G=n(()=>Number.parseInt(`${e.width}`,10)),V=n(()=>{const{totalColumn:t,totalRow:r,columnCache:a}=e,{isScrolling:n,xAxisScrollDir:s,scrollLeft:i}=h(K);if(0===t||0===r)return[0,0,0,0];const c=l(e,i,h(E)),d=o(e,c,i,h(E)),u=n&&s!==nt?1:Math.max(1,a),m=n&&s!==at?1:Math.max(1,a);return[Math.max(0,c-u),Math.max(0,Math.min(t-1,d+m)),c,d]}),B=n(()=>{const{totalColumn:t,totalRow:r,rowCache:a}=e,{isScrolling:n,yAxisScrollDir:l,scrollTop:o}=h(K);if(0===t||0===r)return[0,0,0,0];const s=y(e,o,h(E)),i=w(e,s,o,h(E)),c=n&&l!==nt?1:Math.max(1,a),d=n&&l!==at?1:Math.max(1,a);return[Math.max(0,s-c),Math.max(0,Math.min(r-1,i+d)),s,i]}),q=n(()=>s(e,h(E))),U=n(()=>i(e,h(E))),Z=n(()=>{var t;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:e.direction,height:x(e.height)?`${e.height}px`:e.height,width:x(e.width)?`${e.width}px`:e.width},null!=(t=e.style)?t:{}]}),Y=n(()=>{const e=`${h(U)}px`;return{height:`${h(q)}px`,pointerEvents:h(K).isScrolling?"none":void 0,width:e}}),X=()=>{const{totalColumn:t,totalRow:r}=e;if(t>0&&r>0){const[e,t,r,a]=h(V),[n,l,o,s]=h(B);d(tt,{columnCacheStart:e,columnCacheEnd:t,rowCacheStart:n,rowCacheEnd:l,columnVisibleStart:r,columnVisibleEnd:a,rowVisibleStart:o,rowVisibleEnd:s})}const{scrollLeft:a,scrollTop:n,updateRequested:l,xAxisScrollDir:o,yAxisScrollDir:s}=h(K);d(rt,{xAxisScrollDir:o,scrollLeft:a,yAxisScrollDir:s,scrollTop:n,updateRequested:l})},J=t=>{const{clientHeight:r,clientWidth:a,scrollHeight:n,scrollLeft:l,scrollTop:o,scrollWidth:s}=t.currentTarget,i=h(K);if(i.scrollTop===o&&i.scrollLeft===l)return;let c=l;if(jt(e.direction))switch(Mt()){case mt:c=-l;break;case ht:c=s-a-l}K.value={...i,isScrolling:!0,scrollLeft:c,scrollTop:Math.max(0,Math.min(o,n-r)),updateRequested:!0,xAxisScrollDir:Ft(i.scrollLeft,c),yAxisScrollDir:Ft(i.scrollTop,o)},R(()=>ne()),le(),X()},Q=(e,t)=>{const r=h(P),a=(q.value-r)/t*e;re({scrollTop:Math.min(q.value-r,a)})},ee=(e,t)=>{const r=h(G),a=(U.value-r)/t*e;re({scrollLeft:Math.min(U.value-r,a)})},{onWheel:te}=(({atXEndEdge:e,atXStartEdge:t,atYEndEdge:r,atYStartEdge:a},n)=>{let l=null,o=0,s=0;const i=(n,l)=>{const o=n<=0&&t.value||n>=0&&e.value,s=l<=0&&a.value||l>=0&&r.value;return o&&s};return{hasReachedEdge:i,onWheel:e=>{Le(l);let t=e.deltaX,r=e.deltaY;Math.abs(t)>Math.abs(r)?r=0:t=0,e.shiftKey&&0!==r&&(t=r,r=0),i(o,s)&&i(o+t,s+r)||(o+=t,s+=r,e.preventDefault(),l=ze(()=>{n(o,s),o=0,s=0}))}}})({atXStartEdge:n(()=>K.value.scrollLeft<=0),atXEndEdge:n(()=>K.value.scrollLeft>=U.value-h(G)),atYStartEdge:n(()=>K.value.scrollTop<=0),atYEndEdge:n(()=>K.value.scrollTop>=q.value-h(P))},(e,t)=>{var r,a,n,l;null==(a=null==(r=F.value)?void 0:r.onMouseUp)||a.call(r),null==(l=null==(n=z.value)?void 0:n.onMouseUp)||l.call(n);const o=h(G),s=h(P);re({scrollLeft:Math.min(K.value.scrollLeft+e,U.value-o),scrollTop:Math.min(K.value.scrollTop+t,q.value-s)})});j(H,"wheel",te,{passive:!1});const re=({scrollLeft:e=K.value.scrollLeft,scrollTop:t=K.value.scrollTop})=>{e=Math.max(e,0),t=Math.max(t,0);const r=h(K);t===r.scrollTop&&e===r.scrollLeft||(K.value={...r,xAxisScrollDir:Ft(r.scrollLeft,e),yAxisScrollDir:Ft(r.scrollTop,t),scrollLeft:e,scrollTop:t,updateRequested:!0},R(()=>ne()),le(),X())},ae=(a,n)=>{const{columnWidth:l,direction:o,rowHeight:s}=e,i=_.value(t&&l,t&&s,t&&o),c=`${a},${n}`;if(L(i,c))return i[c];{const[,t]=r(e,n,h(E)),l=h(E),s=jt(o),[d,u]=f(e,a,l),[m]=r(e,n,l);return i[c]={position:"absolute",left:s?void 0:`${t}px`,right:s?`${t}px`:void 0,top:`${u}px`,height:`${d}px`,width:`${m}px`},i[c]}},ne=()=>{K.value.isScrolling=!1,R(()=>{_.value(-1,null,null)})};D(()=>{if(!M)return;const{initScrollLeft:t,initScrollTop:r}=e,a=h(H);a&&(x(t)&&(a.scrollLeft=t),x(r)&&(a.scrollTop=r)),X()});const le=()=>{const{direction:t}=e,{scrollLeft:r,scrollTop:a,updateRequested:n}=h(K),l=h(H);if(n&&l){if("rtl"===t)switch(Mt()){case mt:l.scrollLeft=-r;break;case pt:l.scrollLeft=r;break;default:{const{clientWidth:e,scrollWidth:t}=l;l.scrollLeft=t-e-r;break}}else l.scrollLeft=Math.max(0,r);l.scrollTop=Math.max(0,a)}},{resetAfterColumnIndex:oe,resetAfterRowIndex:se,resetAfter:ie}=I.proxy;k({windowRef:H,innerRef:W,getItemStyleCache:_,scrollTo:re,scrollToItem:(t=0,r=0,a=lt)=>{const n=h(K);r=Math.max(0,Math.min(r,e.totalColumn-1)),t=Math.max(0,Math.min(t,e.totalRow-1));const l=We(T.namespace.value),o=h(E),d=s(e,o),u=i(e,o);re({scrollLeft:c(e,r,a,n.scrollLeft,o,u>e.width?l:0),scrollTop:p(e,t,a,n.scrollTop,o,d>e.height?l:0)})},states:K,resetAfterColumnIndex:oe,resetAfterRowIndex:se,resetAfter:ie});const ce=()=>{const t=N(e.innerElement),r=(()=>{var t;const[r,a]=h(V),[n,l]=h(B),{data:o,totalColumn:s,totalRow:i,useIsScrolling:c,itemKey:d}=e,u=[];if(i>0&&s>0)for(let e=n;e<=l;e++)for(let n=r;n<=a;n++){const r=d({columnIndex:n,data:o,rowIndex:e});u.push(g(O,{key:r},null==(t=C.default)?void 0:t.call(C,{columnIndex:n,data:o,isScrolling:c?h(K).isScrolling:void 0,style:ae(e,n),rowIndex:e})))}return u})();return[g(t,A(e.innerProps,{style:h(Y),ref:W}),$(t)?r:{default:()=>r})]};return()=>{const t=N(e.containerElement),{horizontalScrollbar:r,verticalScrollbar:a}=(()=>{const{scrollbarAlwaysOn:t,scrollbarStartGap:r,scrollbarEndGap:a,totalColumn:n,totalRow:l}=e,o=h(G),s=h(P),i=h(U),c=h(q),{scrollLeft:d,scrollTop:u}=h(K);return{horizontalScrollbar:g(Nt,{ref:F,alwaysOn:t,startGap:r,endGap:a,class:T.e("horizontal"),clientSize:o,layout:"horizontal",onScroll:ee,ratio:100*o/i,scrollFrom:d/(i-o),total:l,visible:!0}),verticalScrollbar:g(Nt,{ref:z,alwaysOn:t,startGap:r,endGap:a,class:T.e("vertical"),clientSize:s,layout:"vertical",onScroll:Q,ratio:100*s/c,scrollFrom:u/(c-s),total:n,visible:!0})}})(),n=ce();return g("div",{key:0,class:T.e("wrapper"),role:e.role},[g(t,{class:e.className,style:h(Z),onScroll:J,ref:H},$(t)?n:{default:()=>n}),r,a])}}}),{max:ur,min:mr,floor:pr}=Math,hr={column:"columnWidth",row:"rowHeight"},fr={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},yr=(e,t,r,a)=>{const[n,l,o]=[r[a],e[hr[a]],r[fr[a]]];if(t>o){let e=0;if(o>=0){const t=n[o];e=t.offset+t.size}for(let r=o+1;r<=t;r++){const t=l(r);n[r]={offset:e,size:t},e+=t}r[fr[a]]=t}return n[t]},gr=(e,t,r,a,n,l)=>{for(;r<=a;){const o=r+pr((a-r)/2),s=yr(e,o,t,l).offset;if(s===n)return o;s<n?r=o+1:a=o-1}return ur(0,r-1)},wr=(e,t,r,a)=>{const[n,l]=[t[a],t[fr[a]]];return(l>0?n[l].offset:0)>=r?gr(e,t,0,l,r,a):((e,t,r,a,n)=>{const l="column"===n?e.totalColumn:e.totalRow;let o=1;for(;r<l&&yr(e,r,t,n).offset<a;)r+=o,o*=2;return gr(e,t,pr(r/2),mr(r,l-1),a,n)})(e,t,ur(0,l),r,a)},vr=({totalRow:e},{estimatedRowHeight:t,lastVisitedRowIndex:r,row:a})=>{let n=0;if(r>=e&&(r=e-1),r>=0){const e=a[r];n=e.offset+e.size}return n+(e-r-1)*t},br=({totalColumn:e},{column:t,estimatedColumnWidth:r,lastVisitedColumnIndex:a})=>{let n=0;if(a>e&&(a=e-1),a>=0){const e=t[a];n=e.offset+e.size}return n+(e-a-1)*r},xr={column:br,row:vr},Rr=(e,t,r,a,n,l,o)=>{const[s,i]=["row"===l?e.height:e.width,xr[l]],c=yr(e,t,n,l),d=i(e,n),u=ur(0,mr(d-s,c.offset)),m=ur(0,c.offset-s+o+c.size);switch(r===ot&&(r=a>=m-s&&a<=u+s?lt:it),r){case st:return u;case ct:return m;case it:return Math.round(m+(u-m)/2);default:return a>=m&&a<=u?a:m>u||a<m?m:u}},Sr=dr({name:"ElDynamicSizeGrid",getColumnPosition:(e,t,r)=>{const a=yr(e,t,r,"column");return[a.size,a.offset]},getRowPosition:(e,t,r)=>{const a=yr(e,t,r,"row");return[a.size,a.offset]},getColumnOffset:(e,t,r,a,n,l)=>Rr(e,t,r,a,n,"column",l),getRowOffset:(e,t,r,a,n,l)=>Rr(e,t,r,a,n,"row",l),getColumnStartIndexForOffset:(e,t,r)=>wr(e,r,t,"column"),getColumnStopIndexForStartIndex:(e,t,r,a)=>{const n=yr(e,t,a,"column"),l=r+e.width;let o=n.offset+n.size,s=t;for(;s<e.totalColumn-1&&o<l;)s++,o+=yr(e,t,a,"column").size;return s},getEstimatedTotalHeight:vr,getEstimatedTotalWidth:br,getRowStartIndexForOffset:(e,t,r)=>wr(e,r,t,"row"),getRowStopIndexForStartIndex:(e,t,r,a)=>{const{totalRow:n,height:l}=e,o=yr(e,t,a,"row"),s=r+l;let i=o.size+o.offset,c=t;for(;c<n-1&&i<s;)c++,i+=yr(e,c,a,"row").size;return c},injectToInstance:(e,t)=>{const r=({columnIndex:r,rowIndex:a},n)=>{var l,o;n=!!z(n)||n,x(r)&&(t.value.lastVisitedColumnIndex=Math.min(t.value.lastVisitedColumnIndex,r-1)),x(a)&&(t.value.lastVisitedRowIndex=Math.min(t.value.lastVisitedRowIndex,a-1)),null==(l=e.exposed)||l.getItemStyleCache.value(-1,null,null),n&&(null==(o=e.proxy)||o.$forceUpdate())};Object.assign(e.proxy,{resetAfterColumnIndex:(e,t)=>{r({columnIndex:e},t)},resetAfterRowIndex:(e,t)=>{r({rowIndex:e},t)},resetAfter:r})},initCache:({estimatedColumnWidth:e=50,estimatedRowHeight:t=50})=>({column:{},estimatedColumnWidth:e,estimatedRowHeight:t,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:e,rowHeight:t})=>{}}),kr=dr({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:e},t)=>[e,t*e],getRowPosition:({rowHeight:e},t)=>[e,t*e],getEstimatedTotalHeight:({totalRow:e,rowHeight:t})=>t*e,getEstimatedTotalWidth:({totalColumn:e,columnWidth:t})=>t*e,getColumnOffset:({totalColumn:e,columnWidth:t,width:r},a,n,l,o,s)=>{r=Number(r);const i=Math.max(0,e*t-r),c=Math.min(i,a*t),d=Math.max(0,a*t-r+s+t);switch("smart"===n&&(n=l>=d-r&&l<=c+r?lt:it),n){case st:return c;case ct:return d;case it:{const e=Math.round(d+(c-d)/2);return e<Math.ceil(r/2)?0:e>i+Math.floor(r/2)?i:e}default:return l>=d&&l<=c?l:d>c||l<d?d:c}},getRowOffset:({rowHeight:e,height:t,totalRow:r},a,n,l,o,s)=>{t=Number(t);const i=Math.max(0,r*e-t),c=Math.min(i,a*e),d=Math.max(0,a*e-t+s+e);switch(n===ot&&(n=l>=d-t&&l<=c+t?lt:it),n){case st:return c;case ct:return d;case it:{const e=Math.round(d+(c-d)/2);return e<Math.ceil(t/2)?0:e>i+Math.floor(t/2)?i:e}default:return l>=d&&l<=c?l:d>c||l<d?d:c}},getColumnStartIndexForOffset:({columnWidth:e,totalColumn:t},r)=>Math.max(0,Math.min(t-1,Math.floor(r/e))),getColumnStopIndexForStartIndex:({columnWidth:e,totalColumn:t,width:r},a,n)=>{const l=a*e,o=Math.ceil((r+n-l)/e);return Math.max(0,Math.min(t-1,a+o-1))},getRowStartIndexForOffset:({rowHeight:e,totalRow:t},r)=>Math.max(0,Math.min(t-1,Math.floor(r/e))),getRowStopIndexForStartIndex:({rowHeight:e,totalRow:t,height:r},a,n)=>{const l=a*e,o=Math.ceil((r+n-l)/e);return Math.max(0,Math.min(t-1,a+o-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:e,rowHeight:t})=>{}});var Cr=d({name:"ElTableV2Grid",props:sr,setup(e,{slots:t,expose:r}){const{ns:a}=E(qt),{bodyRef:l,fixedRowHeight:o,gridHeight:s,hasHeader:i,headerRef:c,headerHeight:d,totalHeight:u,forceUpdate:p,itemKey:y,onItemRendered:g,resetAfterRowIndex:w,scrollTo:b,scrollToTop:S,scrollToRow:k,scrollLeft:C}=(e=>{const t=m(),r=m(),a=m(0),l=n(()=>{const{data:t,rowHeight:r,estimatedRowHeight:a}=e;if(!a)return t.length*r}),o=n(()=>{const{fixedData:t,rowHeight:r}=e;return((null==t?void 0:t.length)||0)*r}),s=n(()=>_t(e.headerHeight)),i=n(()=>{const{height:t}=e;return Math.max(0,t-h(s)-h(o))}),c=n(()=>h(s)+h(o)>0);return f(()=>e.bodyWidth,()=>{var t;x(e.estimatedRowHeight)&&(null==(t=r.value)||t.resetAfter({columnIndex:0},!1))}),{bodyRef:r,forceUpdate:function(){var e,a;null==(e=h(r))||e.$forceUpdate(),null==(a=h(t))||a.$forceUpdate()},fixedRowHeight:o,gridHeight:i,hasHeader:c,headerHeight:s,headerRef:t,totalHeight:l,itemKey:({data:t,rowIndex:r})=>t[r][e.rowKey],onItemRendered:function({rowCacheStart:t,rowCacheEnd:r,rowVisibleStart:a,rowVisibleEnd:n}){var l;null==(l=e.onRowsRendered)||l.call(e,{rowCacheStart:t,rowCacheEnd:r,rowVisibleStart:a,rowVisibleEnd:n})},resetAfterRowIndex:function(e,t){var a;null==(a=r.value)||a.resetAfterRowIndex(e,t)},scrollTo:function(e,n){const l=h(t),o=h(r);v(e)?(null==l||l.scrollToLeft(e.scrollLeft),a.value=e.scrollLeft,null==o||o.scrollTo(e)):(null==l||l.scrollToLeft(e),a.value=e,null==o||o.scrollTo({scrollLeft:e,scrollTop:n}))},scrollToTop:function(e){var t;null==(t=h(r))||t.scrollTo({scrollTop:e})},scrollToRow:function(e,t){var a;null==(a=h(r))||a.scrollToItem(e,1,t)},scrollLeft:a}})(e);K(Ut,C),W(async()=>{var e;await R();const t=null==(e=l.value)?void 0:e.states.scrollTop;t&&S(Math.round(t)+1)}),r({forceUpdate:p,totalHeight:u,scrollTo:b,scrollToTop:S,scrollToRow:k,resetAfterRowIndex:w});const T=()=>e.bodyWidth;return()=>{const{cache:r,columns:n,data:u,fixedData:m,useIsScrolling:p,scrollbarAlwaysOn:f,scrollbarEndGap:w,scrollbarStartGap:v,style:b,rowHeight:R,bodyWidth:S,estimatedRowHeight:k,headerWidth:C,height:I,width:E,getRowHeight:H,onScroll:j}=e,D=x(k),M=D?Sr:kr,N=h(d);return F("div",{role:"table",class:[a.e("table"),e.class],style:b},[F(M,{ref:l,data:u,useIsScrolling:p,itemKey:y,columnCache:0,columnWidth:D?T:S,totalColumn:1,totalRow:u.length,rowCache:r,rowHeight:D?H:R,width:E,height:h(s),class:a.e("body"),role:"rowgroup",scrollbarStartGap:v,scrollbarEndGap:w,scrollbarAlwaysOn:f,onScroll:j,onItemRendered:g,perfMode:!1},{default:e=>{var r;const a=u[e.rowIndex];return null==(r=t.row)?void 0:r.call(t,{...e,columns:n,rowData:a})}}),h(i)&&F(cr,{ref:c,class:a.e("header-wrapper"),columns:n,headerData:u,headerHeight:e.headerHeight,fixedHeaderData:m,rowWidth:C,rowHeight:R,width:E,height:Math.min(N+h(o),I)},{dynamic:t.header,fixed:t.row})])}}});var Tr=(e,{slots:t})=>{const{mainTableRef:r,...a}=e;return F(Cr,A({ref:r},a),"function"==typeof(n=t)||"[object Object]"===Object.prototype.toString.call(n)&&!C(n)?t:{default:()=>[t]});var n};var Ir=(e,{slots:t})=>{if(!e.columns.length)return;const{leftTableRef:r,...a}=e;return F(Cr,A({ref:r},a),"function"==typeof(n=t)||"[object Object]"===Object.prototype.toString.call(n)&&!C(n)?t:{default:()=>[t]});var n};var Er=(e,{slots:t})=>{if(!e.columns.length)return;const{rightTableRef:r,...a}=e;return F(Cr,A({ref:r},a),"function"==typeof(n=t)||"[object Object]"===Object.prototype.toString.call(n)&&!C(n)?t:{default:()=>[t]});var n};const Hr=e=>{const{isScrolling:t}=E(qt),r=m(!1),a=m(),l=n(()=>x(e.estimatedRowHeight)&&e.rowIndex>=0),o=n(()=>{const{rowData:t,rowIndex:r,rowKey:a,onRowHover:n}=e,l=e.rowEventHandlers||{},o={};return Object.entries(l).forEach(([e,n])=>{T(n)&&(o[e]=e=>{n({event:e,rowData:t,rowIndex:r,rowKey:a})})}),n&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach(({name:e,hovered:l})=>{const s=o[e];o[e]=e=>{n({event:e,hovered:l,rowData:t,rowIndex:r,rowKey:a}),null==s||s(e)}}),o});return D(()=>{h(l)&&((t=!1)=>{const n=h(a);if(!n)return;const{columns:l,onRowHeightChange:o,rowKey:s,rowIndex:i,style:c}=e,{height:d}=n.getBoundingClientRect();r.value=!0,R(()=>{if(t||d!==Number.parseInt(c.height)){const e=l[0],t=(null==e?void 0:e.placeholderSign)===zt;null==o||o({rowKey:s,height:d,rowIndex:i},e&&!t&&e.fixed)}})})(!0)}),{isScrolling:t,measurable:l,measured:r,rowRef:a,eventHandlers:o,onExpand:t=>{const{onRowExpand:r,rowData:a,rowIndex:n,rowKey:l}=e;null==r||r({expanded:t,rowData:a,rowIndex:n,rowKey:l})}}};var Fr=d({name:"ElTableV2TableRow",props:nr,setup(e,{expose:t,slots:r,attrs:a}){const{eventHandlers:n,isScrolling:l,measurable:o,measured:s,rowRef:i,onExpand:c}=Hr(e);return t({onExpand:c}),()=>{const{columns:t,columnsStyles:d,expandColumnKey:u,depth:m,rowData:p,rowIndex:f,style:y}=e;let g=t.map((e,a)=>{const n=S(p.children)&&p.children.length>0&&e.key===u;return r.cell({column:e,columns:t,columnIndex:a,depth:m,style:d[e.key],rowData:p,rowIndex:f,isScrolling:h(l),expandIconProps:n?{rowData:p,rowIndex:f,onExpand:c}:void 0})});if(r.row&&(g=r.row({cells:g.map(e=>S(e)&&1===e.length?e[0]:e),style:y,columns:t,depth:m,rowData:p,rowIndex:f,isScrolling:h(l)})),h(o)){const{height:t,...r}=y||{},l=h(s);return F("div",A({ref:i,class:e.class,style:l?y:r,role:"row"},a,h(n)),[g])}return F("div",A(a,{ref:i,class:e.class,style:y,role:"row"},h(n)),[g])}}});var jr=(e,{slots:t})=>{const{columns:r,columnsStyles:a,depthMap:n,expandColumnKey:l,expandedRowKeys:o,estimatedRowHeight:s,hasFixedColumns:i,rowData:c,rowIndex:d,style:u,isScrolling:m,rowProps:p,rowClass:h,rowKey:f,rowEventHandlers:y,ns:g,onRowHovered:w,onRowExpanded:v}=e,b=Pt(h,{columns:r,rowData:c,rowIndex:d},""),x=Pt(p,{columns:r,rowData:c,rowIndex:d}),R=c[f],S=n[R]||0,k=Boolean(l),T=d<0,I=[g.e("row"),b,{[g.e(`row-depth-${S}`)]:k&&d>=0,[g.is("expanded")]:k&&o.includes(R),[g.is("fixed")]:!S&&T,[g.is("customized")]:Boolean(t.row)}],E=i?w:void 0,H={...x,columns:r,columnsStyles:a,class:I,depth:S,expandColumnKey:l,estimatedRowHeight:T?void 0:s,isScrolling:m,rowIndex:d,rowData:c,rowKey:R,rowEventHandlers:y,style:u};return F(Fr,A(H,{onRowExpand:v,onMouseenter:e=>{null==E||E({hovered:!0,rowKey:R,event:e,rowData:c,rowIndex:d})},onMouseleave:e=>{null==E||E({hovered:!1,rowKey:R,event:e,rowData:c,rowIndex:d})},rowkey:R}),"function"==typeof(j=t)||"[object Object]"===Object.prototype.toString.call(j)&&!C(j)?t:{default:()=>[t]});var j};const Dr=(e,{slots:t})=>{var r;const{cellData:a,style:n}=e,l=(null==(r=null==a?void 0:a.toString)?void 0:r.call(a))||"",o=_(t,"default",e,()=>[l]);return F("div",{class:e.class,title:l,style:n},[o])};Dr.displayName="ElTableV2Cell",Dr.inheritAttrs=!1;var Mr=Dr;var Nr=e=>{const{expanded:t,expandable:r,onExpand:a,style:n,size:l}=e,o={onClick:r?()=>a(!t):void 0,class:e.class};return F(G,A(o,{size:l,style:n}),{default:()=>[F(P,null,null)]})};const $r=({columns:e,column:t,columnIndex:r,depth:a,expandIconProps:n,isScrolling:l,rowData:o,rowIndex:s,style:i,expandedRowKeys:c,ns:d,cellProps:u,expandColumnKey:m,indentSize:p,iconSize:h,rowKey:f},{slots:y})=>{const g=Gt(i);if(t.placeholderSign===zt)return F("div",{class:d.em("row-cell","placeholder"),style:g},null);const{cellRenderer:w,dataKey:b,dataGetter:x}=t,R=T(x)?x({columns:e,column:t,columnIndex:r,rowData:o,rowIndex:s}):V(o,null!=b?b:""),S=Pt(u,{cellData:R,columns:e,column:t,columnIndex:r,rowIndex:s,rowData:o}),k={class:d.e("cell-text"),columns:e,column:t,columnIndex:r,cellData:R,isScrolling:l,rowData:o,rowIndex:s},C=Vt(w),I=C?C(k):_(y,"default",k,()=>[F(Mr,k,null)]),E=[d.e("row-cell"),t.class,t.align===At.CENTER&&d.is("align-center"),t.align===At.RIGHT&&d.is("align-right")],H=s>=0&&m&&t.key===m,j=s>=0&&c.includes(o[f]);let D;const M=`margin-inline-start: ${a*p}px;`;return H&&(D=v(n)?F(Nr,A(n,{class:[d.e("expand-icon"),d.is("expanded",j)],size:h,expanded:j,style:M,expandable:!0}),null):F("div",{style:[M,`width: ${h}px; height: ${h}px;`].join(" ")},null)),F("div",A({class:E,style:g},S,{role:"cell"}),[D,I])};$r.inheritAttrs=!1;var Ar=$r;const Or=o({class:String,columns:Yt,columnsStyles:{type:i(Object),required:!0},headerIndex:Number,style:{type:i(Object)}});var Lr=d({name:"ElTableV2HeaderRow",props:Or,setup:(e,{slots:t})=>()=>{const{columns:r,columnsStyles:a,headerIndex:n,style:l}=e;let o=r.map((e,l)=>t.cell({columns:r,column:e,columnIndex:l,headerIndex:n,style:a[e.key]}));return t.header&&(o=t.header({cells:o.map(e=>S(e)&&1===e.length?e[0]:e),columns:r,headerIndex:n})),F("div",{class:e.class,style:l,role:"row"},[o])}});var zr=({columns:e,columnsStyles:t,headerIndex:r,style:a,headerClass:n,headerProps:l,ns:o},{slots:s})=>{const i={columns:e,headerIndex:r},c=[o.e("header-row"),Pt(n,i,""),{[o.is("customized")]:Boolean(s.header)}],d={...Pt(l,i),columnsStyles:t,class:c,columns:e,headerIndex:r,style:a};return F(Lr,d,"function"==typeof(u=s)||"[object Object]"===Object.prototype.toString.call(u)&&!C(u)?s:{default:()=>[s]});var u};const Wr=(e,{slots:t})=>_(t,"default",e,()=>{var t,r;return[F("div",{class:e.class,title:null==(t=e.column)?void 0:t.title},[null==(r=e.column)?void 0:r.title])]});Wr.displayName="ElTableV2HeaderCell",Wr.inheritAttrs=!1;var Kr=Wr;var _r=e=>{const{sortOrder:t}=e;return F(G,{size:14,class:e.class},{default:()=>[t===$t.ASC?F(B,null,null):F(q,null,null)]})};var Pr=(e,{slots:t})=>{const{column:r,ns:a,style:n,onColumnSorted:l}=e,o=Gt(n);if(r.placeholderSign===zt)return F("div",{class:a.em("header-row-cell","placeholder"),style:o},null);const{headerCellRenderer:s,headerClass:i,sortable:c}=r,d={...e,class:a.e("header-cell-text")},u=Vt(s),m=u?u(d):_(t,"default",d,()=>[F(Kr,d,null)]),{sortBy:p,sortState:h,headerCellProps:f}=e;let y,g;if(h){const e=h[r.key];y=Boolean(Lt[e]),g=y?e:$t.ASC}else y=r.key===p.key,g=y?p.order:$t.ASC;const w=[a.e("header-cell"),Pt(i,e,""),r.align===At.CENTER&&a.is("align-center"),r.align===At.RIGHT&&a.is("align-right"),c&&a.is("sortable")],v={...Pt(f,e),onClick:r.sortable?l:void 0,class:w,style:o,"data-key":r.key};return F("div",A(v,{role:"columnheader"}),[m,c&&F(_r,{class:[a.e("sort-icon"),y&&a.is("sorting")],sortOrder:g},null)])};const Gr=(e,{slots:t})=>{var r;return F("div",{class:e.class,style:e.style},[null==(r=t.default)?void 0:r.call(t)])};Gr.displayName="ElTableV2Footer";var Vr=Gr;const Br=(e,{slots:t})=>{const r=_(t,"default",{},()=>[F(Ce,null,null)]);return F("div",{class:e.class,style:e.style},[r])};Br.displayName="ElTableV2Empty";var qr=Br;const Ur=(e,{slots:t})=>{var r;return F("div",{class:e.class,style:e.style},[null==(r=t.default)?void 0:r.call(t)])};Ur.displayName="ElTableV2Overlay";var Zr=Ur;function Yr(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!C(e)}var Xr=d({name:"ElTableV2",props:ir,setup(e,{slots:t,expose:r}){const a=u("table-v2"),{columnsStyles:n,fixedColumnsOnLeft:l,fixedColumnsOnRight:o,mainColumns:s,mainTableHeight:i,fixedTableHeight:c,leftTableWidth:d,rightTableWidth:m,data:p,depthMap:f,expandedRowKeys:y,hasFixedColumns:g,mainTableRef:w,leftTableRef:v,rightTableRef:b,isDynamic:x,isResetting:R,isScrolling:S,bodyWidth:k,emptyStyle:C,rootStyle:T,footerHeight:I,showEmpty:E,scrollTo:H,scrollToLeft:j,scrollToTop:D,scrollToRow:M,getRowHeight:N,onColumnSorted:$,onRowHeightChange:O,onRowHovered:L,onRowExpanded:z,onRowsRendered:W,onScroll:_,onVerticalScroll:P}=Bt(e);return r({scrollTo:H,scrollToLeft:j,scrollToTop:D,scrollToRow:M}),K(qt,{ns:a,isResetting:R,isScrolling:S}),()=>{const{cache:r,cellProps:u,estimatedRowHeight:R,expandColumnKey:S,fixedData:H,headerHeight:j,headerClass:D,headerProps:M,headerCellProps:K,sortBy:G,sortState:V,rowHeight:B,rowClass:q,rowEventHandlers:U,rowKey:Z,rowProps:Y,scrollbarAlwaysOn:X,indentSize:J,iconSize:Q,useIsScrolling:ee,vScrollbarSize:te,width:re}=e,ae=h(p),ne={cache:r,class:a.e("main"),columns:h(s),data:ae,fixedData:H,estimatedRowHeight:R,bodyWidth:h(k),headerHeight:j,headerWidth:h(k),height:h(i),mainTableRef:w,rowKey:Z,rowHeight:B,scrollbarAlwaysOn:X,scrollbarStartGap:2,scrollbarEndGap:te,useIsScrolling:ee,width:re,getRowHeight:N,onRowsRendered:W,onScroll:_},le=h(d),oe=h(c),se={cache:r,class:a.e("left"),columns:h(l),data:ae,fixedData:H,estimatedRowHeight:R,leftTableRef:v,rowHeight:B,bodyWidth:le,headerWidth:le,headerHeight:j,height:oe,rowKey:Z,scrollbarAlwaysOn:X,scrollbarStartGap:2,scrollbarEndGap:te,useIsScrolling:ee,width:le,getRowHeight:N,onScroll:P},ie=h(m),ce={cache:r,class:a.e("right"),columns:h(o),data:ae,fixedData:H,estimatedRowHeight:R,rightTableRef:b,rowHeight:B,bodyWidth:ie,headerWidth:ie,headerHeight:j,height:oe,rowKey:Z,scrollbarAlwaysOn:X,scrollbarStartGap:2,scrollbarEndGap:te,width:ie,style:`${a.cssVarName("table-scrollbar-size")}: ${te}px`,useIsScrolling:ee,getRowHeight:N,onScroll:P},de=h(n),ue={ns:a,depthMap:h(f),columnsStyles:de,expandColumnKey:S,expandedRowKeys:h(y),estimatedRowHeight:R,hasFixedColumns:h(g),rowProps:Y,rowClass:q,rowKey:Z,rowEventHandlers:U,onRowHovered:L,onRowExpanded:z,onRowHeightChange:O},me={cellProps:u,expandColumnKey:S,indentSize:J,iconSize:Q,rowKey:Z,expandedRowKeys:h(y),ns:a},pe={ns:a,headerClass:D,headerProps:M,columnsStyles:de},he={ns:a,sortBy:G,sortState:V,headerCellProps:K,onColumnSorted:$},fe={row:e=>F(jr,A(e,ue),{row:t.row,cell:e=>{let r;return t.cell?F(Ar,A(e,me,{style:de[e.column.key]}),Yr(r=t.cell(e))?r:{default:()=>[r]}):F(Ar,A(e,me,{style:de[e.column.key]}),null)}}),header:e=>F(zr,A(e,pe),{header:t.header,cell:e=>{let r;return t["header-cell"]?F(Pr,A(e,he,{style:de[e.column.key]}),Yr(r=t["header-cell"](e))?r:{default:()=>[r]}):F(Pr,A(e,he,{style:de[e.column.key]}),null)}})},ye=[e.class,a.b(),a.e("root"),{[a.is("dynamic")]:h(x)}],ge={class:a.e("footer"),style:h(I)};return F("div",{class:ye,style:h(T)},[F(Tr,ne,Yr(fe)?fe:{default:()=>[fe]}),F(Ir,se,Yr(fe)?fe:{default:()=>[fe]}),F(Er,ce,Yr(fe)?fe:{default:()=>[fe]}),t.footer&&F(Vr,ge,{default:t.footer}),h(E)&&F(qr,{class:a.e("empty"),style:h(C)},{default:t.empty}),t.overlay&&F(Zr,{class:a.e("overlay")},{default:t.overlay})])}}});const Jr=o({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:i(Function)}});var Qr=d({name:"ElAutoResizer",props:Jr,setup(e,{slots:t}){const r=u("auto-resizer"),{height:a,width:n,sizer:l}=(e=>{const t=m(),r=m(0),a=m(0);let n;return D(()=>{n=U(t,([e])=>{const{width:t,height:n}=e.contentRect,{paddingLeft:l,paddingRight:o,paddingTop:s,paddingBottom:i}=getComputedStyle(e.target),c=Number.parseInt(l)||0,d=Number.parseInt(o)||0,u=Number.parseInt(s)||0,m=Number.parseInt(i)||0;r.value=t-c-d,a.value=n-u-m}).stop}),y(()=>{null==n||n()}),f([r,a],([t,r])=>{var a;null==(a=e.onResize)||a.call(e,{width:t,height:r})}),{sizer:t,width:r,height:a}})(e),o={width:"100%",height:"100%"};return()=>{var e;return F("div",{ref:l,class:r.b(),style:o},[null==(e=t.default)?void 0:e.call(t,{height:a.value,width:n.value})])}}});const ea=Z(Xr),ta=Z(Qr),ra={class:"upload select"},aa={class:"upload text"},na=ke(d({__name:"TestLog",emits:["handleLine","beforeHandle","afterHandle"],setup(t,{emit:a}){const{t:n}=e(),l=a,o=m(null),s=m(null);async function i(e){s.value?.classList.remove("drag");const t=e.target.files;if(!t||0===t.length)return;l("beforeHandle");const a=r.service({fullscreen:!0,text:n("testLog.loading"),lock:!0,spinner:'<div style="width:0;height:0"></div>'});for(let r=0;r<t.length;r++){const e=t[r],a=await e.text();for(const t of a.split("\n"))l("handleLine",t)}a.close(),l("afterHandle"),s.value?.classList.remove("drag")}function c(e){e.preventDefault(),s.value?.classList.add("drag")}function d(e){e.preventDefault(),s.value?.classList.remove("drag")}return D(()=>{o.value?.addEventListener("change",i),s.value?.addEventListener("dragover",c),s.value?.addEventListener("dragleave",d)}),Y(()=>{o.value?.removeEventListener("change",i),s.value?.removeEventListener("dragover",c),s.value?.removeEventListener("dragleave",d)}),(e,t)=>(J(),X("div",ra,[Q("div",{ref_key:"select",ref:s,class:"upload-select"},[Q("div",aa,[t[0]||(t[0]=Q("span",null,"+",-1)),Q("p",null,ee(e.$t("testLog.upload")),1)]),Q("input",{ref_key:"input",ref:o,type:"file"},null,512)],512)]))}}),[["__scopeId","data-v-36beaa21"]]),la=re("hash"),oa=te("keigennRecord2",{state:()=>({userOptions:{scale:n(()=>sa(la.scale,1)),opacity:n(()=>sa(la.opacity,.9)),targetType:n(()=>sa(la.targetType,"icon")),iconType:n(()=>sa(la.iconType,2)),parseAA:n(()=>sa(la.parseAA,!0)),parseDoT:n(()=>sa(la.parseDoT,!1)),minimize:n(()=>sa(la.minimize,!1)),actionCN:n(()=>sa(la.actionCN,!0)),statusCN:n(()=>sa(la.statusCN,!0))},isBrowser:!1}),getters:{icon4k:e=>e.userOptions.scale>=2||window.devicePixelRatio>=2?"_hr1":""},actions:{checkIsBrowser(){this.isBrowser=!window.OverlayPluginApi&&!la.OVERLAY_WS&&!la.HOST_PORT,this.isBrowser&&setTimeout(()=>this.checkIsBrowser(),1e3)},formatterName(e){const t=/^([A-Z])\S+ ([A-Z])\S+/;return t.test(e)?e.replace(t,"$1.$2"):`${e.at(0)}.${e.at(-1)}`}}});function sa(e,t){return"boolean"==typeof t?"0"!==e&&"false"!==e?.toLocaleLowerCase()&&("1"===e||"true"===e?.toLocaleLowerCase()||t):"number"==typeof t?Number.isNaN(+e)?t:+e:"string"==typeof t?e:t}const ia=[Number(409).toString(16).toUpperCase(),Number(810).toString(16).toUpperCase(),Number(811).toString(16).toUpperCase(),Number(1836).toString(16).toUpperCase()];function ca(e){return e.currentHp-e.amount<0&&!e.keigenns.find(e=>ia.includes(e.effectId))}const da={class:"amount"},ua={class:"row-info"},ma=ke(d({__name:"Amount",props:{row:{}},setup(e){const t=e,{amount:r,maxHp:a,currentHp:l,shield:o,source:s,type:i}=t.row,c=Math.round(a*+o/100),d=Math.round(l/a*100),u=t.row.reduction,m=(r&&Math.round((r+c)/(1-u))||0).toLocaleString(),p=n(()=>r>999999?`${(r/1e4).toFixed(0)}万`:r.toLocaleString()),f=i,y=ca(t.row);return(e,t)=>{const r=je,a=De;return J(),ae(a,{"append-to":".wrapper",trigger:"hover",enterable:!1,"hide-after":0,width:180},{reference:ne(()=>[Q("span",da,[Q("span",{class:se(h(f))},[Q("span",{class:se({lethal:h(y)})},ee(h(p)),3)],2)])]),default:ne(()=>[Q("ul",ua,[Q("li",null,ee(e.$t("keigennRecord.source"))+": "+ee(h(s)),1),Q("li",null,ee(e.$t("keigennRecord.playerShield"))+": "+ee(h(o))+"%",1),Q("li",null,ee(e.$t("keigennRecord.playerHp"))+": "+ee(h(d))+"%",1),h(u)<1&&"dot"!==h(i)?(J(),X(O,{key:0},[F(r),Q("li",null,ee(e.$t("keigennRecord.reductionRate"))+": "+ee((100*h(u)).toFixed(3))+"% ",1),Q("li",null,[oe(ee(e.$t("keigennRecord.originalDamage"))+": ",1),Q("span",{class:se(h(f))},ee(h(m)),3)])],64)):le("",!0)])]),_:1})}}}),[["__scopeId","data-v-43628410"]]),pa=[{name:"受伤减轻",id:1100,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"铁壁",id:1191,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"盾阵",id:1856,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"干预",id:1174,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"预警",id:74,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"武装",id:1176,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"神圣领域",id:82,type:"multiplier",performance:{physics:0,magic:0,darkness:0},isFriendly:!0},{name:"圣光幕帘",id:1362,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"圣盾阵",id:2674,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"骑士的坚守",id:2675,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"壁垒",id:77,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"极致防御",id:3829,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"极致护盾",id:3830,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"原初的直觉",id:735,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的勇猛",id:1857,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的武猛",id:1858,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"战栗",id:87,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"复仇",id:89,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"摆脱",id:1457,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"死斗",id:409,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"原初的血气",id:2678,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的血潮",id:2679,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的血烟",id:2680,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"戮罪",id:3832,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"至黑之夜",id:1178,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"弃明投暗",id:746,type:"multiplier",performance:{physics:.9,magic:.8,darkness:1},isFriendly:!0},{name:"暗影墙",id:747,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"暗黑布道",id:1894,type:"multiplier",performance:{physics:.95,magic:.9,darkness:1},isFriendly:!0},{name:"暗影卫",id:3835,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"行尸走肉",id:810,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"死而不僵",id:811,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"出死入生",id:3255,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"献奉",id:2682,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"石之心",id:1840,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"残暴弹",id:1898,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"伪装",id:1832,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"星云",id:1834,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"光之心",id:1839,type:"multiplier",performance:{physics:.95,magic:.85,darkness:1},isFriendly:!0},{name:"超火流星",id:1836,type:"multiplier",performance:{physics:0,magic:0,darkness:0},isFriendly:!0},{name:"刚玉之心",id:2683,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"刚玉之清",id:2684,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"神祝祷",id:1218,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"告解",id:1219,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"节制",id:1873,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"水流幕",id:2708,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"鼓舞",id:297,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"激励",id:1918,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"炽天的幕帘",id:1917,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"野战治疗阵",id:299,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"异想的幻光",id:317,type:"multiplier",performance:{physics:1,magic:.95,darkness:1},isFriendly:!0},{name:"炽天的幻光",id:1875,type:"multiplier",performance:{physics:1,magic:.95,darkness:1},isFriendly:!0},{name:"生命回生法",id:2710,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"怒涛之计",id:2711,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"命运之轮",id:849,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"天星交错",id:1889,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"擢升",id:2717,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"中间学派",id:1921,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"均衡诊断",id:2607,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"齐衡诊断",id:2608,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"均衡预后",id:2609,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"坚角清汁",id:2618,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"白牛清汁",id:2619,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"整体论",id:3003,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"整体盾",id:3365,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"输血",id:2612,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"泛输血",id:2613,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"心眼",id:1232,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"金刚极意",id:1179,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"行吟",id:1934,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"策动",id:1951,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"防守之桑巴",id:1826,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"即兴表演结束",id:2697,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"残影",id:488,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"魔罩",id:168,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"守护之光",id:2702,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"守护纹",id:2597,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"抗死",id:2707,type:"multiplier",performance:{physics:1,magic:.9,darkness:1},isFriendly:!0},{name:"雪仇",id:1193,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!1},{name:"牵制",id:1195,type:"multiplier",performance:{physics:.9,magic:.95,darkness:1},isFriendly:!1},{name:"昏乱",id:1203,type:"multiplier",performance:{physics:.95,magic:.9,darkness:1},isFriendly:!1},{name:"武装解除",id:860,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!1},{name:"减速",id:9,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!1},{name:"体力增加",id:2120,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"腐臭",id:1715,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!1},{name:"智力精神降低",id:2115,type:"multiplier",performance:{physics:1,magic:.9,darkness:1},isFriendly:!1},{name:"龙之力",id:2500,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"超硬化",id:1722,type:"multiplier",performance:{physics:.1,magic:.1,darkness:1},isFriendly:!0},{name:"玄结界",id:2496,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"仙人盾",id:2119,type:"multiplier",performance:{physics:.95,magic:.95,darkness:1},isFriendly:!0},{name:"强力守护",id:1719,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"哥布防御",id:2114,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"铜墙铁盾",id:194,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"坚守要塞",id:195,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"终极堡垒",id:196,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"原初大地",id:863,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"暗黑之力",id:864,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"灵魂之青",id:1931,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"坦培拉涂层",id:3686,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"油性坦培拉涂层",id:3687,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"世界树之干",id:3890,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"建筑神之塔",id:3892,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"太阳星座",id:3896,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"神爱抚",id:3903,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0}],ha=new Map;for(const Pa of pa){const e=Me[Pa.id][1];Pa.fullIcon=Ne(e),ha.set(Pa.id.toString(16).toUpperCase().padStart(2,"0"),Pa)}function fa(e){return ha.get(e)}function ya(e,t){if("absorbed"===e.type)return"useful";if("dot"===t||"darkness"===t)return"unuseful";if(0===e.performance.darkness&&0===e.performance.magic&&0===e.performance.physics||1===e.performance.darkness&&1===e.performance.magic&&1===e.performance.physics)return"useful";const r="physics"===t?"magic":"physics";return 2*(100-100*e.performance[t])===100-100*e.performance[r]?"half-useful":1===e.performance[t]?"unuseful":"useful"}function ga(e,t){return Object.entries(Me).reduce((r,[a,[n,l]])=>(e.test(n)&&r.set(a,{name:n,icon:l,isFriendly:t}),r),new Map)}const wa=ga(/(?:耐性|防御力)(?:大幅)?(?:降低|提升|低下|下降)|受伤(?:加重|减轻)|体力(?:增加|衰减|减少)|伤害屏障/,!0),va=ga(/(?:精神|力量|灵巧|智力){1,2}(?:大幅)?降低/,!1),ba={key:0},xa={key:1,class:"status-container"},Ra=["title","data-duration","data-sourcePov"],Sa=["src","alt"],ka={class:"flags"},Ca=ke(d({__name:"StatusShow",props:{row:{type:Object,required:!0}},setup(e){const t=e,r=oa(),a=r.userOptions,n=r.icon4k;return(e,r)=>"dot"===t.row.type?(J(),X("div",ba,ee(e.$t("keigennRecord.noSupport")),1)):(J(),X("div",xa,[(J(!0),X(O,null,ie(t.row.keigenns,(e,l)=>(J(),X("span",{key:l},[Q("span",{class:"status",title:`${h(a).statusCN?e.name:e.effect}(${e.source})`,"data-duration":e.remainingDuration,"data-sourcePov":e.isPov},[Q("img",{class:se(`statusIcon ${h(ya)(e,t.row.type)}`),src:h(Oe)(`/i/${e.fullIcon}${h(n)}.png`),alt:e.effect,loading:"lazy",onError:r[0]||(r[0]=(...e)=>h(Ae)&&h(Ae)(...e))},null,42,Sa)],8,Ra)]))),128)),Q("span",ka,ee("damage done"===t.row.effect?"":e.$t(`keigennRecord.${t.row.effect}`)),1)]))}}),[["__scopeId","data-v-e479f52a"]]),Ta={class:"target"},Ia=["src","alt"],Ea={key:1,class:"alt-text"},Ha={key:3,class:"has-duplicate"},Fa=ke(d({__name:"Target",props:{row:{type:Object,required:!0}},setup(e){const t=e,r=oa(),a=m(!1);function l(e){a.value=!0;e.target.style.display="none"}const o=n(()=>!a.value&&"icon"===(r.userOptions.targetType??"icon")),s=n(()=>ca(t.row));return(e,a)=>{return J(),X("div",Ta,[h(o)?(J(),X("img",{key:0,class:se(`${h(r).isBrowser?"browser":"act"} jobIcon cj${h(r).userOptions.iconType} ${h(s)?"lethal-icon":""}`),src:(n=t.row.jobIcon,i=h(r).userOptions.iconType,`https://souma.diemoe.net/resources/img/cj${i}/${n.replaceAll(/([A-Z])/g," $1").trim()}.png`),alt:t.row.jobIcon,onError:l},null,42,Ia)):(J(),X("span",Ea,ee(t.row.job),1)),h(s)?(J(),X("span",{key:2,class:se(`lethal-emoji ${h(r).isBrowser?"browser":"act"} emoji-cj${h(r).userOptions.iconType}`)}," 💀 ",2)):le("",!0),t.row.hasDuplicate?(J(),X("span",Ha,ee(h(r).formatterName(t.row.target)),1)):le("",!0)]);var n,i}}}),[["__scopeId","data-v-8cdea5a4"]]),ja=ke(d({__name:"Table",props:{rows:{},actionKey:{}},setup(t){const{t:r}=e(),a=t,l=oa().userOptions,o=ce("contextMenu"),s=m(""),i=m("");f(()=>a.rows,e=>{0===e.length&&(s.value="",i.value="")},{immediate:!0});const c=m(!1),d=m(0),u=m(0),p=m(null);de(o,()=>{c.value=!1});const y=r("keigennRecord.cancelFilter"),w=n(()=>{const e=Array.from(new Set(a.rows.map(e=>e[a.actionKey])));return[{label:y,value:""},...e.map(e=>({label:e,value:e}))]}),v=n(()=>{const e=Array.from(new Map(a.rows.map(e=>[e.target,e])).values());return[{label:y,value:"",job:-1},...e.map(e=>({label:`${e.job}(${e.target})`,value:e.target,job:e.jobEnum}))].sort((e,t)=>Fe.enumSortMethod(e.job,t.job))});function b(){if(p.value){const e=p.value[a.actionKey];s.value===e?s.value="":s.value=e,c.value=!1}}function x(){if(p.value){const e=p.value.target;i.value===e?i.value="":i.value=e,c.value=!1}}const R=n(()=>a.rows.filter(e=>{const t=!s.value||s.value===y||e[a.actionKey]===s.value,r=!i.value||i.value===y||e.target===i.value;return t&&r}));function S(e){const t=[88,88,88],r=[50,250,200],a=Math.min(1,e/.5),n=Math.min(9,Math.floor(10*a))/9,l=Math.pow(n,.8),o=t[0]+(r[0]-t[0])*l,s=t[1]+(r[1]-t[1])*l,i=t[2]+(r[2]-t[2])*l;return`rgba(${Math.round(o)}, ${Math.round(s)}, ${Math.round(i)}, 1)`}const k=n(()=>[{key:"time",title:r("keigennRecord.time"),dataKey:"time",width:40,align:"center",class:"col-time",headerCellRenderer:()=>g("div",{class:"header-time"},r("keigennRecord.time"))},{key:"action",title:r("keigennRecord.action"),dataKey:a.actionKey,width:64,align:"center",class:"col-action",headerCellRenderer:()=>g("div",{class:"header-filter"},[g(Ke,{size:"small",modelValue:s.value,placeholder:r("keigennRecord.action"),clearable:!1,style:"width:4.5em",teleported:!1,onChange:e=>s.value=e===y?"":e},()=>w.value.map(e=>g(_e,{key:e.value,label:e.label,value:e.value})))]),cellRenderer:({rowData:e})=>g("span",e[a.actionKey]??"")},{key:"target",title:r("keigennRecord.target"),dataKey:"target",width:34,align:"center",class:"col-target",headerCellRenderer:()=>g("div",{class:"header-filter"},[g(Ke,{size:"small",modelValue:i.value,placeholder:r("keigennRecord.target"),clearable:!1,style:"width:4.7em;text-overflow:clip;white-space:nowrap",class:"col-target-select",teleported:!1,onChange:e=>{i.value=e===y?"":e}},()=>v.value.map(e=>g(_e,{key:e.value,label:e.label,value:e.value})))]),cellRenderer:({rowData:e})=>g(Fa,{row:e})},{key:"amount",title:r("keigennRecord.amount"),dataKey:"amount",width:52,align:"right",class:"col-amount",cellRenderer:({rowData:e})=>g(ma,{row:e})},{key:"reduction",title:r("keigennRecord.reduction"),dataKey:"reduction",width:35,align:"right",class:"col-reduction",headerCellRenderer:()=>g("div",{class:"header-reduction"},r("keigennRecord.reduction")),cellRenderer:({rowData:e})=>g("span",{class:"col-reduction-number",style:{color:S(e.reduction)}},`${(100*e.reduction).toFixed(0)}`)},{key:"keigenns",title:r("keigennRecord.keigenns"),dataKey:"keigenns",width:100,align:"left",flexGrow:1,class:"col-keigenns",cellRenderer:({rowData:e})=>g(Ca,{row:e})}]);let C=null;const T=n(()=>({onClick:({rowData:e})=>{const{actionCN:t,amount:a,job:n,keigenns:o,time:s,type:i,effect:c,currentHp:d,maxHp:u,shield:m,reduction:p}=e,h="damage done"===c?"":`,${r(`keigennRecord.${c}`)}`,f=`${s} ${n} ${t} ${a.toLocaleString()}(${r(`keigennRecord.${i}`)}) ${r("keigennRecord.reduction")}(${(100*p).toFixed(0)}%):${0===o.length&&""===h?r("keigennRecord.none"):o.map(e=>l.statusCN?e.name:e.effect).join(",")+h} ${r("keigennRecord.hp")}}:${d}(${Math.round(d/u*100)}%)+${r("keigennRecord.shield")}:${Math.round(u*+m/100)}(${m}%)`;He(f).then(()=>{C?.close(),C=me.success({message:r("keigennRecord.copySuccess"),duration:800})}).catch(()=>me.error(r("keigennRecord.copyFailed")))},onContextmenu:({rowData:e,event:t})=>{const r=t;p.value=e,d.value=r.clientX,u.value=r.clientY,c.value=!0}}));return(e,a)=>{const n=ea,l=ta;return J(),ae(l,{style:{height:"100%",width:"100%"}},{default:ne(({height:e,width:a})=>[F(n,{"header-class":"keigenn-table-header",class:"keigenn-table",columns:k.value,data:R.value,width:a,height:e,"row-height":28,"header-height":24,"row-key":"key","scrollbar-always-on":"","row-event-handlers":T.value},null,8,["columns","data","width","height","row-event-handlers"]),h(c)?(J(),X("div",{key:0,ref_key:"contextMenu",ref:o,class:"context-menu",style:ue({top:`${h(u)}px`,left:`${h(d)}px`})},[Q("ul",null,[Q("li",{onClick:b},ee(h(s)===(h(p)?.[t.actionKey]??"")?h(r)("keigennRecord.filter.action_cancel",{actionName:h(p)?.[t.actionKey]??h(r)("keigennRecord.this_skill")}):h(r)("keigennRecord.filter.action_only",{actionName:h(p)?.[t.actionKey]??h(r)("keigennRecord.this_skill")})),1),Q("li",{onClick:x},ee(h(i)===h(p)?.target?h(r)("keigennRecord.filter.target_cancel",{jobName:h(p)?.job??h(r)("keigennRecord.this_job")}):h(r)("keigennRecord.filter.target_only",{jobName:h(p)?.job??h(r)("keigennRecord.this_job")})),1)])],4)):le("",!0)]),_:1})}}}),[["__scopeId","data-v-214ee7f7"]]),Da="function"==typeof structuredClone?structuredClone:e=>{if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e.source,e.flags);if(Array.isArray(e))return e.map(e=>Da(e));if(Object.getPrototypeOf(e)===Object.prototype){const t={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Da(e[r]));return t}return e};function Ma(e){const t=function(e){switch(!0){case e.endsWith("33"):return"instant death";case/2\w{4}4$/.test(e):return"crit heal";case e.endsWith("1"):return"dodge";case e.endsWith("3"):return"damage done";case e.endsWith("4"):return"heal";case e.endsWith("5"):return"blocked damage";case e.endsWith("6"):return"parried damage";default:throw new Error(`Unknown effect flag ${e}`)}}(e),r=function(e){switch(!0){case/2\w{3}$/.test(e):return"crit damage";case/4\w{3}$/.test(e):return"direct hit damage";case/6\w{3}$/.test(e):return"crit direct hit damage";default:return"damage"}}(e),a=function(e){switch(!0){case/7?[1-4]\w{3}[35]$/.test(e):case/[16]$/.test(e):return"physics";case/^E$/.test(e):case/5\w{4}$/.test(e):return"magic";case/^(?:\d0)?3$/.test(e):case/6\w{4}$/.test(e):return"darkness";default:return"physics"}}(e);return{effect:t,properties:r,type:a}}const Na=["3E","113","213","313"],$a=["A10","E"],Aa=["04"],Oa=["01","03","05","06","36"];function La(e){let t=0,r=e[8]??"",a=e[9]??"";Na.includes(r)&&(t+=2,r=e[8+t]??r,a=e[8+t+1]??a),$a.includes(r)&&(t+=2,r=e[8+t]??r,a=e[8+t+1]??a);const n=function(e){if(void 0===e)return 0;const t=e.length;if(t<=4)return 0;let r=Number.parseInt(e.slice(0,t-4),16);if("4"===e[t-4]){const a=Number.parseInt(e.slice(t-2,t),16);r=r-a+(a<<16)}return r}(a),l=`00${r}`.slice(-2);return{amount:n,lowByte:l,flags:r,isHeal:Aa.includes(l),isAttack:Oa.includes(l)}}const za={class:"header-select"},Wa={style:{height:"100%"}},Ka={key:0,class:"testLog"},_a=ke(d({__name:"keigennRecord2",setup(e){const r=Pe(),a=oa(),l=a.userOptions;a.checkIsBrowser();const o=m(l.minimize),s=n(()=>l.actionCN?"actionCN":"action"),i=m(!1),c=pe("keigenn-record-2-pov-id",""),d=pe("keigenn-record-2-party-list",[]),u=pe("keigenn-record-2-job-map",{}),p=pe("keigenn-record-2-party-event-party",[]),f=m(0),y=m([{zoneName:"",duration:"00:00",table:he([]),key:"init",timestamp:-1}]),g={rsv:/^262\|(?<timestamp>[^|]*)\|[^|]*\|[^|]*\|_rsv_(?<id>\d+)_[^|]+\|(?<real>[^|]*)\|/i,ability:qe.ability(),statusEffectExplicit:qe.statusEffectExplicit(),gainsEffect:qe.gainsEffect(),losesEffect:qe.losesEffect(),inCombat:/^260\|(?<timestamp>[^|]*)\|(?<inACTCombat>[^|]*)\|(?<inGameCombat>[^|]*)\|/,changeZone:qe.changeZone(),partyList:/^11\|(?<timestamp>[^|]*)\|(?<partyCount>\d*)\|(?<list>(?:\w{8}\|)*)\w{16}/,primaryPlayer:/^02\|(?<timestamp>[^|]*)\|(?<id>[^|]*)\|(?<name>[^|]*)/,addCombatant:qe.addedCombatant(),removingCombatant:qe.removingCombatant(),networkDoT:qe.networkDoT()},v=m(0),b=pe("souma-keigenn-record-2-zone-name",""),x=pe("souma-keigenn-record-2-rsv-data",{}),R={},S={friendly:{},enemy:{}},k=Ge("keigenn-record-2");function C(){i.value=!0,v.value=0,f.value=0,y.value.length=0,y.value.push({zoneName:"",duration:"00:00",table:he([]),key:"init",timestamp:-1})}function T(){i.value=!1,M()}function I(e){for(const r in g){const a=g[r].exec(e);if(a){const n=e.split("|");switch(r){case"statusEffectExplicit":a.groups?.targetId.startsWith("1")&&(R[a.groups.targetId]=a.groups.currentShield);break;case"gainsEffect":{const e=n[Be.GainsEffect.fields.effectId],t=n[Be.GainsEffect.fields.effect],r=n[Be.GainsEffect.fields.target],a=n[Be.GainsEffect.fields.targetId],l=Number.parseInt(n[Be.GainsEffect.fields.count],16);let o=fa(e);if(!o){const t=a.startsWith("1")&&wa.get(Number.parseInt(e,16).toString())||a.startsWith("4")&&va.get(Number.parseInt(e,16).toString());if(!t)return;const r=Ne(t.icon),n=l>1?$e(r,l):r;o={type:"multiplier",performance:{physics:1,magic:1,darkness:1},id:Number.parseInt(e,16),fullIcon:n,name:t.name,isFriendly:t.isFriendly}}const s=n[Be.GainsEffect.fields.duration],i=n[Be.GainsEffect.fields.source],d=n[Be.GainsEffect.fields.sourceId],u=new Date(n[Be.GainsEffect.fields.timestamp]).getTime()+1e3*Number.parseFloat(s),m={name:o.name,type:o.type,count:l,effect:t,effectId:e,source:i,sourceId:d,target:r,targetId:a,expirationTimestamp:u,performance:o.performance,fullIcon:o.fullIcon,isPov:c.value===d};a.startsWith("1")&&o.isFriendly?(void 0===S.friendly[a]&&(S.friendly[a]={}),S.friendly[a][e]=m):a.startsWith("4")&&!o.isFriendly&&(void 0===S.enemy[r]&&(S.enemy[r]={}),S.enemy[r][e]=m)}break;case"losesEffect":{const e=n[Be.LosesEffect.fields.target],t=n[Be.LosesEffect.fields.targetId],r=n[Be.LosesEffect.fields.effectId];t.startsWith("1")?S.friendly[t]&&Reflect.deleteProperty(S.friendly[t],r):S.enemy[e]&&Reflect.deleteProperty(S.enemy[e],r)}break;case"addCombatant":if("00"!==n[Be.AddedCombatant.fields.job]){const e=n[Be.AddedCombatant.fields.job],t=new Date(n[Be.AddedCombatant.fields.timestamp]).getTime();u.value[n[Be.AddedCombatant.fields.id]]={job:Number.parseInt(e,16),timestamp:t}}break;case"removingCombatant":Reflect.deleteProperty(u.value,n[Be.RemovedCombatant.fields.id]);break;case"primaryPlayer":c.value=n[Be.ChangedPlayer.fields.id];break;case"partyList":d.value=(a.groups?.list?.split("|")??[]).filter(Boolean);break;case"changeZone":{const e=parseInt(n[Be.ChangeZone.fields.id],16);if(b.value=n[Be.ChangeZone.fields.name],Ze[e]?.name){const r=t(Ze[e]?.name);r&&"Unknown"!==r&&(b.value=r)}j(new Date(n[Be.ChangeZone.fields.timestamp]).getTime());break}case"inCombat":{const e="1"===n[Be.InCombat.fields.inACTCombat],t="1"===n[Be.InCombat.fields.inGameCombat],r=new Date(n[Be.InCombat.fields.timestamp]).getTime();if(e||t){const e=n[Be.InCombat.fields.timestamp];if(v.value>0)return;return 0!==y.value[0].table.length&&y.value.unshift({zoneName:"",duration:"00:00",table:he([]),key:e,timestamp:r}),v.value=r,y.value[0].zoneName=b.value,y.value[0].timestamp=r,y.value[0].key=e,void(f.value=0)}if(!e&&!t)return void j(r)}break;case"rsv":{const e=Number(a.groups?.id),t=n[Be.RSVData.fields.value];e&&t&&(x.value[Number(e)]=t)}break;case"networkDoT":if(!l.parseDoT)return;{const e=n[Be.NetworkDoT.fields.which],t=n[Be.NetworkDoT.fields.id];if("DoT"!==e||t.startsWith("4")||t!==c.value&&!d.value.includes(t)&&!p.value.find(e=>e.id===t))return;const r=n[Be.NetworkDoT.fields.name],a=n[Be.NetworkDoT.fields.damage],l=Number.parseInt(a,16),o=new Date(n[Be.Ability.fields.timestamp]??"???").getTime(),s=Number(n[Be.NetworkDoT.fields.currentHp]),i=Number(n[Be.NetworkDoT.fields.maxHp]),u=N(0===v.value?0:o-v.value),{job:m,hasDuplicate:h}=E(t),f=Fe.jobToFullName(Fe.jobEnumToJob(m)).simple2,g=m,w=Fe.jobEnumToIcon(g);H({key:y.value[0].table.length.toString(),time:u,id:void 0,action:e,actionCN:e,source:"",target:r,targetId:t,job:f,jobIcon:w,jobEnum:g,hasDuplicate:h,amount:l,keigenns:[],currentHp:s,maxHp:i,effect:"damage done",type:"dot",shield:R[t]??"0",povId:c.value,reduction:0})}break;case"ability":if(0===v.value)return;{const e=La(n);if(e.isAttack&&e.amount>=0){const t=n[Be.Ability.fields.sourceId]??"???",r=n[Be.Ability.fields.targetId]??"???";if(!t.startsWith("4")||!r.startsWith("1"))return;if(r!==c.value&&!d.value.includes(r)&&!p.value.find(e=>e.id===r))return;const o=new Date(n[Be.Ability.fields.timestamp]??"???").getTime(),s=n[Be.Ability.fields.ability],i=s.match(/^_rsv_(?<id>\d+)_/),u=n[Be.Ability.fields.id]??"???";let m=s;if(i){const e=Number(i.groups?.id);m=x.value[e]??s.match(/^_(?<id>rsv_\d+)_/)?.groups?.id}else if(m=m.replace(/unknown_.*/,"攻击"),!1===l.parseAA&&/^攻击|攻撃|[Aa]ttack$/.test(m))return;const h=Ve(Number.parseInt(u,16)),f=h&&""!==h?h:m,g=Number(n[Be.Ability.fields.targetCurrentHp]),w=Number(n[Be.Ability.fields.targetMaxHp]),b=n[Be.Ability.fields.source]??"???",k=n[Be.Ability.fields.target]??"???",{effect:C,type:T}=Ma(e.flags),I=N(0===v.value?0:o-v.value),{job:F,hasDuplicate:j}=E(r),D=Fe.jobToFullName(Fe.jobEnumToJob(F)).simple2,M=F,$=Fe.jobEnumToIcon(M),A=Da(Object.values(S.friendly[r]??[]).concat(Object.values(S.enemy[b]??[])).filter(e=>{const t=Math.max(0,(e.expirationTimestamp-o)/1e3);return e.remainingDuration=t>=999?"":t.toFixed(t>.05&&t<.95?1:0),Number(e.remainingDuration)>-3})),O=R[a.groups.targetId]??"0",L=e.amount;let z=0;if("instant death"!==C&&"dodge"!==C){let e=1;"blocked damage"===C?e=.8:"parried damage"===C&&(e=.85);let t=1;for(const r of A)"absorbed"!==r.type&&(t*=r.performance[T]??1);z=1-t*e}H({key:y.value[0].table.length.toString(),time:I,id:u,action:m,actionCN:f,source:b,target:k,targetId:r,job:D,jobIcon:$,jobEnum:M,hasDuplicate:j,amount:L,keigenns:A,currentHp:g,maxHp:w,effect:C,type:T,shield:O,povId:c.value,reduction:z}),y.value[0].duration=N(new Date(n[Be.Ability.fields.timestamp]).getTime()-v.value)}}}}}}function E(e){const t=u.value[e],r=p.value.find(t=>t.id===e)??{job:0,timestamp:0},a=(t?.timestamp??0)>r.timestamp?t:r,n=a===t?Object.entries(u.value).some(([t,r])=>t!==e&&r.job===a?.job&&d.value.includes(t)):p.value.some(t=>t.id!==e&&t.job===a?.job);return{job:a?.job??0,hasDuplicate:n}}function H(e){y.value[0].table.unshift(e)}function j(e){0!==v.value&&(y.value[0].duration=N(e-v.value),y.value[0]=Re(y.value[0]),v.value=0,S.friendly={},S.enemy={},M())}async function M(){if(i.value)return;const e=y.value.filter(e=>"init"!==e.key&&e.timestamp>0).map(e=>{const t=Array.isArray(e.table)?Se(e.table):[];return{...Se(e),table:t}});await k.replaceAll(e)}function N(e){const t=Math.max(Math.floor(e/6e4),0),r=Math.max(Math.floor((e-6e4*t)/1e3),0);return`${t<10?"0":""}${t}:${r<10?"0":""}${r}`}function $(){o.value=!o.value}function A(){y.value.unshift({zoneName:"",duration:"00:00",table:he([]),key:"test",timestamp:Date.now()}),f.value=0}function L(e){const t=new Date(e),r=t.getHours();return`${(r%12||12).toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}:${t.getSeconds().toString().padStart(2,"0")} ${r>=12?"PM":"AM"}`}return D(()=>{const e=fe({storageKey:"keigenn-record-2-theme"}),t=ye(e);!1===e.value&&t();for(const r in u.value){const e=u.value[r];Date.now()-e.timestamp>864e5&&Reflect.deleteProperty(u.value,r)}!async function(){f.value=0;try{const e=await k.getAll();e.length&&(y.value.length=0,y.value.push(...e.filter(e=>e.timestamp>Date.now()-2592e5).reverse()),0===y.value.length&&y.value.push({zoneName:"",duration:"00:00",table:he([]),key:"init",timestamp:-1}))}catch(e){throw y.value.length=0,e}}(),Ue("LogLine",e=>{I(e.rawLine)}),Ue("PartyChanged",e=>{p.value=e.party.map(e=>({...e,timestamp:Date.now()}))}),Ue("ChangePrimaryPlayer",e=>{c.value=Number(e.charID).toString(16).toUpperCase()})}),(e,t)=>{const n=_e,i=Ke,c=Ye,d=ja,u=na;return J(),X(O,null,[Q("div",{class:"wrapper",style:ue({"--scale":h(l).scale,"--opacity":h(l).opacity}),onContextmenu:t[1]||(t[1]=w(()=>{},["prevent"]))},[Q("header",null,[Q("div",za,[ge(F(i,{modelValue:h(f),"onUpdate:modelValue":t[0]||(t[0]=e=>ve(f)?f.value=e:null),size:"small",class:se(["combat-select",h(a).isBrowser?"browser":"act"]),"popup-class-name":"combat-select-popup",offset:0,"show-arrow":!1},{default:ne(()=>[(J(!0),X(O,null,ie(h(y).length,e=>(J(),ae(n,{key:`${h(y)[e-1].key}-${h(y)[e-1].duration}-${h(y)[e-1].zoneName}`,value:e-1,label:`${h(y)[e-1].zoneName}${""===h(y)[e-1].zoneName?"":` - [${h(y)[e-1].duration}] ${L(h(y)[e-1].timestamp)}`}`},null,8,["value","label"]))),128))]),_:1},8,["modelValue","class"]),[[we,!h(o)]])]),h(a).isBrowser?le("",!0):(J(),ae(c,{key:0,class:se(["minimize",h(o)?"in-minimize":"not-minimize"]),icon:h(o)?h(be):h(xe),circle:"",style:ue({opacity:h(o)?.5:1}),onClick:$},null,8,["class","icon","style"]))]),ge(Q("main",Wa,[F(d,{rows:h(y)[h(f)].table,"action-key":h(s)},null,8,["rows","action-key"])],512),[[we,!h(o)]])],36),h(a).isBrowser||h(r)?(J(),X("div",Ka,[h(r)?(J(),ae(c,{key:0,onClick:A},{default:ne(()=>[...t[2]||(t[2]=[oe(" 测试 ",-1)])]),_:1})):le("",!0),F(u,{"m-1":"",onBeforeHandle:C,onAfterHandle:T,onHandleLine:I})])):le("",!0)],64)}}}),[["__scopeId","data-v-9a8d00bb"]]);export{_a as default};
