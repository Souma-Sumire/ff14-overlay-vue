import{c as e,_ as l}from"./shared-common-D_wk7g3H.js";import{ab as s,F as i,b as a,q as t,h as n,ae as r}from"./shared-core-DjphjpVF.js";import{a as o,r as c}from"./cactbot-DRs0Yy4Y.js";import{n as k}from"./vendor-element-plus-DviEGymo.js";import{o as d,B as u,a5 as m,v as y,J as f,t as p,u as S,H as g,K as v,R as w,am as h,L as b,M as j,Z as C,X as T,I as $,Y as _,c as x}from"./vendor-vue-iK2zA9mI.js";const I={class:"demo-text"},K={key:0,class:"key-skills-timer-container"},P={class:"skills-grid"},L=["onClick"],D={class:"buff-filter"},F=["src"],z={key:1,class:"test"},E=l(d({__name:"keySkillTimer",setup(l){const d=s(),{zoneType:E}=i(),N=x(()=>"Pvp"===E.value),R=n(),q=a(),A=e=>{d.party=e.party.filter(e=>e.inParty)},B=e=>{if(!N.value)if("21"===e.line[0]||"22"===e.line[0]&&"0"===e.line[45]){const l=Number.parseInt(e.line[4],16),s=r(l),i=e.line[2];d.triggerSkill([l,s],i,!0)}else"33"===e.line[0]&&["40000010","4000000F"].includes(e.line[3])&&d.wipe()};function H(e){d.speed=e,d.usedSkills.forEach(e=>{d.triggerSkill([e.id],e.owner.id,!1)})}function J(){window.open("/ff14-overlay-vue/#/keySkillTimerSettings","keySkillTimerSettings","width=1280,height=768")}return u(()=>{t(),o("PartyChanged",A),o("LogLine",B)}),m(()=>{c("PartyChanged",A),c("LogLine",B),Object.values(d.skillStates).forEach(e=>{e.rafId&&cancelAnimationFrame(e.rafId)})}),(l,s)=>{const i=k,a=e;return p(),y(a,null,{readme:f(()=>[v("span",I,[_(C(l.$t("keySkillTimer.demo-text1")),1),s[3]||(s[3]=v("br",null,null,-1)),_(" "+C(l.$t("keySkillTimer.demo-text2")),1)])]),default:f(()=>[S(N)?T("",!0):(p(),g("div",K,[v("div",P,[(p(!0),g(w,null,h(S(d).usedSkills,e=>(p(),g("div",{key:e.instanceKey,class:j(["buff-container",`line${e.line}`]),style:b({zIndex:S(q)||S(R)?99:void 0}),onClick:()=>S(q)||S(R)?function(e,l){(R||q)&&d.triggerSkill([e.id],e.owner.id,l)}(e,!0):null},[v("div",D,[v("span",{class:j(["duration",[S(d).skillStates[e.instanceKey]?.isRecast?"cooldown":"active"]])},C(S(d).skillStates[e.instanceKey]?.text||""),3),v("img",{src:e.src},null,8,F),S(d).skillStates[e.instanceKey]?.active?(p(),g("div",{key:S(d).skillStates[e.instanceKey]?.startTime||0,class:"cooldown-layer",style:b({clipPath:`inset(${S(d).skillStates[e.instanceKey]?.clipPercent??0}% 0 0 0)`})},null,4)):T("",!0)]),e.owner.hasDuplicate.skill||e.owner.hasDuplicate.job?(p(),g("span",{key:0,class:j(`job has-duplicate ${e.owner.hasDuplicate.job?"duplicate-show-name":"duplicate-show-job-name"} ${e.owner.jobIcon.toLowerCase()}`)},C(e.owner.hasDuplicate.job?e.owner.name:e.owner.jobName),3)):T("",!0)],14,L))),128))])])),S(R)||S(q)?(p(),g("div",z,[$(i,{onClick:S(d).demoFullParty},{default:f(()=>[_(C(l.$t("keySkillTimer.test-all-jobs")),1)]),_:1},8,["onClick"]),$(i,{onClick:s[0]||(s[0]=()=>S(d).shuffle())},{default:f(()=>[_(C(l.$t("keySkillTimer.test-8-party")),1)]),_:1}),S(R)?(p(),y(i,{key:0,onClick:s[1]||(s[1]=()=>H(1))},{default:f(()=>[_(C(l.$t("keySkillTimer.test-trigger-1x")),1)]),_:1})):T("",!0),S(R)?(p(),y(i,{key:1,onClick:s[2]||(s[2]=()=>H(5))},{default:f(()=>[_(C(l.$t("keySkillTimer.test-trigger-5x")),1)]),_:1})):T("",!0),$(i,{onClick:S(d).wipe},{default:f(()=>[_(C(l.$t("keySkillTimer.test-wipe")),1)]),_:1},8,["onClick"]),$(i,{type:"primary",onClick:J},{default:f(()=>[_(C(l.$t("keySkillTimer.settings")),1)]),_:1})])):T("",!0)]),_:1})}}}),[["__scopeId","data-v-ff6a5e1b"]]);export{E as default};
