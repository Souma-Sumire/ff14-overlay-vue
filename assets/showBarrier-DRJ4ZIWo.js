import{c as e,d as a,_ as r}from"./shared-common-oDeuwpoM.js";import{h as t,x as s,G as n,o as i,w as o,g as l,e as u,dr as c,f as d,a as p,b as m,p as v,c as b,F as f,r as g,t as h,v as w,s as y,d as x}from"./vendor-vue-i6lpFrx4.js";import{c as P}from"./shared-core-CDdSgUpa.js";import{N as j,a as E}from"./cactbot-C9BOJncy.js";import"./vendor-element-plus-lMYbWyTR.js";const I=r(t({__name:"showBarrier",setup(r){c(e=>({v38cc43cb:d(C),eae0bb00:d(U)}));const t=P(),I={statusEffectExplicit:j.statusEffectExplicit()};let L=0;const N=s([]),_=s(""),S=s(window.location.href),$=n(()=>new URLSearchParams(S.value.split("?")[1])),A=n(()=>"1"===$.value.get("showSettings")),C=n(()=>40*Number($.value.get("lineHeight")||1)+"px"),U=n(()=>`${Number($.value.get("fontSize")||26)}px`),z=n(()=>$.value.get("type")||"1");function H(){N.value.sort((e,a)=>e.id===_.value?-1:a.id===_.value?1:e.job===a.job?a.id.localeCompare(e.id):t.arr.indexOf(e.job)-t.arr.indexOf(a.job))}function O(e){return"1"===z.value?`${e.barrierPercent}`:"2"===z.value?`${e.barrierAmount}`:`${e.barrierPercent}%(${e.barrierAmount})`}return i(()=>{E("LogLine",e=>{!function(e){const a=I.statusEffectExplicit.exec(e);if(a?.groups?.targetId.startsWith("1")){const e=N.value.find(e=>e.id===a.groups?.targetId);e&&(e.barrierPercent=Number(a.groups?.currentShield),e.barrierAmount=Math.round(Number(a.groups?.maxHp)*e.barrierPercent/100))}}(e.rawLine)}),E("PartyChanged",e=>{N.value=e.party.filter(e=>e.inParty).map(e=>({...e,barrierPercent:0,barrierAmount:0}))}),E("ChangePrimaryPlayer",e=>{_.value=Number(e.charID).toString(16).toUpperCase()}),o([N,_,t.arr],()=>{clearInterval(L),_.value?H():L=window.setInterval(()=>{_.value&&(H(),clearInterval(L))},100)},{immediate:!0}),window.addEventListener("hashchange",e=>S.value=e.newURL)}),(r,t)=>{const s=a,n=e;return p(),l(n,null,{default:u(()=>[m("div",null,[m("ul",null,[(p(!0),b(f,null,g(d(N),e=>(p(),b("li",{key:e.id},[v(m("span",{"m-r-2":""},h(e.name),513),[[w,d(A)]]),m("span",{style:y(0===e.barrierPercent?{opacity:.25,color:"white"}:{opacity:1,color:"#f5da3c"})},h(O(e)),5)]))),128))]),v(x(s,{style:{"z-index":"10000"},party:d(N),"m-b-1":"","p-1":""},null,8,["party"]),[[w,d(A)]])])]),_:1})}}}),[["__scopeId","data-v-d26e0ae1"]]);export{I as default};
