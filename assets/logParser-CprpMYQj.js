!function(){"use strict";const e=Object.values({1040:"地平关",1041:"迷雾湿地",1042:"拉诺西亚",1043:"紫水栈桥",1044:"幻影群岛",1045:"摩杜纳",1046:"魔兽领域",1047:"封魔洞",1048:"太阳海岸",1049:"小麦酒港",1050:"银泪湖",1051:"盛夏滩",1052:"葡萄酒港",1053:"黑衣森林",1054:"青磷泉",1055:"金锤台地",1056:"红茶川",1057:"伊修加德",1058:"雪松原",1059:"妖精领",1060:"萌芽池",1061:"执掌峡谷",1062:"密约之塔",1063:"莫拉比湾",1064:"月牙湾",1065:"摇篮树",1066:"樵鸣洞",1067:"尼姆河",1068:"黄金谷",1069:"百灵啼",1070:"天狼星灯塔",1071:"灼热走廊",1072:"私语巨木",1073:"月影岛",1074:"水晶塔",1075:"梦想宫",1076:"白金幻象",1077:"黑金湖",1078:"龙息瀑布",1079:"石卫塔",1080:"铜铃铜山",1081:"神意之地",1082:"狮鹫大桥",1083:"永恒川",1084:"海雾沙滩",1085:"和风流地",1086:"泽梅尔要塞",1087:"巨石丘",1088:"剑斗领域",1089:"黑尘驿站",1090:"睡莲岩",1091:"领航明灯",1092:"海词石窟",1093:"翡翠湖",1094:"雄心广场",1095:"库尔札斯",1096:"流沙迷宫",1097:"芳香堂",1098:"花蜜栈桥",1099:"蓝雾涌泉",1100:"神灵圣域",1101:"白云崖",1102:"海将水渠",1103:"元灵幼树",1104:"沙钟旅亭",1105:"姐妹丘",1106:"静语庄园",1107:"足迹谷",1108:"珊瑚塔",1109:"横断崖",1110:"水上庭院",1111:"无限回廊",1112:"金锭池",1113:"旅人栈桥",1114:"龙纹岩",1115:"海鳗桥廊",1116:"源泉之梯",1117:"秘石塔",1118:"日升门",1119:"西风岬",1120:"审理之门",1121:"拂晓之间",1122:"海狼洞",1123:"橡树原",1124:"魔女咖啡馆",1125:"巨龙首营地",1126:"低语河谷",1127:"芙蓉圆桌",1128:"神握角",1129:"黄金广场",1130:"弯枝牧场",1131:"桤木泉",1132:"镜池栈桥",1133:"白鸥塔",1134:"消逝王都",1135:"跨天桥",1136:"圣人泪",1137:"剑峰",1138:"后桅塔",1139:"白银集市",1140:"来生回廊",1141:"暴风陆门",1142:"幽灵湖",1143:"石绿湖",1144:"黄昏湾",1145:"小阿拉米格",1146:"放浪神礼堂",1147:"荆棘森",1148:"狼烟丘",1149:"圣人旅道",1150:"不悔战泉",1151:"九藤",1152:"荣耀溪",1153:"境树",1154:"狱门蚁穴",1155:"遗忘绿洲",1156:"炎帝陵",1157:"歌咏裂谷",1158:"流沙屋",1159:"八剑士前庭",1160:"巴哈姆特",1161:"诸神黄昏",1162:"王者之剑",1163:"陆行鸟",1164:"神圣裁判所",1165:"冰天宫",1166:"龙巢神殿",1167:"红玉海",1168:"クガネ",1169:"延夏",1170:"潮风亭",1171:"神拳痕",1172:"白银乡",1173:"宇宙和音",1174:"沃仙曦染",1175:"晨曦王座",1176:"梦羽宝境",1177:"海猫茶屋",1178:"柔风海湾",1179:"琥珀原",1180:"太阳海岸",1181:"永恒川",1182:"魔兽领域",1183:"银泪湖",1184:"和风流地",1185:"妖精领",1186:"伊修加德",1188:"小麦酒港",1189:"月影岛",1190:"葡萄酒港",1191:"神灵圣域",1192:"水晶塔",1194:"翡翠湖",1195:"地平关",1196:"迷雾湿地",1197:"库尔札斯",1198:"执掌峡谷",1199:"珊瑚塔",1200:"亚马乌罗提",1201:"红茶川",1202:"萨雷安",1203:"加雷马"}).sort((e,t)=>t.length-e.length),t=new Map;function n(e){if(t.has(e))return t.get(e);let n=e.replace(/[\ue000-\uf8ff]/g,"");for(;/^[""「『]|[""」』]$/.test(n);)n=n.replace(/^[""「『]|[""」』]$/g,"").trim();const s=n.trim();return t.set(e,s),s}const s=new Map;function o(t){if(s.has(t))return s.get(t);let n=t.replace(/[\ue000-\uf8ff]/g,"");for(const s of e)if(n.length>s.length&&n.endsWith(s)){n=n.slice(0,-s.length);break}const o=n.trim();return s.set(t,o),o}var r=(e=>(e.WeaponBox="武器箱",e.HeadBox="头部装备箱",e.BodyBox="身体装备箱",e.HandsBox="手臂装备箱",e.LegsBox="腿部装备箱",e.FeetBox="脚部装备箱",e.EarringBox="耳部装备箱",e.NecklaceBox="颈部装备箱",e.BraceletBox="腕部装备箱",e.RingBox="指环装备箱",e.Twine="硬化药",e.Coating="强化纤维",e.Tome="神典石",e.Solvent="强化药",e))(r||{});Object.values(r);var a=(e=>(e.EarringBox="耳部装备箱",e.NecklaceBox="颈部装备箱",e.BraceletBox="腕部装备箱",e.RingBox="指环装备箱",e.HeadBox="头部装备箱",e.HandsBox="手臂装备箱",e.FeetBox="脚部装备箱",e.Tome="神典石",e.Twine="硬化药",e.BodyBox="身体装备箱",e.LegsBox="腿部装备箱",e.Solvent="强化药",e.Coating="强化纤维",e.WeaponBox="武器箱",e))(a||{});Object.values(a);const l=/^([^|，。]+?)获得了“(.*?)[”](?:[×x*](\d+))?/,i=/^(.+?)分配给了(.+?)[。.]?$/,c=/^([^|，。]+?)在(需求|贪婪)条件下对“?(.*?)[”]掷出了(\d+)点/,u=new Set(["083E","103E","203E","0A3E"]),f=new Set(["1041","2041","0841","0041","0840","0044"]);function g(e,t,s,r){const a=e.split("|");if(a.length<5)return null;const g=a[2],p=a[1],B=a[4];if(!g||!p||!B)return null;if(u.has(g)){let e="",a="",c=1,u=!1;const f=B.match(l),g=B.match(i);if(f)e=o(f[1]),a=n(f[2]),c=f[3]?parseInt(f[3],10):1;else{if(!g)return null;a=n(g[1]),e=o(g[2]),u=!0}s.add(a),r.add(e);const x=t.get(a)||[];if(t.delete(a),c>1){const t=[];for(let n=0;n<c;n++)t.push({key:`${p}-${e}-${a}-${n}`,timestamp:new Date(p),player:e,item:a,rolls:0===n?[...x]:[],isAssign:u});return t}return{key:`${p}-${e}-${a}`,timestamp:new Date(p),player:e,item:a,rolls:[...x],isAssign:u}}if(f.has(g)){const e=B.match(c);if(e){const s=o(e[1]),a=n(e[3]),l=parseInt(e[4],10),i="需求"===e[2]?"need":"greed";t.has(a)||t.set(a,[]);const c=t.get(a);return c.some(e=>e.player===s)||(r.add(s),c.push({player:s,type:i,value:l})),null}}return null}self.onmessage=e=>{const t=e.data.split("\n"),n=new Map,s=[],o=new Set,r=new Set;for(let a=0;a<t.length;a++){const e=t[a];if(!e)continue;const l=g(e,n,r,o);l&&(Array.isArray(l)?s.push(...l):s.push(l))}self.postMessage({records:s,players:Array.from(o),items:Array.from(r)})}}();
