import{d as L,p as h,q as N,s as D,o as F,e as k,t as I,v as V,u as l,a as _,w as B,x as u,y as v,A as U,F as z,B as A,C,D as M,G as H,H as O,I as q}from"./vendor-8aa0aaaa.js";import{a as $,c as G}from"./overlay_plugin_api-409cb9ea.js";import{N as R}from"./netregexes-3f94ba22.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";const j=i=>(O("data-v-ee6edad2"),i=i(),q(),i),J={"w-30":""},K=j(()=>u("span",null," 若无法输入，先切换到ACT，再点击此悬浮窗 ",-1)),P=L({__name:"r4s",setup(i){var T,y;const x={gainsEffects:R.gainsEffect({effectId:["F9F","343"],targetId:"1[a-zA-Z0-9]{7}"})},r=h(Date.now()),t=h([]),c=N(()=>{if(t.value.length===0||t.value[0].end===0)return"0";const e=Math.abs(r.value-t.value[0].end).toString().padStart(5,"0"),o=e.slice(0,2),m=e.slice(2,4);return`${o}.${m}`}),w=h(((y=(T=document.getElementById("unlocked"))==null?void 0:T.style)==null?void 0:y.display)==="flex");document.addEventListener("onOverlayStateUpdate",a=>{var e;w.value=((e=a==null?void 0:a.detail)==null?void 0:e.isLocked)===!1});const s=D("special-r4s-settings",{ms:.65,text:"穿",test:!1});$("LogLine",a=>{var e;for(const o in x){const d=x[o].exec(a.rawLine);if(d)switch(o){case"gainsEffects":{if(((e=d.groups)==null?void 0:e.effectId)==="343"&&s.value.test===!1)return;const f=+d.groups.duration,n=Date.now(),E=n+ +f*1e3;if(t.value.find(p=>Math.abs(p.start-n)<=1e3&&Math.abs(p.end-E)<=1e3))return;t.value.push({start:n,end:E,duration:f,alreadyTTS:!1}),t.value.sort((p,b)=>p.end-b.end);break}}}});let g=0;function S(){r.value=Date.now();const a=r.value-g;a>100&&g!==0&&console.warn(a),g=r.value,t.value=t.value.filter(e=>e.end>0&&!(e.end<r.value&&e.alreadyTTS===!0)),t.value.length>0&&c.value!=="0"&&Math.abs(Number.parseFloat(c.value))<=s.value.ms&&t.value[0].alreadyTTS===!1&&(t.value[0].alreadyTTS=!0,G({call:"cactbotSay",text:s.value.text})),requestAnimationFrame(()=>{S()})}return setInterval(()=>{S()},4.175),(a,e)=>{const o=A,m=C,d=M,f=H;return F(),k(z,null,[I(_(f,{class:"settings"},{default:B(()=>[u("form",null,[v(" 剩余秒 "),_(o,{modelValue:l(s).ms,"onUpdate:modelValue":e[0]||(e[0]=n=>l(s).ms=n),min:0,max:1e4,size:"small",step:.001},null,8,["modelValue"])]),u("form",J,[v(" TTS文本 "),_(m,{modelValue:l(s).text,"onUpdate:modelValue":e[1]||(e[1]=n=>l(s).text=n),size:"small"},null,8,["modelValue"])]),v(),K,u("form",null,[_(d,{modelValue:l(s).test,"onUpdate:modelValue":e[2]||(e[2]=n=>l(s).test=n),size:"small"},null,8,["modelValue"]),v(" 使用吉星相位测试 ")])]),_:1},512),[[V,l(w)]]),I(u("h1",{"w-50":"","text-right":"","color-white":""},U(l(c)),513),[[V,l(c)!=="0"]])],64)}}});const te=Z(P,[["__scopeId","data-v-ee6edad2"]]);export{te as default};
