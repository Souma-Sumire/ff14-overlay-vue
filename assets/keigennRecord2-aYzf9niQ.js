import{E as e}from"./index-BHZPengA.js";import{O as t,g as r,bv as a,K as n,bw as o,a8 as l,ac as s,d as i,M as c,r as d,f as u,u as m,y as p,i as h,x as f,am as y,aT as g,aj as w,L as v,av as b,a4 as x,aS as S,a5 as R,aM as k,z as C,S as I,Z as T,b as E,ak as H,h as F,ab as j,m as D,a7 as M,F as L,bi as A,Y as N,bx as O,P as W,ax as $,N as z,ao as K,T as B,bl as P,by as G,bz as _,b4 as V,W as q,aX as U,c as Y,o as Z,a as X,s as J,j as Q,w as ee,B as te,t as re,e as ae,q as ne,l as oe,aW as le,p as se,E as ie,bA as ce,k as de,v as ue,a0 as me,aq as pe,ap as he,ad as fe,bB as ye}from"./index-Cah_h10a.js";import{_ as ge}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{E as we}from"./el-empty-CAtXSVTC.js";import{B as ve,c as be}from"./el-scrollbar-B7IiUqWq.js";import{d as xe,o as Se,u as Re,e as ke,a as Ce}from"./index-Ch9QvK_g.js";import{s as Ie,c as Te,a as Ee}from"./status-BoSfddpn.js";import{c as He}from"./clipboard-BKuKuDeo.js";import{U as Fe}from"./util-BOtaAWHW.js";import"./el-popper-27jhkWpF.js";/* empty css                   */import{E as je}from"./el-divider-CwG5nGnL.js";import{E as De}from"./index-D-WwX92R.js";import{h as Me,g as Le}from"./xivapi-CVfNURcy.js";import{d as Ae}from"./debounce-CS1UMlqL.js";import{c as Ne,r as Oe}from"./raf-BKB-dh6x.js";import{a as We}from"./scroll-CqjjIQGU.js";import{E as $e,b as ze}from"./el-select-D3-ulTCP.js";/* empty css                  *//* empty css               */import{u as Ke}from"./useDev-DIrRmHOg.js";import{g as Be}from"./actionChinese-CjZRUybd.js";import{l as Pe}from"./regexes-BKeG-dSP.js";import{N as Ge}from"./netregexes-RPvCCaeG.js";import{a as _e}from"./overlay_plugin_api-DHbPkDtN.js";import{E as Ve}from"./index-C4t_yDrw.js";import"./use-form-common-props-Cwd-E4t6.js";import"./isEqual-D1hctxZJ.js";import"./index-FkK1FLLf.js";import"./index-Ey_JH29X.js";import"./index-Dilsm_qT.js";import"./focus-trap-Cu8iyBv3.js";import"./index-DG81CmMj.js";import"./index-Y07AYO7D.js";import"./vnode-C3ohSnjo.js";import"./lz-string-Bhlr6y1U.js";import"./_commonjsHelpers-CLPN-Npl.js";import"./index-BjaDYOwK.js";var qe=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function Ue(e,t){return e===t||!(!qe(e)||!qe(t))}function Ye(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!Ue(e[r],t[r]))return!1;return!0}const Ze=()=>{const e=t().proxy.$props;return r(()=>{const t=(e,t,r)=>({});return e.perfMode?a(t):function(e,t){void 0===t&&(t=Ye);var r=null;function a(){for(var a=[],n=0;n<arguments.length;n++)a[n]=arguments[n];if(r&&r.lastThis===this&&t(a,r.lastArgs))return r.lastResult;var o=e.apply(this,a);return r={lastResult:o,lastArgs:a,lastThis:this},o}return a.clear=function(){r=null},a}(t)})},Xe="itemRendered",Je="scroll",Qe="forward",et="backward",tt="auto",rt="smart",at="start",nt="center",ot="end",lt="horizontal",st="vertical",it="negative",ct="positive-ascending",dt="positive-descending",ut={[lt]:"left",[st]:"top"},mt=o({type:l([Number,Function]),required:!0}),pt=o({type:Number}),ht=o({type:Number,default:2}),ft=o({type:String,values:["ltr","rtl"],default:"ltr"}),yt=o({type:Number,default:0}),gt=o({type:Number,required:!0}),wt=o({type:String,values:["horizontal","vertical"],default:st}),vt=n({className:{type:String,default:""},containerElement:{type:l([String,Object]),default:"div"},data:{type:l(Array),default:()=>s([])},direction:ft,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},style:{type:l([Object,String,Array])},useIsScrolling:Boolean,width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:Boolean}),bt=n({cache:ht,estimatedItemSize:pt,layout:wt,initScrollOffset:yt,total:gt,itemSize:mt,...vt}),xt={type:Number,default:6},St={type:Number,default:0},Rt={type:Number,default:2},kt=n({columnCache:ht,columnWidth:mt,estimatedColumnWidth:pt,estimatedRowHeight:pt,initScrollLeft:yt,initScrollTop:yt,itemKey:{type:l(Function),default:({columnIndex:e,rowIndex:t})=>`${t}:${e}`},rowCache:ht,rowHeight:mt,totalColumn:gt,totalRow:gt,hScrollbarSize:xt,vScrollbarSize:xt,scrollbarStartGap:St,scrollbarEndGap:Rt,role:String,...vt}),Ct=n({alwaysOn:Boolean,class:String,layout:wt,total:gt,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:xt,startGap:St,endGap:Rt,visible:Boolean}),It=(e,t)=>e<t?Qe:et,Tt=e=>"rtl"===e;let Et=null;function Ht(e=!1){if(null===Et||e){const e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",t.direction="rtl";const r=document.createElement("div"),a=r.style;return a.width="100px",a.height="100px",e.appendChild(r),document.body.appendChild(e),e.scrollLeft>0?Et=dt:(e.scrollLeft=1,Et=0===e.scrollLeft?it:ct),document.body.removeChild(e),Et}return Et}const Ft=i({name:"ElVirtualScrollBar",props:Ct,emits:["scroll","start-move","stop-move"],setup(e,{emit:t}){const a=r(()=>e.startGap+e.endGap),n=c("virtual-scrollbar"),o=c("scrollbar"),l=d(),s=d();let i=null,g=null;const w=u({isDragging:!1,traveled:0}),v=r(()=>ve[e.layout]),b=r(()=>e.clientSize-m(a)),x=r(()=>({position:"absolute",width:`${lt===e.layout?b.value:e.scrollbarSize}px`,height:`${lt===e.layout?e.scrollbarSize:b.value}px`,[ut[e.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"})),S=r(()=>{const t=e.ratio;if(t>=100)return Number.POSITIVE_INFINITY;if(t>=50)return t*b.value/100;const r=b.value/3;return Math.floor(Math.min(Math.max(t*b.value,20),r))}),R=r(()=>{if(!Number.isFinite(S.value))return{display:"none"};const t=`${S.value}px`,r=function({move:e,size:t,bar:r},a){const n={},o=`translate${r.axis}(${e}px)`;return n[r.size]=t,n.transform=o,"horizontal"===a?n.height="100%":n.width="100%",n}({bar:v.value,size:t,move:w.traveled},e.layout);return r}),k=r(()=>Math.ceil(e.clientSize-S.value-m(a))),C=()=>{window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",T),document.onselectstart=g,g=null;const e=m(s);e&&(e.removeEventListener("touchmove",E),e.removeEventListener("touchend",T))},I=e=>{e.stopImmediatePropagation(),e.ctrlKey||[1,2].includes(e.button)||(w.isDragging=!0,w[v.value.axis]=e.currentTarget[v.value.offset]-(e[v.value.client]-e.currentTarget.getBoundingClientRect()[v.value.direction]),t("start-move"),(()=>{window.addEventListener("mousemove",E),window.addEventListener("mouseup",T);const e=m(s);e&&(g=document.onselectstart,document.onselectstart=()=>!1,e.addEventListener("touchmove",E,{passive:!0}),e.addEventListener("touchend",T))})())},T=()=>{w.isDragging=!1,w[v.value.axis]=0,t("stop-move"),C()},E=e=>{const{isDragging:r}=w;if(!r)return;if(!s.value||!l.value)return;const a=w[v.value.axis];if(!a)return;Ne(i);const n=-1*(l.value.getBoundingClientRect()[v.value.direction]-e[v.value.client])-(s.value[v.value.offset]-a);i=Oe(()=>{w.traveled=Math.max(0,Math.min(n,k.value)),t("scroll",n,k.value)})},H=e=>{const r=Math.abs(e.target.getBoundingClientRect()[v.value.direction]-e[v.value.client])-s.value[v.value.offset]/2;w.traveled=Math.max(0,Math.min(r,k.value)),t("scroll",r,k.value)};return p(()=>e.scrollFrom,e=>{w.isDragging||(w.traveled=Math.ceil(e*k.value))}),h(()=>{C()}),()=>f("div",{role:"presentation",ref:l,class:[n.b(),e.class,(e.alwaysOn||w.isDragging)&&"always-on"],style:x.value,onMousedown:y(H,["stop","prevent"]),onTouchstartPrevent:I},f("div",{ref:s,class:o.e("thumb"),style:R.value,onMousedown:I},[]))}});var jt=(e=>(e.ASC="asc",e.DESC="desc",e))(jt||{}),Dt=(e=>(e.CENTER="center",e.RIGHT="right",e))(Dt||{}),Mt=(e=>(e.LEFT="left",e.RIGHT="right",e))(Mt||{});const Lt={asc:"desc",desc:"asc"},At=Symbol("placeholder");const Nt=(e,{mainTableRef:a,leftTableRef:n,rightTableRef:o,tableInstance:l,ns:s,isScrolling:i})=>{const c=t(),{emit:u}=c,p=w(!1),h=d(e.defaultExpandedRowKeys||[]),f=d(-1),y=w(null),g=d({}),x=d({}),S=w({}),R=w({}),k=w({}),C=r(()=>v(e.estimatedRowHeight));function I({hovered:e,rowKey:t}){if(i.value)return;l.vnode.el.querySelectorAll(`[rowkey="${String(t)}"]`).forEach(t=>{e?t.classList.add(s.is("hovered")):t.classList.remove(s.is("hovered"))})}const T=Ae(()=>{var e,t,r,l;p.value=!0,g.value={...m(g),...m(x)},E(m(y),!1),x.value={},y.value=null,null==(e=a.value)||e.forceUpdate(),null==(t=n.value)||t.forceUpdate(),null==(r=o.value)||r.forceUpdate(),null==(l=c.proxy)||l.$forceUpdate(),p.value=!1},0);function E(e,t=!1){m(C)&&[a,n,o].forEach(r=>{const a=m(r);a&&a.resetAfterRowIndex(e,t)})}return{expandedRowKeys:h,lastRenderedRowIndex:f,isDynamic:C,isResetting:p,rowHeights:g,resetAfterIndex:E,onRowExpanded:function({expanded:t,rowData:r,rowIndex:a,rowKey:n}){var o,i;const c=[...m(h)],d=c.indexOf(n);t?-1===d&&c.push(n):d>-1&&c.splice(d,1),h.value=c,u("update:expandedRowKeys",c),null==(o=e.onRowExpand)||o.call(e,{expanded:t,rowData:r,rowIndex:a,rowKey:n}),null==(i=e.onExpandedRowsChange)||i.call(e,c),l.vnode.el.querySelector(`.${s.is("hovered")}[rowkey="${String(n)}"]`)&&b(()=>I({hovered:!0,rowKey:n}))},onRowHovered:I,onRowsRendered:function(t){var r;null==(r=e.onRowsRendered)||r.call(e,t),t.rowCacheEnd>m(f)&&(f.value=t.rowCacheEnd)},onRowHeightChange:function({rowKey:e,height:t,rowIndex:r},a){a?a===Mt.RIGHT?k.value[e]=t:S.value[e]=t:R.value[e]=t;const n=Math.max(...[S,k,R].map(t=>t.value[e]||0));m(g)[e]!==n&&(!function(e,t,r){const a=m(y);(null===a||a>r)&&(y.value=r),x.value[e]=t}(e,n,r),T())}}},Ot=(e,t)=>e+t,Wt=e=>x(e)?e.reduce(Ot,0):e,$t=(e,t,r={})=>k(e)?e(t):null!=e?e:r,zt=e=>(["width","maxWidth","minWidth","height"].forEach(t=>{e[t]=S(e[t])}),e),Kt=e=>R(e)?t=>f(e,t):e;function Bt(e){const a=d(),n=d(),o=d(),{columns:l,columnsStyles:s,columnsTotalWidth:i,fixedColumnsOnLeft:u,fixedColumnsOnRight:h,hasFixedColumns:f,mainColumns:y,onColumnSorted:b}=function(e,t,a){const n=r(()=>m(t).map((e,t)=>{var r,a;return{...e,key:null!=(a=null!=(r=e.key)?r:e.dataKey)?a:t}})),o=r(()=>m(n).filter(e=>!e.hidden)),l=r(()=>m(o).filter(e=>"left"===e.fixed||!0===e.fixed)),s=r(()=>m(o).filter(e=>"right"===e.fixed)),i=r(()=>m(o).filter(e=>!e.fixed)),c=r(()=>{const e=[];return m(l).forEach(t=>{e.push({...t,placeholderSign:At})}),m(i).forEach(t=>{e.push(t)}),m(s).forEach(t=>{e.push({...t,placeholderSign:At})}),e}),d=r(()=>m(l).length||m(s).length),u=r(()=>m(n).reduce((t,r)=>(t[r.key]=((e,t,r)=>{var a;const n={flexGrow:0,flexShrink:0,...r?{}:{flexGrow:e.flexGrow||0,flexShrink:e.flexShrink||1}};r||(n.flexShrink=1);const o={...null!=(a=e.style)?a:{},...n,flexBasis:"auto",width:e.width};return t||(e.maxWidth&&(o.maxWidth=e.maxWidth),e.minWidth&&(o.minWidth=e.minWidth)),o})(r,m(a),e.fixed),t),{})),p=r(()=>m(o).reduce((e,t)=>e+t.width,0)),h=e=>m(n).find(t=>t.key===e);return{columns:n,columnsStyles:u,columnsTotalWidth:p,fixedColumnsOnLeft:l,fixedColumnsOnRight:s,hasFixedColumns:d,mainColumns:c,normalColumns:i,visibleColumns:o,getColumn:h,getColumnStyle:e=>m(u)[e],updateColumnWidth:(e,t)=>{e.width=t},onColumnSorted:function(t){var r;const{key:a}=t.currentTarget.dataset;if(!a)return;const{sortState:n,sortBy:o}=e;let l=jt.ASC;l=g(n)?Lt[n[a]]:Lt[o.order],null==(r=e.onColumnSort)||r.call(e,{column:h(a),key:a,order:l})}}}(e,C(e,"columns"),C(e,"fixed")),{scrollTo:R,scrollToLeft:k,scrollToTop:I,scrollToRow:T,onScroll:E,onVerticalScroll:H,scrollPos:F}=((e,{mainTableRef:t,leftTableRef:r,rightTableRef:a,onMaybeEndReached:n})=>{const o=d({scrollLeft:0,scrollTop:0});function l(e){var n,o,l;const{scrollTop:s}=e;null==(n=t.value)||n.scrollTo(e),null==(o=r.value)||o.scrollToTop(s),null==(l=a.value)||l.scrollToTop(s)}function s(e){o.value=e,l(e)}function i(e){o.value.scrollTop=e,l(m(o))}return p(()=>m(o).scrollTop,(e,t)=>{e>t&&n()}),{scrollPos:o,scrollTo:s,scrollToLeft:function(e){var r,a;o.value.scrollLeft=e,null==(a=null==(r=t.value)?void 0:r.scrollTo)||a.call(r,m(o))},scrollToTop:i,scrollToRow:function(e,r="auto"){var a;null==(a=t.value)||a.scrollToRow(e,r)},onScroll:function(t){var r;s(t),null==(r=e.onScroll)||r.call(e,t)},onVerticalScroll:function({scrollTop:e}){const{scrollTop:t}=m(o);e!==t&&i(e)}}})(e,{mainTableRef:a,leftTableRef:n,rightTableRef:o,onMaybeEndReached:function(){const{onEndReached:t}=e;if(!t)return;const{scrollTop:r}=m(F),a=m(V),n=m(J),o=a-(r+n)+e.hScrollbarSize;!oe.value&&m(A)>=0&&a<=r+m(Y)-m(re)?(oe.value=!0,t(o)):oe.value=!1}}),j=c("table-v2"),D=t(),M=w(!1),{expandedRowKeys:L,lastRenderedRowIndex:A,isDynamic:N,isResetting:O,rowHeights:W,resetAfterIndex:$,onRowExpanded:z,onRowHeightChange:K,onRowHovered:B,onRowsRendered:P}=Nt(e,{mainTableRef:a,leftTableRef:n,rightTableRef:o,tableInstance:D,ns:j,isScrolling:M}),{data:G,depthMap:_}=((e,{expandedRowKeys:t,lastRenderedRowIndex:a,resetAfterIndex:n})=>{const o=d({}),l=r(()=>{const r={},{data:a,rowKey:n}=e,l=m(t);if(!l||!l.length)return a;const s=[],i=new Set;l.forEach(e=>i.add(e));let c=a.slice();for(c.forEach(e=>r[e[n]]=0);c.length>0;){const e=c.shift();s.push(e),i.has(e[n])&&x(e.children)&&e.children.length>0&&(c=[...e.children,...c],e.children.forEach(t=>r[t[n]]=r[e[n]]+1))}return o.value=r,s}),s=r(()=>{const{data:t,expandColumnKey:r}=e;return r?m(l):t});return p(s,(e,t)=>{e!==t&&(a.value=-1,n(0,!0))}),{data:s,depthMap:o}})(e,{expandedRowKeys:L,lastRenderedRowIndex:A,resetAfterIndex:$}),V=r(()=>{const{estimatedRowHeight:t,rowHeight:r}=e,a=m(G);return v(t)?Object.values(m(W)).reduce((e,t)=>e+t,0):a.length*r}),{bodyWidth:q,fixedTableHeight:U,mainTableHeight:Y,leftTableWidth:Z,rightTableWidth:X,windowHeight:J,footerHeight:Q,emptyStyle:ee,rootStyle:te,headerHeight:re}=((e,{columnsTotalWidth:t,rowsHeight:a,fixedColumnsOnLeft:n,fixedColumnsOnRight:o})=>{const l=r(()=>{const{fixed:r,width:a,vScrollbarSize:n}=e,o=a-n;return r?Math.max(Math.round(m(t)),o):o}),s=r(()=>{const{height:t=0,maxHeight:r=0,footerHeight:n,hScrollbarSize:o}=e;if(r>0){const e=m(h),t=m(a),l=m(p)+e+t+o;return Math.min(l,r-n)}return t-n}),i=r(()=>{const{maxHeight:t}=e,r=m(s);if(v(t)&&t>0)return r;const n=m(a)+m(p)+m(h);return Math.min(r,n)}),c=e=>e.width,d=r(()=>Wt(m(n).map(c))),u=r(()=>Wt(m(o).map(c))),p=r(()=>Wt(e.headerHeight)),h=r(()=>{var t;return((null==(t=e.fixedData)?void 0:t.length)||0)*e.rowHeight}),f=r(()=>m(s)-m(p)-m(h)),y=r(()=>{const{style:t={},height:r,width:a}=e;return zt({...t,height:r,width:a})}),g=r(()=>zt({height:e.footerHeight})),w=r(()=>({top:S(m(p)),bottom:S(e.footerHeight),width:S(e.width)}));return{bodyWidth:l,fixedTableHeight:i,mainTableHeight:s,leftTableWidth:d,rightTableWidth:u,windowHeight:f,footerHeight:g,emptyStyle:w,rootStyle:y,headerHeight:p}})(e,{columnsTotalWidth:i,fixedColumnsOnLeft:u,fixedColumnsOnRight:h,rowsHeight:V}),ae=d(),ne=r(()=>{const t=0===m(G).length;return x(e.fixedData)?0===e.fixedData.length&&t:t});const oe=d(!1);return p(()=>m(V),()=>oe.value=!1),p(()=>e.expandedRowKeys,e=>L.value=e,{deep:!0}),{columns:l,containerRef:ae,mainTableRef:a,leftTableRef:n,rightTableRef:o,isDynamic:N,isResetting:O,isScrolling:M,hasFixedColumns:f,columnsStyles:s,columnsTotalWidth:i,data:G,expandedRowKeys:L,depthMap:_,fixedColumnsOnLeft:u,fixedColumnsOnRight:h,mainColumns:y,bodyWidth:q,emptyStyle:ee,rootStyle:te,footerHeight:Q,mainTableHeight:Y,fixedTableHeight:U,leftTableWidth:Z,rightTableWidth:X,showEmpty:ne,getRowHeight:function(t){const{estimatedRowHeight:r,rowHeight:a,rowKey:n}=e;return r?m(W)[m(G)[t][n]]||r:a},onColumnSorted:b,onRowHovered:B,onRowExpanded:z,onRowsRendered:P,onRowHeightChange:K,scrollTo:R,scrollToLeft:k,scrollToTop:I,scrollToRow:T,onScroll:E,onVerticalScroll:H}}const Pt=Symbol("tableV2"),Gt="tableV2GridScrollLeft",_t=String,Vt={type:l(Array),required:!0},qt={type:l(Array)},Ut={...qt,required:!0},Yt=String,Zt={type:l(Array),default:()=>s([])},Xt={type:Number,required:!0},Jt={type:l([String,Number,Symbol]),default:"id"},Qt={type:l(Object)},er=n({class:String,columns:Vt,columnsStyles:{type:l(Object),required:!0},depth:Number,expandColumnKey:Yt,estimatedRowHeight:{...kt.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:l(Function)},onRowHover:{type:l(Function)},onRowHeightChange:{type:l(Function)},rowData:{type:l(Object),required:!0},rowEventHandlers:{type:l(Object)},rowIndex:{type:Number,required:!0},rowKey:Jt,style:{type:l(Object)}}),tr={type:Number,required:!0},rr=n({class:String,columns:Vt,fixedHeaderData:{type:l(Array)},headerData:{type:l(Array),required:!0},headerHeight:{type:l([Number,Array]),default:50},rowWidth:tr,rowHeight:{type:Number,default:50},height:tr,width:tr}),ar=n({columns:Vt,data:Ut,fixedData:qt,estimatedRowHeight:er.estimatedRowHeight,width:Xt,height:Xt,headerWidth:Xt,headerHeight:rr.headerHeight,bodyWidth:Xt,rowHeight:Xt,cache:bt.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:kt.scrollbarAlwaysOn,scrollbarStartGap:kt.scrollbarStartGap,scrollbarEndGap:kt.scrollbarEndGap,class:_t,style:Qt,containerStyle:Qt,getRowHeight:{type:l(Function),required:!0},rowKey:er.rowKey,onRowsRendered:{type:l(Function)},onScroll:{type:l(Function)}}),nr=n({cache:ar.cache,estimatedRowHeight:er.estimatedRowHeight,rowKey:Jt,headerClass:{type:l([String,Function])},headerProps:{type:l([Object,Function])},headerCellProps:{type:l([Object,Function])},headerHeight:rr.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:l([String,Function])},rowProps:{type:l([Object,Function])},rowHeight:{type:Number,default:50},cellProps:{type:l([Object,Function])},columns:Vt,data:Ut,dataGetter:{type:l(Function)},fixedData:qt,expandColumnKey:er.expandColumnKey,expandedRowKeys:Zt,defaultExpandedRowKeys:Zt,class:_t,fixed:Boolean,style:{type:l(Object)},width:Xt,height:Xt,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:kt.hScrollbarSize,vScrollbarSize:kt.vScrollbarSize,scrollbarAlwaysOn:Ct.alwaysOn,sortBy:{type:l(Object),default:()=>({})},sortState:{type:l(Object),default:void 0},onColumnSort:{type:l(Function)},onExpandedRowsChange:{type:l(Function)},onEndReached:{type:l(Function)},onRowExpand:er.onRowExpand,onScroll:ar.onScroll,onRowsRendered:ar.onRowsRendered,rowEventHandlers:er.rowEventHandlers});var or=i({name:"ElTableV2Header",props:rr,setup(e,{slots:t,expose:a}){const n=c("table-v2"),o=I(Gt),l=d(),s=r(()=>zt({width:e.width,height:e.height})),i=r(()=>zt({width:e.rowWidth,height:e.height})),u=r(()=>be(m(e.headerHeight))),p=e=>{const t=m(l);b(()=>{(null==t?void 0:t.scroll)&&t.scroll({left:e})})},h=()=>{const r=n.e("fixed-header-row"),{columns:a,fixedHeaderData:o,rowHeight:l}=e;return null==o?void 0:o.map((e,n)=>{var o;const s=zt({height:l,width:"100%"});return null==(o=t.fixed)?void 0:o.call(t,{class:r,columns:a,rowData:e,rowIndex:-(n+1),style:s})})},f=()=>{const r=n.e("dynamic-header-row"),{columns:a}=e;return m(u).map((e,n)=>{var o;const l=zt({width:"100%",height:e});return null==(o=t.dynamic)?void 0:o.call(t,{class:r,columns:a,headerIndex:n,style:l})})};return T(()=>{(null==o?void 0:o.value)&&p(o.value)}),a({scrollToLeft:p}),()=>{if(!(e.height<=0))return E("div",{ref:l,class:e.class,style:m(s),role:"rowgroup"},[E("div",{style:m(i),class:n.e("header")},[f(),h()])])}}});const lr=({name:e,clearCache:a,getColumnPosition:n,getColumnStartIndexForOffset:o,getColumnStopIndexForStartIndex:l,getEstimatedTotalHeight:s,getEstimatedTotalWidth:u,getColumnOffset:p,getRowOffset:h,getRowPosition:y,getRowStartIndexForOffset:g,getRowStopIndexForStartIndex:w,initCache:x,injectToInstance:S,validateProps:R})=>i({name:null!=e?e:"ElVirtualList",props:kt,emits:[Xe,Je],setup(e,{emit:i,expose:k,slots:C}){const I=c("vl");R(e);const T=t(),E=d(x(e,T));null==S||S(T,E);const N=d(),O=d(),W=d(),$=d(null),z=d({isScrolling:!1,scrollLeft:v(e.initScrollLeft)?e.initScrollLeft:0,scrollTop:v(e.initScrollTop)?e.initScrollTop:0,updateRequested:!1,xAxisScrollDir:Qe,yAxisScrollDir:Qe}),K=Ze(),B=r(()=>Number.parseInt(`${e.height}`,10)),P=r(()=>Number.parseInt(`${e.width}`,10)),G=r(()=>{const{totalColumn:t,totalRow:r,columnCache:a}=e,{isScrolling:n,xAxisScrollDir:s,scrollLeft:i}=m(z);if(0===t||0===r)return[0,0,0,0];const c=o(e,i,m(E)),d=l(e,c,i,m(E)),u=n&&s!==et?1:Math.max(1,a),p=n&&s!==Qe?1:Math.max(1,a);return[Math.max(0,c-u),Math.max(0,Math.min(t-1,d+p)),c,d]}),_=r(()=>{const{totalColumn:t,totalRow:r,rowCache:a}=e,{isScrolling:n,yAxisScrollDir:o,scrollTop:l}=m(z);if(0===t||0===r)return[0,0,0,0];const s=g(e,l,m(E)),i=w(e,s,l,m(E)),c=n&&o!==et?1:Math.max(1,a),d=n&&o!==Qe?1:Math.max(1,a);return[Math.max(0,s-c),Math.max(0,Math.min(r-1,i+d)),s,i]}),V=r(()=>s(e,m(E))),q=r(()=>u(e,m(E))),U=r(()=>{var t;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:e.direction,height:v(e.height)?`${e.height}px`:e.height,width:v(e.width)?`${e.width}px`:e.width},null!=(t=e.style)?t:{}]}),Y=r(()=>{const e=`${m(q)}px`;return{height:`${m(V)}px`,pointerEvents:m(z).isScrolling?"none":void 0,width:e}}),Z=()=>{const{totalColumn:t,totalRow:r}=e;if(t>0&&r>0){const[e,t,r,a]=m(G),[n,o,l,s]=m(_);i(Xe,{columnCacheStart:e,columnCacheEnd:t,rowCacheStart:n,rowCacheEnd:o,columnVisibleStart:r,columnVisibleEnd:a,rowVisibleStart:l,rowVisibleEnd:s})}const{scrollLeft:a,scrollTop:n,updateRequested:o,xAxisScrollDir:l,yAxisScrollDir:s}=m(z);i(Je,{xAxisScrollDir:l,scrollLeft:a,yAxisScrollDir:s,scrollTop:n,updateRequested:o})},X=t=>{const{clientHeight:r,clientWidth:a,scrollHeight:n,scrollLeft:o,scrollTop:l,scrollWidth:s}=t.currentTarget,i=m(z);if(i.scrollTop===l&&i.scrollLeft===o)return;let c=o;if(Tt(e.direction))switch(Ht()){case it:c=-o;break;case dt:c=s-a-o}z.value={...i,isScrolling:!0,scrollLeft:c,scrollTop:Math.max(0,Math.min(l,n-r)),updateRequested:!0,xAxisScrollDir:It(i.scrollLeft,c),yAxisScrollDir:It(i.scrollTop,l)},b(()=>ae()),ne(),Z()},J=(e,t)=>{const r=m(B),a=(V.value-r)/t*e;te({scrollTop:Math.min(V.value-r,a)})},Q=(e,t)=>{const r=m(P),a=(q.value-r)/t*e;te({scrollLeft:Math.min(q.value-r,a)})},{onWheel:ee}=(({atXEndEdge:e,atXStartEdge:t,atYEndEdge:r,atYStartEdge:a},n)=>{let o=null,l=0,s=0;const i=(n,o)=>{const l=n<=0&&t.value||n>=0&&e.value,s=o<=0&&a.value||o>=0&&r.value;return l&&s};return{hasReachedEdge:i,onWheel:e=>{Ne(o);let t=e.deltaX,r=e.deltaY;Math.abs(t)>Math.abs(r)?r=0:t=0,e.shiftKey&&0!==r&&(t=r,r=0),i(l,s)&&i(l+t,s+r)||(l+=t,s+=r,e.preventDefault(),o=Oe(()=>{n(l,s),l=0,s=0}))}}})({atXStartEdge:r(()=>z.value.scrollLeft<=0),atXEndEdge:r(()=>z.value.scrollLeft>=q.value-m(P)),atYStartEdge:r(()=>z.value.scrollTop<=0),atYEndEdge:r(()=>z.value.scrollTop>=V.value-m(B))},(e,t)=>{var r,a,n,o;null==(a=null==(r=O.value)?void 0:r.onMouseUp)||a.call(r),null==(o=null==(n=W.value)?void 0:n.onMouseUp)||o.call(n);const l=m(P),s=m(B);te({scrollLeft:Math.min(z.value.scrollLeft+e,q.value-l),scrollTop:Math.min(z.value.scrollTop+t,V.value-s)})});H(N,"wheel",ee,{passive:!1});const te=({scrollLeft:e=z.value.scrollLeft,scrollTop:t=z.value.scrollTop})=>{e=Math.max(e,0),t=Math.max(t,0);const r=m(z);t===r.scrollTop&&e===r.scrollLeft||(z.value={...r,xAxisScrollDir:It(r.scrollLeft,e),yAxisScrollDir:It(r.scrollTop,t),scrollLeft:e,scrollTop:t,updateRequested:!0},b(()=>ae()),ne(),Z())},re=(t,r)=>{const{columnWidth:o,direction:l,rowHeight:s}=e,i=K.value(a&&o,a&&s,a&&l),c=`${t},${r}`;if(A(i,c))return i[c];{const[,a]=n(e,r,m(E)),o=m(E),s=Tt(l),[d,u]=y(e,t,o),[p]=n(e,r,o);return i[c]={position:"absolute",left:s?void 0:`${a}px`,right:s?`${a}px`:void 0,top:`${u}px`,height:`${d}px`,width:`${p}px`},i[c]}},ae=()=>{z.value.isScrolling=!1,b(()=>{K.value(-1,null,null)})};F(()=>{if(!j)return;const{initScrollLeft:t,initScrollTop:r}=e,a=m(N);a&&(v(t)&&(a.scrollLeft=t),v(r)&&(a.scrollTop=r)),Z()});const ne=()=>{const{direction:t}=e,{scrollLeft:r,scrollTop:a,updateRequested:n}=m(z),o=m(N);if(n&&o){if("rtl"===t)switch(Ht()){case it:o.scrollLeft=-r;break;case ct:o.scrollLeft=r;break;default:{const{clientWidth:e,scrollWidth:t}=o;o.scrollLeft=t-e-r;break}}else o.scrollLeft=Math.max(0,r);o.scrollTop=Math.max(0,a)}},{resetAfterColumnIndex:oe,resetAfterRowIndex:le,resetAfter:se}=T.proxy;k({windowRef:N,innerRef:$,getItemStyleCache:K,scrollTo:te,scrollToItem:(t=0,r=0,a=tt)=>{const n=m(z);r=Math.max(0,Math.min(r,e.totalColumn-1)),t=Math.max(0,Math.min(t,e.totalRow-1));const o=We(I.namespace.value),l=m(E),i=s(e,l),c=u(e,l);te({scrollLeft:p(e,r,a,n.scrollLeft,l,c>e.width?o:0),scrollTop:h(e,t,a,n.scrollTop,l,i>e.height?o:0)})},states:z,resetAfterColumnIndex:oe,resetAfterRowIndex:le,resetAfter:se});const ie=()=>{const t=D(e.innerElement),r=(()=>{var t;const[r,a]=m(G),[n,o]=m(_),{data:l,totalColumn:s,totalRow:i,useIsScrolling:c,itemKey:d}=e,u=[];if(i>0&&s>0)for(let e=n;e<=o;e++)for(let n=r;n<=a;n++){const r=d({columnIndex:n,data:l,rowIndex:e});u.push(f(L,{key:r},null==(t=C.default)?void 0:t.call(C,{columnIndex:n,data:l,isScrolling:c?m(z).isScrolling:void 0,style:re(e,n),rowIndex:e})))}return u})();return[f(t,{style:m(Y),ref:$},M(t)?r:{default:()=>r})]};return()=>{const t=D(e.containerElement),{horizontalScrollbar:r,verticalScrollbar:a}=(()=>{const{scrollbarAlwaysOn:t,scrollbarStartGap:r,scrollbarEndGap:a,totalColumn:n,totalRow:o}=e,l=m(P),s=m(B),i=m(q),c=m(V),{scrollLeft:d,scrollTop:u}=m(z);return{horizontalScrollbar:f(Ft,{ref:O,alwaysOn:t,startGap:r,endGap:a,class:I.e("horizontal"),clientSize:l,layout:"horizontal",onScroll:Q,ratio:100*l/i,scrollFrom:d/(i-l),total:o,visible:!0}),verticalScrollbar:f(Ft,{ref:W,alwaysOn:t,startGap:r,endGap:a,class:I.e("vertical"),clientSize:s,layout:"vertical",onScroll:J,ratio:100*s/c,scrollFrom:u/(c-s),total:n,visible:!0})}})(),n=ie();return f("div",{key:0,class:I.e("wrapper"),role:e.role},[f(t,{class:e.className,style:m(U),onScroll:X,ref:N},M(t)?n:{default:()=>n}),r,a])}}}),{max:sr,min:ir,floor:cr}=Math,dr={column:"columnWidth",row:"rowHeight"},ur={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},mr=(e,t,r,a)=>{const[n,o,l]=[r[a],e[dr[a]],r[ur[a]]];if(t>l){let e=0;if(l>=0){const t=n[l];e=t.offset+t.size}for(let r=l+1;r<=t;r++){const t=o(r);n[r]={offset:e,size:t},e+=t}r[ur[a]]=t}return n[t]},pr=(e,t,r,a,n,o)=>{for(;r<=a;){const l=r+cr((a-r)/2),s=mr(e,l,t,o).offset;if(s===n)return l;s<n?r=l+1:a=l-1}return sr(0,r-1)},hr=(e,t,r,a)=>{const[n,o]=[t[a],t[ur[a]]];return(o>0?n[o].offset:0)>=r?pr(e,t,0,o,r,a):((e,t,r,a,n)=>{const o="column"===n?e.totalColumn:e.totalRow;let l=1;for(;r<o&&mr(e,r,t,n).offset<a;)r+=l,l*=2;return pr(e,t,cr(r/2),ir(r,o-1),a,n)})(e,t,sr(0,o),r,a)},fr=({totalRow:e},{estimatedRowHeight:t,lastVisitedRowIndex:r,row:a})=>{let n=0;if(r>=e&&(r=e-1),r>=0){const e=a[r];n=e.offset+e.size}return n+(e-r-1)*t},yr=({totalColumn:e},{column:t,estimatedColumnWidth:r,lastVisitedColumnIndex:a})=>{let n=0;if(a>e&&(a=e-1),a>=0){const e=t[a];n=e.offset+e.size}return n+(e-a-1)*r},gr={column:yr,row:fr},wr=(e,t,r,a,n,o,l)=>{const[s,i]=["row"===o?e.height:e.width,gr[o]],c=mr(e,t,n,o),d=i(e,n),u=sr(0,ir(d-s,c.offset)),m=sr(0,c.offset-s+l+c.size);switch(r===rt&&(r=a>=m-s&&a<=u+s?tt:nt),r){case at:return u;case ot:return m;case nt:return Math.round(m+(u-m)/2);default:return a>=m&&a<=u?a:m>u||a<m?m:u}},vr=lr({name:"ElDynamicSizeGrid",getColumnPosition:(e,t,r)=>{const a=mr(e,t,r,"column");return[a.size,a.offset]},getRowPosition:(e,t,r)=>{const a=mr(e,t,r,"row");return[a.size,a.offset]},getColumnOffset:(e,t,r,a,n,o)=>wr(e,t,r,a,n,"column",o),getRowOffset:(e,t,r,a,n,o)=>wr(e,t,r,a,n,"row",o),getColumnStartIndexForOffset:(e,t,r)=>hr(e,r,t,"column"),getColumnStopIndexForStartIndex:(e,t,r,a)=>{const n=mr(e,t,a,"column"),o=r+e.width;let l=n.offset+n.size,s=t;for(;s<e.totalColumn-1&&l<o;)s++,l+=mr(e,t,a,"column").size;return s},getEstimatedTotalHeight:fr,getEstimatedTotalWidth:yr,getRowStartIndexForOffset:(e,t,r)=>hr(e,r,t,"row"),getRowStopIndexForStartIndex:(e,t,r,a)=>{const{totalRow:n,height:o}=e,l=mr(e,t,a,"row"),s=r+o;let i=l.size+l.offset,c=t;for(;c<n-1&&i<s;)c++,i+=mr(e,c,a,"row").size;return c},injectToInstance:(e,t)=>{const r=({columnIndex:r,rowIndex:a},n)=>{var o,l;n=!!N(n)||n,v(r)&&(t.value.lastVisitedColumnIndex=Math.min(t.value.lastVisitedColumnIndex,r-1)),v(a)&&(t.value.lastVisitedRowIndex=Math.min(t.value.lastVisitedRowIndex,a-1)),null==(o=e.exposed)||o.getItemStyleCache.value(-1,null,null),n&&(null==(l=e.proxy)||l.$forceUpdate())};Object.assign(e.proxy,{resetAfterColumnIndex:(e,t)=>{r({columnIndex:e},t)},resetAfterRowIndex:(e,t)=>{r({rowIndex:e},t)},resetAfter:r})},initCache:({estimatedColumnWidth:e=50,estimatedRowHeight:t=50})=>({column:{},estimatedColumnWidth:e,estimatedRowHeight:t,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:e,rowHeight:t})=>{}}),br=lr({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:e},t)=>[e,t*e],getRowPosition:({rowHeight:e},t)=>[e,t*e],getEstimatedTotalHeight:({totalRow:e,rowHeight:t})=>t*e,getEstimatedTotalWidth:({totalColumn:e,columnWidth:t})=>t*e,getColumnOffset:({totalColumn:e,columnWidth:t,width:r},a,n,o,l,s)=>{r=Number(r);const i=Math.max(0,e*t-r),c=Math.min(i,a*t),d=Math.max(0,a*t-r+s+t);switch("smart"===n&&(n=o>=d-r&&o<=c+r?tt:nt),n){case at:return c;case ot:return d;case nt:{const e=Math.round(d+(c-d)/2);return e<Math.ceil(r/2)?0:e>i+Math.floor(r/2)?i:e}default:return o>=d&&o<=c?o:d>c||o<d?d:c}},getRowOffset:({rowHeight:e,height:t,totalRow:r},a,n,o,l,s)=>{t=Number(t);const i=Math.max(0,r*e-t),c=Math.min(i,a*e),d=Math.max(0,a*e-t+s+e);switch(n===rt&&(n=o>=d-t&&o<=c+t?tt:nt),n){case at:return c;case ot:return d;case nt:{const e=Math.round(d+(c-d)/2);return e<Math.ceil(t/2)?0:e>i+Math.floor(t/2)?i:e}default:return o>=d&&o<=c?o:d>c||o<d?d:c}},getColumnStartIndexForOffset:({columnWidth:e,totalColumn:t},r)=>Math.max(0,Math.min(t-1,Math.floor(r/e))),getColumnStopIndexForStartIndex:({columnWidth:e,totalColumn:t,width:r},a,n)=>{const o=a*e,l=Math.ceil((r+n-o)/e);return Math.max(0,Math.min(t-1,a+l-1))},getRowStartIndexForOffset:({rowHeight:e,totalRow:t},r)=>Math.max(0,Math.min(t-1,Math.floor(r/e))),getRowStopIndexForStartIndex:({rowHeight:e,totalRow:t,height:r},a,n)=>{const o=a*e,l=Math.ceil((r+n-o)/e);return Math.max(0,Math.min(t-1,a+l-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:e,rowHeight:t})=>{}});var xr=i({name:"ElTableV2Grid",props:ar,setup(e,{slots:t,expose:a}){const{ns:n}=I(Pt),{bodyRef:o,fixedRowHeight:l,gridHeight:s,hasHeader:i,headerRef:c,headerHeight:u,totalHeight:h,forceUpdate:f,itemKey:y,onItemRendered:w,resetAfterRowIndex:x,scrollTo:S,scrollToTop:R,scrollToRow:k,scrollLeft:C}=(e=>{const t=d(),a=d(),n=d(0),o=r(()=>{const{data:t,rowHeight:r,estimatedRowHeight:a}=e;if(!a)return t.length*r}),l=r(()=>{const{fixedData:t,rowHeight:r}=e;return((null==t?void 0:t.length)||0)*r}),s=r(()=>Wt(e.headerHeight)),i=r(()=>{const{height:t}=e;return Math.max(0,t-m(s)-m(l))}),c=r(()=>m(s)+m(l)>0);return p(()=>e.bodyWidth,()=>{var t;v(e.estimatedRowHeight)&&(null==(t=a.value)||t.resetAfter({columnIndex:0},!1))}),{bodyRef:a,forceUpdate:function(){var e,r;null==(e=m(a))||e.$forceUpdate(),null==(r=m(t))||r.$forceUpdate()},fixedRowHeight:l,gridHeight:i,hasHeader:c,headerHeight:s,headerRef:t,totalHeight:o,itemKey:({data:t,rowIndex:r})=>t[r][e.rowKey],onItemRendered:function({rowCacheStart:t,rowCacheEnd:r,rowVisibleStart:a,rowVisibleEnd:n}){var o;null==(o=e.onRowsRendered)||o.call(e,{rowCacheStart:t,rowCacheEnd:r,rowVisibleStart:a,rowVisibleEnd:n})},resetAfterRowIndex:function(e,t){var r;null==(r=a.value)||r.resetAfterRowIndex(e,t)},scrollTo:function(e,r){const o=m(t),l=m(a);g(e)?(null==o||o.scrollToLeft(e.scrollLeft),n.value=e.scrollLeft,null==l||l.scrollTo(e)):(null==o||o.scrollToLeft(e),n.value=e,null==l||l.scrollTo({scrollLeft:e,scrollTop:r}))},scrollToTop:function(e){var t;null==(t=m(a))||t.scrollTo({scrollTop:e})},scrollToRow:function(e,t){var r;null==(r=m(a))||r.scrollToItem(e,1,t)},scrollLeft:n}})(e);W(Gt,C),O(async()=>{var e;await b();const t=null==(e=o.value)?void 0:e.states.scrollTop;t&&R(Math.round(t)+1)}),a({forceUpdate:f,totalHeight:h,scrollTo:S,scrollToTop:R,scrollToRow:k,resetAfterRowIndex:x});const T=()=>e.bodyWidth;return()=>{const{cache:r,columns:a,data:d,fixedData:p,useIsScrolling:h,scrollbarAlwaysOn:f,scrollbarEndGap:g,scrollbarStartGap:b,style:x,rowHeight:S,bodyWidth:R,estimatedRowHeight:k,headerWidth:C,height:I,width:H,getRowHeight:F,onScroll:j}=e,D=v(k),M=D?vr:br,L=m(u);return E("div",{role:"table",class:[n.e("table"),e.class],style:x},[E(M,{ref:o,data:d,useIsScrolling:h,itemKey:y,columnCache:0,columnWidth:D?T:R,totalColumn:1,totalRow:d.length,rowCache:r,rowHeight:D?F:S,width:H,height:m(s),class:n.e("body"),role:"rowgroup",scrollbarStartGap:b,scrollbarEndGap:g,scrollbarAlwaysOn:f,onScroll:j,onItemRendered:w,perfMode:!1},{default:e=>{var r;const n=d[e.rowIndex];return null==(r=t.row)?void 0:r.call(t,{...e,columns:a,rowData:n})}}),m(i)&&E(or,{ref:c,class:n.e("header-wrapper"),columns:a,headerData:d,headerHeight:e.headerHeight,fixedHeaderData:p,rowWidth:C,rowHeight:S,width:H,height:Math.min(L+m(l),I)},{dynamic:t.header,fixed:t.row})])}}});var Sr=(e,{slots:t})=>{const{mainTableRef:r,...a}=e;return E(xr,$({ref:r},a),"function"==typeof(n=t)||"[object Object]"===Object.prototype.toString.call(n)&&!R(n)?t:{default:()=>[t]});var n};var Rr=(e,{slots:t})=>{if(!e.columns.length)return;const{leftTableRef:r,...a}=e;return E(xr,$({ref:r},a),"function"==typeof(n=t)||"[object Object]"===Object.prototype.toString.call(n)&&!R(n)?t:{default:()=>[t]});var n};var kr=(e,{slots:t})=>{if(!e.columns.length)return;const{rightTableRef:r,...a}=e;return E(xr,$({ref:r},a),"function"==typeof(n=t)||"[object Object]"===Object.prototype.toString.call(n)&&!R(n)?t:{default:()=>[t]});var n};const Cr=e=>{const{isScrolling:t}=I(Pt),a=d(!1),n=d(),o=r(()=>v(e.estimatedRowHeight)&&e.rowIndex>=0),l=r(()=>{const{rowData:t,rowIndex:r,rowKey:a,onRowHover:n}=e,o=e.rowEventHandlers||{},l={};return Object.entries(o).forEach(([e,n])=>{k(n)&&(l[e]=e=>{n({event:e,rowData:t,rowIndex:r,rowKey:a})})}),n&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach(({name:e,hovered:o})=>{const s=l[e];l[e]=e=>{n({event:e,hovered:o,rowData:t,rowIndex:r,rowKey:a}),null==s||s(e)}}),l});return F(()=>{m(o)&&((t=!1)=>{const r=m(n);if(!r)return;const{columns:o,onRowHeightChange:l,rowKey:s,rowIndex:i,style:c}=e,{height:d}=r.getBoundingClientRect();a.value=!0,b(()=>{if(t||d!==Number.parseInt(c.height)){const e=o[0],t=(null==e?void 0:e.placeholderSign)===At;null==l||l({rowKey:s,height:d,rowIndex:i},e&&!t&&e.fixed)}})})(!0)}),{isScrolling:t,measurable:o,measured:a,rowRef:n,eventHandlers:l,onExpand:t=>{const{onRowExpand:r,rowData:a,rowIndex:n,rowKey:o}=e;null==r||r({expanded:t,rowData:a,rowIndex:n,rowKey:o})}}};var Ir=i({name:"ElTableV2TableRow",props:er,setup(e,{expose:t,slots:r,attrs:a}){const{eventHandlers:n,isScrolling:o,measurable:l,measured:s,rowRef:i,onExpand:c}=Cr(e);return t({onExpand:c}),()=>{const{columns:t,columnsStyles:d,expandColumnKey:u,depth:p,rowData:h,rowIndex:f,style:y}=e;let g=t.map((e,a)=>{const n=x(h.children)&&h.children.length>0&&e.key===u;return r.cell({column:e,columns:t,columnIndex:a,depth:p,style:d[e.key],rowData:h,rowIndex:f,isScrolling:m(o),expandIconProps:n?{rowData:h,rowIndex:f,onExpand:c}:void 0})});if(r.row&&(g=r.row({cells:g.map(e=>x(e)&&1===e.length?e[0]:e),style:y,columns:t,depth:p,rowData:h,rowIndex:f,isScrolling:m(o)})),m(l)){const{height:t,...r}=y||{},o=m(s);return E("div",$({ref:i,class:e.class,style:o?y:r,role:"row"},a,m(n)),[g])}return E("div",$(a,{ref:i,class:e.class,style:y,role:"row"},m(n)),[g])}}});var Tr=(e,{slots:t})=>{const{columns:r,columnsStyles:a,depthMap:n,expandColumnKey:o,expandedRowKeys:l,estimatedRowHeight:s,hasFixedColumns:i,rowData:c,rowIndex:d,style:u,isScrolling:m,rowProps:p,rowClass:h,rowKey:f,rowEventHandlers:y,ns:g,onRowHovered:w,onRowExpanded:v}=e,b=$t(h,{columns:r,rowData:c,rowIndex:d},""),x=$t(p,{columns:r,rowData:c,rowIndex:d}),S=c[f],k=n[S]||0,C=Boolean(o),I=d<0,T=[g.e("row"),b,{[g.e(`row-depth-${k}`)]:C&&d>=0,[g.is("expanded")]:C&&l.includes(S),[g.is("fixed")]:!k&&I,[g.is("customized")]:Boolean(t.row)}],H=i?w:void 0,F={...x,columns:r,columnsStyles:a,class:T,depth:k,expandColumnKey:o,estimatedRowHeight:I?void 0:s,isScrolling:m,rowIndex:d,rowData:c,rowKey:S,rowEventHandlers:y,style:u};return E(Ir,$(F,{onRowExpand:v,onMouseenter:e=>{null==H||H({hovered:!0,rowKey:S,event:e,rowData:c,rowIndex:d})},onMouseleave:e=>{null==H||H({hovered:!1,rowKey:S,event:e,rowData:c,rowIndex:d})},rowkey:S}),"function"==typeof(j=t)||"[object Object]"===Object.prototype.toString.call(j)&&!R(j)?t:{default:()=>[t]});var j};const Er=(e,{slots:t})=>{var r;const{cellData:a,style:n}=e,o=(null==(r=null==a?void 0:a.toString)?void 0:r.call(a))||"",l=z(t,"default",e,()=>[o]);return E("div",{class:e.class,title:o,style:n},[l])};Er.displayName="ElTableV2Cell",Er.inheritAttrs=!1;var Hr=Er;var Fr=e=>{const{expanded:t,expandable:r,onExpand:a,style:n,size:o}=e,l={onClick:r?()=>a(!t):void 0,class:e.class};return E(B,$(l,{size:o,style:n}),{default:()=>[E(K,null,null)]})};const jr=({columns:e,column:t,columnIndex:r,depth:a,expandIconProps:n,isScrolling:o,rowData:l,rowIndex:s,style:i,expandedRowKeys:c,ns:d,cellProps:u,expandColumnKey:m,indentSize:p,iconSize:h,rowKey:f},{slots:y})=>{const w=zt(i);if(t.placeholderSign===At)return E("div",{class:d.em("row-cell","placeholder"),style:w},null);const{cellRenderer:v,dataKey:b,dataGetter:x}=t,S=k(x)?x({columns:e,column:t,columnIndex:r,rowData:l,rowIndex:s}):P(l,null!=b?b:""),R=$t(u,{cellData:S,columns:e,column:t,columnIndex:r,rowIndex:s,rowData:l}),C={class:d.e("cell-text"),columns:e,column:t,columnIndex:r,cellData:S,isScrolling:o,rowData:l,rowIndex:s},I=Kt(v),T=I?I(C):z(y,"default",C,()=>[E(Hr,C,null)]),H=[d.e("row-cell"),t.class,t.align===Dt.CENTER&&d.is("align-center"),t.align===Dt.RIGHT&&d.is("align-right")],F=s>=0&&m&&t.key===m,j=s>=0&&c.includes(l[f]);let D;const M=`margin-inline-start: ${a*p}px;`;return F&&(D=g(n)?E(Fr,$(n,{class:[d.e("expand-icon"),d.is("expanded",j)],size:h,expanded:j,style:M,expandable:!0}),null):E("div",{style:[M,`width: ${h}px; height: ${h}px;`].join(" ")},null)),E("div",$({class:H,style:w},R,{role:"cell"}),[D,T])};jr.inheritAttrs=!1;var Dr=jr;const Mr=n({class:String,columns:Vt,columnsStyles:{type:l(Object),required:!0},headerIndex:Number,style:{type:l(Object)}});var Lr=i({name:"ElTableV2HeaderRow",props:Mr,setup:(e,{slots:t})=>()=>{const{columns:r,columnsStyles:a,headerIndex:n,style:o}=e;let l=r.map((e,o)=>t.cell({columns:r,column:e,columnIndex:o,headerIndex:n,style:a[e.key]}));return t.header&&(l=t.header({cells:l.map(e=>x(e)&&1===e.length?e[0]:e),columns:r,headerIndex:n})),E("div",{class:e.class,style:o,role:"row"},[l])}});var Ar=({columns:e,columnsStyles:t,headerIndex:r,style:a,headerClass:n,headerProps:o,ns:l},{slots:s})=>{const i={columns:e,headerIndex:r},c=[l.e("header-row"),$t(n,i,""),{[l.is("customized")]:Boolean(s.header)}],d={...$t(o,i),columnsStyles:t,class:c,columns:e,headerIndex:r,style:a};return E(Lr,d,"function"==typeof(u=s)||"[object Object]"===Object.prototype.toString.call(u)&&!R(u)?s:{default:()=>[s]});var u};const Nr=(e,{slots:t})=>z(t,"default",e,()=>{var t,r;return[E("div",{class:e.class,title:null==(t=e.column)?void 0:t.title},[null==(r=e.column)?void 0:r.title])]});Nr.displayName="ElTableV2HeaderCell",Nr.inheritAttrs=!1;var Or=Nr;var Wr=e=>{const{sortOrder:t}=e;return E(B,{size:14,class:e.class},{default:()=>[t===jt.ASC?E(G,null,null):E(_,null,null)]})};var $r=(e,{slots:t})=>{const{column:r,ns:a,style:n,onColumnSorted:o}=e,l=zt(n);if(r.placeholderSign===At)return E("div",{class:a.em("header-row-cell","placeholder"),style:l},null);const{headerCellRenderer:s,headerClass:i,sortable:c}=r,d={...e,class:a.e("header-cell-text")},u=Kt(s),m=u?u(d):z(t,"default",d,()=>[E(Or,d,null)]),{sortBy:p,sortState:h,headerCellProps:f}=e;let y,g;if(h){const e=h[r.key];y=Boolean(Lt[e]),g=y?e:jt.ASC}else y=r.key===p.key,g=y?p.order:jt.ASC;const w=[a.e("header-cell"),$t(i,e,""),r.align===Dt.CENTER&&a.is("align-center"),r.align===Dt.RIGHT&&a.is("align-right"),c&&a.is("sortable")],v={...$t(f,e),onClick:r.sortable?o:void 0,class:w,style:l,"data-key":r.key};return E("div",$(v,{role:"columnheader"}),[m,c&&E(Wr,{class:[a.e("sort-icon"),y&&a.is("sorting")],sortOrder:g},null)])};const zr=(e,{slots:t})=>{var r;return E("div",{class:e.class,style:e.style},[null==(r=t.default)?void 0:r.call(t)])};zr.displayName="ElTableV2Footer";var Kr=zr;const Br=(e,{slots:t})=>{const r=z(t,"default",{},()=>[E(we,null,null)]);return E("div",{class:e.class,style:e.style},[r])};Br.displayName="ElTableV2Empty";var Pr=Br;const Gr=(e,{slots:t})=>{var r;return E("div",{class:e.class,style:e.style},[null==(r=t.default)?void 0:r.call(t)])};Gr.displayName="ElTableV2Overlay";var _r=Gr;function Vr(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!R(e)}var qr=i({name:"ElTableV2",props:nr,setup(e,{slots:t,expose:r}){const a=c("table-v2"),{columnsStyles:n,fixedColumnsOnLeft:o,fixedColumnsOnRight:l,mainColumns:s,mainTableHeight:i,fixedTableHeight:d,leftTableWidth:u,rightTableWidth:p,data:h,depthMap:f,expandedRowKeys:y,hasFixedColumns:g,mainTableRef:w,leftTableRef:v,rightTableRef:b,isDynamic:x,isResetting:S,isScrolling:R,bodyWidth:k,emptyStyle:C,rootStyle:I,footerHeight:T,showEmpty:H,scrollTo:F,scrollToLeft:j,scrollToTop:D,scrollToRow:M,getRowHeight:L,onColumnSorted:A,onRowHeightChange:N,onRowHovered:O,onRowExpanded:z,onRowsRendered:K,onScroll:B,onVerticalScroll:P}=Bt(e);return r({scrollTo:F,scrollToLeft:j,scrollToTop:D,scrollToRow:M}),W(Pt,{ns:a,isResetting:S,isScrolling:R}),()=>{const{cache:r,cellProps:c,estimatedRowHeight:S,expandColumnKey:R,fixedData:F,headerHeight:j,headerClass:D,headerProps:M,headerCellProps:W,sortBy:G,sortState:_,rowHeight:V,rowClass:q,rowEventHandlers:U,rowKey:Y,rowProps:Z,scrollbarAlwaysOn:X,indentSize:J,iconSize:Q,useIsScrolling:ee,vScrollbarSize:te,width:re}=e,ae=m(h),ne={cache:r,class:a.e("main"),columns:m(s),data:ae,fixedData:F,estimatedRowHeight:S,bodyWidth:m(k),headerHeight:j,headerWidth:m(k),height:m(i),mainTableRef:w,rowKey:Y,rowHeight:V,scrollbarAlwaysOn:X,scrollbarStartGap:2,scrollbarEndGap:te,useIsScrolling:ee,width:re,getRowHeight:L,onRowsRendered:K,onScroll:B},oe=m(u),le=m(d),se={cache:r,class:a.e("left"),columns:m(o),data:ae,fixedData:F,estimatedRowHeight:S,leftTableRef:v,rowHeight:V,bodyWidth:oe,headerWidth:oe,headerHeight:j,height:le,rowKey:Y,scrollbarAlwaysOn:X,scrollbarStartGap:2,scrollbarEndGap:te,useIsScrolling:ee,width:oe,getRowHeight:L,onScroll:P},ie=m(p),ce={cache:r,class:a.e("right"),columns:m(l),data:ae,fixedData:F,estimatedRowHeight:S,rightTableRef:b,rowHeight:V,bodyWidth:ie,headerWidth:ie,headerHeight:j,height:le,rowKey:Y,scrollbarAlwaysOn:X,scrollbarStartGap:2,scrollbarEndGap:te,width:ie,style:`--${m(a.namespace)}-table-scrollbar-size: ${te}px`,useIsScrolling:ee,getRowHeight:L,onScroll:P},de=m(n),ue={ns:a,depthMap:m(f),columnsStyles:de,expandColumnKey:R,expandedRowKeys:m(y),estimatedRowHeight:S,hasFixedColumns:m(g),rowProps:Z,rowClass:q,rowKey:Y,rowEventHandlers:U,onRowHovered:O,onRowExpanded:z,onRowHeightChange:N},me={cellProps:c,expandColumnKey:R,indentSize:J,iconSize:Q,rowKey:Y,expandedRowKeys:m(y),ns:a},pe={ns:a,headerClass:D,headerProps:M,columnsStyles:de},he={ns:a,sortBy:G,sortState:_,headerCellProps:W,onColumnSorted:A},fe={row:e=>E(Tr,$(e,ue),{row:t.row,cell:e=>{let r;return t.cell?E(Dr,$(e,me,{style:de[e.column.key]}),Vr(r=t.cell(e))?r:{default:()=>[r]}):E(Dr,$(e,me,{style:de[e.column.key]}),null)}}),header:e=>E(Ar,$(e,pe),{header:t.header,cell:e=>{let r;return t["header-cell"]?E($r,$(e,he,{style:de[e.column.key]}),Vr(r=t["header-cell"](e))?r:{default:()=>[r]}):E($r,$(e,he,{style:de[e.column.key]}),null)}})},ye=[e.class,a.b(),a.e("root"),{[a.is("dynamic")]:m(x)}],ge={class:a.e("footer"),style:m(T)};return E("div",{class:ye,style:m(I)},[E(Sr,ne,Vr(fe)?fe:{default:()=>[fe]}),E(Rr,se,Vr(fe)?fe:{default:()=>[fe]}),E(kr,ce,Vr(fe)?fe:{default:()=>[fe]}),t.footer&&E(Kr,ge,{default:t.footer}),m(H)&&E(Pr,{class:a.e("empty"),style:m(C)},{default:t.empty}),t.overlay&&E(_r,{class:a.e("overlay")},{default:t.overlay})])}}});const Ur=n({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:l(Function)}});var Yr=i({name:"ElAutoResizer",props:Ur,setup(e,{slots:t}){const r=c("auto-resizer"),{height:a,width:n,sizer:o}=(e=>{const t=d(),r=d(0),a=d(0);let n;return F(()=>{n=V(t,([e])=>{const{width:t,height:n}=e.contentRect,{paddingLeft:o,paddingRight:l,paddingTop:s,paddingBottom:i}=getComputedStyle(e.target),c=Number.parseInt(o)||0,d=Number.parseInt(l)||0,u=Number.parseInt(s)||0,m=Number.parseInt(i)||0;r.value=t-c-d,a.value=n-u-m}).stop}),h(()=>{null==n||n()}),p([r,a],([t,r])=>{var a;null==(a=e.onResize)||a.call(e,{width:t,height:r})}),{sizer:t,width:r,height:a}})(e),l={width:"100%",height:"100%"};return()=>{var e;return E("div",{ref:o,class:r.b(),style:l},[null==(e=t.default)?void 0:e.call(t,{height:a.value,width:n.value})])}}});const Zr=q(qr),Xr=q(Yr),Jr={class:"upload select"},Qr=ge(i({__name:"TestLog",emits:["handleLine","beforeHandle","afterHandle"],setup(t,{emit:r}){const a=r,n=d(null),o=d(null);async function l(t){o.value?.classList.remove("drag");const r=t.target.files;if(!r||0===r.length)return;a("beforeHandle");const n=e.service({fullscreen:!0,text:"正在解析……请稍候",lock:!0,spinner:'<div style="width:0;height:0"></div>'});for(let e=0;e<r.length;e++){const t=r[e],n=await t.text();for(const e of n.split("\n"))a("handleLine",e)}n.close(),a("afterHandle"),o.value?.classList.remove("drag")}function s(e){e.preventDefault(),o.value?.classList.add("drag")}function i(e){e.preventDefault(),o.value?.classList.remove("drag")}return F(()=>{n.value?.addEventListener("change",l),o.value?.addEventListener("dragover",s),o.value?.addEventListener("dragleave",i)}),U(()=>{n.value?.removeEventListener("change",l),o.value?.removeEventListener("dragover",s),o.value?.removeEventListener("dragleave",i)}),(e,t)=>(Z(),Y("div",Jr,[X("div",{ref_key:"select",ref:o,class:"upload-select"},[t[0]||(t[0]=X("div",{class:"upload text"},[X("span",null,"+"),X("p",null,"上传或拖入ACT日志")],-1)),X("input",{ref_key:"input",ref:n,type:"file"},null,512)],512)]))}}),[["__scopeId","data-v-6722092f"]]),ea=[{name:"铁壁",id:1191,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"盾阵",id:1856,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"干预",id:1174,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"预警",id:74,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"武装",id:1176,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"神圣领域",id:82,type:"multiplier",performance:{physics:0,magic:0,darkness:0},isFriendly:!0},{name:"圣光幕帘",id:1362,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"圣盾阵",id:2674,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"骑士的坚守",id:2675,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"壁垒",id:77,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"极致防御",id:3829,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"极致护盾",id:3830,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"原初的直觉",id:735,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的勇猛",id:1857,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的武猛",id:1858,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"战栗",id:87,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"复仇",id:89,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"摆脱",id:1457,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"死斗",id:409,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"原初的血气",id:2678,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的血潮",id:2679,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"原初的血烟",id:2680,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"戮罪",id:3832,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"至黑之夜",id:1178,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"弃明投暗",id:746,type:"multiplier",performance:{physics:.9,magic:.8,darkness:1},isFriendly:!0},{name:"暗影墙",id:747,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"暗黑布道",id:1894,type:"multiplier",performance:{physics:.95,magic:.9,darkness:1},isFriendly:!0},{name:"暗影卫",id:3835,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"行尸走肉",id:810,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"死而不僵",id:811,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"出死入生",id:3255,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"献奉",id:2682,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"石之心",id:1840,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"残暴弹",id:1898,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"伪装",id:1832,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"星云",id:1834,type:"multiplier",performance:{physics:.7,magic:.7,darkness:1},isFriendly:!0},{name:"光之心",id:1839,type:"multiplier",performance:{physics:.95,magic:.85,darkness:1},isFriendly:!0},{name:"超火流星",id:1836,type:"multiplier",performance:{physics:0,magic:0,darkness:0},isFriendly:!0},{name:"刚玉之心",id:2683,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"刚玉之清",id:2684,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"神祝祷",id:1218,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"节制",id:1873,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"水流幕",id:2708,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"鼓舞",id:297,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"激励",id:1918,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"炽天的幕帘",id:1917,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"野战治疗阵",id:299,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"异想的幻光",id:317,type:"multiplier",performance:{physics:1,magic:.95,darkness:1},isFriendly:!0},{name:"炽天的幻光",id:1875,type:"multiplier",performance:{physics:1,magic:.95,darkness:1},isFriendly:!0},{name:"生命回生法",id:2710,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"怒涛之计",id:2711,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"命运之轮",id:849,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"天星交错",id:1889,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"擢升",id:2717,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"中间学派",id:1921,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"均衡诊断",id:2607,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"齐衡诊断",id:2608,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"均衡预后",id:2609,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"坚角清汁",id:2618,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"白牛清汁",id:2619,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"整体论",id:3003,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"整体盾",id:3365,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"输血",id:2612,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"泛输血",id:2613,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"心眼",id:1232,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"金刚极意",id:1179,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"行吟",id:1934,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"策动",id:1951,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"防守之桑巴",id:1826,type:"multiplier",performance:{physics:.85,magic:.85,darkness:1},isFriendly:!0},{name:"即兴表演结束",id:2697,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"残影",id:488,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"魔罩",id:168,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"守护之光",id:2702,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"守护纹",id:2597,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"抗死",id:2707,type:"multiplier",performance:{physics:1,magic:.9,darkness:1},isFriendly:!0},{name:"雪仇",id:1193,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!1},{name:"牵制",id:1195,type:"multiplier",performance:{physics:.9,magic:.95,darkness:1},isFriendly:!1},{name:"昏乱",id:1203,type:"multiplier",performance:{physics:.95,magic:.9,darkness:1},isFriendly:!1},{name:"武装解除",id:860,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!1},{name:"减速",id:9,type:"multiplier",performance:{physics:1,magic:1,darkness:1},isFriendly:!1},{name:"体力增加",id:2120,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"腐臭",id:1715,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!1},{name:"智力精神降低",id:2115,type:"multiplier",performance:{physics:1,magic:.9,darkness:1},isFriendly:!1},{name:"龙之力",id:2500,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"超硬化",id:1722,type:"multiplier",performance:{physics:.1,magic:.1,darkness:1},isFriendly:!0},{name:"玄结界",id:2496,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"仙人盾",id:2119,type:"multiplier",performance:{physics:.95,magic:.95,darkness:1},isFriendly:!0},{name:"强力守护",id:1719,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"哥布防御",id:2114,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"铜墙铁盾",id:194,type:"multiplier",performance:{physics:.8,magic:.8,darkness:1},isFriendly:!0},{name:"坚守要塞",id:195,type:"multiplier",performance:{physics:.6,magic:.6,darkness:1},isFriendly:!0},{name:"终极堡垒",id:196,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"原初大地",id:863,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"暗黑之力",id:864,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"灵魂之青",id:1931,type:"multiplier",performance:{physics:.2,magic:.2,darkness:1},isFriendly:!0},{name:"坦培拉涂层",id:3686,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"油性坦培拉涂层",id:3687,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"世界树之干",id:3890,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"建筑神之塔",id:3892,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0},{name:"太阳星座",id:3896,type:"multiplier",performance:{physics:.9,magic:.9,darkness:1},isFriendly:!0},{name:"神爱抚",id:3903,type:"absorbed",performance:{physics:1,magic:1,darkness:1},isFriendly:!0}],ta=[...ea],ra=new Map;let aa="Chinese";function na(e){if(aa!==e||0===ra.size){ra.clear();for(const t of"Chinese"===e?ea:ta){const e=Ie[t.id][1];t.fullIcon=Te(e),ra.set(t.id.toString(16).toUpperCase().padStart(2,"0"),t)}aa=e}}function oa(e){return ra.get(e)}function la(e,t){if("absorbed"===e.type)return"useful";if("dot"===t||"darkness"===t)return"unuseful";if(0===e.performance.darkness&&0===e.performance.magic&&0===e.performance.physics||1===e.performance.darkness&&1===e.performance.magic&&1===e.performance.physics)return"useful";const r="physics"===t?"magic":"physics";return 2*(100-100*e.performance[t])===100-100*e.performance[r]?"half-useful":1===e.performance[t]?"unuseful":"useful"}na("Chinese");function sa(e,t){return Object.entries(Ie).reduce((r,[a,[n,o]])=>(e.test(n)&&r.set(a,{name:n,icon:o,isFriendly:t}),r),new Map)}const ia=sa(/(?:耐性|防御力)(?:大幅)?(?:降低|提升|低下|下降)|受伤(?:加重|减轻)|体力(?:增加|衰减|减少)|伤害屏障/,!0),ca=sa(/(?:精神|力量|灵巧|智力){1,2}(?:大幅)?降低/,!1),da=xe("hash"),ua=J("keigennRecord2.1",{state:()=>({userOptions:{scale:r(()=>ma(da.scale,1)),opacity:r(()=>ma(da.opacity,.9)),targetType:r(()=>ma(da.targetType,"icon")),iconType:r(()=>ma(da.iconType,3)),parseAA:r(()=>ma(da.parseAA,!0)),parseDoT:r(()=>ma(da.parseDoT,!1)),minimize:r(()=>ma(da.minimize,!1)),actionCN:r(()=>ma(da.actionCN,!0)),statusCN:r(()=>ma(da.statusCN,!0))},isBrowser:!1}),getters:{icon4k:e=>e.userOptions.scale>=2||window.devicePixelRatio>=2?"_hr1":""},actions:{checkIsBrowser(){this.isBrowser=!window.OverlayPluginApi&&!da.OVERLAY_WS&&!da.HOST_PORT,this.isBrowser&&setTimeout(()=>this.checkIsBrowser(),1e3)},formatterName:e=>e,initEnvironment(e){/^[A-Z]\S+ [A-Z]\S+$/.test(e)?na("Global"):na("Chinese")}}});function ma(e,t){return"boolean"==typeof t?"0"!==e&&"false"!==e?.toLocaleLowerCase()&&("1"===e||"true"===e?.toLocaleLowerCase()||t):"number"==typeof t?Number.isNaN(+e)?t:+e:"string"==typeof t?e:t}function pa(e){return{dodge:"闪避","damage done":"击中","blocked damage":"格挡","parried damage":"招架","instant death":"即死",heal:"治疗","crit heal":"暴击治疗"}[e]}function ha(e){const t=function(e){switch(!0){case e.endsWith("33"):return"instant death";case/2\w{4}4$/.test(e):return"crit heal";case e.endsWith("1"):return"dodge";case e.endsWith("3"):return"damage done";case e.endsWith("4"):return"heal";case e.endsWith("5"):return"blocked damage";case e.endsWith("6"):return"parried damage";default:throw new Error(`Unknown effect flag ${e}`)}}(e),r=function(e){switch(!0){case/2\w{3}$/.test(e):return"crit damage";case/4\w{3}$/.test(e):return"direct hit damage";case/6\w{3}$/.test(e):return"crit direct hit damage";default:return"damage"}}(e),a=function(e){switch(!0){case/7?[1-4]\w{3}[35]$/.test(e):case/[16]$/.test(e):return"physics";case/^E$/.test(e):case/5\w{4}$/.test(e):return"magic";case/^(?:\d0)?3$/.test(e):case/6\w{4}$/.test(e):return"darkness";default:return"physics"}}(e);return{effect:t,properties:r,type:a}}const fa=["3E","113","213","313"],ya=["A10","E"],ga=["04"],wa=["01","03","05","06","36"];function va(e){let t=0,r=e[8]??"",a=e[9]??"";fa.includes(r)&&(t+=2,r=e[8+t]??r,a=e[8+t+1]??a),ya.includes(r)&&(t+=2,r=e[8+t]??r,a=e[8+t+1]??a);const n=function(e){if(void 0===e)return 0;const t=e.length;if(t<=4)return 0;let r=Number.parseInt(e.slice(0,t-4),16);if("4"===e[t-4]){const a=Number.parseInt(e.slice(t-2,t),16);r=r-a+(a<<16)}return r}(a),o=`00${r}`.slice(-2);return{amount:n,lowByte:o,flags:r,isHeal:ga.includes(o),isAttack:wa.includes(o)}}const ba=[Number(409).toString(16).toUpperCase(),Number(810).toString(16).toUpperCase(),Number(811).toString(16).toUpperCase(),Number(1836).toString(16).toUpperCase()];const xa={class:"amount"},Sa={class:"row-info"},Ra=ge(i({__name:"Amount",props:{row:{}},setup(e){const t=e,{amount:a,maxHp:n,currentHp:o,shield:l,source:s,type:i,keigenns:c,effect:d}=t.row,u=Math.round(n*+l/100),p=Math.round(o/n*100);let h=0;if("instant death"!==d&&"dodge"!==d){let e=1;"blocked damage"===d?e=.8:"parried damage"===d&&(e=.85);let t=1;for(const r of c)"absorbed"!==r.type&&(t*=r.performance[i]??1);h=1-t*e}const f=(a&&Math.round((a+u)/(1-h))||0).toLocaleString(),y=(100*h).toFixed(2),g=r(()=>a.toLocaleString()),w=i,v=(b=t.row).currentHp-b.amount<0&&!b.keigenns.find(e=>ba.includes(e.effectId));var b;const x=(()=>{const e=[u>0?"有盾不准":"",c.find(e=>e.name.includes("受伤加重"))?"不算易伤":""].filter(Boolean);return e.length?`（${e.join("、")}）`:""})();return(e,t)=>{const r=je,a=De;return Z(),Q(a,{"append-to":".wrapper",trigger:"hover",enterable:!1,"hide-after":0,width:180},{reference:ee(()=>[X("span",xa,[X("span",{class:ne(m(w))},[X("span",{class:ne({lethal:m(v)})},re(m(g)),3)],2)])]),default:ee(()=>[X("ul",Sa,[X("li",null,"伤害来源: "+re(m(s)),1),X("li",null,"玩家护盾: "+re(m(l))+"%",1),X("li",null,"玩家血量: "+re(m(p))+"%",1),m(h)<1&&"dot"!==m(i)?(Z(),Y(L,{key:0},[E(r),X("li",null,[t[0]||(t[0]=ae(" 玩家减伤率: ",-1)),X("strong",null,re(m(y))+"%",1)]),X("li",null,[t[1]||(t[1]=ae(" 倒推裸吃伤害: ",-1)),X("span",{class:ne(m(w))},re(m(f)),3)]),X("li",null,re(m(x)),1)],64)):te("",!0)])]),_:1})}}}),[["__scopeId","data-v-7f67f40d"]]),ka={key:0},Ca={key:1,class:"status-container"},Ia=["title","data-duration","data-sourcePov"],Ta=["src","alt"],Ea={class:"flags"},Ha=ge(i({__name:"StatusShow",props:{row:{type:Object,required:!0}},setup(e){const t=e,r=ua(),a=r.userOptions,n=r.icon4k;return(e,r)=>"dot"===t.row.type?(Z(),Y("div",ka," （不支持） ")):(Z(),Y("div",Ca,[(Z(!0),Y(L,null,oe(t.row.keigenns,(e,o)=>(Z(),Y("span",{key:o},[X("span",{class:"status",title:`${m(a).statusCN?e.name:e.effect}(${e.source})`,"data-duration":e.remainingDuration,"data-sourcePov":e.isPov},[X("img",{class:ne(`statusIcon ${m(la)(e,t.row.type)}`),src:m(Le)(`/i/${e.fullIcon}${m(n)}.png`),alt:e.effect,loading:"lazy",onError:r[0]||(r[0]=(...e)=>m(Me)&&m(Me)(...e))},null,42,Ta)],8,Ia)]))),128)),X("span",Ea,re("damage done"===t.row.effect?"":m(pa)(t.row.effect)),1)]))}}),[["__scopeId","data-v-9b1eaeae"]]),Fa={class:"target"},ja=["src","alt"],Da={key:1,class:"alt-text"},Ma=ge(i({__name:"Target",props:{row:{type:Object,required:!0}},setup(e){const t=e,a=ua(),n=d(!1);function o(e){n.value=!0;e.target.style.display="none"}const l=r(()=>!n.value&&"icon"===(a.userOptions.targetType??"icon"));return(e,r)=>{return Z(),Y("div",Fa,[m(l)?(Z(),Y("img",{key:0,class:ne(`jobIcon cj${m(a).userOptions.iconType}`),src:(n=t.row.jobIcon,s=m(a).userOptions.iconType,`https://souma.diemoe.net/resources/img/cj${s}/${n.replace(/([A-Z])/g," $1").trim()}.png`),alt:t.row.jobIcon,onError:o},null,42,ja)):(Z(),Y("span",Da,re(t.row.job),1))]);var n,s}}}),[["__scopeId","data-v-0c7a0405"]]),La="[取消筛选]",Aa=ge(i({__name:"Table",props:{rows:{},actionKey:{}},setup(e){const t=e,a=ua().userOptions,n=le("contextMenu"),o=d(""),l=d("");p(()=>t.rows,e=>{0===e.length&&(o.value="",l.value="")},{immediate:!0});const s=d(!1),i=d(0),c=d(0),u=d(null);Se(n,()=>{s.value=!1});const h=r(()=>[{label:"[取消筛选]",value:""},...Array.from(new Set(t.rows.map(e=>e[t.actionKey]))).map(e=>({label:e,value:e}))]),y=r(()=>[{label:"[取消筛选]",value:"",job:-1},...Array.from(new Map(t.rows.map(e=>[e.target,e])).values()).map(e=>({label:`${e.job}(${e.target})`,value:e.target,job:e.jobEnum}))].sort((e,t)=>Fe.enumSortMethod(e.job,t.job)));function g(){if(u.value){const e=u.value[t.actionKey];o.value===e?o.value="":o.value=e,s.value=!1}}function w(){if(u.value){const e=u.value.target;l.value===e?l.value="":l.value=e,s.value=!1}}const v=r(()=>t.rows.filter(e=>{const r=!o.value||o.value===La||e[t.actionKey]===o.value,a=!l.value||l.value===La||e.target===l.value;return r&&a})),b=r(()=>[{key:"time",title:"时间",dataKey:"time",width:40,align:"center",class:"col-time"},{key:"action",title:"技能",dataKey:t.actionKey,width:64,align:"center",class:"col-action",headerCellRenderer:()=>f("div",{class:"header-filter"},[f($e,{size:"small",modelValue:o.value,placeholder:"技能",clearable:!1,style:"width:4.5em",teleported:!1,onChange:e=>o.value=e===La?"":e},()=>h.value.map(e=>f(ze,{key:e.value,label:e.label,value:e.value})))]),cellRenderer:({rowData:e})=>f("span",e[t.actionKey]??"")},{key:"target",title:"职业",dataKey:"target",width:32,align:"center",class:"col-target",headerCellRenderer:()=>f("div",{class:"header-filter"},[f($e,{size:"small",modelValue:l.value,placeholder:"职业",clearable:!1,style:"width:4.7em;text-overflow:clip;white-space:nowrap",class:"col-target-select",teleported:!1,onChange:e=>{l.value=e===La?"":e}},()=>y.value.map(e=>f(ze,{key:e.value,label:e.label,value:e.value})))]),cellRenderer:({rowData:e})=>f(Ma,{row:e})},{key:"amount",title:"伤害",dataKey:"amount",width:45,align:"right",class:"col-amount",cellRenderer:({rowData:e})=>f(Ra,{row:e})},{key:"keigenns",title:"减伤",dataKey:"keigenns",width:100,align:"left",flexGrow:1,class:"col-keigenns",cellRenderer:({rowData:e})=>f(Ha,{row:e})}]);let x=null;const S=r(()=>({onClick:({rowData:e})=>{const{actionCN:t,amount:r,job:n,keigenns:o,time:l,type:s,effect:i,currentHp:c,maxHp:d,shield:u}=e,m="damage done"===i?"":`,${pa(i)}`,p=`${l} ${n} ${t} ${r.toLocaleString()}(${h=s,{physics:"物理",magic:"魔法",darkness:"暗黑",dot:"持续伤害"}[h]}) 减伤:${0===o.length&&""===m?"无":o.map(e=>a.statusCN?e.name:e.effect).join(",")+m} HP:${c}/${d}(${Math.round(c/d*100)}%)+盾:${Math.round(d*+u/100)}(${u}%)`;var h;He(p).then(()=>{x?.close(),x=ie.success({message:"复制成功",duration:800})}).catch(()=>ie.error("复制失败"))},onContextmenu:({rowData:e,event:t})=>{const r=t;u.value=e,i.value=r.clientX,c.value=r.clientY,s.value=!0}}));return(e,t)=>{const r=Zr,a=Xr;return Z(),Q(a,{style:{height:"100%",width:"100%"}},{default:ee(({height:t,width:a})=>[E(r,{"header-class":"keigenn-table-header",class:"keigenn-table",columns:b.value,data:v.value,width:a,height:t,"row-height":28,"header-height":24,"row-key":"key","scrollbar-always-on":"","row-event-handlers":S.value},null,8,["columns","data","width","height","row-event-handlers"]),m(s)?(Z(),Y("div",{key:0,ref_key:"contextMenu",ref:n,class:"context-menu",style:se({top:`${m(c)}px`,left:`${m(i)}px`})},[X("ul",null,[X("li",{onClick:g},re(m(o)===(m(u)?.[e.actionKey]??"")?`取消筛选 [${m(u)?.[e.actionKey]??"此技能"}]`:`只看 [${m(u)?.[e.actionKey]??"此技能"}]`),1),X("li",{onClick:w},re(m(l)===m(u)?.target?`取消筛选 [${m(u)?.job??"此职业"}]`:`只看 [${m(u)?.job??"此职业"}]`),1)])],4)):te("",!0)]),_:1})}}}),[["__scopeId","data-v-75e2ce20"]]),Na=(e,t)=>t.some(t=>e instanceof t);let Oa,Wa;const $a=new WeakMap,za=new WeakMap,Ka=new WeakMap;let Ba={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return $a.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Va(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Pa(e){Ba=e(Ba)}function Ga(e){return(Wa||(Wa=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(qa(this),t),Va(this.request)}:function(...t){return Va(e.apply(qa(this),t))}}function _a(e){return"function"==typeof e?Ga(e):(e instanceof IDBTransaction&&function(e){if($a.has(e))return;const t=new Promise((t,r)=>{const a=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",o),e.removeEventListener("abort",o)},n=()=>{t(),a()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",n),e.addEventListener("error",o),e.addEventListener("abort",o)});$a.set(e,t)}(e),Na(e,Oa||(Oa=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Ba):e)}function Va(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,r)=>{const a=()=>{e.removeEventListener("success",n),e.removeEventListener("error",o)},n=()=>{t(Va(e.result)),a()},o=()=>{r(e.error),a()};e.addEventListener("success",n),e.addEventListener("error",o)});return Ka.set(t,e),t}(e);if(za.has(e))return za.get(e);const t=_a(e);return t!==e&&(za.set(e,t),Ka.set(t,e)),t}const qa=e=>Ka.get(e);const Ua=["get","getKey","getAll","getAllKeys","count"],Ya=["put","add","delete","clear"],Za=new Map;function Xa(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Za.get(t))return Za.get(t);const r=t.replace(/FromIndex$/,""),a=t!==r,n=Ya.includes(r);if(!(r in(a?IDBIndex:IDBObjectStore).prototype)||!n&&!Ua.includes(r))return;const o=async function(e,...t){const o=this.transaction(e,n?"readwrite":"readonly");let l=o.store;return a&&(l=l.index(t.shift())),(await Promise.all([l[r](...t),n&&o.done]))[0]};return Za.set(t,o),o}Pa(e=>({...e,get:(t,r,a)=>Xa(t,r)||e.get(t,r,a),has:(t,r)=>!!Xa(t,r)||e.has(t,r)}));const Ja=["continue","continuePrimaryKey","advance"],Qa={},en=new WeakMap,tn=new WeakMap,rn={get(e,t){if(!Ja.includes(t))return e[t];let r=Qa[t];return r||(r=Qa[t]=function(...e){en.set(this,tn.get(this)[t](...e))}),r}};async function*an(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const r=new Proxy(t,rn);for(tn.set(r,t),Ka.set(r,qa(t));t;)yield r,t=await(en.get(r)||t.continue()),en.delete(r)}function nn(e,t){return t===Symbol.asyncIterator&&Na(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&Na(e,[IDBIndex,IDBObjectStore])}Pa(e=>({...e,get:(t,r,a)=>nn(t,r)?an:e.get(t,r,a),has:(t,r)=>nn(t,r)||e.has(t,r)}));let on=null;async function ln(e){return on||(on=function(e,t,{blocked:r,upgrade:a,blocking:n,terminated:o}={}){const l=indexedDB.open(e,t),s=Va(l);return a&&l.addEventListener("upgradeneeded",e=>{a(Va(l.result),e.oldVersion,e.newVersion,Va(l.transaction),e)}),r&&l.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),s.then(e=>{o&&e.addEventListener("close",()=>o()),n&&e.addEventListener("versionchange",e=>n(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}("souma",1,{upgrade(t){t.objectStoreNames.contains(e)||t.createObjectStore(e,{keyPath:"key"})}})),on}const sn="function"==typeof structuredClone?structuredClone:e=>{if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e.source,e.flags);if(Array.isArray(e))return e.map(e=>sn(e));if(Object.getPrototypeOf(e)===Object.prototype){const t={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=sn(e[r]));return t}return e},cn={class:"header-select"},dn={style:{height:"100%"}},un={key:0,class:"testLog"},mn=ge(i({__name:"keigennRecord2",setup(e){const t=Ke(),a=ua(),n=a.userOptions;a.checkIsBrowser();const o=d(n.minimize),l=r(()=>n.actionCN?"actionCN":"action"),s=d(!1),i=Re("keigenn-record-2-pov-name",""),c=Re("keigenn-record-2-pov-id",""),u=Re("keigenn-record-2-party-list",[]),p=Re("keigenn-record-2-job-map",{}),h=Re("keigenn-record-2-party-event-party",[]),f=d(0),g=d([{zoneName:"",duration:"00:00",table:ce([]),key:"init",timestamp:-1}]),w={rsv:/^262\|(?<timestamp>[^|]*)\|[^|]*\|[^|]*\|_rsv_(?<id>\d+)_[^|]+\|(?<real>[^|]*)\|/i,ability:Ge.ability(),statusEffectExplicit:Ge.statusEffectExplicit(),gainsEffect:Ge.gainsEffect(),losesEffect:Ge.losesEffect(),inCombat:/^260\|(?<timestamp>[^|]*)\|(?<inACTCombat>[^|]*)\|(?<inGameCombat>[^|]*)\|/,changeZone:Ge.changeZone(),partyList:/^11\|(?<timestamp>[^|]*)\|(?<partyCount>\d*)\|(?<list>(?:\w{8}\|)*)\w{16}/,primaryPlayer:/^02\|(?<timestamp>[^|]*)\|(?<id>[^|]*)\|(?<name>[^|]*)/,addCombatant:Ge.addedCombatant(),removingCombatant:Ge.removingCombatant(),networkDoT:Ge.networkDoT()},v=d(0),b=Re("souma-keigenn-record-2-zone-name",""),x=Re("souma-keigenn-record-2-rsv-data",{}),S={},R={friendly:{},enemy:{}},k=function(e){const t=async t=>t(await ln(e));return{getAll:()=>t(t=>t.getAll(e)),get:r=>t(t=>t.get(e,r)),set:r=>t(t=>t.put(e,r)),bulkSet:r=>t(async t=>{const a=t.transaction(e,"readwrite");for(const e of r)a.store.put(e);await a.done}),remove:r=>t(t=>t.delete(e,r)),clear:()=>t(t=>t.clear(e))}}("keigenn-record-2");function C(){s.value=!0,v.value=0,f.value=0,g.value.length=0,g.value.push({zoneName:"",duration:"00:00",table:ce([]),key:"init",timestamp:-1})}function I(){s.value=!1,M()}function T(e){for(const t in w){const r=w[t].exec(e);if(r){const o=e.split("|");switch(t){case"statusEffectExplicit":r.groups?.targetId.startsWith("1")&&(S[r.groups.targetId]=r.groups.currentShield);break;case"gainsEffect":{const e=o[Pe.GainsEffect.fields.effectId],t=o[Pe.GainsEffect.fields.effect],r=o[Pe.GainsEffect.fields.target],a=o[Pe.GainsEffect.fields.targetId],n=Number.parseInt(o[Pe.GainsEffect.fields.count],16);let l=oa(e);if(!l){const t=a.startsWith("1")&&ia.get(Number.parseInt(e,16).toString())||a.startsWith("4")&&ca.get(Number.parseInt(e,16).toString());if(!t)return;const r=Te(t.icon),o=n>1?Ee(r,n):r;l={type:"multiplier",performance:{physics:1,magic:1,darkness:1},id:Number.parseInt(e,16),fullIcon:o,name:t.name,isFriendly:t.isFriendly}}const s=o[Pe.GainsEffect.fields.duration],i=o[Pe.GainsEffect.fields.source],d=o[Pe.GainsEffect.fields.sourceId],u=new Date(o[Pe.GainsEffect.fields.timestamp]).getTime()+1e3*Number.parseFloat(s),m={name:l.name,type:l.type,count:n,effect:t,effectId:e,source:i,sourceId:d,target:r,targetId:a,expirationTimestamp:u,performance:l.performance,fullIcon:l.fullIcon,isPov:c.value===d};a.startsWith("1")&&l.isFriendly?(void 0===R.friendly[a]&&(R.friendly[a]={}),R.friendly[a][e]=m):a.startsWith("4")&&!l.isFriendly&&(void 0===R.enemy[r]&&(R.enemy[r]={}),R.enemy[r][e]=m)}break;case"losesEffect":{const e=o[Pe.LosesEffect.fields.target],t=o[Pe.LosesEffect.fields.targetId],r=o[Pe.LosesEffect.fields.effectId];t.startsWith("1")?R.friendly[t]&&Reflect.deleteProperty(R.friendly[t],r):R.enemy[e]&&Reflect.deleteProperty(R.enemy[e],r)}break;case"addCombatant":if("00"!==o[Pe.AddedCombatant.fields.job]){const e=o[Pe.AddedCombatant.fields.job],t=new Date(o[Pe.AddedCombatant.fields.timestamp]).getTime();p.value[o[Pe.AddedCombatant.fields.id]]={job:Number.parseInt(e,16),timestamp:t}}break;case"removingCombatant":Reflect.deleteProperty(p.value,o[Pe.RemovedCombatant.fields.id]);break;case"primaryPlayer":{c.value=o[Pe.ChangedPlayer.fields.id];const e=o[Pe.ChangedPlayer.fields.name];if(i.value===e)return;i.value=e,a.initEnvironment(o[Pe.ChangedPlayer.fields.name])}break;case"partyList":u.value=r.groups?.list?.split("|")??[];break;case"changeZone":b.value=o[Pe.ChangeZone.fields.name],D(new Date(o[Pe.ChangeZone.fields.timestamp]).getTime());break;case"inCombat":{const e="1"===o[Pe.InCombat.fields.inACTCombat],t="1"===o[Pe.InCombat.fields.inGameCombat],r=new Date(o[Pe.InCombat.fields.timestamp]).getTime();if(e||t){if(v.value>0)return;return"placeholder"===g.value[0].key&&g.value.splice(0,1),0!==g.value[0].table.length&&g.value.unshift({zoneName:"",duration:"00:00",table:ce([]),key:o[Pe.InCombat.fields.timestamp],timestamp:r}),v.value=r,g.value[0].zoneName=b.value,void(f.value=0)}if(!e&&!t)return void D(r)}break;case"rsv":{const e=Number(r.groups?.id),t=o[Pe.RSVData.fields.value];e&&t&&(x.value[Number(e)]=t)}break;case"networkDoT":if(!n.parseDoT)return;{const e=o[Pe.NetworkDoT.fields.which],t=o[Pe.NetworkDoT.fields.id];if("DoT"!==e||t.startsWith("4")||t!==c.value&&!u.value.includes(t)&&!h.value.find(e=>e.id===t))return;const r=o[Pe.NetworkDoT.fields.name],a=o[Pe.NetworkDoT.fields.damage],n=Number.parseInt(a,16),l=new Date(o[Pe.Ability.fields.timestamp]??"???").getTime(),s=Number(o[Pe.NetworkDoT.fields.currentHp]),i=Number(o[Pe.NetworkDoT.fields.maxHp]),d=A(0===v.value?0:l-v.value),m=H(t),p=Fe.jobToFullName(Fe.jobEnumToJob(m)).simple2,f=m,y=Fe.jobEnumToIcon(f);j({key:g.value[0].table.length.toString(),time:d,id:void 0,action:e,actionCN:e,source:"",target:r,targetId:t,job:p,jobIcon:y,jobEnum:f,amount:n,keigenns:[],currentHp:s,maxHp:i,effect:"damage done",type:"dot",shield:S[t]??"0",povId:c.value})}break;case"ability":if(0===v.value)return;{const e=va(o);if(e.isAttack&&e.amount>=0){const t=o[Pe.Ability.fields.sourceId]??"???",a=o[Pe.Ability.fields.targetId]??"???";if(!t.startsWith("4")||!a.startsWith("1"))return;if(a!==c.value&&!u.value.includes(a)&&!h.value.find(e=>e.id===a))return;const l=new Date(o[Pe.Ability.fields.timestamp]??"???").getTime(),s=o[Pe.Ability.fields.ability],i=s.match(/^_rsv_(?<id>\d+)_/),d=o[Pe.Ability.fields.id]??"???";let m=s;if(i){const e=Number(i.groups?.id);m=x.value[e]??s.match(/^_(?<id>rsv_\d+)_/)?.groups?.id}else if(m=m.replace(/unknown_.*/,"攻击"),!1===n.parseAA&&/^攻击|攻撃|[Aa]ttack$/.test(m))return;const p=Be(Number.parseInt(d,16)),f=p&&""!==p?p:m,y=Number(o[Pe.Ability.fields.targetCurrentHp])??"???",w=Number(o[Pe.Ability.fields.targetMaxHp])??"???",b=o[Pe.Ability.fields.source]??"???",k=o[Pe.Ability.fields.target]??"???",{effect:C,type:I}=ha(e.flags),T=A(0===v.value?0:l-v.value),E=H(a),F=Fe.jobToFullName(Fe.jobEnumToJob(E)).simple2,D=E,M=Fe.jobEnumToIcon(D),L=sn(Object.values(R.friendly[a]??[]).concat(Object.values(R.enemy[b]??[])).filter(e=>{const t=Math.max(0,(e.expirationTimestamp-l)/1e3);return e.remainingDuration=t>=999?"":t.toFixed(t>.05&&t<.95?1:0),Number(e.remainingDuration)>-3}));j({key:g.value[0].table.length.toString(),time:T,id:d,action:m,actionCN:f,source:b,target:k,targetId:a,job:F,jobIcon:M,jobEnum:D,amount:e.amount,keigenns:L,currentHp:y,maxHp:w,effect:C,type:I,shield:S[r.groups.targetId]??"0",povId:c.value}),g.value[0].duration=A(new Date(o[Pe.Ability.fields.timestamp]).getTime()-v.value)}}}}}}function H(e){return[p.value[e],h.value.find(t=>t.id===e)??{job:0,timestamp:0}].sort((e,t)=>t.timestamp-e.timestamp)[0].job}function j(e){g.value[0].table.unshift(e)}function D(e){0!==v.value&&(g.value[0].duration=A(e-v.value),g.value[0]=fe(g.value[0]),v.value=0,R.friendly={},R.enemy={},M())}async function M(){if(s.value)return;const e=g.value.filter(e=>"placeholder"!==e.key&&e.timestamp>0).map(e=>{const t=Array.isArray(e.table)?ye(e.table):[];return{...ye(e),table:t}});await k.clear(),await k.bulkSet(e)}function A(e){const t=Math.max(Math.floor(e/6e4),0),r=Math.max(Math.floor((e-6e4*t)/1e3),0);return`${t<10?"0":""}${t}:${r<10?"0":""}${r}`}function N(){o.value=!o.value}function O(){g.value.unshift({zoneName:"",duration:"00:00",table:ce([]),key:"test",timestamp:Date.now()}),f.value=0}return a.isBrowser&&(i.value="测试用户"),""!==i.value&&a.initEnvironment(i.value),F(()=>{const e=ke({storageKey:"keigenn-record-2-theme"}),t=Ce(e);!1===e.value&&t();for(const r in p.value){const e=p.value[r];Date.now()-e.timestamp>864e5&&Reflect.deleteProperty(p.value,r)}!async function(){try{const e=await k.getAll();e.length&&(g.value.length=0,g.value.push(...e.reverse()))}catch(e){throw g.value.length=0,e}}(),_e("LogLine",e=>{T(e.rawLine)}),_e("PartyChanged",e=>{h.value=e.party.map(e=>({...e,timestamp:Date.now()}))}),_e("ChangePrimaryPlayer",e=>{i.value=e.charName,c.value=Number(e.charID).toString(16).toUpperCase()})}),(e,r)=>{const s=ze,i=$e,c=Ve,d=Aa,u=Qr;return Z(),Y(L,null,[X("div",{class:"wrapper",style:se({"--scale":m(n).scale,"--opacity":m(n).opacity}),onContextmenu:r[1]||(r[1]=y(()=>{},["prevent"]))},[X("header",null,[X("div",cn,[de(E(i,{modelValue:m(f),"onUpdate:modelValue":r[0]||(r[0]=e=>me(f)?f.value=e:null),size:"small",class:ne(["combat-select",m(a).isBrowser?"browser":"act"]),"popup-class-name":"combat-select-popup",offset:0,"show-arrow":!1},{default:ee(()=>[(Z(!0),Y(L,null,oe(m(g).length,e=>(Z(),Q(s,{key:`${m(g)[e-1].key}-${m(g)[e-1].duration}-${m(g)[e-1].zoneName}`,value:e-1,label:`${m(g)[e-1].duration} ${m(g)[e-1].zoneName}`},null,8,["value","label"]))),128))]),_:1},8,["modelValue","class"]),[[ue,!m(o)]])]),m(a).isBrowser?te("",!0):(Z(),Q(c,{key:0,class:ne(["minimize",m(o)?"in-minimize":"not-minimize"]),icon:m(o)?m(pe):m(he),circle:"",style:se({opacity:m(o)?.5:1}),onClick:N},null,8,["class","icon","style"]))]),de(X("main",dn,[E(d,{rows:m(g)[m(f)].table,"action-key":m(l)},null,8,["rows","action-key"])],512),[[ue,!m(o)]])],36),m(a).isBrowser||m(t)?(Z(),Y("div",un,[m(t)?(Z(),Q(c,{key:0,onClick:O},{default:ee(()=>r[2]||(r[2]=[ae(" 测试 ",-1)])),_:1,__:[2]})):te("",!0),E(u,{"m-1":"",onBeforeHandle:C,onAfterHandle:I,onHandleLine:T})])):te("",!0)],64)}}}),[["__scopeId","data-v-0d664694"]]);export{mn as default};
