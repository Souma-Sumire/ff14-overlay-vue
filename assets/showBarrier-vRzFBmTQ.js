import{_ as e}from"./DragJob-pdvFOXUD.js";import{t as r,av as a,r as t,c as i,f as n,w as s,v as o,x as u,A as l,F as c,L as p,a9 as m,u as v,O as d,M as f,K as b,S as g}from"./vue-vendor-Bp7_Yb1I.js";import{j as h}from"./util-u6u0BslC.js";import{N as x}from"./netregexes-BPXJ-L2_.js";import{a as y}from"./overlay_plugin_api-DHbPkDtN.js";import{u as j}from"./index-CPPE20Uu.js";import{_ as w}from"./_plugin-vue_export-helper-BCo6x5W8.js";const P=w(r({__name:"showBarrier",setup(r){a(e=>({"21bf6ff8":v(S),e74d3e0e:v(N)}));const w={statusEffectExplicit:x.statusEffectExplicit()};let P=0;const _=t([]),E=t(""),A=t(window.location.href),I=i(()=>new URLSearchParams(A.value.split("?")[1])),L=i(()=>"1"===I.value.get("showSettings")),S=i(()=>40*Number(I.value.get("lineHeight")||1)+"px"),N=i(()=>`${Number(I.value.get("fontSize")||26)}px`),$=i(()=>I.value.get("type")||"1");const C=j("cactbotRuntime-sortArr",h);function U(e){C.value=e}function O(){_.value.sort((e,r)=>e.id===E.value?-1:r.id===E.value?1:e.job===r.job?r.id.localeCompare(e.id):C.value.indexOf(e.job)-C.value.indexOf(r.job))}function R(e){return"1"===$.value?`${e.barrierPercent}`:"2"===$.value?`${e.barrierAmount}`:`${e.barrierPercent}%(${e.barrierAmount})`}return n(()=>{y("LogLine",e=>{!function(e){const r=w.statusEffectExplicit.exec(e);if(r?.groups?.targetId.startsWith("1")){const e=_.value.find(e=>e.id===r.groups?.targetId);e&&(e.barrierPercent=Number(r.groups?.currentShield),e.barrierAmount=Math.round(Number(r.groups?.maxHp)*e.barrierPercent/100))}}(e.rawLine)}),y("PartyChanged",e=>{_.value=e.party.filter(e=>e.inParty).map(e=>({...e,barrierPercent:0,barrierAmount:0}))}),y("ChangePrimaryPlayer",e=>{E.value=Number(e.charID).toString(16).toUpperCase()}),s([_,E,C],()=>{clearInterval(P),E.value?O():P=setInterval(()=>{E.value&&(O(),clearInterval(P))},100)},{immediate:!0}),window.addEventListener("hashchange",e=>A.value=e.newURL)}),(r,a)=>{const t=e;return u(),o("div",null,[l("ul",null,[(u(!0),o(p,null,m(v(_),e=>(u(),o("li",{key:e.id},[c(l("span",{"m-r-2":""},b(e.name),513),[[d,v(L)]]),l("span",{style:g(0===e.barrierPercent?{opacity:.25,color:"white"}:{opacity:1,color:"#f5da3c"})},b(R(e)),5)]))),128))]),c(f(t,{style:{"z-index":"10000"},party:v(_),"m-b-1":"","p-1":"",onUpdateSortArr:U},null,8,["party"]),[[d,v(L)]])])}}}),[["__scopeId","data-v-243d7cc7"]]);export{P as default};
