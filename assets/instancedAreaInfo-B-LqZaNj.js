import{_ as e}from"./ActWrapper-Dbt0zKSA.js";import{a as t,r as a,c as n}from"./overlay_plugin_api-DHbPkDtN.js";import{d as s,f as i,i as o,bk as c,k as r,w as m,o as l,c as u,D as p,u as d,t as f}from"./index-8J91msG_.js";import{_ as I}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./el-card-CoW-4QKd.js";import"./useDev-TY9WaPms.js";import"./useDemo-Bmo9jFY9.js";const g={key:0},D={key:1},_=I(s({__name:"instancedAreaInfo",setup(s){const I=i({islandId:0,instanceNum:""}),_=[732,763,795,827,920,975,1252],h=Object.fromEntries(_.map(e=>[e,new Map])),b=async e=>{if(!_.includes(e.zoneID))return void(I.islandId=0);const t=(await n({call:"getCombatants"})).combatants.filter(e=>e.Name&&e.ID&&e.ID.toString(16).startsWith("4")&&["木人","striking dummy"].includes(e.Name)).sort((e,t)=>e.ID-t.ID)[0];if(!t)return;const a=t.ID-1073741824,s=Date.now(),i=h[e.zoneID],o=i.get(a);if(I.islandId=a,o){const e=s-o.timestamp,t=`这个岛${e<6e4?`${Math.floor(e/1e3)}秒`:`${Math.floor(e/6e4)}分钟`}前来过，是第${o.count}个遇到的岛`;o.timestamp=s,n({call:"cactbotSay",text:t})}else{i.set(a,{timestamp:s,count:i.size+1});const e=`这个岛第一次来，现在总共遇到了${i.size}个岛`;n({call:"cactbotSay",text:e})}},j={"":"①","":"②","":"③","":"④","":"⑤","":"⑥","":"⑦","":"⑧","":"⑨"},y=e=>{if("00"===e.line[0]&&"0039"===e.line[2]){const t=e.line[4].match(/当前所在副本区为“([^”]+)(?<instance>[])”/)??e.line[4].match(/You are now in the instanced area (.+?)(?<instance>[])”/)??e.line[4].match(/インスタンスエリア「(.+?)(?<instance>[])」/);t&&(I.instanceNum=j[t.groups?.instance])}else"01"===e.line[0]&&(I.instanceNum="")};return o(()=>{t("LogLine",y),t("ChangeZone",b)}),c(()=>{a("LogLine",y),a("ChangeZone",b)}),(t,a)=>{const n=e;return l(),r(n,null,{default:m(()=>[d(I).instanceNum?(l(),u("p",g,f(d(I).instanceNum),1)):p("",!0),d(I).islandId?(l(),u("p",D,f(d(I).islandId)+"号岛 ",1)):p("",!0)]),_:1})}}}),[["__scopeId","data-v-cbb21785"]]);export{_ as default};
