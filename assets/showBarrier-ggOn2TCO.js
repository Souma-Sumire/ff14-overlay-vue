import{c as e,d as a,_ as r}from"./shared-common-epuQhnIK.js";import{o as t,B as s,A as n,v as i,J as o,r as l,ds as u,u as c,c as d,t as m,K as p,H as v,R as b,am as f,V as g,Z as h,_ as y,L as w,I as x}from"./vendor-vue-GqahCgpc.js";import{c as P}from"./shared-core-C_PmX05s.js";import{N as j,a as I}from"./cactbot-CmNinDrW.js";import"./vendor-element-plus-DIlhOlLn.js";const E=r(t({__name:"showBarrier",setup(r){u(e=>({v38cc43cb:c(C),eae0bb00:c(H)}));const t=P(),E={statusEffectExplicit:j.statusEffectExplicit()};let L=0;const _=l([]),N=l(""),A=l(window.location.href),S=d(()=>new URLSearchParams(A.value.split("?")[1])),$=d(()=>"1"===S.value.get("showSettings")),C=d(()=>40*Number(S.value.get("lineHeight")||1)+"px"),H=d(()=>`${Number(S.value.get("fontSize")||26)}px`),R=d(()=>S.value.get("type")||"1");function U(){_.value.sort((e,a)=>e.id===N.value?-1:a.id===N.value?1:e.job===a.job?a.id.localeCompare(e.id):t.arr.indexOf(e.job)-t.arr.indexOf(a.job))}function z(e){return"1"===R.value?`${e.barrierPercent}`:"2"===R.value?`${e.barrierAmount}`:`${e.barrierPercent}%(${e.barrierAmount})`}return s(()=>{I("LogLine",e=>{!function(e){const a=E.statusEffectExplicit.exec(e);if(a?.groups?.targetId.startsWith("1")){const e=_.value.find(e=>e.id===a.groups?.targetId);e&&(e.barrierPercent=Number(a.groups?.currentShield),e.barrierAmount=Math.round(Number(a.groups?.maxHp)*e.barrierPercent/100))}}(e.rawLine)}),I("PartyChanged",e=>{_.value=e.party.filter(e=>e.inParty).map(e=>({...e,barrierPercent:0,barrierAmount:0}))}),I("ChangePrimaryPlayer",e=>{N.value=Number(e.charID).toString(16).toUpperCase()}),n([_,N,t.arr],()=>{clearInterval(L),N.value?U():L=window.setInterval(()=>{N.value&&(U(),clearInterval(L))},100)},{immediate:!0}),window.addEventListener("hashchange",e=>A.value=e.newURL)}),(r,t)=>{const s=a,n=e;return m(),i(n,null,{default:o(()=>[p("div",null,[p("ul",null,[(m(!0),v(b,null,f(c(_),e=>(m(),v("li",{key:e.id},[g(p("span",{"m-r-2":""},h(e.name),513),[[y,c($)]]),p("span",{style:w(0===e.barrierPercent?{opacity:.25,color:"white"}:{opacity:1,color:"#f5da3c"})},h(z(e)),5)]))),128))]),g(x(s,{style:{"z-index":"10000"},party:c(_),"m-b-1":"","p-1":""},null,8,["party"]),[[y,c($)]])])]),_:1})}}}),[["__scopeId","data-v-d26e0ae1"]]);export{E as default};
