import{_ as e}from"./ActWrapper-C4mLrMUb.js";import{_ as t}from"./LanguageSwitcher-ydyeXnCL.js";import{_ as n}from"./ThemeToggle-CG7U89C8.js";import{g as o,a as s,c as r}from"./_commonjsHelpers-CLPN-Npl.js";import{u as a}from"./useDev-CtxOMi7C.js";import{u as i,C as c}from"./useZone-YpGpDEPz.js";import{l}from"./regexes-Blkj7yOl.js";import{N as u,c as d}from"./netregexes-DsAXea56.js";import{a as p,r as f}from"./overlay_plugin_api-DHbPkDtN.js";import{u as h}from"./useLang-bNkybWrz.js";import{d as m,g as b,r as g,i as w,aG as v,h as C,k as y,w as _,f as S,E as x,o as k,c as F,u as E,a as P,F as j,s as V,t as O,b as A,e as B,G as R}from"./index-Bs3XIB3F.js";import{E as z}from"./index-tBDSrn0H.js";import{E as M}from"./index-CaUuAK62.js";import{E as L}from"./index-C4zhJhmZ.js";import{b as U}from"./index-Bz7dwT_2.js";import{a as D,E as N}from"./index-DTZy2fJe.js";import{E as T}from"./validator-DYioAUWj.js";import{E as I}from"./index-B_R2Nlmj.js";import{E as W,a as H}from"./index-BOPHr8VT.js";import{E as q}from"./index-DqIUJhEb.js";import{E as $,a as G}from"./index-BGJoIjyK.js";import{E as Z}from"./index-h3AzMtO6.js";import{E as J}from"./index-DMsLiMTj.js";import{_ as Y}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./useDemo-odHMXSXp.js";import"./index-DHehZtk9.js";import"./index-BW_gcwg_.js";import"./index-B9-ZbzyL.js";import"./index-DT3FD6qN.js";import"./focus-trap-8Wmz_1SC.js";import"./use-form-common-props-BYsbxE8U.js";import"./index-BlYvX-Xe.js";import"./index-BRg-LbDb.js";import"./vnode-wg55JEEe.js";import"./zoneInfo-Kvs06RCG.js";import"./zone_info-C8YMEhdS.js";import"./content_type-uhloenTS.js";import"./index-6PCuaXNn.js";import"./_baseClone-3Nn7y7lt.js";import"./index-6arRNwRy.js";var K,Q,X,ee,te,ne={exports:{}};function oe(){if(Q)return K;Q=1;var e=1e3,t=60*e,n=60*t,o=24*n,s=7*o,r=365.25*o;function a(e,t,n,o){var s=t>=1.5*n;return Math.round(e/n)+" "+o+(s?"s":"")}return K=function(i,c){c=c||{};var l=typeof i;if("string"===l&&i.length>0)return function(a){if((a=String(a)).length>100)return;var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(a);if(!i)return;var c=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*r;case"weeks":case"week":case"w":return c*s;case"days":case"day":case"d":return c*o;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*t;case"seconds":case"second":case"secs":case"sec":case"s":return c*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(i);if("number"===l&&isFinite(i))return c.long?function(s){var r=Math.abs(s);if(r>=o)return a(s,r,o,"day");if(r>=n)return a(s,r,n,"hour");if(r>=t)return a(s,r,t,"minute");if(r>=e)return a(s,r,e,"second");return s+" ms"}(i):function(s){var r=Math.abs(s);if(r>=o)return Math.round(s/o)+"d";if(r>=n)return Math.round(s/n)+"h";if(r>=t)return Math.round(s/t)+"m";if(r>=e)return Math.round(s/e)+"s";return s+"ms"}(i);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(i))}}const se=o((te||(te=1,function(e,t){var n={};t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let o=0,s=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(o++,"%c"===e&&(s=o))}),t.splice(s,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(n){}},t.load=function(){let e;try{e=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch(o){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=n.DEBUG),e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0)}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=(ee?X:(ee=1,X=function(e){function t(e){let o,s,r,a=null;function i(...e){if(!i.enabled)return;const n=i,s=Number(new Date),r=s-(o||s);n.diff=r,n.prev=o,n.curr=s,o=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(o,s)=>{if("%%"===o)return"%";a++;const r=t.formatters[s];if("function"==typeof r){const t=e[a];o=r.call(n,t),e.splice(a,1),a--}return o}),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return i.namespace=e,i.useColors=t.useColors(),i.color=t.selectColor(e),i.extend=n,i.destroy=t.destroy,Object.defineProperty(i,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(s!==t.namespaces&&(s=t.namespaces,r=t.enabled(e)),r),set:e=>{a=e}}),"function"==typeof t.init&&t.init(i),i}function n(e,n){const o=t(this.namespace+(void 0===n?":":n)+e);return o.log=this.log,o}function o(e,t){let n=0,o=0,s=-1,r=0;for(;n<e.length;)if(o<t.length&&(t[o]===e[n]||"*"===t[o]))"*"===t[o]?(s=o,r=n,o++):(n++,o++);else{if(-1===s)return!1;o=s+1,r++,n=r}for(;o<t.length&&"*"===t[o];)o++;return o===t.length}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names,...t.skips.map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const o of n)"-"===o[0]?t.skips.push(o.slice(1)):t.names.push(o)},t.enabled=function(e){for(const n of t.skips)if(o(e,n))return!1;for(const n of t.names)if(o(e,n))return!0;return!1},t.humanize=oe(),t.destroy=function(){},Object.keys(e).forEach(n=>{t[n]=e[n]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}))(t);const{formatters:o}=e.exports;o.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}(ne,ne.exports)),ne.exports));var re,ae={exports:{}};const ie=o((re||(re=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function o(){}function s(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(e,t,o,r,a){if("function"!=typeof o)throw new TypeError("The listener must be a function");var i=new s(o,r||e,a),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],i]:e._events[c].push(i):(e._events[c]=i,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new o:delete e._events[t]}function i(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(n=!1)),i.prototype.eventNames=function(){var e,o,s=[];if(0===this._eventsCount)return s;for(o in e=this._events)t.call(e,o)&&s.push(n?o.slice(1):o);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(e)):s},i.prototype.listeners=function(e){var t=n?n+e:e,o=this._events[t];if(!o)return[];if(o.fn)return[o.fn];for(var s=0,r=o.length,a=new Array(r);s<r;s++)a[s]=o[s].fn;return a},i.prototype.listenerCount=function(e){var t=n?n+e:e,o=this._events[t];return o?o.fn?1:o.length:0},i.prototype.emit=function(e,t,o,s,r,a){var i=n?n+e:e;if(!this._events[i])return!1;var c,l,u=this._events[i],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,o),!0;case 4:return u.fn.call(u.context,t,o,s),!0;case 5:return u.fn.call(u.context,t,o,s,r),!0;case 6:return u.fn.call(u.context,t,o,s,r,a),!0}for(l=1,c=new Array(d-1);l<d;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var p,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,o);break;case 4:u[l].fn.call(u[l].context,t,o,s);break;default:if(!c)for(p=1,c=new Array(d-1);p<d;p++)c[p-1]=arguments[p];u[l].fn.apply(u[l].context,c)}}return!0},i.prototype.on=function(e,t,n){return r(this,e,t,n,!1)},i.prototype.once=function(e,t,n){return r(this,e,t,n,!0)},i.prototype.removeListener=function(e,t,o,s){var r=n?n+e:e;if(!this._events[r])return this;if(!t)return a(this,r),this;var i=this._events[r];if(i.fn)i.fn!==t||s&&!i.once||o&&i.context!==o||a(this,r);else{for(var c=0,l=[],u=i.length;c<u;c++)(i[c].fn!==t||s&&!i[c].once||o&&i[c].context!==o)&&l.push(i[c]);l.length?this._events[r]=1===l.length?l[0]:l:a(this,r)}return this},i.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new o,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=n,i.EventEmitter=i,e.exports=i}(ae)),ae.exports));var ce=null;"undefined"!=typeof WebSocket?ce=WebSocket:"undefined"!=typeof MozWebSocket?ce=MozWebSocket:"undefined"!=typeof global?ce=global.WebSocket||global.MozWebSocket:"undefined"!=typeof window?ce=window.WebSocket||window.MozWebSocket:"undefined"!=typeof self&&(ce=self.WebSocket||self.MozWebSocket);var le={exports:{}};var ue={exports:{}};const de=s(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var pe;function fe(){return pe||(pe=1,ue.exports=(e=e||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==r&&r.crypto&&(n=r.crypto),!n)try{n=de}catch(b){}var o=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(b){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(b){}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),a={},i=a.lib={},c=i.Base=function(){return{extend:function(e){var t=s(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),l=i.WordArray=c.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||d).stringify(this)},concat:function(e){var t=this.words,n=e.words,o=this.sigBytes,s=e.sigBytes;if(this.clamp(),o%4)for(var r=0;r<s;r++){var a=n[r>>>2]>>>24-r%4*8&255;t[o+r>>>2]|=a<<24-(o+r)%4*8}else for(var i=0;i<s;i+=4)t[o+i>>>2]=n[i>>>2];return this.sigBytes+=s,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(o());return new l.init(t,e)}}),u=a.enc={},d=u.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],s=0;s<n;s++){var r=t[s>>>2]>>>24-s%4*8&255;o.push((r>>>4).toString(16)),o.push((15&r).toString(16))}return o.join("")},parse:function(e){for(var t=e.length,n=[],o=0;o<t;o+=2)n[o>>>3]|=parseInt(e.substr(o,2),16)<<24-o%8*4;return new l.init(n,t/2)}},p=u.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],s=0;s<n;s++){var r=t[s>>>2]>>>24-s%4*8&255;o.push(String.fromCharCode(r))}return o.join("")},parse:function(e){for(var t=e.length,n=[],o=0;o<t;o++)n[o>>>2]|=(255&e.charCodeAt(o))<<24-o%4*8;return new l.init(n,t)}},f=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(p.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return p.parse(unescape(encodeURIComponent(e)))}},h=i.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,o=this._data,s=o.words,r=o.sigBytes,a=this.blockSize,i=r/(4*a),c=(i=t?e.ceil(i):e.max((0|i)-this._minBufferSize,0))*a,u=e.min(4*c,r);if(c){for(var d=0;d<c;d+=a)this._doProcessBlock(s,d);n=s.splice(0,c),o.sigBytes-=u}return new l.init(n,u)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=h.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new m.HMAC.init(e,n).finalize(t)}}});var m=a.algo={};return a}(Math),e)),ue.exports;var e}var he,me;const be=o(he?le.exports:(he=1,le.exports=(me=fe(),function(e){var t=me,n=t.lib,o=n.WordArray,s=n.Hasher,r=t.algo,a=[],i=[];!function(){function t(t){for(var n=e.sqrt(t),o=2;o<=n;o++)if(!(t%o))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var o=2,s=0;s<64;)t(o)&&(s<8&&(a[s]=n(e.pow(o,.5))),i[s]=n(e.pow(o,1/3)),s++),o++}();var c=[],l=r.SHA256=s.extend({_doReset:function(){this._hash=new o.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],s=n[1],r=n[2],a=n[3],l=n[4],u=n[5],d=n[6],p=n[7],f=0;f<64;f++){if(f<16)c[f]=0|e[t+f];else{var h=c[f-15],m=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,b=c[f-2],g=(b<<15|b>>>17)^(b<<13|b>>>19)^b>>>10;c[f]=m+c[f-7]+g+c[f-16]}var w=o&s^o&r^s&r,v=(o<<30|o>>>2)^(o<<19|o>>>13)^(o<<10|o>>>22),C=p+((l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25))+(l&u^~l&d)+i[f]+c[f];p=d,d=u,u=l,l=a+C|0,a=r,r=s,s=o,o=C+(v+w)|0}n[0]=n[0]+o|0,n[1]=n[1]+s|0,n[2]=n[2]+r|0,n[3]=n[3]+a|0,n[4]=n[4]+l|0,n[5]=n[5]+u|0,n[6]=n[6]+d|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,o=8*this._nDataBytes,s=8*t.sigBytes;return n[s>>>5]|=128<<24-s%32,n[14+(s+64>>>9<<4)]=e.floor(o/4294967296),n[15+(s+64>>>9<<4)]=o,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=s._createHelper(l),t.HmacSHA256=s._createHmacHelper(l)}(Math),me.SHA256)));var ge,we={exports:{}};var ve=(ge||(ge=1,we.exports=function(e){return function(){var t=e,n=t.lib.WordArray;function o(e,t,o){for(var s=[],r=0,a=0;a<t;a++)if(a%4){var i=o[e.charCodeAt(a-1)]<<a%4*2|o[e.charCodeAt(a)]>>>6-a%4*2;s[r>>>2]|=i<<24-r%4*8,r++}return n.create(s,r)}t.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,o=this._map;e.clamp();for(var s=[],r=0;r<n;r+=3)for(var a=(t[r>>>2]>>>24-r%4*8&255)<<16|(t[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|t[r+2>>>2]>>>24-(r+2)%4*8&255,i=0;i<4&&r+.75*i<n;i++)s.push(o.charAt(a>>>6*(3-i)&63));var c=o.charAt(64);if(c)for(;s.length%4;)s.push(c);return s.join("")},parse:function(e){var t=e.length,n=this._map,s=this._reverseMap;if(!s){s=this._reverseMap=[];for(var r=0;r<n.length;r++)s[n.charCodeAt(r)]=r}var a=n.charAt(64);if(a){var i=e.indexOf(a);-1!==i&&(t=i)}return o(e,t,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64}(fe())),we.exports);const Ce=o(ve);var ye=se("obs-websocket-js"),_e=class extends Error{constructor(e,t){super(t),this.code=e}},Se=class e extends ie{static requestCounter=1;static generateMessageId(){return String(e.requestCounter++)}_identified=!1;internalListeners=new ie;socket;get identified(){return this._identified}async connect(e="ws://127.0.0.1:4455",t,n={}){this.socket&&await this.disconnect();try{const o=this.internalEventPromise("ConnectionClosed"),s=this.internalEventPromise("ConnectionError");return await Promise.race([(async()=>{const o=await this.createConnection(e);return this.emit("Hello",o),this.identify(o,t,n)})(),new Promise((e,t)=>{s.then(e=>{e.message&&t(e)}),o.then(e=>{t(e)})})])}catch(o){throw await this.disconnect(),o}}async disconnect(){if(!this.socket||this.socket.readyState===ce.CLOSED)return;const e=this.internalEventPromise("ConnectionClosed");this.socket.close(),await e}async reidentify(e){const t=this.internalEventPromise("op:2");return await this.message(3,e),t}async call(t,n){const o=e.generateMessageId(),s=this.internalEventPromise(`res:${o}`);await this.message(6,{requestId:o,requestType:t,requestData:n});const{requestStatus:r,responseData:a}=await s;if(!r.result)throw new _e(r.code,r.comment);return a}async callBatch(t,n={}){const o=e.generateMessageId(),s=this.internalEventPromise(`res:${o}`);await this.message(8,{requestId:o,requests:t,...n});const{results:r}=await s;return r}cleanup(){this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket=void 0,this._identified=!1,this.internalListeners.removeAllListeners())}async createConnection(e){var t;const n=this.internalEventPromise("ConnectionOpened"),o=this.internalEventPromise("op:0");this.socket=new ce(e,this.protocol),this.socket.onopen=this.onOpen.bind(this),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=this.onError.bind(this),this.socket.onclose=this.onClose.bind(this),await n;const s=null==(t=this.socket)?void 0:t.protocol;if(!s)throw new _e(-1,"Server sent no subprotocol");if(s!==this.protocol)throw new _e(-1,"Server sent an invalid subprotocol");return o}async identify({authentication:e,rpcVersion:t,...n},o,s={}){const r={rpcVersion:t,...s};e&&o&&(r.authentication=function(e,t,n){const o=Ce.stringify(be(n+e));return Ce.stringify(be(o+t))}(e.salt,e.challenge,o));const a=this.internalEventPromise("op:2");await this.message(1,r);const i=await a;return this._identified=!0,this.emit("Identified",i),{rpcVersion:t,...n,...i}}async message(e,t){if(!this.socket)throw new Error("Not connected");if(!this.identified&&1!==e)throw new Error("Socket not identified");const n=await this.encodeMessage({op:e,d:t});this.socket.send(n)}async internalEventPromise(e){return new Promise(t=>{this.internalListeners.once(e,t)})}onOpen(e){ye("socket.open"),this.emit("ConnectionOpened"),this.internalListeners.emit("ConnectionOpened",e)}async onMessage(e){try{const{op:t,d:n}=await this.decodeMessage(e.data);if(ye("socket.message: %d %j",t,n),void 0===t||void 0===n)return;switch(t){case 5:{const{eventType:e,eventData:t}=n;return void this.emit(e,t)}case 7:case 9:{const{requestId:e}=n;return void this.internalListeners.emit(`res:${e}`,n)}default:this.internalListeners.emit(`op:${t}`,n)}}catch(t){ye("error handling message: %o",t)}}onError(e){ye("socket.error: %o",e);const t=new _e(-1,e.message);this.emit("ConnectionError",t),this.internalListeners.emit("ConnectionError",t)}onClose(e){ye("socket.close: %s (%d)",e.reason,e.code);const t=new _e(e.code,e.reason);this.emit("ConnectionClosed",t),this.internalListeners.emit("ConnectionClosed",t),this.cleanup()}};"undefined"!=typeof exports&&Object.defineProperty(exports,"__esModule",{value:!0});var xe=class extends Se{protocol="obswebsocket.json";async encodeMessage(e){return JSON.stringify(e)}async decodeMessage(e){return JSON.parse(e)}};const ke={key:0,class:"mini-mode"},Fe={class:"zone-info"},Ee={class:"zone-name-wrapper"},Pe={class:"zone-name"},je={class:"rules-status"},Ve=["title"],Oe=["title"],Ae=["title"],Be=["title"],Re=["title"],ze={key:1,class:"obs-status-text"},Me={class:"mode-switch-container"},Le={class:"mini-mode-placeholder",style:{visibility:"hidden","pointer-events":"none"}},Ue={class:"zone-info"},De={class:"zone-name-wrapper"},Ne={class:"zone-name"},Te={class:"zone-type"},Ie={class:"rules-status"},We={class:"rule-item"},He={class:"rule-item"},qe={class:"rule-item"},$e={class:"rule-item"},Ge={class:"rule-item"},Ze={key:1,class:"obs-status-text"},Je={class:"card-header"},Ye={class:"header-actions"},Ke={key:1},Qe={class:"card-header"},Xe={class:"status-info"},et={class:"button-container"},tt={class:"card-header"},nt={class:"header-actions"},ot={class:"profile-info"},st={class:"append-content-toggle"},rt={class:"card-header"},at={class:"header-actions"},it={key:0,class:"current-type"},ct=Y(m({__name:"obs2",setup(o){const{t:s}=h(),{zoneType:r}=i(),m=b("obs-zone-name",""),Y=b("obs-user-config",{host:4455,password:"",path:"",fileName:"%CCYY-%MM-%DD %hh-%mm-%ss",appendContentName:!0},localStorage,{mergeDefaults:!0}),K=b("obs-user-content-setting",[]),Q=a(),X=g(1),ee=b("obs-has-used-before",!1),te=g(ee.value),ne={inCombat:u.inCombat(),countdown:u.countdown(),countdownCancel:u.countdownCancel(),wipe:d.wipe},oe={enter:!1,countdown:!0,countdownCancel:!0,combatStart:!0,combatEnd:!0,wipe:!0,partyLength:1,customPath:""},se={enter:!1,countdown:!1,countdownCancel:!1,combatStart:!1,combatEnd:!1,wipe:!1,partyLength:1,customPath:""};const re=new class{ws;status;connectingPromise=null;handleConnectionError=()=>{ce("OBS connection error"),this.status.connecting=!1,this.status.connected=!1,this.status.recording=!1,this.status.outputActive=!1,this.status.outputPath=""};handleConnectionClosed=()=>{ce("OBS connection closed"),this.status.connecting=!1,this.status.connected=!1,this.status.recording=!1,this.status.outputActive=!1,this.status.outputPath=""};handleRecordStateChanged=e=>{this.status.connected=!0,this.status.recording="OBS_WEBSOCKET_OUTPUT_STARTED"===e.outputState,this.status.outputActive=e.outputActive,this.status.outputPath=e.outputPath||""};constructor(){this.ws=new xe,this.status=S({connecting:!1,connected:!1,recording:!1,outputActive:!1,outputPath:""}),this.ws.on("ConnectionClosed",this.handleConnectionClosed),this.ws.on("ConnectionError",this.handleConnectionError),this.ws.on("RecordStateChanged",this.handleRecordStateChanged)}async connect(){return this.status.connected?Promise.resolve():(this.connectingPromise||(this.connectingPromise=(async()=>{if(ce("Connecting to OBS"),Y.value.host){this.status.connecting=!0;try{await this.ws.connect(`ws://127.0.0.1:${Y.value.host}`,Y.value.password),ce("Connected to OBS");const e=await this.ws.call("GetRecordStatus");if(this.status.recording=e.outputActive,this.status.outputActive=e.outputActive,this.status.connected=!0,!Y.value.path){const e=await this.ws.call("GetRecordDirectory");e.recordDirectory&&(Y.value.path=e.recordDirectory,K.value.forEach(t=>{""===t.customPath&&(t.customPath=e.recordDirectory)}))}Y.value.fileName||(Y.value.fileName="%CCYY-%MM-%DD %hh-%mm-%ss"),ee.value=!0}catch(e){ce("OBS connection failed",e),x({type:"error",message:s("obs2.connection failed"),duration:1e3})}finally{this.status.connecting=!1,this.connectingPromise=null}}else x({type:"error",message:s("obs2.host required"),duration:1e3})})()),this.connectingPromise)}disconnect(){ce("Disconnecting from OBS"),this.ws.disconnect()}async startRecord(){ce("Starting recording"),await this.setProfileParameter("start"),this.ws.call("StartRecord")}async stopRecord(){return ce("Stopping recording"),await this.setProfileParameter("stop"),this.ws.call("StopRecord")}async splitRecord(){ce("Splitting recording"),await this.setProfileParameter("split"),await this.ws.call("StopRecord"),setTimeout(()=>{this.startRecord()},1e3)}async setProfileParameter(e){const t=[{requestType:"SetProfileParameter",requestData:{parameterCategory:"AdvOut",parameterName:"RecFilePath",parameterValue:"stop"===e?Y.value.path:K.value.find(e=>e.type===r.value)?.customPath||Y.value.path}},{requestType:"SetProfileParameter",requestData:{parameterCategory:"Output",parameterName:"FilenameFormatting",parameterValue:"stop"===e?Y.value.fileName:Y.value.fileName+(Y.value.appendContentName?` - ${m.value}`:"")}}];return this.ws.callBatch(t)}},ae=e=>{ce("ChangeZone:",e),m.value=e.zoneName,le("enter")},ie=e=>{const t=e.rawLine;for(const n in ne){if(ne[n].exec(t)){const e=t.split("|");switch(n){case"inCombat":{const t="1"===e[l.InCombat.fields.inACTCombat],n="1"===e[l.InCombat.fields.inGameCombat];if(t&&n)return void le("combatStart");if(!t&&!n)return void le("combatEnd");break}case"countdown":le("countdown");break;case"countdownCancel":le("countdownCancel");break;case"wipe":le("wipe")}}}};function ce(...e){Q.value}function le(e){ce();const t=K.value.find(e=>e.type===r.value);if(!t)throw new Error("Rule not found for zone type:"+r.value);if(!1===t.enter&&"enter"===e&&re.status.recording)re.stopRecord();else if(t[e])switch(ce(r.value),e){case"enter":case"countdown":case"combatStart":if(X.value<t.partyLength)return;if(!re.status.connected)return void re.connect()?.then(()=>{re.status.connected&&re.startRecord()});if(!1===re.status.recording)return void re.startRecord();if(!0===re.status.recording&&"combatStart"!==e)return void re.splitRecord();break;case"countdownCancel":case"combatEnd":case"wipe":re.status.recording&&re.stopRecord()}else ce()}const ue=e=>{ce(),X.value=e.party.length||1};w(()=>{re.connect(),p("ChangeZone",ae),p("LogLine",ie),p("PartyChanged",ue),function(){const e=["Savage","Extreme","Ultimate","Chaotic","OccultCrescent","DeepDungeonExtras","Default"];if(0===K.value.length){K.value=[...e.map(e=>({type:e,...oe})),...c.filter(t=>!e.includes(t)).map(e=>({type:e,...se}))];const t=K.value.find(e=>"OccultCrescent"===e.type);t&&(t.partyLength=40)}else{K.value=K.value.filter(e=>c.includes(e.type));const t=c.filter(e=>!K.value.some(t=>t.type===e)&&"Default"!==e).map(t=>e.includes(t)?{type:t,...oe}:{type:t,...se});K.value.push(...t)}K.value.sort((e,t)=>c.indexOf(e.type)-c.indexOf(t.type)),K.value=K.value.map(t=>({...e.includes(t.type)?oe:se,...t})),Y.value.path&&K.value.forEach(e=>{""===e.customPath&&(e.customPath=Y.value.path)})}()}),v(()=>{re.disconnect(),f("ChangeZone",ae),f("LogLine",ie)});const de=C(()=>K.value.find(e=>e.type===r.value)),pe=({row:e})=>e.type===r.value?"current-zone-row":"";return(o,a)=>{const i=z,c=M,l=n,u=t,d=T,p=N,f=D,h=I,b=L,g=H,w=W,v=q,C=G,S=Z,x=J,X=$,ee=U,ne=e;return k(),y(ne,null,{default:_(()=>[E(te)?(k(),F("div",ke,[E(re).status.connected?(k(),F(j,{key:0},[P("div",{class:V(["recording-dot",{"is-recording":E(re).status.recording}])},null,2),P("div",Fe,[P("div",Ee,[P("div",Pe,O(E(m)||E(s)("obs2.Unknown")),1)])]),P("div",je,[P("span",{class:V(["rule-item",{active:E(de)?.enter}]),title:E(s)("obs2.Enter Zone")},O(E(s)("obs2.EnterShort")),11,Ve),P("span",{class:V(["rule-item",{active:E(de)?.countdown}]),title:E(s)("obs2.CountDown")},O(E(s)("obs2.CountdownShort")),11,Oe),P("span",{class:V(["rule-item",{active:E(de)?.combatStart}]),title:E(s)("obs2.CombatStart")},O(E(s)("obs2.CombatStartShort")),11,Ae),P("span",{class:V(["rule-item",{active:E(de)?.combatEnd}]),title:E(s)("obs2.CombatEnd")},O(E(s)("obs2.CombatEndShort")),11,Be),P("span",{class:V(["rule-item",{active:E(de)?.wipe}]),title:E(s)("obs2.Wipe")},O(E(s)("obs2.WipeShort")),11,Re)])],64)):(k(),F("div",ze,O(E(s)("obs2.OBS Not Connected")),1)),P("button",{class:"settings-btn",onClick:a[0]||(a[0]=e=>te.value=!1),title:"展开详情"}," ⚙ ")])):(k(),F(j,{key:1},[P("div",Me,[P("div",Le,[E(re).status.connected?(k(),F(j,{key:0},[a[13]||(a[13]=P("div",{class:"recording-dot"},null,-1)),P("div",Ue,[P("div",De,[P("div",Ne,O(E(m)||E(s)("obs2.Unknown")),1)]),P("div",Te,O(E(r)?`（${E(s)(`obs2.${E(r)}`)}）`:""),1)]),P("div",Ie,[P("span",We,O(E(s)("obs2.EnterShort")),1),P("span",He,O(E(s)("obs2.CountdownShort")),1),P("span",qe,O(E(s)("obs2.CombatStartShort")),1),P("span",$e,O(E(s)("obs2.CombatEndShort")),1),P("span",Ge,O(E(s)("obs2.WipeShort")),1)])],64)):(k(),F("div",Ze,O(E(s)("obs2.OBS Not Connected")),1))]),A(i,{size:"small",onClick:a[1]||(a[1]=e=>te.value=!0),class:"mini-toggle-btn"},{default:_(()=>[B(O(E(s)("obs2.Mini Mode")),1)]),_:1})]),A(c,{title:E(s)("obs2.size warning"),type:"warning",center:"","show-icon":"",closable:!1,class:"window-size-warning"},null,8,["title"]),A(b,{class:"obs-container"},{default:_(()=>[A(ee,null,{default:_(()=>[E(re).status.connected?(k(),F("div",Ke,[E(Q)?(k(),y(b,{key:0,class:"status-card"},{header:_(()=>[P("div",Qe,[P("span",null,O(E(s)("obs2.Connection Status")),1),A(i,{type:"danger",size:"small",class:"disconnect-button",onClick:a[5]||(a[5]=e=>E(re).disconnect())},{default:_(()=>[B(O(E(s)("obs2.Disconnect")),1)]),_:1})])]),default:_(()=>[P("div",Xe,[A(w,{direction:"vertical",column:1,border:""},{default:_(()=>[A(g,{label:E(s)("obs2.Recording")},{default:_(()=>[B(O(E(re).status.recording?E(s)("obs2.Yes"):E(s)("obs2.No")),1)]),_:1},8,["label"]),A(g,{label:E(s)("obs2.Output Path")},{default:_(()=>[B(O(E(re).status.outputPath||E(s)("obs2.None")),1)]),_:1},8,["label"])]),_:1})]),P("div",et,[A(i,{disabled:!E(re).status.connected||E(re).status.recording,type:"primary",onClick:a[6]||(a[6]=e=>E(re).startRecord())},{default:_(()=>[B(O(E(s)("obs2.Start Record")),1)]),_:1},8,["disabled"]),A(i,{disabled:!E(re).status.connected||!E(re).status.recording,type:"danger",onClick:a[7]||(a[7]=e=>E(re).stopRecord())},{default:_(()=>[B(O(E(s)("obs2.Stop Record")),1)]),_:1},8,["disabled"]),A(i,{disabled:!E(re).status.connected||!E(re).status.recording,type:"warning",onClick:a[8]||(a[8]=e=>E(re).splitRecord())},{default:_(()=>[B(O(E(s)("obs2.Split Record")),1)]),_:1},8,["disabled"]),A(i,{type:"primary",onClick:a[9]||(a[9]=e=>E(re).setProfileParameter("stop"))},{default:_(()=>[B(O(E(s)("obs2.Set Recording Name")),1)]),_:1})])]),_:1})):R("",!0),A(b,{class:"profile-card"},{header:_(()=>[P("div",tt,[P("span",null,O(E(s)("obs2.Recording Profile")),1),P("div",nt,[A(l,{"storage-key":"obs-2-theme"}),A(u)])])]),default:_(()=>[P("div",ot,[A(f,{"label-position":"top",class:"content-form"},{default:_(()=>[A(p,{label:E(s)("obs2.Record Default Path")},{default:_(()=>[A(d,{modelValue:E(Y).path,"onUpdate:modelValue":a[10]||(a[10]=e=>E(Y).path=e),placeholder:E(s)("obs2.recordPathPlaceholder")},null,8,["modelValue","placeholder"]),A(c,{description:E(s)("obs2.filePathExplanation"),type:"info","show-icon":"",closable:!1},null,8,["description"])]),_:1},8,["label"]),A(p,{label:E(s)("obs2.Record File Name")},{default:_(()=>[A(d,{modelValue:E(Y).fileName,"onUpdate:modelValue":a[11]||(a[11]=e=>E(Y).fileName=e),placeholder:E(s)("obs2.recordFileNamePlaceholder")},null,8,["modelValue","placeholder"]),A(c,{description:E(s)("obs2.fileNameExplanation"),type:"info","show-icon":"",closable:!1},null,8,["description"])]),_:1},8,["label"]),A(p,null,{default:_(()=>[P("div",st,[P("span",null,O(E(s)("obs2.Append Content Name")),1),A(v,{modelValue:E(Y).appendContentName,"onUpdate:modelValue":a[12]||(a[12]=e=>E(Y).appendContentName=e)},null,8,["modelValue"])])]),_:1})]),_:1})])]),_:1}),A(c,{class:"instruction-alert",type:"info",description:E(s)("obs2.IMETutorial"),closable:!1,"show-icon":""},null,8,["description"]),A(b,{class:"table-card"},{header:_(()=>[P("div",rt,[P("span",null,O(E(s)("obs2.User Content Settings")),1),P("div",at,[A(l,{"storage-key":"obs-2-theme"}),A(u)])])]),default:_(()=>[A(X,{data:E(K),border:!0,stripe:"","row-class-name":pe},{default:_(()=>[A(C,{prop:"type",label:E(s)("obs2.Type"),width:"100",fixed:"",align:"center"},{default:_(e=>[E(r)===e.row.type?(k(),F("span",it,[B(O(E(s)("obs2.Current")),1),a[14]||(a[14]=P("br",null,null,-1))])):R("",!0),P("span",null,O(e.row.type?E(s)(`obs2.${e.row.type}`):""),1)]),_:1},8,["label"]),A(C,{label:E(s)("obs2.Start When"),align:"center"},{default:_(()=>[A(C,{label:E(s)("obs2.When Party"),align:"center",width:"70"},{default:_(e=>[A(S,{modelValue:e.row.partyLength,"onUpdate:modelValue":t=>e.row.partyLength=t,min:1,max:48,style:{width:"40px"},size:"small",controls:!1},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),A(C,{prop:"enter",label:E(s)("obs2.Enter Zone"),align:"center",width:"50"},{default:_(e=>[A(x,{modelValue:e.row.enter,"onUpdate:modelValue":t=>e.row.enter=t},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),A(C,{prop:"countdown",label:E(s)("obs2.CountDown"),align:"center",width:"55"},{default:_(e=>[A(x,{modelValue:e.row.countdown,"onUpdate:modelValue":t=>e.row.countdown=t},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),A(C,{prop:"combatStart",label:E(s)("obs2.CombatStart"),align:"center",width:"55"},{default:_(e=>[A(x,{modelValue:e.row.combatStart,"onUpdate:modelValue":t=>e.row.combatStart=t},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"])]),_:1},8,["label"]),A(C,{label:E(s)("obs2.End When"),align:"center"},{default:_(()=>[A(C,{prop:"combatEnd",label:E(s)("obs2.CombatEnd"),align:"center",width:"55"},{default:_(e=>[A(x,{modelValue:e.row.combatEnd,"onUpdate:modelValue":t=>e.row.combatEnd=t},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),A(C,{prop:"wipe",label:E(s)("obs2.Wipe"),align:"center",width:"50"},{default:_(e=>[A(x,{modelValue:e.row.wipe,"onUpdate:modelValue":t=>e.row.wipe=t},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),A(C,{prop:"countdown",label:E(s)("obs2.CountDownCancel"),align:"center",width:"60"},{default:_(e=>[A(x,{modelValue:e.row.countdownCancel,"onUpdate:modelValue":t=>e.row.countdownCancel=t},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"])]),_:1},8,["label"]),A(C,{label:E(s)("obs2.Custom Path"),align:"left","min-width":"200"},{default:_(e=>[A(d,{modelValue:e.row.customPath,"onUpdate:modelValue":t=>e.row.customPath=t,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1})])):(k(),y(b,{key:0,class:"connection-card"},{header:_(()=>[P("div",Je,[P("span",null,O(E(s)("obs2.Connect to OBS")),1),P("div",Ye,[A(l,{"storage-key":"obs-2-theme"}),A(u)])])]),default:_(()=>[A(f,{"label-position":"top",class:"connection-form"},{default:_(()=>[A(p,{label:E(s)("obs2.Port")},{default:_(()=>[A(d,{modelValue:E(Y).host,"onUpdate:modelValue":a[2]||(a[2]=e=>E(Y).host=e),placeholder:E(s)("obs2.portPlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),A(p,{label:E(s)("obs2.Password")},{default:_(()=>[A(d,{modelValue:E(Y).password,"onUpdate:modelValue":a[3]||(a[3]=e=>E(Y).password=e),placeholder:E(s)("obs2.passwordPlaceholder"),type:"password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),A(p,null,{default:_(()=>[A(i,{type:"primary",class:"connect-button",loading:E(re).status.connecting,disabled:E(re).status.connecting||!E(Y).host,onClick:a[4]||(a[4]=e=>E(re).connect())},{default:_(()=>[B(O(E(re).status.connecting?E(s)("obs2.Connecting"):E(s)("obs2.Connect")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),A(h,null,{default:_(()=>[B(O(E(s)("obs2.Instructions")),1)]),_:1}),A(c,{class:"instruction-alert",type:"info",description:E(s)("obs2.obsTutorial"),closable:!1,"show-icon":""},null,8,["description"]),A(c,{class:"instruction-alert",type:"info",description:E(s)("obs2.inputTutorial"),closable:!1,"show-icon":""},null,8,["description"]),A(c,{class:"instruction-alert",type:"info",description:E(s)("obs2.firewallTutorial"),closable:!1,"show-icon":""},null,8,["description"])]),_:1}))]),_:1})]),_:1})],64))]),_:1})}}}),[["__scopeId","data-v-6f40bc18"]]);export{ct as default};
