import{_ as e}from"./ActWrapper-UDafzLxa.js";import{u as r,_ as a}from"./DragJob-CV-r8Ran.js";import{d as t,r as s,g as i,h as o,y as n,j as l,w as u,n as p,u as m,o as c,a as d,k as b,c as f,F as v,l as g,t as j,v as x,p as h,b as y}from"./index-DtRnTB31.js";import{N as w}from"./netregexes-RPvCCaeG.js";import{a as P}from"./overlay_plugin_api-DHbPkDtN.js";import{_}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./el-card-BCG1h_HK.js";import"./useDev-DsYpLybs.js";import"./index-DfBPki2T.js";import"./useDemo-DdiBJ_CJ.js";import"./el-checkbox-0yGfRGsS.js";import"./index-BGXr5xLJ.js";import"./use-form-common-props-DU0Ex9rX.js";import"./isEqual-CSBA_F7Y.js";import"./index-BPiL1AwD.js";import"./util-BOtaAWHW.js";import"./regexes-BKeG-dSP.js";const I=_(t({__name:"showBarrier",setup(t){p(e=>({"38cc43cb":m($),eae0bb00:m(C)}));const _=r(),I={statusEffectExplicit:w.statusEffectExplicit()};let E=0;const L=s([]),N=s(""),A=s(window.location.href),D=i(()=>new URLSearchParams(A.value.split("?")[1])),S=i(()=>"1"===D.value.get("showSettings")),$=i(()=>40*Number(D.value.get("lineHeight")||1)+"px"),C=i(()=>`${Number(D.value.get("fontSize")||26)}px`),k=i(()=>D.value.get("type")||"1");function z(){L.value.sort((e,r)=>e.id===N.value?-1:r.id===N.value?1:e.job===r.job?r.id.localeCompare(e.id):_.arr.indexOf(e.job)-_.arr.indexOf(r.job))}function H(e){return"1"===k.value?`${e.barrierPercent}`:"2"===k.value?`${e.barrierAmount}`:`${e.barrierPercent}%(${e.barrierAmount})`}return o(()=>{P("LogLine",e=>{!function(e){const r=I.statusEffectExplicit.exec(e);if(r?.groups?.targetId.startsWith("1")){const e=L.value.find(e=>e.id===r.groups?.targetId);e&&(e.barrierPercent=Number(r.groups?.currentShield),e.barrierAmount=Math.round(Number(r.groups?.maxHp)*e.barrierPercent/100))}}(e.rawLine)}),P("PartyChanged",e=>{L.value=e.party.filter(e=>e.inParty).map(e=>({...e,barrierPercent:0,barrierAmount:0}))}),P("ChangePrimaryPlayer",e=>{N.value=Number(e.charID).toString(16).toUpperCase()}),n([L,N,_.arr],()=>{clearInterval(E),N.value?z():E=window.setInterval(()=>{N.value&&(z(),clearInterval(E))},100)},{immediate:!0}),window.addEventListener("hashchange",e=>A.value=e.newURL)}),(r,t)=>{const s=a,i=e;return c(),l(i,null,{default:u(()=>[d("div",null,[d("ul",null,[(c(!0),f(v,null,g(m(L),e=>(c(),f("li",{key:e.id},[b(d("span",{"m-r-2":""},j(e.name),513),[[x,m(S)]]),d("span",{style:h(0===e.barrierPercent?{opacity:.25,color:"white"}:{opacity:1,color:"#f5da3c"})},j(H(e)),5)]))),128))]),b(y(s,{style:{"z-index":"10000"},party:m(L),"m-b-1":"","p-1":""},null,8,["party"]),[[x,m(S)]])])]),_:1})}}}),[["__scopeId","data-v-d26e0ae1"]]);export{I as default};
